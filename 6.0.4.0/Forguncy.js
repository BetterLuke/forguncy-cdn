function getListviewPreviewImage(n){return Forguncy.ListViewHelper.PreviewHelper.createImage(n)}function AddLoadChartMissedContext(n){Forguncy.ColorHelper.Colors=n.ThemeColors;Forguncy.ColorHelper.ColorCache={};Forguncy.ForguncyData=Forguncy.ForguncyData;Forguncy.ForguncyData.pageInfo=new Forguncy.PageInfo;Forguncy.ForguncyData.pageInfo.formulaManager=new Forguncy.FormulaManager(new Forguncy.DataModel);Forguncy.ForguncyData.pageInfo.formulaManager.evaluateFormula=function(n){return n}}function getChartPreviewImage(n,t,i){var r,c,o,u,s,v,h;try{i||(i=1);r=JSON.parse(n);AddLoadChartMissedContext(r);var l=r.Width,a=r.Height,e=$("#chart");return e.css("width",l),e.css("height",a),c=$("canvas",e),c.css("width",l),c.css("height",a),o=window.echarts.init(e[0]),u=r.ChartGeoJsonMetadata,u&&u.GeoAreaJsonFileName&&(s=u.GeoAreaJsonFileName,s=s.replace(/\\/g,"_"),window.echarts.registerMap(s,u.GeoAreaJsonContent)),setChartOptionInternal(r,o),v=o.getDataURL({pixelRatio:i,backgroundColor:"transparent"}),t||o.clear(),v}catch(f){return console.error(f),h="Error:"+f,f&&f.stack&&(h=h+"\r\n"+f.stack),h}}function setChartOptionInternal(n,t){var i=Forguncy.ConvertChartHelper.convertChartModelToECharts(n.ChartJson,n.ChartDataMapping,null,n.ChartGeoJsonMetadata);i.animation=!1;t.setOption(i);t.resize()}var __assign,PivotData,__spreadArrays,__extends,Forguncy;(function(n){var t;(function(t){var r=function(){function t(){}return t.requestRSAPublicKey=function(t){n.Common.forguncyPost("Account/GetRSAPublicKey",null,function(i,r){i!=null&&i.Result?t(i.Result):alert(n.RS.Failed)},null,function(){alert(n.RS.Failed)})},t}(),i;t.SecurityManager=r;i=function(){function n(){}return n.encrypt=function(n,t){var i=new JSEncrypt({});return i.setPublicKey(t),i.encrypt(n)},n}();t.Encrypter=i})(t=n.Security||(n.Security={}))})(Forguncy||(Forguncy={})),function(n){var t;(function(n){var t=function(){function n(n,t){n===void 0&&(n=0);t===void 0&&(t=0);this.x=n;this.y=t}return Object.defineProperty(n,"Zero",{get:function(){return new n(0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sqrtLength",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!0,configurable:!0}),n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.normalize=function(){var t=1/this.length;return new n(this.x*t,this.y*t)},n.prototype.negate=function(){return new n(-this.x,-this.y)},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.multiply=function(t){return new n(this.x*t,this.y*t)},n.prototype.divide=function(t){var i=1/t;return new n(this.x*i,this.y*i)},n.prototype.dot=function(n){return this.x*n.x+this.y*n.y},n.prototype.rotate=function(t){var i=Math.sin(t),r=Math.cos(t);return new n(this.x*r-this.y*i,this.y*r+this.x*i)},n.prototype.setLength=function(n){var t=this.length;t>0&&(this.x=this.x*n/t,this.y=this.y*n/t)},n.prototype.limitLength=function(n){var t=this.length;t>n&&this.setLength(n)},n.prototype.cos=function(n){return this.dot(n)/(this.length*n.length)},n}();n.Vector2=t})(t=n.Numerics||(n.Numerics={}))}(Forguncy||(Forguncy={})),function(n){var h=function(){function t(){}Object.defineProperty(t,"default",{get:function(){var r,i,u=n.ForguncyData.GlobalSettings;return i=(r=u)===null||r===void 0?void 0:r.ThemeFont,i!==null&&i!==void 0?i:t[n.RS.Culture]},enumerable:!0,configurable:!0});var i,r,u,f;return i="EN",r="CN",u="JA",f="KR",t[i]="Arial",t[r]="Microsoft YaHei",t[u]="Meiryo UI",t[f]="Malgun Gothic",t}(),t,i,r,u,f,e,o,s;n.LocaleFonts=h;t=function(){function n(){}return n.Culture="EN",n.UserNameOrPasswordIsIncorrect="User name or password is incorrect",n.PasswordIsNotSame="Password is not same",n.ForSafetyReasonPleaseChangeYourPassword="Login success. For safety reason, please change your default password",n.TokenIsInvalid="token is invalid",n.ResetPasswordSuccess="Reset Password Success!",n.Failed="Failed",n.UserName="UserName",n.None="<None>",n.deleteStr="delete",n.addStr="add",n.listviewNotExisted="The listview is not existed.",n.FullName="Full Name",n.Email="Email",n.Role="Role",n.OrganizationSuperior="OrganizationSuperior",n.Success="Success!",n.ConfirmDelete="Are you sure to delete?",n.Year="Year",n.Month="Month",n.Day="Day",n.Quarter="Quarter",n.noFieldErrorInfo="There is no field for table {0}.",n.unique="The value has been existed, please input other value.",n.login="Login",n.cantAddEmptyFile="Can't upload an empty file",n.Boolean_True="Yes",n.Boolean_False="No",n.MonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],n.ColumnFilter_YearName="",n.ColumnFilter_DayName="",n.ContextMenu_CompareType_Equals="Equals",n.ContextMenu_CompareType_DoesNotEqual="Does Not Equal",n.ContextMenu_CompareType_BeginsWith="Begins With",n.ContextMenu_CompareType_DoesNotBeginWith="Does Not Begin With",n.ContextMenu_CompareType_EndsWith="Ends With",n.ContextMenu_CompareType_DoesNotEndWidth="Does Not End With",n.ContextMenu_CompareType_Contains="Contains",n.ContextMenu_CompareType_DoesNotContain="Does Not Contain",n.ContextMenu_CompareType_IsGreaterThan="Greater Than",n.ContextMenu_CompareType_IsGreaterThanOrEqualTo="Greater Than Or Equal To",n.ContextMenu_CompareType_IsLessThan="Less Than",n.ContextMenu_CompareType_IsLessThanOrEqualTo="Less Than Or Equal To",n.ContextMenu_CompareType_IsBetween="Between",n.ContextMenu_CompareType_IsNotBetween="Not Between",n.ContextMenu_CompareType_In="In",n.ContextMenu_CompareType_NotIn="Not In",n.ContextMenu_CompareType_IsLessThan_Date="Before",n.ContextMenu_CompareType_IsGreaterThan_Date="After",n.ComboBox_CompareType_Equals="Equals",n.ComboBox_CompareType_DoesNotEqual="Does Not Equal",n.ComboBox_CompareType_BeginsWith="Begins With",n.ComboBox_CompareType_DoesNotBeginWith="Does Not Begin With",n.ComboBox_CompareType_EndsWith="Ends With",n.ComboBox_CompareType_DoesNotEndWidth="Does Not End With",n.ComboBox_CompareType_Contains="Contains",n.ComboBox_CompareType_DoesNotContain="Does Not Contain",n.ComboBox_CompareType_IsGreaterThan="Greater Than",n.ComboBox_CompareType_IsGreaterThanOrEqualTo="Greater Than Or Equal To",n.ComboBox_CompareType_IsLessThan="Less Than",n.ComboBox_CompareType_IsLessThanOrEqualTo="Less Than Or Equal To",n.ComboBox_CompareType_IsBetween="Between",n.ComboBox_CompareType_IsNotBetween="Not Between",n.ComboBox_CompareType_In="In",n.ComboBox_CompareType_NotIn="Not In",n.ComboBox_CompareType_IsLessThan_Date="Before",n.ComboBox_CompareType_IsGreaterThan_Date="After",n.DateCompareType_Tomorrow="Tomorrow",n.DateCompareType_Today="Today",n.DateCompareType_Yesterday="Yesterday",n.DateCompareType_NextWeek="Next Week",n.DateCompareType_ThisWeek="This Week",n.DateCompareType_LastWeek="Last Week",n.DateCompareType_NextMonth="Next Month",n.DateCompareType_ThisMonth="This Month",n.DateCompareType_LastMonth="Last Month",n.DateCompareType_NextYear="Next Year",n.DateCompareType_ThisYear="This Year",n.DateCompareType_LastYear="Last Year",n.ForguncyUI_Dialog_OK="OK",n.ForguncyUI_Dialog_Cancel="Cancel",n.ColumnFilter_Dialog_Title="Filter",n.ColumnFilter_ContextMenu_SortAscending="Sort Ascending",n.ColumnFilter_ContextMenu_SortDesending="Sort Desending",n.ColumnFilter_ContextMenu_ClearFilter="Clear Filter",n.ColumnFilter_ContextMenu_Filter="Filter",n.ColumnFilter_ContextMenu_CustomFilter="Custom Filter",n.ColumnFilter_ContextMenu_NumberFilter="Number Filter",n.ColumnFilter_ContextMenu_TextFilter="Text Filters",n.ColumnFilter_ContextMenu_DateFilter="Date Filters",n.ColumnFilter_TreeView_SelectAll="(Select All)",n.ColumnFilter_TreeView_Blanks="(Blanks)",n.ColumnFilter_TreeView_TooManyItems="Not all items showing",n.ColumnFilter_TextBlock_And="And",n.ColumnFilter_TextBlock_Where="Show items where:",n.ColumnFilter_Alert_IncorrectValue="The value you entered is not correct\uff01",n.ColumnFilter_TextBlock_TextExample_In="e.g. Apple,Banana,Orange (Seperate by half-width comma)",n.ColumnFilter_TextBlock_DateExample="e.g. 2019/01/01",n.ColumnFilter_TextBlock_DateExample_Between="e.g. 2019/01/01 and 2019/12/31",n.ColumnFilter_TextBlock_TimeExample="e.g. 10:00",n.ColumnFilter_TextBlock_TimeExample_Between="e.g. 10:00 and 12:00",n.ColumnOptionsCommand_Title="Column Options",n.ColumnOptionsCommand_AvailableColumns="Available Columns:",n.ColumnOptionsCommand_SelectedColumns="Selected Columns:",n.ColumnOptionsCommand_UnamedColumn="<Unnamed Column>",n.ColumnOptionsCommand_ResetSetting="Reset setting",n.ColumnOptionsCommand_ConfirmResetSetting="Are you sure to reset setting?\r\nNotice that the browser will be reloaded immediately.",n.ColumnOptionsCommand_AddColumn="Add Column",n.ColumnOptionsCommand_RemoveColumn="Remove Column",n.ColumnOptionsCommand_MoveColumnUp="Move Column Up ",n.ColumnOptionsCommand_MoveColumnDown="Move Column Down",n.AttachmentCell_NotSupportedFile="Not Supported File",n.CurrentUserCell_ChangeProfile="Change Profile",n.CurrentUserCell_ChangePassword="Change Password",n.CurrentUserCell_Logout="Log out",n.ProcessBarCell_AssignedToPopup_Title="Current Assignees",n.ProcessBarCell_AssignedTo="Assigned To",n.ProcessBarCell_AssignedTo_me="me",n.ProcessBarCell_AssignedToMultiUser="{0} and {1} more",n.ProcessBarCell_HistoryPopup_Title="Status History",n.ProcessBarCell_History_Operator="Operator",n.ProcessBarCell_History_Time="Time",n.ProcessBarCell_History_EndStatus="End Status",n.ProcessBarCell_History_Comments="Comments",n.ProcessBarCell_History_ActionName="Action Name",n.ProcessBarCell_ActionPopup_Title="Update Status",n.ProcessBarCell_ActionPopup_NextStatus="Next Status:",n.ProcessBarCell_ActionPopup_Assignto_Choose="Select Assignee:",n.ProcessBarCell_ActionPopup_Assignto_All="Next status's Assignees:",n.ProcessBarCell_ActionPopup_Comments="Comments:",n.ProcessBarCell_OK="OK",n.ProcessBarCell_Cancel="Cancel",n.ProcessBarCell_Status="Status: {0}",n.ProcessBarCell_ChangeStateFailed="_Execute action failed",n.ProcessBarCell_ChangeAssignee="Change Assignee",n.ProcessBarCell_CreateBy="Create by {0}, at {1}",n.ProcessBarCell_LastModifyBy="Last modify by {0}, at {1}",n.CannotFindCell="Can't find a cell named '{0}' in this page",n.CannotFindCellById="Can't find a cell which id equals to '{0}' in this page",n.CannotFindListview="Can't find a listview named '{0}' in this page",n.CannotFindColumn="Can't find a column named '{0}' in listview '{1}'",n.CannotFindColumnIndex="Invalid column index '{0}' in listview '{1}'",n.NotSupportEventForPage="Not support event '{0}' for {1}",n.NotSupportEventForCellOrListview="Not support event '{0}' for {1} '{2}'",n.NotSupportSetValue="This method isn't support for cell '{0}'",n.InvalidNumberParam="Please give a valid number for param '{0}'",n.IndexOutOfRange="Param '{0}' is out of range",n.ForguncyApiExceptionString="{0} in {1}.{2} method : {3}.",n.InvalidFunctionParam="Param '{0}' should be a function.",n.HideShowColumns_CannotHideRowHeader="Can't hide or show row Header columns.",n.HideShowColumns_ListviewIsEditing="Can't hide or show columns when listview is editing.",n.HideShowColumns_CannotShowHiddenColumn="Can show column that is hidden(Not ignore hidden) or width is 0 in designer.",n.WebApi_ErrorInfo_NonemptyStringParam="Param '{0}' should be a non-empty string.",n.WebApi_ErrorInfo_ParamInvalid="Param '{0}' is not valid.",n.groupCell_Other="Others:",n.ClosePopupCommand_NotPopup="Current page is not popup page.",n.AddUserApiParamError="The type of parameters is wrong!",n.Echart_DataLoadingText="Data loading...",n.Echart_NoDataLoadingText="No Data",n.Echart_BubbleChartToolTip="Size: {0}",n.InvalidCopyPasteSize="The copy and paste areas are not the same size.",n.RangeOperationCannotInvolveTotalRow="The range operation can not involve total row.",n.ValidateErrorMessage="Value '{0}' is not valid on Row: {1}, Column: {2}.\r\nError Message:\r\n{3}",n.InvalidValueTypeMessage="Invalid value type.",n.ValueNotInList="The value is not contained in items list.",n.ErrorInfo_Uncommited="Contain uncommited data.",n.DataValidation_Required="Required",n.DataValidation_WholeNumberDefaultErrorMessage="The WholeNumber you entered is not valid",n.DataValidation_DecimalDefaultErrorMessage="The decimal number you entered is not valid",n.DataValidation_DateDefaultErrorMessage="The date you entered is not valid",n.DataValidation_TimeDefaultErrorMessage="The time you entered is not valid",n.DataValidation_TextLenghtDefaultErrorMessage="The lenght of value you entered is not valid",n.DataValidation_CustomDefaultErrorMessage="The value you entered is not match formula",n.DataValidation_RegularUserInputDefaultErrorMessage="The value you entered is not match regular expression",n.DataValidation_RegularDefaultErrorMessage="The value you entered is not match {0} regular expression",n.Validate_Number="Please enter a valid number.",n.InvalidValueErrorMessage="Can't commit invaid value '{0}' of column '{1}' in table '{2}'.",n.uploadFileBiggerThanMaxFileCount="The uploaded file count is match max count. You can't upload more file.",n.uploadFileBiggerThanMaxSize="The uploaded file {0} size is bigger than limit, the max size is {1} MB.",n.uploadFileNotMatchExtension="The file type of the uploaded file {0} is not acceptable.",n.ExprotToExcelCalFormulaError="The Export Excel File's Name is Wrong When calculating the formula!",n.ExprotToPDFCalFormulaError="The Export PDF File's Name is Wrong When calculating the formula!",n.ExportListviewNoColumnError="There is no column to export.",n.AutoGeneratedID_Conflict_Error="Auto generated id has already exists. Related cells have updated new ids. Please commit data again.",n.AutoGeneratedID_Generate_Error="Number part's length is bigger than setted length in auto generated id.",n.AutoGeneratedID_Conflict_Listview_Error="Value in filed '{0}' has already exists.",n.ImportExcelFirstRowMissDataError="The Excel imported first row data can't be empty.",n.NoMatchBetweenExcelWithListViewError="The Excel imported is not matched with listview in page.",n.InCorrectFileFormatError="InCorrect File Format.",n.NoSelectedRowError="Please select one row at least",n.GUID_Creator="Creator",n.GUID_CreateDate="CreateDate",n.GUID_LastModifyBy="LastModifyBy",n.GUID_LastModifyDate="LastModifyDate",n.GUID_AssignTo="AssignTo",n.GUID_Status="Status",n.UpdateListviewCommand_Listview_Group="Can't update a listview contains statistic columns.",n.UpdateListviewCommand_Listview_DetailListview="Can't update a detail listview don't have master table's current row.",n.ImportExcelToListViewError_Detail="The value is invalid in row '{0}' and column named '{1}' in excel. \r\nError message:{2}",n.ImportExcelToListViewError_ExistSameKeys="Exists same reference column values in excel data and please ensure the reference column values is unique.",n.UpdateViewFail_Error="Update failed. \r\n Current view can not be update.",n.UpdateListViewFail_BindingTableCantEditError="Update failed. \r\n Current binding data source can not be update.",n.ConcurrentLicenseError_Kickoffed="You have kickoffed by administrator.",n.ConcurrentLicenseError_NoEnoughLicense="Access refused. The account license has run out, please contact administrator.",n.ConcurrentLicenseError_SendEmail="Send Email",n.ConcurrentLicenseError_Cancel="Not Send",n.ConcurrentLicenseError_MessagePlaceHolder="Input email content here.",n.ConcurrentLicenseError_AddressPlaceHolder="Please input your email address.",n.ConcurrentLicenseError_SendSuccess="Send success.",n.ConcurrentLicenseError_SendFailed="Send failed.",n.ConcurrentLicenseError_EmailTitle="Access refused",n.ConcurrentLicenseError_PleaseInputValidEmailAddress="Please input valid email address.",n.ConcurrentLicenseError_SenderAddress="From",n.ContainerCellType_Error_CircularReference="Sub page '{0}' load fail, exist circular reference.",n.NameConflict="Name '{0}' has conflict, page '{1}' and page '{2}' both have this name.",n.ContainerCellType_Error_NoExistedPage="Can't find page '{0}'.",n.SetCurrentRow_Error_NoRecord="Fail to set current row of table '{0}', there is no record by the query condtion.",n.ListViewAddNewRowError_CantConvertToNumber="Can't convert to number.",n.ListViewAddNewRowError_CantConvertToBool="Can't convert to bool.",n.ListViewAddNewRowError_CantConvertToDateTime="Can't convert to date or time.",n.CallStoredProcedureCommand_ExecuteFailed="Stored procedure execute failed.",n.Command_postFail_ErrorMessage="Command execution fail.",n.Commit_FailMessage="Commit Fail.",n.Commit_ExecutingMessage="Command is executing.",n.LongTimeNoOperation="It is long time you did not operate the page, the connection is disconnected.",n.PleaseClickButtonToReload="Click button to reload page.",n.ReloadPage="Reload the Page",n.DateTime_Calender_HeaderFormat="M-yyyy",n.DateTime_Calender_YearMonthFormat="yyyy,M",n.UnauthorizedUpload="Not allow anonymous access. You need to login.",n}();n.RS=t;i=function(){function n(){}return n.Culture="CN",n.UserNameOrPasswordIsIncorrect="\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef",n.PasswordIsNotSame="\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u76f8\u540c",n.ForSafetyReasonPleaseChangeYourPassword="\u767b\u5f55\u6210\u529f\u3002\u4e3a\u4e86\u5b89\u5168\uff0c\u8bf7\u4fee\u6539\u60a8\u7684\u521d\u59cb\u5bc6\u7801",n.TokenIsInvalid="\u4ee4\u724c\u503c\u4e0d\u6b63\u786e",n.ResetPasswordSuccess="\u91cd\u7f6e\u5bc6\u7801\u6210\u529f",n.Failed="\u5931\u8d25",n.UserName="\u7528\u6237\u540d",n.None="<\u672a\u9009\u62e9>",n.deleteStr="\u5220\u9664",n.addStr="\u6dfb\u52a0",n.listviewNotExisted="\u8868\u683c\u4e0d\u5b58\u5728\u3002",n.FullName="\u5168\u540d",n.Email="\u7535\u5b50\u90ae\u4ef6",n.Role="\u89d2\u8272",n.OrganizationSuperior="\u7ec4\u7ec7\u4e0a\u7ea7",n.Success="\u6210\u529f\uff01",n.ConfirmDelete="\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",n.Year="\u5e74",n.Month="\u6708",n.Day="\u65e5",n.Quarter="\u5b63\u5ea6",n.noFieldErrorInfo="\u4e0d\u5b58\u5728\u6570\u636e\u8868 {0} \u7684\u7ed1\u5b9a\u5b57\u6bb5\u3002",n.unique="\u503c\u5df2\u7ecf\u5b58\u5728\uff0c\u8bf7\u8f93\u5165\u5176\u4ed6\u503c\u3002",n.login="\u767b\u5f55",n.cantAddEmptyFile="\u4e0d\u80fd\u4e0a\u4f20\u7a7a\u6587\u4ef6\u3002",n.Boolean_True="\u662f",n.Boolean_False="\u5426",n.MonthNames=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],n.ColumnFilter_YearName="\u5e74",n.ColumnFilter_DayName="\u65e5",n.ContextMenu_CompareType_Equals="\u7b49\u4e8e",n.ContextMenu_CompareType_DoesNotEqual="\u4e0d\u7b49\u4e8e",n.ContextMenu_CompareType_BeginsWith="\u5f00\u5934\u662f",n.ContextMenu_CompareType_DoesNotBeginWith="\u5f00\u5934\u4e0d\u662f",n.ContextMenu_CompareType_EndsWith="\u7ed3\u5c3e\u662f",n.ContextMenu_CompareType_DoesNotEndWidth="\u7ed3\u5c3e\u4e0d\u662f",n.ContextMenu_CompareType_Contains="\u5305\u542b",n.ContextMenu_CompareType_DoesNotContain="\u4e0d\u5305\u542b",n.ContextMenu_CompareType_IsGreaterThan="\u5927\u4e8e",n.ContextMenu_CompareType_IsGreaterThanOrEqualTo="\u5927\u4e8e\u6216\u7b49\u4e8e",n.ContextMenu_CompareType_IsLessThan="\u5c0f\u4e8e",n.ContextMenu_CompareType_IsLessThanOrEqualTo="\u5c0f\u4e8e\u6216\u7b49\u4e8e",n.ContextMenu_CompareType_IsBetween="\u4ecb\u4e8e\u4e24\u8005",n.ContextMenu_CompareType_IsNotBetween="\u4e0d\u4ecb\u4e8e\u4e24\u8005",n.ContextMenu_CompareType_In="\u5728\u91cc\u9762",n.ContextMenu_CompareType_NotIn="\u4e0d\u5728\u91cc\u9762",n.ContextMenu_CompareType_IsLessThan_Date="\u4e4b\u524d",n.ContextMenu_CompareType_IsGreaterThan_Date="\u4e4b\u540e",n.ComboBox_CompareType_Equals="\u7b49\u4e8e",n.ComboBox_CompareType_DoesNotEqual="\u4e0d\u7b49\u4e8e",n.ComboBox_CompareType_BeginsWith="\u5f00\u5934\u662f",n.ComboBox_CompareType_DoesNotBeginWith="\u5f00\u5934\u4e0d\u662f",n.ComboBox_CompareType_EndsWith="\u7ed3\u5c3e\u662f",n.ComboBox_CompareType_DoesNotEndWidth="\u7ed3\u5c3e\u4e0d\u662f",n.ComboBox_CompareType_Contains="\u5305\u542b",n.ComboBox_CompareType_DoesNotContain="\u4e0d\u5305\u542b",n.ComboBox_CompareType_IsGreaterThan="\u5927\u4e8e",n.ComboBox_CompareType_IsGreaterThanOrEqualTo="\u5927\u4e8e\u6216\u7b49\u4e8e",n.ComboBox_CompareType_IsLessThan="\u5c0f\u4e8e",n.ComboBox_CompareType_IsLessThanOrEqualTo="\u5c0f\u4e8e\u6216\u7b49\u4e8e",n.ComboBox_CompareType_IsBetween="\u4ecb\u4e8e\u4e24\u8005",n.ComboBox_CompareType_IsNotBetween="\u4e0d\u4ecb\u4e8e\u4e24\u8005",n.ComboBox_CompareType_In="\u5728\u91cc\u9762",n.ComboBox_CompareType_NotIn="\u4e0d\u5728\u91cc\u9762",n.ComboBox_CompareType_IsLessThan_Date="\u4e4b\u524d",n.ComboBox_CompareType_IsGreaterThan_Date="\u4e4b\u540e",n.DateCompareType_Tomorrow="\u660e\u5929",n.DateCompareType_Today="\u4eca\u5929",n.DateCompareType_Yesterday="\u6628\u5929",n.DateCompareType_NextWeek="\u4e0b\u5468",n.DateCompareType_ThisWeek="\u672c\u5468",n.DateCompareType_LastWeek="\u4e0a\u5468",n.DateCompareType_NextMonth="\u4e0b\u6708",n.DateCompareType_ThisMonth="\u672c\u6708",n.DateCompareType_LastMonth="\u4e0a\u6708",n.DateCompareType_NextYear="\u660e\u5e74",n.DateCompareType_ThisYear="\u4eca\u5e74",n.DateCompareType_LastYear="\u53bb\u5e74",n.ForguncyUI_Dialog_OK="\u786e\u5b9a",n.ForguncyUI_Dialog_Cancel="\u53d6\u6d88",n.ColumnFilter_Dialog_Title="\u7b5b\u9009",n.ColumnFilter_ContextMenu_SortAscending="\u5347\u5e8f\u6392\u5e8f",n.ColumnFilter_ContextMenu_SortDesending="\u964d\u5e8f\u6392\u5e8f",n.ColumnFilter_ContextMenu_ClearFilter="\u6e05\u7a7a\u7b5b\u9009",n.ColumnFilter_ContextMenu_Filter="\u8bbe\u7f6e\u7b5b\u9009",n.ColumnFilter_ContextMenu_CustomFilter="\u81ea\u5b9a\u4e49\u7b5b\u9009",n.ColumnFilter_ContextMenu_NumberFilter="\u6570\u5b57\u7b5b\u9009",n.ColumnFilter_ContextMenu_TextFilter="\u6587\u672c\u7b5b\u9009",n.ColumnFilter_ContextMenu_DateFilter="\u65e5\u671f\u7b5b\u9009",n.ColumnFilter_TreeView_SelectAll="(\u5168\u9009)",n.ColumnFilter_TreeView_Blanks="(\u7a7a\u767d\u9879)",n.ColumnFilter_TreeView_TooManyItems="\u6570\u636e\u8fc7\u591a\uff0c\u4ec5\u663e\u793a\u524d 500 \u9879\uff01",n.ColumnFilter_TextBlock_And="\u548c",n.ColumnFilter_TextBlock_Where="\u663e\u793a\u884c\uff1a",n.ColumnFilter_Alert_IncorrectValue="\u8f93\u5165\u7684\u503c\u4e0d\u6b63\u786e\uff01",n.ColumnFilter_TextBlock_TextExample_In="\u793a\u4f8b\uff1a\u82f9\u679c,\u9999\u8549,\u6a58\u5b50 (\u4f7f\u7528\u534a\u89d2\u9017\u53f7\u5206\u9694)",n.ColumnFilter_TextBlock_DateExample="\u793a\u4f8b\uff1a2019/01/01",n.ColumnFilter_TextBlock_DateExample_Between="\u793a\u4f8b\uff1a2019/01/01 \u548c 2019/12/31",n.ColumnFilter_TextBlock_TimeExample="\u793a\u4f8b\uff1a10:00",n.ColumnFilter_TextBlock_TimeExample_Between="\u793a\u4f8b\uff1a10:00 \u548c 12:00",n.ColumnOptionsCommand_Title="\u5217\u9009\u9879",n.ColumnOptionsCommand_AvailableColumns="\u53ef\u7528\u5217\uff1a",n.ColumnOptionsCommand_SelectedColumns="\u663e\u793a\u5217\uff1a",n.ColumnOptionsCommand_UnamedColumn="<\u672a\u547d\u540d\u5217>",n.ColumnOptionsCommand_ResetSetting="\u91cd\u7f6e\u8bbe\u5b9a",n.ColumnOptionsCommand_ConfirmResetSetting="\u60a8\u786e\u5b9a\u8981\u91cd\u7f6e\u8bbe\u5b9a\u5417?\r\n\u6ce8\u610f\uff1a\u8fd9\u5c06\u5bfc\u81f4\u6d4f\u89c8\u5668\u7acb\u5373\u5237\u65b0\u3002",n.ColumnOptionsCommand_AddColumn="\u6dfb\u52a0\u5217",n.ColumnOptionsCommand_RemoveColumn="\u79fb\u9664\u5217",n.ColumnOptionsCommand_MoveColumnUp="\u4e0a\u79fb\u5217 ",n.ColumnOptionsCommand_MoveColumnDown="\u4e0b\u79fb\u5217",n.AttachmentCell_NotSupportedFile="\u4e0d\u652f\u6301\u7684\u6587\u4ef6\u7c7b\u578b",n.CurrentUserCell_ChangeProfile="\u4fee\u6539\u4e2a\u4eba\u4fe1\u606f",n.CurrentUserCell_ChangePassword="\u4fee\u6539\u5bc6\u7801",n.CurrentUserCell_Logout="\u9000\u51fa\u5f53\u524d\u8d26\u6237",n.ProcessBarCell_AssignedToPopup_Title="\u62c5\u5f53\u8005",n.ProcessBarCell_AssignedTo="\u62c5\u5f53\u8005",n.ProcessBarCell_AssignedTo_me="\u6211",n.ProcessBarCell_AssignedToMultiUser="{0}\u53ca\u5176\u4ed6{1}\u4eba",n.ProcessBarCell_HistoryPopup_Title="\u72b6\u6001\u5386\u53f2",n.ProcessBarCell_History_Operator="\u64cd\u4f5c\u8005",n.ProcessBarCell_History_Time="\u65f6\u95f4",n.ProcessBarCell_History_EndStatus="\u7ed3\u675f\u72b6\u6001",n.ProcessBarCell_History_Comments="\u5907\u6ce8",n.ProcessBarCell_History_ActionName="\u64cd\u4f5c\u540d\u79f0",n.ProcessBarCell_ActionPopup_Title="\u66f4\u65b0\u72b6\u6001",n.ProcessBarCell_ActionPopup_NextStatus="\u4e0b\u4e2a\u72b6\u6001",n.ProcessBarCell_ActionPopup_Assignto_Choose="\u9009\u62e9\u62c5\u5f53\u8005",n.ProcessBarCell_ActionPopup_Assignto_All="\u4e0b\u4e2a\u64cd\u4f5c\u7684\u62c5\u5f53\u8005",n.ProcessBarCell_ActionPopup_Comments="\u6ce8\u91ca",n.ProcessBarCell_OK="\u786e\u5b9a",n.ProcessBarCell_Cancel="\u53d6\u6d88",n.ProcessBarCell_Status="\u72b6\u6001: {0}",n.ProcessBarCell_ChangeStateFailed="\u6267\u884c\u64cd\u4f5c\u5931\u8d25",n.ProcessBarCell_ChangeAssignee="\u4fee\u6539\u62c5\u5f53\u8005",n.ProcessBarCell_CreateBy="\u521b\u5efa\u8005\uff1a{0}\uff0c\u521b\u5efa\u65f6\u95f4\uff1a{1}",n.ProcessBarCell_LastModifyBy="\u6700\u540e\u66f4\u65b0\u8005\uff1a{0}\uff0c\u66f4\u65b0\u65f6\u95f4\uff1a{1}",n.CannotFindCell="\u672c\u9875\u9762\u4e0d\u80fd\u53d1\u73b0\u547d\u540d\u4e3a'{0}'\u7684\u5355\u5143\u683c\u3002",n.CannotFindCellById="\u672c\u9875\u9762\u4e0d\u80fd\u53d1\u73b0Id\u7b49\u4e8e'{0}'\u7684\u5355\u5143\u683c\u3002",n.CannotFindListview="\u672c\u9875\u9762\u4e0d\u80fd\u53d1\u73b0\u547d\u540d\u4e3a'{0}'\u7684\u5355\u5143\u683c\u3002",n.CannotFindColumn="\u5728\u8868\u683c'{1}'\u4e2d\u4e0d\u80fd\u53d1\u73b0\u547d\u540d\u4e3a'{0}'\u7684\u5217\u3002",n.CannotFindColumnIndex="\u5728\u8868\u683c'{1}'\u4e2d\u6ca1\u6709\u7b2c'{0}'\u5217\u3002",n.NotSupportEventForPage="'{1}'\u4e0d\u652f\u6301\u4e8b\u4ef6'{0}'",n.NotSupportEventForCellOrListview="'{1}'\u6216\u8005'{2}'\u4e0d\u652f\u6301\u4e8b\u4ef6'{0}'",n.NotSupportSetValue="\u5355\u5143\u683c'{0}'\u4e0d\u652f\u6301\u6b64\u65b9\u6cd5\u3002",n.InvalidNumberParam="\u8bf7\u8bbe\u7f6e\u6b63\u786e\u7684\u503c\u7ed9\u53c2\u6570'{0}'",n.IndexOutOfRange="\u53c2\u6570'{0}'\u8d85\u51fa\u8303\u56f4\u3002",n.ForguncyApiExceptionString="{0} \u5728 {1}.{2} \u65b9\u6cd5 : {3}.",n.InvalidFunctionParam="\u53c2\u6570'{0}'\u5e94\u5f53\u662f\u4e00\u4e2a\u51fd\u6570\u3002",n.HideShowColumns_CannotHideRowHeader="\u4e0d\u80fd\u9690\u85cf\u6216\u663e\u793a\u884c\u5934\u3002",n.HideShowColumns_ListviewIsEditing="\u8868\u683c\u6b63\u5728\u7f16\u8f91\uff0c\u4e0d\u80fd\u9690\u85cf\u6216\u663e\u793a\u5217\u3002",n.HideShowColumns_CannotShowHiddenColumn="\u4e0d\u80fd\u663e\u793a\u9690\u85cf\u5217\uff08\u6ca1\u6709\u5f00\u542f\u5ffd\u7565\u9690\u85cf\uff09\u548c\u5728\u8bbe\u8ba1\u5668\u4e2d\u5bbd\u5ea6\u4e3a0\u7684\u5217\u3002",n.WebApi_ErrorInfo_NonemptyStringParam="\u53c2\u6570'{0}'\u5e94\u5f53\u662f\u4e00\u4e2a\u975e\u7a7a\u5b57\u7b26\u3002",n.WebApi_ErrorInfo_ParamInvalid="\u53c2\u6570'{0}'\u65e0\u6548",n.groupCell_Other="\u5176\u4ed6\uff1a",n.ClosePopupCommand_NotPopup="\u5f53\u524d\u9875\u9762\u4e0d\u662f\u5f39\u51fa\u5f0f\u9875\u9762\u3002",n.AddUserApiParamError="\u53c2\u6570\u7c7b\u578b\u4e0d\u6b63\u786e\uff01",n.Echart_DataLoadingText="\u6570\u636e\u52a0\u8f7d\u4e2d...",n.Echart_NoDataLoadingText="\u6ca1\u6709\u6570\u636e",n.Echart_BubbleChartToolTip="\u5927\u5c0f\uff1a {0}",n.InvalidCopyPasteSize="\u590d\u5236\u533a\u57df\u548c\u7c98\u8d34\u533a\u57df\u5927\u5c0f\u4e0d\u4e00\u6837\u3002",n.RangeOperationCannotInvolveTotalRow="\u5355\u5143\u683c\u533a\u57df\u64cd\u4f5c\u4e0d\u80fd\u5305\u542b\u6c47\u603b\u884c\u3002",n.ValidateErrorMessage="\u503c'{0}'\u5728\u884c: {1}, \u5217: {2}\u65e0\u6548.\r\n\u9519\u8bef\u4fe1\u606f:\r\n{3}",n.InvalidValueTypeMessage="\u65e0\u6548\u7684\u503c\u7c7b\u578b\u3002",n.ValueNotInList="\u6ca1\u6709\u5305\u542b\u5728\u9879\u76ee\u5217\u8868\u91cc\u3002",n.ErrorInfo_Uncommited="\u6709\u672a\u63d0\u4ea4\u7684\u6570\u636e\u3002",n.DataValidation_Required="\u4e0d\u80fd\u4e3a\u7a7a",n.DataValidation_WholeNumberDefaultErrorMessage="\u8f93\u5165\u7684\u6574\u6570\u503c\u975e\u6cd5",n.DataValidation_DecimalDefaultErrorMessage="\u8f93\u5165\u7684\u5c0f\u6570\u503c\u975e\u6cd5",n.DataValidation_DateDefaultErrorMessage="\u8f93\u5165\u7684\u65e5\u671f\u503c\u975e\u6cd5",n.DataValidation_TimeDefaultErrorMessage="\u8f93\u5165\u7684\u65f6\u95f4\u503c\u975e\u6cd5",n.DataValidation_TextLenghtDefaultErrorMessage="\u8f93\u5165\u503c\u7684\u957f\u5ea6\u975e\u6cd5",n.DataValidation_CustomDefaultErrorMessage="\u8f93\u5165\u7684\u503c\u975e\u6cd5",n.DataValidation_RegularUserInputDefaultErrorMessage="\u8f93\u5165\u7684\u503c\u975e\u6cd5",n.DataValidation_RegularDefaultErrorMessage="\u8f93\u5165\u7684\u503c\u65e0\u6cd5\u901a\u8fc7{0}\u7684\u9a8c\u8bc1",n.Validate_Number="\u8bf7\u8f93\u5165\u4e00\u4e2a\u6709\u6548\u6570\u5b57.",n.InvalidValueErrorMessage="\u4e0d\u80fd\u63d0\u4ea4\u65e0\u6548\u7684\u503c'{0}' \u5230\u8868'{2}'\u7684\u5217'{1}'\u3002",n.uploadFileBiggerThanMaxFileCount="\u4e0a\u4f20\u7684\u6587\u4ef6\u4e2a\u6570\u5df2\u7ecf\u8fbe\u5230\u6700\u5927\uff0c\u4e0d\u80fd\u4e0a\u4f20\u66f4\u591a\u7684\u6587\u4ef6\u3002",n.uploadFileBiggerThanMaxSize="\u4e0a\u4f20\u7684\u6587\u4ef6 {0} \u7684\u5927\u5c0f\u8d85\u51fa\u4e86\u9650\u5236, \u6700\u5927\u4e0a\u4f20\u6587\u4ef6\u7684\u5927\u5c0f\u4e3a {1} MB.",n.uploadFileNotMatchExtension="\u4e0a\u4f20\u7684\u6587\u4ef6 {0} \u7684\u7c7b\u578b\u4e0d\u6b63\u786e.",n.ExprotToExcelCalFormulaError="\u5bfc\u51faExcel\u6587\u4ef6\u7684\u6587\u4ef6\u540d\uff0c\u88ab\u60a8\u8bbe\u7f6e\u6210\u4e86\u4e00\u4e2a\u9519\u8bef\u7684\u503c\u3002",n.ExprotToPDFCalFormulaError="\u5bfc\u51faPDF\u6587\u4ef6\u7684\u6587\u4ef6\u540d\uff0c\u88ab\u60a8\u8bbe\u7f6e\u6210\u4e86\u4e00\u4e2a\u9519\u8bef\u7684\u503c\u3002",n.ExportListviewNoColumnError="\u8868\u683c\u4e2d\u6ca1\u6709\u8981\u5bfc\u51fa\u7684\u5217\u3002",n.AutoGeneratedID_Conflict_Error="\u81ea\u589e\u7f16\u53f7\u5df2\u5b58\u5728\u3002\u8bf7\u91cd\u65b0\u63d0\u4ea4\u6570\u636e\u3002",n.AutoGeneratedID_Generate_Error="\u81ea\u589e\u7f16\u53f7\u7684\u987a\u5e8f\u53f7\u957f\u5ea6\u8d85\u8fc7\u8bbe\u7f6e\u957f\u5ea6\u3002",n.AutoGeneratedID_Conflict_Listview_Error="\u5b57\u6bb5'{0}'\u7684\u6570\u636e\u5df2\u5b58\u5728\u3002",n.NoMatchBetweenExcelWithListViewError="\u8981\u5bfc\u5165\u7684Excel\u548c\u9875\u9762\u4e0a\u7684\u8868\u683c\u4e0d\u5339\u914d\uff01",n.InCorrectFileFormatError="\u6587\u4ef6\u683c\u5f0f\u4e0d\u6b63\u786e.",n.NoSelectedRowError="\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u884c",n.GUID_Creator="\u521b\u5efa\u8005",n.GUID_CreateDate="\u521b\u5efa\u65e5\u671f",n.GUID_LastModifyBy="\u6700\u540e\u66f4\u65b0\u8005",n.GUID_LastModifyDate="\u6700\u540e\u66f4\u65b0\u65e5\u671f",n.GUID_AssignTo="\u62c5\u5f53\u8005",n.GUID_Status="\u72b6\u6001",n.UpdateListviewCommand_Listview_Group="\u4e0d\u80fd\u63d0\u4ea4\u5305\u542b\u7edf\u8ba1\u5217\u7684\u8868\u683c\u3002",n.UpdateListviewCommand_Listview_DetailListview="\u4e0d\u80fd\u63d0\u4ea4\u6ca1\u6709\u4e3b\u8868\u5f53\u524d\u884c\u4fe1\u606f\u7684\u4ece\u8868\u3002",n.ImportExcelFirstRowMissDataError="Excel\u6587\u4ef6\u4e2d\u7684\u7b2c\u4e00\u884c\u6570\u636e\u4e0d\u80fd\u4e3a\u7a7a\u3002",n.ImportExcelToListViewError_Detail="Excel\u6587\u4ef6\u4e2d\u7b2c'{0}'\u884c\uff0c\u5217\u540d\u4e3a'{1}'\u7684\u503c\u4e0d\u5408\u6cd5\u3002\u9519\u8bef\u4fe1\u606f\uff1a{2}",n.ImportExcelToListViewError_ExistSameKeys="Excel\u6587\u4ef6\u4e2d\u57fa\u51c6\u5217\u5b58\u5728\u76f8\u540c\u6570\u636e\uff0c\u8bf7\u786e\u4fdd\u57fa\u51c6\u5217\u7684\u6570\u636e\u552f\u4e00\u3002",n.UpdateViewFail_Error="\u66f4\u65b0\u5931\u8d25\u3002 \r\n\u5f53\u524d\u89c6\u56fe\u4e0d\u80fd\u66f4\u65b0\u3002",n.UpdateListViewFail_BindingTableCantEditError="\u66f4\u65b0\u5931\u8d25\u3002 \r\n\u5f53\u524d\u7ed1\u5b9a\u7684\u6570\u636e\u6e90\u4e0d\u80fd\u66f4\u65b0\u3002",n.ConcurrentLicenseError_Kickoffed="\u60a8\u5df2\u7ecf\u88ab\u7ba1\u7406\u5458\u5f3a\u5236\u767b\u51fa\u3002",n.ConcurrentLicenseError_NoEnoughLicense="\u8bbf\u95ee\u88ab\u62d2\u7edd\u3002\u5e76\u53d1\u7528\u6237\u8bbf\u95ee\u6570\u91cf\u8fbe\u5230\u6700\u5927\u503c\uff0c\u5982\u6709\u7591\u95ee\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u3002",n.ConcurrentLicenseError_SendEmail="\u53d1\u9001\u90ae\u4ef6",n.ConcurrentLicenseError_Cancel="\u4e0d\u53d1\u9001",n.ConcurrentLicenseError_MessagePlaceHolder="\u90ae\u4ef6\u5185\u5bb9",n.ConcurrentLicenseError_AddressPlaceHolder="\u8bf7\u586b\u5199\u53d1\u4ef6\u4eba\u5730\u5740",n.ConcurrentLicenseError_SendSuccess="\u53d1\u9001\u6210\u529f",n.ConcurrentLicenseError_SendFailed="\u53d1\u9001\u5931\u8d25",n.ConcurrentLicenseError_EmailTitle="\u8bbf\u95ee\u88ab\u62d2\u7edd",n.ConcurrentLicenseError_PleaseInputValidEmailAddress="\u8bf7\u586b\u5199\u5408\u6cd5\u7684\u90ae\u7bb1",n.ConcurrentLicenseError_SenderAddress="\u53d1\u4ef6\u4eba",n.ContainerCellType_Error_CircularReference="\u5b50\u9875\u9762'{0}'\u52a0\u8f7d\u5931\u8d25\uff0c\u5b58\u5728\u5faa\u73af\u5f15\u7528\u3002",n.NameConflict="\u540d\u79f0'{0}'\u51fa\u73b0\u51b2\u7a81\uff0c\u5206\u522b\u4f4d\u4e8e\u9875\u9762'{1}'\u548c\u9875\u9762'{2}'",n.ContainerCellType_Error_NoExistedPage="\u9875\u9762'{0}'\u4e0d\u5b58\u5728\u3002",n.SetCurrentRow_Error_NoRecord="\u8bbe\u7f6e\u8868'{0}'\u7684\u5f53\u524d\u884c\u5931\u8d25\uff0c\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684\u8bb0\u5f55\u3002",n.ListViewAddNewRowError_CantConvertToNumber="\u4e0d\u80fd\u8f6c\u6362\u6210\u6570\u5b57\u7c7b\u578b\u3002",n.ListViewAddNewRowError_CantConvertToBool="\u4e0d\u80fd\u8f6c\u6362\u6210\u662f\u5426\u7c7b\u578b\u3002",n.ListViewAddNewRowError_CantConvertToDateTime="\u4e0d\u80fd\u8f6c\u6362\u6210\u65e5\u671f\u6216\u65f6\u95f4\u7c7b\u578b\u3002",n.CallStoredProcedureCommand_ExecuteFailed="\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u5931\u8d25.",n.Command_postFail_ErrorMessage="\u547d\u4ee4\u6267\u884c\u5931\u8d25\u3002",n.Commit_FailMessage="\u63d0\u4ea4\u5931\u8d25\u3002",n.Commit_ExecutingMessage="\u60a8\u5df2\u7ecf\u70b9\u8fc7\u4e00\u6b21\u4e86\uff0c\u4f11\u606f\u4e00\u4e0b....",n.LongTimeNoOperation="\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u6ca1\u6709\u64cd\u4f5c\u9875\u9762\uff0c\u8fde\u63a5\u5df2\u7ecf\u65ad\u5f00\uff0c\u5982\u9700\u7ee7\u7eed\u4f7f\u7528\u8bf7\u5237\u65b0\u9875\u9762\u3002",n.PleaseClickButtonToReload="\u70b9\u51fb\u6309\u94ae\u91cd\u65b0\u52a0\u8f7d\u672c\u9875\u9762",n.ReloadPage="\u91cd\u65b0\u52a0\u8f7d\u9875\u9762",n.DateTime_Calender_HeaderFormat="yyy\u5e74M\u6708",n.DateTime_Calender_YearMonthFormat="yyyy\u5e74,M\u6708",n.UnauthorizedUpload="\u4e0d\u5141\u8bb8\u533f\u540d\u64cd\u4f5c\u3002\u4f60\u9700\u8981\u767b\u5f55\u3002",n}();n._CNStringResource=i;r=function(){function n(){}return n.Culture="JA",n.UserNameOrPasswordIsIncorrect="\u30e6\u30fc\u30b6\u30fc\u540d\u3001\u307e\u305f\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002",n.PasswordIsNotSame="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u3066\u3044\u307e\u305b\u3093\u3002",n.ForSafetyReasonPleaseChangeYourPassword="\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3057\u305f\u3002 \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u306e\u305f\u3081\u3001\u521d\u671f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002",n.TokenIsInvalid="\u30c8\u30fc\u30af\u30f3\u304c\u4e0d\u6b63\u3067\u3059\u3002",n.ResetPasswordSuccess="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u30ea\u30bb\u30c3\u30c8\u3055\u308c\u307e\u3057\u305f\u3002",n.Failed="\u5931\u6557",n.UserName="\u30e6\u30fc\u30b6\u30fc\u540d",n.None="\uff1c\u306a\u3057\uff1e",n.deleteStr="\u524a\u9664",n.addStr="\u6dfb\u4ed8",n.listviewNotExisted="\u30ea\u30b9\u30c8\u30d3\u30e5\u30fc\u306f\u5b58\u5728\u3057\u307e\u305b\u3093\u3002",n.FullName="\u6c0f\u540d",n.Email="\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9",n.Role="\u30ed\u30fc\u30eb",n.OrganizationSuperior="\u4e0a\u4f4d\u7d44\u7e54\u306e\u30e1\u30f3\u30d0\u30fc",n.Success="\u6210\u529f\u3057\u307e\u3057\u305f\u3002",n.ConfirmDelete="\u672c\u5f53\u306b\u524a\u9664\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",n.Year="\u5e74",n.Month="\u6708",n.Day="\u65e5",n.Quarter="\u56db\u534a\u671f",n.noFieldErrorInfo="\u300c{0}\u300d\u30c6\u30fc\u30d6\u30eb\u3092\u66f4\u65b0\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u30c7\u30fc\u30bf\u9023\u7d50\u8a2d\u5b9a\u304c\u3042\u308a\u307e\u305b\u3093\u3002",n.unique="\u305d\u306e\u5024\u306f\u65e2\u306b\u5b58\u5728\u3057\u307e\u3059\u3002\u7570\u306a\u308b\u5024\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",n.login="\u30ed\u30b0\u30a4\u30f3",n.cantAddEmptyFile="\u7a7a\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002",n.Boolean_True="\u306f\u3044",n.Boolean_False="\u3044\u3044\u3048",n.MonthNames=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],n.ColumnFilter_YearName="\u5e74",n.ColumnFilter_DayName="\u65e5",n.ContextMenu_CompareType_Equals="\u6307\u5b9a\u306e\u5024\u306b\u7b49\u3057\u3044",n.ContextMenu_CompareType_DoesNotEqual="\u6307\u5b9a\u306e\u5024\u306b\u7b49\u3057\u304f\u306a\u3044",n.ContextMenu_CompareType_BeginsWith="\u6307\u5b9a\u5024\u304b\u3089\u59cb\u307e\u308b",n.ContextMenu_CompareType_DoesNotBeginWith="\u6307\u5b9a\u5024\u304b\u3089\u59cb\u307e\u3089\u306a\u3044",n.ContextMenu_CompareType_EndsWith="\u6307\u5b9a\u5024\u3067\u7d42\u308f\u308b",n.ContextMenu_CompareType_DoesNotEndWidth="\u6307\u5b9a\u5024\u3067\u7d42\u308f\u3089\u306a\u3044",n.ContextMenu_CompareType_Contains="\u6307\u5b9a\u5024\u3092\u542b\u3080",n.ContextMenu_CompareType_DoesNotContain="\u6307\u5b9a\u5024\u3092\u542b\u307e\u306a\u3044",n.ContextMenu_CompareType_IsGreaterThan="\u6307\u5b9a\u306e\u5024\u3088\u308a\u5927\u304d\u3044",n.ContextMenu_CompareType_IsGreaterThanOrEqualTo="\u6307\u5b9a\u306e\u5024\u4ee5\u4e0a",n.ContextMenu_CompareType_IsLessThan="\u6307\u5b9a\u306e\u5024\u3088\u308a\u5c0f\u3055\u3044",n.ContextMenu_CompareType_IsLessThanOrEqualTo="\u6307\u5b9a\u306e\u5024\u4ee5\u4e0b",n.ContextMenu_CompareType_IsBetween="\u6307\u5b9a\u306e\u7bc4\u56f2\u5185",n.ContextMenu_CompareType_IsNotBetween="\u6307\u5b9a\u5024\u306e\u9593\u4ee5\u5916",n.ContextMenu_CompareType_In="\u6307\u5b9a\u3057\u305f\u30ea\u30b9\u30c8\u306b\u542b\u307e\u308c\u308b",n.ContextMenu_CompareType_NotIn="\u6307\u5b9a\u3057\u305f\u30ea\u30b9\u30c8\u306b\u542b\u307e\u308c\u306a\u3044",n.ContextMenu_CompareType_IsLessThan_Date="\u6307\u5b9a\u306e\u5024\u3088\u308a\u524d",n.ContextMenu_CompareType_IsGreaterThan_Date="\u6307\u5b9a\u306e\u5024\u3088\u308a\u5f8c",n.ComboBox_CompareType_Equals="\u3068\u7b49\u3057\u3044",n.ComboBox_CompareType_DoesNotEqual="\u3068\u7b49\u3057\u304f\u306a\u3044",n.ComboBox_CompareType_BeginsWith="\u3067\u59cb\u307e\u308b",n.ComboBox_CompareType_DoesNotBeginWith="\u3067\u59cb\u307e\u3089\u306a\u3044",n.ComboBox_CompareType_EndsWith="\u3067\u7d42\u308f\u308b",n.ComboBox_CompareType_DoesNotEndWidth="\u3067\u7d42\u308f\u3089\u306a\u3044",n.ComboBox_CompareType_Contains="\u3092\u542b\u3080",n.ComboBox_CompareType_DoesNotContain="\u3092\u542b\u307e\u306a\u3044",n.ComboBox_CompareType_IsGreaterThan="\u3088\u308a\u5927\u304d\u3044",n.ComboBox_CompareType_IsGreaterThanOrEqualTo="\u4ee5\u4e0a",n.ComboBox_CompareType_IsLessThan="\u3088\u308a\u5c0f\u3055\u3044",n.ComboBox_CompareType_IsLessThanOrEqualTo="\u4ee5\u4e0b",n.ComboBox_CompareType_IsBetween="\u306e\u9593",n.ComboBox_CompareType_IsNotBetween="\u306e\u9593\u4ee5\u5916",n.ComboBox_CompareType_In="\u306e\u30ea\u30b9\u30c8\u306b\u542b\u307e\u308c\u308b",n.ComboBox_CompareType_NotIn="\u306e\u30ea\u30b9\u30c8\u306b\u542b\u307e\u308c\u306a\u3044",n.ComboBox_CompareType_IsLessThan_Date="\u3088\u308a\u524d",n.ComboBox_CompareType_IsGreaterThan_Date="\u3088\u308a\u5f8c",n.DateCompareType_Tomorrow="\u660e\u65e5",n.DateCompareType_Today="\u4eca\u65e5",n.DateCompareType_Yesterday="\u6628\u65e5",n.DateCompareType_NextWeek="\u6765\u9031",n.DateCompareType_ThisWeek="\u4eca\u9031",n.DateCompareType_LastWeek="\u5148\u9031",n.DateCompareType_NextMonth="\u6765\u6708",n.DateCompareType_ThisMonth="\u4eca\u6708",n.DateCompareType_LastMonth="\u5148\u6708",n.DateCompareType_NextYear="\u6765\u5e74",n.DateCompareType_ThisYear="\u4eca\u5e74",n.DateCompareType_LastYear="\u6628\u5e74",n.ForguncyUI_Dialog_OK="OK",n.ForguncyUI_Dialog_Cancel="\u30ad\u30e3\u30f3\u30bb\u30eb",n.ColumnFilter_Dialog_Title="\u30d5\u30a3\u30eb\u30bf\u30fc",n.ColumnFilter_ContextMenu_SortAscending="\u6607\u9806\u3067\u4e26\u3079\u66ff\u3048",n.ColumnFilter_ContextMenu_SortDesending="\u964d\u9806\u3067\u4e26\u3079\u66ff\u3048",n.ColumnFilter_ContextMenu_ClearFilter="\u30d5\u30a3\u30eb\u30bf\u30fc\u3092\u30af\u30ea\u30a2",n.ColumnFilter_ContextMenu_Filter="\u30d5\u30a3\u30eb\u30bf\u30fc",n.ColumnFilter_ContextMenu_CustomFilter="\u30e6\u30fc\u30b6\u30fc\u8a2d\u5b9a\u30d5\u30a3\u30eb\u30bf\u30fc",n.ColumnFilter_ContextMenu_NumberFilter="\u6570\u5024\u30d5\u30a3\u30eb\u30bf\u30fc",n.ColumnFilter_ContextMenu_TextFilter="\u30c6\u30ad\u30b9\u30c8 \u30d5\u30a3\u30eb\u30bf\u30fc",n.ColumnFilter_ContextMenu_DateFilter="\u65e5\u4ed8\u30d5\u30a3\u30eb\u30bf\u30fc",n.ColumnFilter_TreeView_SelectAll="\uff08\u3059\u3079\u3066\u9078\u629e\uff09",n.ColumnFilter_TreeView_Blanks="\uff08\u7a7a\u767d\uff09",n.ColumnFilter_TreeView_TooManyItems="\u4e00\u90e8\u306e\u30a2\u30a4\u30c6\u30e0\u306f\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u305b\u3093",n.ColumnFilter_TextBlock_And="\u3068",n.ColumnFilter_TextBlock_Where="\u62bd\u51fa\u6761\u4ef6\u306e\u6307\u5b9a\uff1a",n.ColumnFilter_Alert_IncorrectValue="\u9069\u5207\u306a\u5024\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",n.ColumnFilter_TextBlock_TextExample_In="\uff08\u4f8b\uff09 \u308a\u3093\u3054,\u30d0\u30ca\u30ca,\u30aa\u30ec\u30f3\u30b8 \uff08\u534a\u89d2\u306e\u30ab\u30f3\u30de\u3067\u533a\u5207\u308b\uff09",n.ColumnFilter_TextBlock_DateExample="\uff08\u4f8b\uff09 2020/01/01",n.ColumnFilter_TextBlock_DateExample_Between="\uff08\u4f8b\uff09 2020/01/01 \u3068 2019/12/31",n.ColumnFilter_TextBlock_TimeExample="\uff08\u4f8b\uff09 10:00",n.ColumnFilter_TextBlock_TimeExample_Between="\uff08\u4f8b\uff09 10:00 \u3068 12:00",n.ColumnOptionsCommand_Title="\u8868\u793a\u5217\u306e\u30ab\u30b9\u30bf\u30de\u30a4\u30ba",n.ColumnOptionsCommand_AvailableColumns="\u8ffd\u52a0\u53ef\u80fd\u306a\u5217",n.ColumnOptionsCommand_SelectedColumns="\u8868\u793a\u5217",n.ColumnOptionsCommand_UnamedColumn="\uff1c\u5217\u540d\u306a\u3057\uff1e",n.ColumnOptionsCommand_ResetSetting="\u521d\u671f\u72b6\u614b\u306b\u623b\u3059",n.ColumnOptionsCommand_ConfirmResetSetting="\u672c\u5f53\u306b\u521d\u671f\u72b6\u614b\u306b\u623b\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\r\n\u3053\u306e\u64cd\u4f5c\u3092\u884c\u3063\u305f\u5834\u5408\u3001Web\u30d6\u30e9\u30a6\u30b6\u30fc\u304c\u672c\u30da\u30fc\u30b8\u3092\u81ea\u52d5\u7684\u306b\u518d\u8aad\u307f\u8fbc\u307f\u3057\u307e\u3059\u3002",n.ColumnOptionsCommand_AddColumn="\u5217\u306e\u8ffd\u52a0",n.ColumnOptionsCommand_RemoveColumn="\u5217\u306e\u524a\u9664",n.ColumnOptionsCommand_MoveColumnUp="1\u3064\u4e0a\u3078\u79fb\u52d5",n.ColumnOptionsCommand_MoveColumnDown="1\u3064\u4e0b\u3078\u79fb\u52d5",n.AttachmentCell_NotSupportedFile="\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u306a\u3044\u30d5\u30a1\u30a4\u30eb",n.CurrentUserCell_ChangeProfile="\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6",n.CurrentUserCell_ChangePassword="\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5909\u66f4",n.CurrentUserCell_Logout="\u30ed\u30b0\u30a2\u30a6\u30c8",n.ProcessBarCell_AssignedToPopup_Title="\u73fe\u5728\u306e\u62c5\u5f53\u8005",n.ProcessBarCell_AssignedTo="\u62c5\u5f53\u8005",n.ProcessBarCell_AssignedTo_me="\u3042\u306a\u305f",n.ProcessBarCell_AssignedToMultiUser="{0}\u3068\u4ed6{1}\u4eba",n.ProcessBarCell_HistoryPopup_Title="\u72b6\u614b\u306e\u5c65\u6b74",n.ProcessBarCell_History_Operator="\u5b9f\u884c\u8005",n.ProcessBarCell_History_Time="\u65e5\u6642",n.ProcessBarCell_History_EndStatus="\u5b9f\u884c\u5f8c\u306e\u72b6\u614b",n.ProcessBarCell_History_Comments="\u30b3\u30e1\u30f3\u30c8",n.ProcessBarCell_History_ActionName="\u30a2\u30af\u30b7\u30e7\u30f3\u540d",n.ProcessBarCell_ActionPopup_Title="\u72b6\u614b\u306e\u66f4\u65b0",n.ProcessBarCell_ActionPopup_NextStatus="\u6b21\u306e\u72b6\u614b\uff1a",n.ProcessBarCell_ActionPopup_Assignto_Choose="\u6b21\u306e\u62c5\u5f53\u8005\uff1a",n.ProcessBarCell_ActionPopup_Assignto_All="\u6b21\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u53ef\u80fd\u306a\u30e6\u30fc\u30b6\u30fc\uff1a",n.ProcessBarCell_ActionPopup_Comments="\u30b3\u30e1\u30f3\u30c8\uff1a",n.ProcessBarCell_OK="OK",n.ProcessBarCell_Cancel="\u30ad\u30e3\u30f3\u30bb\u30eb",n.ProcessBarCell_Status="\u72b6\u614b\uff1a{0}",n.ProcessBarCell_ChangeStateFailed="\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u5b9f\u884c\u306b\u5931\u6557",n.ProcessBarCell_ChangeAssignee="\u62c5\u5f53\u8005\u306e\u5909\u66f4",n.ProcessBarCell_CreateBy="\u4f5c\u6210\u8005\uff1a{0}\u3000\u4f5c\u6210\u65e5\u6642\uff1a{1}",n.ProcessBarCell_LastModifyBy="\u6700\u7d42\u66f4\u65b0\u8005\uff1a{0}\u3000\u6700\u7d42\u66f4\u65b0\u65e5\u6642\uff1a{1}",n.CannotFindCell="\u3053\u306e\u30da\u30fc\u30b8\u306b '{0}' \u3068\u3044\u3046\u540d\u524d\u306e\u30bb\u30eb\u306f\u5b58\u5728\u3057\u307e\u305b\u3093\u3002",n.CannotFindCellById="'{0}' \u3068\u7b49\u3057\u3044\u30bb\u30eb\u304c\u3053\u306e\u30da\u30fc\u30b8\u306b\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002",n.CannotFindListview="\u3053\u306e\u30da\u30fc\u30b8\u306b '{0}' \u3068\u3044\u3046\u540d\u524d\u306e\u30ea\u30b9\u30c8\u30d3\u30e5\u30fc\u306f\u5b58\u5728\u3057\u307e\u305b\u3093\u3002",n.CannotFindColumn="\u30ea\u30b9\u30c8\u30d3\u30e5\u30fc '{1}' \u306b '{0}' \u3068\u3044\u3046\u540d\u524d\u306e\u5217\u306f\u5b58\u5728\u3057\u307e\u305b\u3093\u3002",n.CannotFindColumnIndex="\u30ea\u30b9\u30c8\u30d3\u30e5\u30fc '{1}' \u306e\u5217\u30a4\u30f3\u30c7\u30c3\u30af\u30b9 '{0}' \u304c\u4e0d\u6b63\u3067\u3059\u3002",n.NotSupportEventForPage="{1}\u306e\u30a4\u30d9\u30f3\u30c8 '{0}' \u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",n.NotSupportEventForCellOrListview="{1} '{2}' \u306e\u30a4\u30d9\u30f3\u30c8 '{0}' \u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",n.NotSupportSetValue="\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u30bb\u30eb '{0}' \u3067\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",n.InvalidNumberParam="\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc '{0}' \u306b\u6b63\u3057\u3044\u6570\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002",n.IndexOutOfRange="\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc '{0}' \u306b\u7bc4\u56f2\u5916\u306e\u5024\u304c\u6307\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002",n.ForguncyApiExceptionString="{0} \u304c {1}.{2} \u30e1\u30bd\u30c3\u30c9\u5185\u3067\u767a\u751f\uff1a{3}",n.InvalidFunctionParam="\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc '{0}' \u306f\u95a2\u6570\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002",n.HideShowColumns_CannotHideRowHeader="\u884c\u30d8\u30c3\u30c0\u30fc\u5217\u306e\u8868\u793a\u3001\u975e\u8868\u793a\u3092\u884c\u3046\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002",n.HideShowColumns_ListviewIsEditing="\u7de8\u96c6\u4e2d\u306e\u30ea\u30b9\u30c8\u30d3\u30e5\u30fc\u306b\u5bfe\u3057\u3066\u3001\u5217\u306e\u8868\u793a\u3001\u975e\u8868\u793a\u3092\u884c\u3046\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002",n.HideShowColumns_CannotShowHiddenColumn="\u975e\u8868\u793a\u306e\u5217\uff08\uff3b\u975e\u8868\u793a\u3092\u7121\u8996\u3059\u308b\uff3d\u8a2d\u5b9a\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u306a\u3044) \u3068\u3001\u8a2d\u8a08\u6642\u306e\u5217\u5e45\u304c0\u3067\u3042\u308b\u5217\u3092\u8868\u793a\u3055\u305b\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002",n.WebApi_ErrorInfo_NonemptyStringParam="\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc '{0}' \u3092\u7a7a\u306b\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002",n.WebApi_ErrorInfo_ParamInvalid="\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc '{0}' \u304c\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002",n.groupCell_Other="\u305d\u306e\u4ed6\uff1a",n.ClosePopupCommand_NotPopup="\u3053\u306e\u30da\u30fc\u30b8\u306f\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u30a6\u30a3\u30f3\u30c9\u30a6\u3068\u3057\u3066\u8868\u793a\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\uff3b\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u7d42\u4e86\uff3d\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002",n.Echart_DataLoadingText="\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\u4e2d...",n.Echart_NoDataLoadingText="\u30c7\u30fc\u30bf\u306a\u3057",n.InvalidCopyPasteSize="\u30b3\u30d4\u30fc\u3068\u8cbc\u308a\u4ed8\u3051\u306e\u7bc4\u56f2\u30b5\u30a4\u30ba\u304c\u7570\u306a\u3063\u3066\u3044\u307e\u3059\u3002",n.RangeOperationCannotInvolveTotalRow="\u30bb\u30eb\u306e\u64cd\u4f5c\u7bc4\u56f2\u3068\u3057\u3066\u96c6\u8a08\u884c\u306e\u9818\u57df\u3092\u542b\u3081\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002",n.ValidateErrorMessage="\u884c\uff1a{1}\u3001\u5217\uff1a{2}\u306e\u5024\u300c{0}\u300d\u306f\u6709\u52b9\u306a\u5024\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\r\n\u30a8\u30e9\u30fc\u5185\u5bb9\uff1a\r\n{3}",n.InvalidValueTypeMessage="\u5024\u306e\u578b\u304c\u4e0d\u6b63\u3067\u3059\u3002",n.ValueNotInList="\u305d\u306e\u5024\u306f\u9805\u76ee\u30ea\u30b9\u30c8\u306b\u542b\u307e\u308c\u3066\u3044\u307e\u305b\u3093\u3002",n.ErrorInfo_Uncommited="\u672a\u78ba\u5b9a\u306e\u30c7\u30fc\u30bf\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u30af\u30a8\u30ea\u30fc\uff0f\u4e26\u3079\u66ff\u3048\u51e6\u7406\u3092\u884c\u3046\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002",n.DataValidation_Required="\u5fc5\u9808\u5165\u529b\u9805\u76ee\u3067\u3059\u3002",n.DataValidation_WholeNumberDefaultErrorMessage="\u5165\u529b\u3057\u305f\u5024\u306f\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002",n.DataValidation_DecimalDefaultErrorMessage="\u5165\u529b\u3057\u305f\u5024\u306f\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002",n.DataValidation_DateDefaultErrorMessage="\u5165\u529b\u3057\u305f\u5024\u306f\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002",n.DataValidation_TimeDefaultErrorMessage="\u5165\u529b\u3057\u305f\u5024\u306f\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002",n.DataValidation_TextLenghtDefaultErrorMessage="\u5165\u529b\u3057\u305f\u6587\u5b57\u5217\u306e\u9577\u3055\u306f\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002",n.DataValidation_CustomDefaultErrorMessage="\u5165\u529b\u3057\u305f\u5024\u306f\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002",n.DataValidation_RegularUserInputDefaultErrorMessage="\u5165\u529b\u3057\u305f\u5024\u306f\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002",n.DataValidation_RegularDefaultErrorMessage="\u5165\u529b\u3057\u305f\u5024\u306f\u300c{0}\u300d\u306e\u5024\u3068\u3057\u3066\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002",n.Validate_Number="\u6709\u52b9\u306a\u6570\u5024\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",n.InvalidValueErrorMessage="\u300c{2}\u300d\u30c6\u30fc\u30d6\u30eb\u306e\u300c{1}\u300d\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u4e0d\u6b63\u306a\u5024\u300c{0}\u300d\u3092\u767b\u9332\u3001\u307e\u305f\u306f\u66f4\u65b0\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002",n.uploadFileBiggerThanMaxFileCount="\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u6570\u304c\u4e0a\u9650\u306b\u9054\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u4ee5\u4e0a\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002",n.uploadFileBiggerThanMaxSize="\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u300c{0}\u300d\u306e\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3059\u304e\u307e\u3059\u3002\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u53ef\u80fd\u306a\u30d5\u30a1\u30a4\u30eb\u306e\u6700\u5927\u30b5\u30a4\u30ba\u306f {1} MB\u3067\u3059\u3002",n.uploadFileNotMatchExtension="\u62e1\u5f35\u5b50\u304c\u300c{0}\u300d\u3067\u3042\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u306f\u8a31\u53ef\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",n.ExprotToExcelCalFormulaError="\u6570\u5f0f\u306e\u5b9f\u884c\u7d50\u679c\u304c#N/A\u30a8\u30e9\u30fc\u3067\u3042\u308b\u305f\u3081\u3001Excel\u30d5\u30a1\u30a4\u30eb\u3092\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002",n.ExprotToPDFCalFormulaError="\u6570\u5f0f\u306e\u5b9f\u884c\u7d50\u679c\u304c#N/A\u30a8\u30e9\u30fc\u3067\u3042\u308b\u305f\u3081\u3001PDF\u30d5\u30a1\u30a4\u30eb\u3092\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002",n.ExportListviewNoColumnError="\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u306e\u5bfe\u8c61\u3068\u306a\u308b\u5217\u304c\u3042\u308a\u307e\u305b\u3093\u3002",n.AutoGeneratedID_Conflict_Error="\u81ea\u52d5\u63a1\u756a\u306b\u3088\u308a\u751f\u6210\u3055\u308c\u305fID\u306f\u65e2\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u5bfe\u8c61\u306e\u30bb\u30eb\u306b\u306f\u65b0\u3057\u3044ID\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u518d\u5ea6\u30c7\u30fc\u30bf\u306e\u767b\u9332\u51e6\u7406\u3092\u884c\u3063\u3066\u304f\u3060\u3055\u3044\u3002",n.AutoGeneratedID_Generate_Error="\u81ea\u52d5\u63a1\u756a\u3067\u8a2d\u5b9a\u3057\u305f\u6570\u5024\u306e\u6841\u6570\u3092\u8d85\u3048\u308b\u5024\u304c\u63a1\u756a\u3055\u308c\u3088\u3046\u3068\u3057\u307e\u3057\u305f\u3002\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u8ffd\u52a0\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u81ea\u52d5\u63a1\u756a\u306e\u6570\u5024\u306e\u6841\u6570\u3092\u5897\u3084\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002",n.AutoGeneratedID_Conflict_Listview_Error="\u30d5\u30a3\u30fc\u30eb\u30c9\u300c{0}\u300d\u306e\u5024\u306f\u65e2\u306b\u5b58\u5728\u3057\u307e\u3059\u3002",n.ImportExcelFirstRowMissDataError="\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u3088\u3046\u3068\u3057\u305fExcel\u30d5\u30a1\u30a4\u30eb\u306e\u6700\u521d\u306e\u884c\u306b\u30c7\u30fc\u30bf\u304c\u5b58\u5728\u3057\u307e\u305b\u3093\u3002",n.NoMatchBetweenExcelWithListViewError="\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u3088\u3046\u3068\u3057\u305fExcel\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u306e\u30da\u30fc\u30b8\u306e\u30ea\u30b9\u30c8\u30d3\u30e5\u30fc\u306e\u5217\u5b9a\u7fa9\u3068\u5408\u81f4\u3057\u306a\u3044\u305f\u3081\u3001\u30a4\u30f3\u30dd\u30fc\u30c8\u3067\u304d\u307e\u305b\u3093\u3002",n.InCorrectFileFormatError="\u4e0d\u6b63\u306a\u30d5\u30a1\u30a4\u30eb\u5f62\u5f0f\u3067\u3059\u3002",n.NoSelectedRowError="\u5c11\u306a\u304f\u3068\u30821\u3064\u4ee5\u4e0a\u306e\u884c\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002",n.GUID_Creator="\u4f5c\u6210\u8005",n.GUID_CreateDate="\u4f5c\u6210\u65e5\u6642",n.GUID_LastModifyBy="\u6700\u7d42\u66f4\u65b0\u8005",n.GUID_LastModifyDate="\u6700\u7d42\u66f4\u65b0\u65e5\u6642",n.GUID_AssignTo="\u62c5\u5f53\u8005",n.GUID_Status="\u72b6\u614b",n.UpdateListviewCommand_Listview_Group="\u96c6\u8a08\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u542b\u3080\u30ea\u30b9\u30c8\u30d3\u30e5\u30fc\u3092\u66f4\u65b0\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002",n.UpdateListviewCommand_Listview_DetailListview="\u30de\u30b9\u30bf\u30fc\u30c6\u30fc\u30d6\u30eb\u306b\u5408\u81f4\u3059\u308b\u30ec\u30b3\u30fc\u30c9\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u3001\u8a73\u7d30\u30ea\u30b9\u30c8\u30d3\u30e5\u30fc\u3092\u66f4\u65b0\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002",n.ImportExcelToListViewError_Detail="Excel\u30b7\u30fc\u30c8\u306e {0} \u884c\u76ee\u3001\u5217\u300c{1}\u300d\u306b\u3042\u308b\u5024\u304c\u4e0d\u6b63\u3067\u3059\u3002\r\n\u30a8\u30e9\u30fc\u5185\u5bb9\uff1a{2}",n.ImportExcelToListViewError_ExistSameKeys="\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u3088\u3046\u3068\u3057\u305fExcel\u30d5\u30a1\u30a4\u30eb\u306b\u304a\u3044\u3066\u3001\uff3b\u4e00\u610f\u3068\u306a\u308b\u5217\uff3d\u306b\u91cd\u8907\u3057\u305f\u5024\u304c\u5b58\u5728\u3057\u307e\u3059\u3002Excel\u30d5\u30a1\u30a4\u30eb\u306e\uff3b\u4e00\u610f\u3068\u306a\u308b\u5217\uff3d\u306e\u5024\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002",n.UpdateViewFail_Error="\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 \r\n \u73fe\u5728\u306e\u30d3\u30e5\u30fc\u3092\u66f4\u65b0\u3067\u304d\u307e\u305b\u3093\u3002",n.UpdateListViewFail_BindingTableCantEditError="\u66f4\u65b0\u51e6\u7406\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u73fe\u5728\u30c7\u30fc\u30bf\u9023\u7d50\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u306f\u66f4\u65b0\u3067\u304d\u307e\u305b\u3093\u3002",n.AddUserApiParamError="\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u578b\u304c\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002",n.ConcurrentLicenseError_Kickoffed="\u7ba1\u7406\u8005\u306b\u3088\u308a\u5f37\u5236\u5207\u65ad\u3055\u308c\u307e\u3057\u305f\u3002",n.ConcurrentLicenseError_NoEnoughLicense="\u540c\u6642\u63a5\u7d9a\u6570\u304c\u6700\u5927\u6570\u306b\u9054\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u30a2\u30af\u30bb\u30b9\u304c\u62d2\u5426\u3055\u308c\u307e\u3057\u305f\u3002\u3057\u3070\u3089\u304f\u305f\u3063\u3066\u304b\u3089\u518d\u5ea6\u30a2\u30af\u30bb\u30b9\u3059\u308b\u304b\u3001\u7ba1\u7406\u8005\u306b\u554f\u3044\u5408\u308f\u305b\u3066\u304f\u3060\u3055\u3044\u3002\uff3b\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\uff3d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3053\u3068\u3067Administrator\u30ed\u30fc\u30eb\u306e\u30e1\u30f3\u30d0\u30fc\u306b\u30e1\u30fc\u30eb\u3092\u9001\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002",n.ConcurrentLicenseError_SendEmail="\u30e1\u30fc\u30eb\u3092\u9001\u4fe1",n.ConcurrentLicenseError_Cancel="\u30ad\u30e3\u30f3\u30bb\u30eb",n.ConcurrentLicenseError_MessagePlaceHolder="\u9001\u4fe1\u3059\u308b\u30e1\u30fc\u30eb\u306e\u672c\u6587\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",n.ConcurrentLicenseError_AddressPlaceHolder="\u9001\u4fe1\u5143\u3068\u3059\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",n.ConcurrentLicenseError_SendSuccess="\u30e1\u30fc\u30eb\u306e\u9001\u4fe1\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002",n.ConcurrentLicenseError_SendFailed="\u30e1\u30fc\u30eb\u306e\u9001\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002",n.ConcurrentLicenseError_EmailTitle="\uff3bForguncy Server\uff3d\u540c\u6642\u63a5\u7d9a\u6570\u4e0d\u8db3\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u62d2\u5426\u306e\u901a\u77e5",n.ConcurrentLicenseError_PleaseInputValidEmailAddress="\u4e0d\u6b63\u306a\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u5165\u529b\u3055\u308c\u3066\u3044\u307e\u3059\u3002",n.ConcurrentLicenseError_SenderAddress="\u9001\u4fe1\u5143",n.ContainerCellType_Error_CircularReference="\u30b5\u30d6\u30da\u30fc\u30b8\u300c{0}\u300d\u304c\u5faa\u74b0\u53c2\u7167\u3092\u884c\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002",n.NameConflict="\u300c{0}\u300d\u3068\u3044\u3046\u540d\u524d\u304c\u7af6\u5408\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u540d\u524d\u306f\u30da\u30fc\u30b8\u300c{1}\u300d\u3068\u30da\u30fc\u30b8\u300c{2}\u300d\u306e\u4e21\u65b9\u306b\u5b58\u5728\u3057\u307e\u3059\u3002",n.ContainerCellType_Error_NoExistedPage="\u30da\u30fc\u30b8\u300c{0}\u300d\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002",n.SetCurrentRow_Error_NoRecord="\u30c6\u30fc\u30d6\u30eb\u300c{0}\u300d\u306e\u30ab\u30ec\u30f3\u30c8\u30ec\u30b3\u30fc\u30c9\u306e\u8a2d\u5b9a\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u6307\u5b9a\u3055\u308c\u305f\u30af\u30a8\u30ea\u30fc\u6761\u4ef6\u306b\u5408\u81f4\u3059\u308b\u30ec\u30b3\u30fc\u30c9\u304c\u5b58\u5728\u3057\u307e\u305b\u3093\u3002",n.ListViewAddNewRowError_CantConvertToNumber="\u6570\u5024\u578b\u306b\u5909\u63db\u3067\u304d\u307e\u305b\u3093\u3002",n.ListViewAddNewRowError_CantConvertToBool="Yes/No\u578b\u306b\u5909\u63db\u3067\u304d\u307e\u305b\u3093\u3002",n.ListViewAddNewRowError_CantConvertToDateTime="\u65e5\u4ed8\u578b\u3001\u307e\u305f\u306f\u6642\u523b\u578b\u306b\u5909\u63db\u3067\u304d\u307e\u305b\u3093\u3002",n.CallStoredProcedureCommand_ExecuteFailed="\u30b9\u30c8\u30a2\u30c9\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u30fc\u306e\u5b9f\u884c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002",n.Echart_BubbleChartToolTip="\u30b5\u30a4\u30ba\uff1a{0}",n.Command_postFail_ErrorMessage="\u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002",n.Commit_FailMessage="\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u66f4\u65b0\u306e\u53cd\u6620\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002",n.Commit_ExecutingMessage="\u30b3\u30de\u30f3\u30c9\u304c\u5b9f\u884c\u4e2d\u3067\u3059\u3002",n.LongTimeNoOperation="\u4e00\u5b9a\u671f\u9593\u64cd\u4f5c\u304c\u884c\u308f\u308c\u306a\u304b\u3063\u305f\u305f\u3081\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u5207\u65ad\u3055\u308c\u307e\u3057\u305f\u3002",n.PleaseClickButtonToReload="\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3053\u306e\u30da\u30fc\u30b8\u3092\u518d\u8aad\u307f\u8fbc\u307f\u3057\u307e\u3059\u3002",n.ReloadPage="\u30da\u30fc\u30b8\u306e\u518d\u8aad\u307f\u8fbc\u307f",n.DateTime_Calender_HeaderFormat="yyy\u5e74M\u6708",n.DateTime_Calender_YearMonthFormat="yyyy\u5e74,M\u6708",n.UnauthorizedUpload="\u533f\u540d\u30e6\u30fc\u30b6\u30fc\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u306f\u8a31\u53ef\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002 \u30ed\u30b0\u30a4\u30f3\u304c\u5fc5\u8981\u3067\u3059\u3002",n}();n._JAStringResource=r;u=function(){function n(){}return n.Culture="KR",n.UserNameOrPasswordIsIncorrect="\uc0ac\uc6a9\uc790 \uc774\ub984 \ub610\ub294 \uc554\ud638\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",n.PasswordIsNotSame="\uc554\ud638\uac00 \ub3d9\uc77c\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",n.ForSafetyReasonPleaseChangeYourPassword="Login success. For safety reason, please change your default password",n.TokenIsInvalid="\ud1a0\ud070\uc774 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",n.ResetPasswordSuccess="\uc554\ud638 \uc7ac\uc124\uc815 \uc131\uacf5!",n.Failed="\uc2e4\ud328",n.UserName="\uc0ac\uc6a9\uc790 \uc774\ub984",n.None="<None>",n.deleteStr="\uc0ad\uc81c",n.addStr="\ucd94\uac00",n.listviewNotExisted="ListView\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.",n.FullName="\uc804\uccb4 \uc774\ub984",n.Email="\uc774\uba54\uc77c",n.Role="\uc5ed\ud560",n.OrganizationSuperior="OrganizationSuperior",n.Success="\uc131\uacf5!",n.ConfirmDelete="\uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",n.Year="\ub144",n.Month="\uc6d4",n.Day="\uc77c",n.Quarter="\ubd84\uae30",n.noFieldErrorInfo="{0} \ud45c\uc5d0 \ub300\ud55c \ud544\ub4dc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.",n.unique="\uac12\uc774 \uc874\uc7ac\ud569\ub2c8\ub2e4. \ub2e4\ub978 \uac12\uc744 \uc785\ub825\ud558\uc2ed\uc2dc\uc624.",n.login="\ub85c\uadf8\uc778",n.cantAddEmptyFile="\ube48 \ud30c\uc77c\uc744 \uc5c5\ub85c\ub4dc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.Boolean_True="\uc608",n.Boolean_False="\uc544\ub2c8\uc624",n.MonthNames=["1\uc6d4","2\uc6d4","3\uc6d4","4\uc6d4","6\uc6d4","7\uc6d4","8\uc6d4","9\uc6d4","10\uc6d4","11\uc6d4","12\uc6d4"],n.ColumnFilter_YearName="\ub144",n.ColumnFilter_DayName="\uc77c",n.ContextMenu_CompareType_Equals="\uac19\uc74c",n.ContextMenu_CompareType_DoesNotEqual="\uac19\uc9c0 \uc54a\uc74c",n.ContextMenu_CompareType_BeginsWith="~\ub85c \uc2dc\uc791",n.ContextMenu_CompareType_DoesNotBeginWith="~\ub85c \uc2dc\uc791\ud558\uc9c0 \uc54a\ub294",n.ContextMenu_CompareType_EndsWith="~\ub85c \ub05d\ub0a8",n.ContextMenu_CompareType_DoesNotEndWidth="~\ub85c \ub05d\ub098\uc9c0 \uc54a\ub294",n.ContextMenu_CompareType_Contains="\ud3ec\ud568",n.ContextMenu_CompareType_DoesNotContain="\ud3ec\ud568\ud558\uc9c0 \uc54a\ub294",n.ContextMenu_CompareType_IsGreaterThan="~\ubcf4\ub2e4 \ud070",n.ContextMenu_CompareType_IsGreaterThanOrEqualTo="\ud06c\uac70\ub098 \uac19\uc740",n.ContextMenu_CompareType_IsLessThan="~\ubcf4\ub2e4 \uc791\uc740",n.ContextMenu_CompareType_IsLessThanOrEqualTo="\uc791\uac70\ub098 \uac19\uc740",n.ContextMenu_CompareType_IsBetween="\ubc94\uc704 \ub0b4",n.ContextMenu_CompareType_IsNotBetween="\ubc94\uc704 \ubc16",n.ContextMenu_CompareType_In="\uc548\uc5d0",n.ContextMenu_CompareType_NotIn="\ubc16\uc5d0",n.ContextMenu_CompareType_IsLessThan_Date="\uc774\uc804",n.ContextMenu_CompareType_IsGreaterThan_Date="\uc774\ud6c4",n.ComboBox_CompareType_Equals="\uac19\uc74c",n.ComboBox_CompareType_DoesNotEqual="\uac19\uc9c0 \uc54a\uc74c",n.ComboBox_CompareType_BeginsWith="~\ub85c \uc2dc\uc791",n.ComboBox_CompareType_DoesNotBeginWith="~\ub85c \uc2dc\uc791\ud558\uc9c0 \uc54a\ub294",n.ComboBox_CompareType_EndsWith="~\ub85c \ub05d\ub0a8",n.ComboBox_CompareType_DoesNotEndWidth="~\ub85c \ub05d\ub098\uc9c0 \uc54a\ub294",n.ComboBox_CompareType_Contains="\ud3ec\ud568",n.ComboBox_CompareType_DoesNotContain="\ud3ec\ud568\ud558\uc9c0 \uc54a\ub294",n.ComboBox_CompareType_IsGreaterThan="~\ubcf4\ub2e4 \ud070",n.ComboBox_CompareType_IsGreaterThanOrEqualTo="\ud06c\uac70\ub098 \uac19\uc740",n.ComboBox_CompareType_IsLessThan="~\ubcf4\ub2e4 \uc791\uc740",n.ComboBox_CompareType_IsLessThanOrEqualTo="\uc791\uac70\ub098 \uac19\uc740",n.ComboBox_CompareType_IsBetween="\ubc94\uc704 \ub0b4",n.ComboBox_CompareType_IsNotBetween="\ubc94\uc704 \ubc16",n.ComboBox_CompareType_In="\uc548\uc5d0",n.ComboBox_CompareType_NotIn="\ubc16\uc5d0",n.ComboBox_CompareType_IsLessThan_Date="\uc774\uc804",n.ComboBox_CompareType_IsGreaterThan_Date="\uc774\ud6c4",n.DateCompareType_Tomorrow="\ub0b4\uc77c",n.DateCompareType_Today="\uc624\ub298",n.DateCompareType_Yesterday="\uc5b4\uc81c",n.DateCompareType_NextWeek="\ub2e4\uc74c\uc8fc",n.DateCompareType_ThisWeek="\uc774\ubc88\uc8fc",n.DateCompareType_LastWeek="\uc9c0\ub09c\uc8fc",n.DateCompareType_NextMonth="\ub2e4\uc74c\ub2ec",n.DateCompareType_ThisMonth="\uc774\ubc88\ub2ec",n.DateCompareType_LastMonth="\uc9c0\ub09c\ub2ec",n.DateCompareType_NextYear="\ub0b4\ub144",n.DateCompareType_ThisYear="\uc62c\ud574",n.DateCompareType_LastYear="\uc791\ub144",n.ForguncyUI_Dialog_OK="\ud655\uc778",n.ForguncyUI_Dialog_Cancel="\ucde8\uc18c",n.ColumnFilter_Dialog_Title="\ud544\ud130",n.ColumnFilter_ContextMenu_SortAscending="\uc624\ub984\ucc28\uc21c \uc815\ub82c",n.ColumnFilter_ContextMenu_SortDesending="\ub0b4\ub9bc\ucc28\uc21c \uc815\ub82c",n.ColumnFilter_ContextMenu_ClearFilter="\ud544\ud130 \ucd08\uae30\ud654",n.ColumnFilter_ContextMenu_Filter="\ud544\ud130",n.ColumnFilter_ContextMenu_CustomFilter="\uc0ac\uc6a9\uc790\uc815\uc758 \ud544\ud130",n.ColumnFilter_ContextMenu_NumberFilter="\uc22b\uc790 \ud544\ud130",n.ColumnFilter_ContextMenu_TextFilter="\ubb38\uc790 \ud544\ud130",n.ColumnFilter_ContextMenu_DateFilter="\ub0a0\uc9dc \ud544\ud130",n.ColumnFilter_TreeView_SelectAll="(\ubaa8\ub450 \uc120\ud0dd)",n.ColumnFilter_TreeView_Blanks="(\uacf5\ubc31)",n.ColumnFilter_TreeView_TooManyItems="\uc77c\ubd80 \ud56d\ubaa9 \ud45c\uc2dc \uc548\ud568",n.ColumnFilter_TextBlock_And="\uadf8\ub9ac\uace0",n.ColumnFilter_TextBlock_Where="\ud56d\ubaa9 \uc704\uce58 \ud45c\uc2dc:",n.ColumnFilter_Alert_IncorrectValue="\uc785\ub825\ud55c \uac12\uc774 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc74c!",n.ColumnFilter_TextBlock_TextExample_In="\uc608) \uc0ac\uacfc,\ubc14\ub098\ub098,\uc624\ub80c\uc9c0 (\uc27c\ud45c\ub85c \uad6c\ubd84)",n.ColumnFilter_TextBlock_DateExample="\uc608) 2019/01/01",n.ColumnFilter_TextBlock_DateExample_Between="\uc608) 2019/01/01 \ubd80\ud130 2019/12/31",n.ColumnFilter_TextBlock_TimeExample="\uc608) 10:00",n.ColumnFilter_TextBlock_TimeExample_Between="\uc608) 10:00 \ubd80\ud130 12:00",n.ColumnOptionsCommand_Title="\uc5f4(Column) \uc635\uc158",n.ColumnOptionsCommand_AvailableColumns="\uc0ac\uc6a9\uac00\ub2a5\ud55c \uc5f4:",n.ColumnOptionsCommand_SelectedColumns="\uc120\ud0dd\ub41c \uc5f4:",n.ColumnOptionsCommand_UnamedColumn="<\uc774\ub984\uc5c6\ub294\uc5f4>",n.ColumnOptionsCommand_ResetSetting="\uc124\uc815 \ucd08\uae30\ud654",n.ColumnOptionsCommand_ConfirmResetSetting="\uc124\uc815\uc744 \uc7ac\uc124\uc815 \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?  r  n \ube0c\ub77c\uc6b0\uc800\uac00 \uc989\uc2dc \ub2e4\uc2dc\ub85c\ub4dc\ub429\ub2c8\ub2e4.",n.ColumnOptionsCommand_AddColumn="\uc5f4 \ucd94\uac00",n.ColumnOptionsCommand_RemoveColumn="\uc5f4 \uc81c\uac70",n.ColumnOptionsCommand_MoveColumnUp="\uc704\ub85c \uc5f4 \uc774\ub3d9 ",n.ColumnOptionsCommand_MoveColumnDown="\uc544\ub798\ub85c \uc5f4 \uc774\ub3d9",n.AttachmentCell_NotSupportedFile="\uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ud30c\uc77c\uc785\ub2c8\ub2e4",n.CurrentUserCell_ChangeProfile="\ud504\ub85c\ud544 \ubcc0\uacbd",n.CurrentUserCell_ChangePassword="\uc554\ud638 \ubcc0\uacbd",n.CurrentUserCell_Logout="\ub85c\uadf8\uc544\uc6c3",n.ProcessBarCell_AssignedToPopup_Title="\ud604\uc7ac \ub2f4\ub2f9\uc790",n.ProcessBarCell_AssignedTo="\ud560\ub2f9 \ub300\uc0c1",n.ProcessBarCell_AssignedTo_me="\ubcf8\uc778",n.ProcessBarCell_AssignedToMultiUser="{0} \ubc0f {1} \ub4f1",n.ProcessBarCell_HistoryPopup_Title="\uc0c1\ud0dc \ub0b4\uc5ed",n.ProcessBarCell_History_Operator="\uc5f0\uc0b0\uc790",n.ProcessBarCell_History_Time="\uc2dc\uac04",n.ProcessBarCell_History_EndStatus="\uc885\ub8cc \uc0c1\ud0dc",n.ProcessBarCell_History_Comments="\uba54\ubaa8",n.ProcessBarCell_History_ActionName="\uc791\uc5c5 \uc774\ub984",n.ProcessBarCell_ActionPopup_Title="\uc0c1\ud0dc \uc5c5\ub370\uc774\ud2b8",n.ProcessBarCell_ActionPopup_NextStatus="\ub2e4\uc74c \uc0c1\ud0dc:",n.ProcessBarCell_ActionPopup_Assignto_Choose="\ub2f4\ub2f9\uc790 \uc120\ud0dd:",n.ProcessBarCell_ActionPopup_Assignto_All="\ub2e4\uc74c \uc0c1\ud0dc\uc758 \ub2f4\ub2f9\uc790:",n.ProcessBarCell_ActionPopup_Comments="\uba54\ubaa8:",n.ProcessBarCell_OK="\ud655\uc778",n.ProcessBarCell_Cancel="\ucde8\uc18c",n.ProcessBarCell_Status="\uc0c1\ud0dc: {0}",n.ProcessBarCell_ChangeStateFailed="\uc791\uc5c5 \uc2e4\ud589 \uc2e4\ud328(_E)",n.ProcessBarCell_ChangeAssignee="\ub2f4\ub2f9\uc790 \ubcc0\uacbd",n.ProcessBarCell_CreateBy="{1}\uc5d0 {0}\uc774(\uac00) \ub9cc\ub4e6",n.ProcessBarCell_LastModifyBy="{1}\uc5d0 {0}\uc774(\uac00) \ub9c8\uc9c0\ub9c9\uc73c\ub85c \uc218\uc815\ud568",n.CannotFindCell="\uc774 \ud398\uc774\uc9c0\uc5d0\uc11c \uc774\ub984\uc774 '{0}'\uc778 \uc140\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.CannotFindCellById="\uc774 \ud398\uc774\uc9c0\uc5d0\uc11c ID\uac00 '{0}'\uacfc(\uc640) \uac19\uc740 \uc140\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.CannotFindListview="\uc774 \ud398\uc774\uc9c0\uc5d0\uc11c \uc774\ub984\uc774 '{0}'\uc778 ListView\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.CannotFindColumn="'{1}' ListView\uc5d0\uc11c \uc774\ub984\uc774 '{0}'\uc778 \uc5f4\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.CannotFindColumnIndex="'{1}' ListView\uc758 \uc5f4 \uc778\ub371\uc2a4 '{0}'\uc774(\uac00) \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",n.NotSupportEventForPage="{1}\uc5d0 \ub300\ud574 '{0}' \uc774\ubca4\ud2b8\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",n.NotSupportEventForCellOrListview="{1} '{2}'\uc5d0 \ub300\ud574 '{0}' \uc774\ubca4\ud2b8\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",n.NotSupportSetValue="\uc774 \uba54\uc11c\ub4dc\ub294 \uc140 '{0}'\uc5d0 \uc9c0\uc6d0\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",n.InvalidNumberParam="'{0}' \ub9e4\uac1c \ubcc0\uc218\uc5d0 \ub300\ud574 \uc720\ud6a8\ud55c \uc22b\uc790\ub97c \uc81c\uacf5\ud558\uc2ed\uc2dc\uc624.",n.IndexOutOfRange="'{0}' \ub9e4\uac1c \ubcc0\uc218\uac00 \ubc94\uc704\ub97c \ubc97\uc5b4\ub0ac\uc2b5\ub2c8\ub2e4.",n.ForguncyApiExceptionString="{1}.{2} \uba54\uc11c\ub4dc\uc758 {0}: {3}.",n.InvalidFunctionParam="'{0}' \ub9e4\uac1c \ubcc0\uc218\ub294 \ud568\uc218\uc5ec\uc57c \ud569\ub2c8\ub2e4.",n.HideShowColumns_CannotHideRowHeader="Can't hide or show row Header columns.",n.HideShowColumns_ListviewIsEditing="Can't hide or show columns when listview is editing.",n.HideShowColumns_CannotShowHiddenColumn="Can show column that is hidden(Not ignore hidden) or width is 0 in designer.",n.WebApi_ErrorInfo_NonemptyStringParam="'{0}' \ub9e4\uac1c \ubcc0\uc218\ub294 \ube44\uc5b4 \uc788\uc9c0 \uc54a\uc740 \ubb38\uc790\uc5f4\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.",n.WebApi_ErrorInfo_ParamInvalid="'{0}' \ub9e4\uac1c \ubcc0\uc218\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",n.groupCell_Other="\uae30\ud0c0:",n.ClosePopupCommand_NotPopup="\ud604\uc7ac \ud398\uc774\uc9c0\ub294 \ud31d\uc5c5 \ud398\uc774\uc9c0\uac00 \uc544\ub2d9\ub2c8\ub2e4.",n.AddUserApiParamError="\ub9e4\uac1c \ubcc0\uc218\uc758 \uc720\ud615\uc774 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4!",n.Echart_DataLoadingText="\ub370\uc774\ud130 \ub85c\ub4dc \uc911...",n.Echart_NoDataLoadingText="\ub370\uc774\ud130 \uc5c6\uc74c",n.InvalidCopyPasteSize="\ubcf5\uc0ac \uc601\uc5ed\uacfc \ubd99\uc5ec\ub123\uae30 \uc601\uc5ed\uc758 \ud06c\uae30\uac00 \ub2e4\ub985\ub2c8\ub2e4.",n.RangeOperationCannotInvolveTotalRow="The range operation can not involve total row.",n.ValidateErrorMessage="\ud589: {1}, \uc5f4: {2}\uc758 '{0}' \uac12\uc774 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\r\n\uc624\ub958 \uba54\uc2dc\uc9c0:\r\n{3}",n.InvalidValueTypeMessage="\uc798\ubabb\ub41c \uac12 \uc720\ud615\uc785\ub2c8\ub2e4.",n.ValueNotInList="\uac12\uc774 \ud56d\ubaa9 \ubaa9\ub85d\uc5d0 \ud3ec\ud568\ub418\uc5b4 \uc788\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",n.ErrorInfo_Uncommited="\ucee4\ubc0b\ub418\uc9c0 \uc54a\uc740 \ub370\uc774\ud130\ub97c \ud3ec\ud568\ud569\ub2c8\ub2e4.",n.DataValidation_Required="\ud544\uc218",n.DataValidation_WholeNumberDefaultErrorMessage="\uc785\ub825\ud55c \uc815\uc218\uac00 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",n.DataValidation_DecimalDefaultErrorMessage="\uc785\ub825\ud55c 10\uc9c4\uc218\uac00 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",n.DataValidation_DateDefaultErrorMessage="\uc785\ub825\ud55c \ub0a0\uc9dc\uac00 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",n.DataValidation_TimeDefaultErrorMessage="\uc785\ub825\ud55c \uc2dc\uac04\uc774 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",n.DataValidation_TextLenghtDefaultErrorMessage="\uc785\ub825\ud55c \uac12\uc758 \uae38\uc774\uac00 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",n.DataValidation_CustomDefaultErrorMessage="\uc785\ub825\ud55c \uac12\uc774 \uc218\uc2dd\uacfc \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",n.DataValidation_RegularUserInputDefaultErrorMessage="\uc785\ub825\ud55c \uac12\uc774 \uc815\uaddc\uc2dd\uacfc \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",n.DataValidation_RegularDefaultErrorMessage="\uc785\ub825\ud55c \uac12\uc774 {0} \uc815\uaddc\uc2dd\uacfc \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",n.Validate_Number="\uc720\ud6a8\ud55c \uc22b\uc790\ub97c \uc785\ub825\ud558\uc2ed\uc2dc\uc624.",n.InvalidValueErrorMessage="'{2}' \ud45c\uc5d0\uc11c '{1}' \uc5f4\uc758 \uc798\ubabb\ub41c \uac12 '{0}'\uc744(\ub97c) \ucee4\ubc0b\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.uploadFileBiggerThanMaxFileCount="\uc5c5\ub85c\ub4dc\ub41c \ud30c\uc77c \uc218\uac00 \ucd5c\ub300 \uc218\uc5d0 \ub3c4\ub2ec\ud588\uc2b5\ub2c8\ub2e4. \ub354 \uc774\uc0c1 \ud30c\uc77c\uc744 \uc5c5\ub85c\ub4dc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.uploadFileBiggerThanMaxSize="\uc5c5\ub85c\ub4dc\ub41c \ud30c\uc77c {0} \ud06c\uae30\uac00 \uc81c\ud55c\ubcf4\ub2e4 \ud07d\ub2c8\ub2e4. \ucd5c\ub300 \ud06c\uae30\ub294 {1}MB\uc785\ub2c8\ub2e4.",n.uploadFileNotMatchExtension="\uc5c5\ub85c\ub4dc\ub41c \ud30c\uc77c {0}\uc758 \ud30c\uc77c \uc720\ud615\uc774 \ud5c8\uc6a9\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",n.ExprotToExcelCalFormulaError="\uc218\uc2dd\uc744 \uacc4\uc0b0\ud560 \ub54c \ub0b4\ubcf4\ub0b4\uae30 Excel \ud30c\uc77c\uc758 \uc774\ub984\uc774 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4!",n.ExprotToPDFCalFormulaError="\uc218\uc2dd\uc744 \uacc4\uc0b0\ud560 \ub54c \ub0b4\ubcf4\ub0b4\uae30 PDF \ud30c\uc77c\uc758 \uc774\ub984\uc774 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4!",n.ExportListviewNoColumnError="There is no column to export.",n.AutoGeneratedID_Conflict_Error="\uc790\ub3d9 \uc0dd\uc131\ub41c ID\uac00 \uc774\ubbf8 \uc788\uc2b5\ub2c8\ub2e4. \uad00\ub828 \uc140\uc774 \uc0c8 ID\ub97c \uc5c5\ub370\uc774\ud2b8\ud588\uc2b5\ub2c8\ub2e4. \ub370\uc774\ud130\ub97c \ub2e4\uc2dc \ucee4\ubc0b\ud558\uc2ed\uc2dc\uc624.",n.AutoGeneratedID_Generate_Error="\uc22b\uc790 \ubd80\ubd84\uc758 \uae38\uc774\uac00 \uc790\ub3d9 \uc0dd\uc131\ub41c ID\uc5d0 \uc124\uc815\ub41c \uae38\uc774\ubcf4\ub2e4 \ud07d\ub2c8\ub2e4.",n.AutoGeneratedID_Conflict_Listview_Error="'{0}' \ud544\ub4dc\uc758 \uac12\uc774 \uc774\ubbf8 \uc874\uc7ac\ud569\ub2c8\ub2e4.",n.ImportExcelFirstRowMissDataError="Excel\uc5d0\uc11c \uac00\uc838\uc628 \uccab \ubc88\uc9f8 \ud589 \ub370\uc774\ud130\ub294 \ube44\uc6cc\ub458 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.NoMatchBetweenExcelWithListViewError="Excel\uc5d0\uc11c \uac00\uc838\uc628 \ud56d\ubaa9\uc774 \uc774 \ud398\uc774\uc9c0\uc758 ListView\uc640 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",n.InCorrectFileFormatError="\uc62c\ubc14\ub974\uc9c0 \uc54a\uc740 \ud30c\uc77c \ud615\uc2dd\uc785\ub2c8\ub2e4.",n.NoSelectedRowError="\ud558\ub098 \uc774\uc0c1\uc758 \ud589\uc744 \uc120\ud0dd\ud558\uc2ed\uc2dc\uc624.",n.GUID_Creator="\uc791\uc131\uc790",n.GUID_CreateDate="\uc791\uc131\uc77c",n.GUID_LastModifyBy="\ub9c8\uc9c0\ub9c9 \uc218\uc815\uc790",n.GUID_LastModifyDate="\ub9c8\uc9c0\ub9c9 \uc218\uc815\uc77c",n.GUID_AssignTo="AssignTo",n.GUID_Status="\uc0c1\ud0dc",n.UpdateListviewCommand_Listview_Group="\ud1b5\uacc4 \uc5f4\uc744 \ud3ec\ud568\ud558\ub294 ListView\ub97c \uc5c5\ub370\uc774\ud2b8\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.UpdateListviewCommand_Listview_DetailListview="\ub9c8\uc2a4\ud130 \ud45c\uc758 \ud604\uc7ac \ud589\uc774 \uc5c6\ub294 \uc138\ubd80 ListView\ub97c \uc5c5\ub370\uc774\ud2b8\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.ImportExcelToListViewError_Detail="Excel\uc758 '{1}' \ud589 \ubc0f '{2}' \uc5f4\uc5d0 \uc788\ub294 '{0}' \uac12\uc774 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc624\ub958 \uba54\uc2dc\uc9c0: {3}",n.ImportExcelToListViewError_ExistSameKeys="Exists same keys in excel data and please ensure the primary keys is unique.",n.UpdateViewFail_Error="\uc5c5\ub370\uc774\ud2b8\ud558\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4.\r\n \ud604\uc7ac \ubcf4\uae30\ub97c \uc5c5\ub370\uc774\ud2b8\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.UpdateListViewFail_BindingTableCantEditError="Update failed. \r\n Current binding data source can not be update.",n.ConcurrentLicenseError_Kickoffed="\uad00\ub9ac\uc790\uc5d0 \uc758\ud574 \ud1f4\ucd9c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",n.ConcurrentLicenseError_NoEnoughLicense="\uc561\uc138\uc2a4\uac00 \uac70\ubd80\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uacc4\uc815 \ub77c\uc774\uc120\uc2a4\uac00 \ub9cc\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc2ed\uc2dc\uc624.",n.ConcurrentLicenseError_SendEmail="\uc774\uba54\uc77c \ubcf4\ub0b4\uae30",n.ConcurrentLicenseError_Cancel="\ubcf4\ub0b4\uc9c0 \uc54a\uc74c",n.ConcurrentLicenseError_MessagePlaceHolder="\uc5ec\uae30\uc5d0 \uc774\uba54\uc77c \ub0b4\uc6a9\uc744 \uc785\ub825\ud558\uc2ed\uc2dc\uc624.",n.ConcurrentLicenseError_AddressPlaceHolder="\uc774\uba54\uc77c \uc8fc\uc18c\ub97c \uc785\ub825\ud558\uc2ed\uc2dc\uc624.",n.ConcurrentLicenseError_SendSuccess="\ubcf4\ub0b4\uae30\uc5d0 \uc131\uacf5\ud588\uc2b5\ub2c8\ub2e4.",n.ConcurrentLicenseError_SendFailed="\ubcf4\ub0b4\uae30\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",n.ConcurrentLicenseError_EmailTitle="\uc561\uc138\uc2a4\uac00 \uac70\ubd80\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",n.ConcurrentLicenseError_PleaseInputValidEmailAddress="\uc720\ud6a8\ud55c \uc774\uba54\uc77c \uc8fc\uc18c\ub97c \uc785\ub825\ud558\uc2ed\uc2dc\uc624.",n.ConcurrentLicenseError_SenderAddress="From",n.ContainerCellType_Error_CircularReference="\ud558\uc704 \ud398\uc774\uc9c0 '{0}' \ub85c\ub4dc\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4. \uc21c\ud658 \ucc38\uc870\uac00 \uc788\uc2b5\ub2c8\ub2e4.",n.NameConflict="\uc774\ub984 '{0}'\uc774(\uac00) \ucda9\ub3cc\ud569\ub2c8\ub2e4. '{1}' \ud398\uc774\uc9c0 \ubc0f '{2}' \ud398\uc774\uc9c0 \ubaa8\ub450\uc5d0 \uc774 \uc774\ub984\uc774 \uc788\uc2b5\ub2c8\ub2e4.",n.ContainerCellType_Error_NoExistedPage="'{0}' \ud398\uc774\uc9c0\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.SetCurrentRow_Error_NoRecord="'{0}' \ud45c\uc758 \ud604\uc7ac \ud589\uc744 \uc124\uc815\ud558\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4. \ucffc\ub9ac \uc870\uac74\uc5d0 \ub530\ub978 \ub808\ucf54\ub4dc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.",n.ListViewAddNewRowError_CantConvertToNumber="\uc22b\uc790\ub85c \ubcc0\ud658\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.ListViewAddNewRowError_CantConvertToBool="\ubd80\uc6b8\ub85c \ubcc0\ud658\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.ListViewAddNewRowError_CantConvertToDateTime="\ub0a0\uc9dc \ub610\ub294 \uc2dc\uac04\uc73c\ub85c \ubcc0\ud658\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",n.CallStoredProcedureCommand_ExecuteFailed="\uc800\uc7a5 \ud504\ub85c\uc2dc\uc800 \uc2e4\ud589\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",n.Echart_BubbleChartToolTip="Size: {0}",n.Command_postFail_ErrorMessage="\uba85\ub839 \uc2e4\ud589 \uc2e4\ud328.",n.Commit_FailMessage="\ucee4\ubc0b \uc2e4\ud328.",n.Commit_ExecutingMessage="\uba85\ub839\uc774 \uc2e4\ud589\uc911\uc785\ub2c8\ub2e4.",n.LongTimeNoOperation="\uc624\ub79c \uc2dc\uac04 \ub3d9\uc548 \ud398\uc774\uc9c0\ub97c \uc870\uc791\ud558\uc9c0 \uc54a\uc73c\uba74 \uc5f0\uacb0\uc774 \ub04a\uc5b4\uc9d1\ub2c8\ub2e4.",n.PleaseClickButtonToReload="\ud398\uc774\uc9c0\ub97c \uc0c8\ub85c \uace0\uce68\ud558\ub824\uba74 \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc2ed\uc2dc\uc624..",n.ReloadPage="\ud398\uc774\uc9c0 \uc0c8\ub85c \uace0\uce68",n.DateTime_Calender_HeaderFormat="yyy\ub144M\uc6d4",n.DateTime_Calender_YearMonthFormat="yyyy\ub144,M\uc6d4",n.UnauthorizedUpload="Not allow anonymous access. You need to login.",n}();n._KOStringResource=u;f=function(){function n(){}return n.cultureName="en-US",n.dashboard_scenario_value_running_sum="Running Sum",n.dashboard_scenario_value_running_avg="Running Average",n.dashboard_scenario_value_running_max="Running Max",n.dashboard_scenario_value_running_min="Running Min",n.dashboard_scenario_value_running_cnt="Running Count",n.dashboard_scenario_value_moving_sum="Moving Sum",n.dashboard_scenario_value_moving_avg="Moving Average",n.dashboard_scenario_value_moving_max="Moving Max",n.dashboard_scenario_value_moving_min="Moving Min",n.dashboard_scenario_value_sumof="Sum of {0}",n.dashboard_scenario_value_avgof="Average of {0}",n.dashboard_scenario_value_maxof="Max of {0}",n.dashboard_scenario_value_minof="Min of {0}",n.dashboard_scenario_value_cntof="Count of {0}",n.dashboard_scenario_value_dstof="Distinct Count of {0}",n.dashboard_scenario_value_firstof="First of {0}",n.dashboard_scenario_value_lastof="Last of {0}",n.directives_scenariodimension_datadimensions_year="Year",n.directives_scenariodimension_datadimensions_fiscalyear="Fiscal Year",n.directives_scenariodimension_datadimensions_quarter="Quarter",n.directives_scenariodimension_datadimensions_month="Month",n.directives_scenariodimension_datadimensions_week="Week",n.directives_scenariodimension_datadimensions_day="Day",n.directives_scenariodimension_datadimensions_hour="Hour",n.directives_scenariodimension_datadimensions_minute="Minute",n.directives_scenariodimension_datadimensions_second="Second",n.directives_scenariodimension_datadimensions_millisecond="Millisecond",n.spread_pivot_table_subtotal="Total",n.spread_pivot_table_grand_total="Grand Total",n.nullvalue_display="(blank)",n.datetime_quarter_q1="Q1",n.datetime_quarter_q2="Q2",n.datetime_quarter_q3="Q3",n.datetime_quarter_q4="Q4",n.datetime_month_m1="Jan",n.datetime_month_m2="Feb",n.datetime_month_m3="Mar",n.datetime_month_m4="Apr",n.datetime_month_m5="May",n.datetime_month_m6="Jun",n.datetime_month_m7="Jul",n.datetime_month_m8="Aug",n.datetime_month_m9="Sep",n.datetime_month_m10="Oct",n.datetime_month_m11="Nov",n.datetime_month_m12="Dec",n.datetime_year_format="@",n}();n._PivotTableENSR=f;e=function(){function n(){}return n.cultureName="ja-JP",n.dashboard_scenario_value_running_sum="\u7d2f\u7a4d\u5408\u8a08",n.dashboard_scenario_value_running_avg="\u7d2f\u7a4d\u5e73\u5747",n.dashboard_scenario_value_running_max="\u7d2f\u7a4d\u6700\u5927\u5024",n.dashboard_scenario_value_running_min="\u7d2f\u7a4d\u6700\u5c0f\u5024",n.dashboard_scenario_value_running_cnt="\u7d2f\u7a4d\u6570",n.dashboard_scenario_value_moving_sum="\u79fb\u52d5\u5408\u8a08",n.dashboard_scenario_value_moving_avg="\u79fb\u52d5\u5e73\u5747",n.dashboard_scenario_value_moving_max="\u79fb\u52d5\u6700\u5927\u5024",n.dashboard_scenario_value_moving_min="\u79fb\u52d5\u6700\u5c0f\u5024",n.dashboard_scenario_value_sumof="\u5408\u8a08 {0}",n.dashboard_scenario_value_avgof="\u5e73\u5747 {0}",n.dashboard_scenario_value_maxof="\u6700\u5927 {0}",n.dashboard_scenario_value_minof="\u6700\u5c0f {0}",n.dashboard_scenario_value_cntof="\u30c7\u30fc\u30bf\u306e\u500b\u6570 {0}",n.dashboard_scenario_value_dstof="\u4e00\u610f\u306e\u30c7\u30fc\u30bf\u306e\u500b\u6570 {0}",n.dashboard_scenario_value_firstof="\u7b2c\u4e00\u6761 {0}",n.dashboard_scenario_value_lastof="\u6700\u540e\u4e00\u6761 {0}",n.directives_scenariodimension_datadimensions_year="\u5e74",n.directives_scenariodimension_datadimensions_fiscalyear="\u4f1a\u8a08\u5e74\u5ea6",n.directives_scenariodimension_datadimensions_quarter="\u5b63\u5ea6",n.directives_scenariodimension_datadimensions_month="\u6708",n.directives_scenariodimension_datadimensions_week="\u5468",n.directives_scenariodimension_datadimensions_day="\u65e5",n.directives_scenariodimension_datadimensions_hour="\u65f6",n.directives_scenariodimension_datadimensions_minute="\u5206",n.directives_scenariodimension_datadimensions_second="\u79d2",n.directives_scenariodimension_datadimensions_millisecond="\u6beb\u79d2",n.spread_pivot_table_subtotal="\u8a08",n.spread_pivot_table_grand_total="\u7dcf\u8a08",n.nullvalue_display="(\u7a7a\u767d)",n.datetime_quarter_q1="\u7b2c1\u56db\u534a\u671f",n.datetime_quarter_q2="\u7b2c2\u56db\u534a\u671f",n.datetime_quarter_q3="\u7b2c3\u56db\u534a\u671f",n.datetime_quarter_q4="\u7b2c4\u56db\u534a\u671f",n.datetime_month_m1="1\u6708",n.datetime_month_m2="2\u6708",n.datetime_month_m3="3\u6708",n.datetime_month_m4="4\u6708",n.datetime_month_m5="5\u6708",n.datetime_month_m6="6\u6708",n.datetime_month_m7="7\u6708",n.datetime_month_m8="8\u6708",n.datetime_month_m9="9\u6708",n.datetime_month_m10="10\u6708",n.datetime_month_m11="11\u6708",n.datetime_month_m12="12\u6708",n.datetime_year_format="@\u5e74",n}();n._PivotTableJASR=e;o=function(){function n(){}return n.cultureName="zh-CN",n.dashboard_scenario_value_running_sum="\u7d2f\u79ef\u5408\u8ba1",n.dashboard_scenario_value_running_avg="\u7d2f\u79ef\u5e73\u5747",n.dashboard_scenario_value_running_max="\u7d2f\u79ef\u6700\u5927\u503c",n.dashboard_scenario_value_running_min="\u7d2f\u79ef\u6700\u5c0f\u503c",n.dashboard_scenario_value_running_cnt="\u7d2f\u79ef\u8ba1\u6570",n.dashboard_scenario_value_moving_sum="\u79fb\u52a8\u5408\u8a08",n.dashboard_scenario_value_moving_avg="\u79fb\u52a8\u5e73\u5747",n.dashboard_scenario_value_moving_max="\u79fb\u52a8\u6700\u5927\u503c",n.dashboard_scenario_value_moving_min="\u79fb\u52a8\u6700\u5927\u503c",n.dashboard_scenario_value_sumof="\u5408\u8a08 {0}",n.dashboard_scenario_value_avgof="\u5e73\u5747 {0}",n.dashboard_scenario_value_maxof="\u6700\u5927\u503c {0}",n.dashboard_scenario_value_minof="\u6700\u5c0f\u503c {0}",n.dashboard_scenario_value_cntof="\u6570\u503c\u8ba1\u6570 {0}",n.dashboard_scenario_value_dstof="\u552f\u4e00\u8ba1\u6570 {0}",n.dashboard_scenario_value_firstof="\u7b2c\u4e00\u6761 {0}",n.dashboard_scenario_value_lastof="\u6700\u540e\u4e00\u6761 {0}",n.directives_scenariodimension_datadimensions_year="\u5e74",n.directives_scenariodimension_datadimensions_fiscalyear="\u8d22\u5e74",n.directives_scenariodimension_datadimensions_quarter="\u5b63\u5ea6",n.directives_scenariodimension_datadimensions_month="\u6708",n.directives_scenariodimension_datadimensions_week="\u5468",n.directives_scenariodimension_datadimensions_day="\u65e5",n.directives_scenariodimension_datadimensions_hour="\u65f6",n.directives_scenariodimension_datadimensions_minute="\u5206",n.directives_scenariodimension_datadimensions_second="\u79d2",n.directives_scenariodimension_datadimensions_millisecond="\u6beb\u79d2",n.spread_pivot_table_subtotal="\u5c0f\u8ba1",n.spread_pivot_table_grand_total="\u603b\u8ba1",n.scenario_slicer_relativedate_datetype_year="\u5e74",n.scenario_slicer_relativedate_datetype_quarter="\u5b63\u5ea6",n.scenario_slicer_relativedate_datetype_month="\u6708",n.scenario_slicer_relativedate_datetype_week="\u5468",n.scenario_slicer_relativedate_datetype_day="\u65e5",n.nullvalue_display="(\u7a7a\u767d)",n.table_rows_empty_desc="\u65e0\u6709\u6548\u9879",n.pivot_table_empty_desc="\u70b9\u51fb\u6b64\u533a\u57df\u8bbe\u8ba1\u900f\u89c6\u8868",n.pivot_table_dataset_removed="\u76f8\u5173\u6570\u636e\u96c6\u88ab\u5220\u9664",n.datetime_quarter_q1="\u7b2c\u4e00\u5b63\u5ea6",n.datetime_quarter_q2="\u7b2c\u4e8c\u5b63\u5ea6",n.datetime_quarter_q3="\u7b2c\u4e09\u5b63\u5ea6",n.datetime_quarter_q4="\u7b2c\u56db\u5b63\u5ea6",n.datetime_month_m1="1\u6708",n.datetime_month_m2="2\u6708",n.datetime_month_m3="3\u6708",n.datetime_month_m4="4\u6708",n.datetime_month_m5="5\u6708",n.datetime_month_m6="6\u6708",n.datetime_month_m7="7\u6708",n.datetime_month_m8="8\u6708",n.datetime_month_m9="9\u6708",n.datetime_month_m10="10\u6708",n.datetime_month_m11="11\u6708",n.datetime_month_m12="12\u6708",n.datetime_year_format="@\u5e74",n}();n._PivotTableCNSR=o;s=function(){function n(){}return n.cultureName="ko-KR",n.dashboard_scenario_value_running_sum="Running Sum",n.dashboard_scenario_value_running_avg="Running Average",n.dashboard_scenario_value_running_max="Running Max",n.dashboard_scenario_value_running_min="Running Min",n.dashboard_scenario_value_running_cnt="Running Count",n.dashboard_scenario_value_moving_sum="Moving Sum",n.dashboard_scenario_value_moving_avg="Moving Average",n.dashboard_scenario_value_moving_max="Moving Max",n.dashboard_scenario_value_moving_min="Moving Min",n.dashboard_scenario_value_sumof="Sum of {0}",n.dashboard_scenario_value_avgof="Average of {0}",n.dashboard_scenario_value_maxof="Max of {0}",n.dashboard_scenario_value_minof="Min of {0}",n.dashboard_scenario_value_cntof="Count of {0}",n.dashboard_scenario_value_dstof="Distinct Count of {0}",n.dashboard_scenario_value_firstof="First of {0}",n.dashboard_scenario_value_lastof="Last of {0}",n.directives_scenariodimension_datadimensions_year="Year",n.directives_scenariodimension_datadimensions_fiscalyear="Fiscal Year",n.directives_scenariodimension_datadimensions_quarter="Quarter",n.directives_scenariodimension_datadimensions_month="Month",n.directives_scenariodimension_datadimensions_week="Week",n.directives_scenariodimension_datadimensions_day="Day",n.directives_scenariodimension_datadimensions_hour="Hour",n.directives_scenariodimension_datadimensions_minute="Minute",n.directives_scenariodimension_datadimensions_second="Second",n.directives_scenariodimension_datadimensions_millisecond="Millisecond",n.spread_pivot_table_subtotal="Total",n.spread_pivot_table_grand_total="Grand Total",n.nullvalue_display="(blank)",n.datetime_quarter_q1="Q1",n.datetime_quarter_q2="Q2",n.datetime_quarter_q3="Q3",n.datetime_quarter_q4="Q4",n.datetime_month_m1="Jan",n.datetime_month_m2="Feb",n.datetime_month_m3="Mar",n.datetime_month_m4="Apr",n.datetime_month_m5="May",n.datetime_month_m6="Jun",n.datetime_month_m7="Jul",n.datetime_month_m8="Aug",n.datetime_month_m9="Sep",n.datetime_month_m10="Oct",n.datetime_month_m11="Nov",n.datetime_month_m12="Dec",n.datetime_year_format="@",n}();n._PivotTableKRSR=s}(Forguncy||(Forguncy={})),function(n){var f=function(){function n(){}return n.InnerID="innerid",n.NeedImplementException="Need Implement.",n.isInListview="isInListview",n.conditionalForeColor="conditionalForeColor",n.FontStyle_Italic="Italic",n.Font_Normal="Normal",n.FontWeight_Bold="Bold",n.RunTimeNormalPage="p",n.RunTimeMasterPage="m",n.DefaultFontSizeInPx=14.67,n}(),i,r,t,u;n.StaticValues=f;i=function(){function n(){}return n.toArray=function(){return[n.CreateBy,n.CreateDate,n.LastModifyBy,n.LastModifyDate,n.Status,n.AssignTo]},n.CreateBy="FGC_Creator",n.CreateDate="FGC_CreateDate",n.LastModifyBy="FGC_LastModifier",n.LastModifyDate="FGC_LastModifyDate",n.AssignTo="FGC_AssignTo",n.Status="FGC_State",n}();n.GUIDColumnName=i;r=function(){function i(){}return i.IsKeyWord=function(n){if(n&&typeof n=="string"){var t=n;if(t===i.PageName||t===i.CurrentUserStr||t.length>i.CurrentUserPrefix.length+1&&t.indexOf(i.CurrentUserPrefix)===0&&t[t.length-1]==="%")return!0}return!1},i.GetKeyWordValue=function(r,u){var s;if(!i.IsKeyWord(r))return r;if(r===i.PageName)return n.PageManager.getDesignerPageName(u,!0);var f=0,e=null,o=!0;switch(r){case i.CurrentUserStr:case i.CurrentUserUserName:f=0;break;case i.CurrentUserEmail:f=2;break;case i.CurrentUserFullName:f=1;break;case i.CurrentUserRole:f=3;break;case i.CurrentUserOrganizationSuperior:f=6;break;default:s=r.length;e=r.substr(i.CurrentUserPrefix.length,s-i.CurrentUserPrefix.length-1);t.isCustomProperty(e)?f=4:t.isOrganizationLevel(e)?f=5:o=!1;break}return o?t.getUserInfo({PropertyType:f,UserProperty:e}):null},i.Null="%Null%",i.CurrentUserStr="%CurrentUser%",i.CurrentUserPrefix="%CurrentUser.",i.CurrentUserEmail="%CurrentUser.Email%",i.CurrentUserFullName="%CurrentUser.FullName%",i.CurrentUserRole="%CurrentUser.Role%",i.CurrentUserUserName="%CurrentUser.UserName%",i.CurrentUserOrganizationSuperior="%CurrentUser.OrganizationSuperior%",i.PageName="%PageName%",i}();n.KeyWords=r;t=function(){function t(){}return t.getUserInfo=function(i){var r=n.ForguncyData.userInfo;switch(i.PropertyType){case 2:return r.Email;case 1:return r.FullName;case 6:return r.OrganizationSuperior;case 3:return r.Role;case 0:return r.UserName;case 4:return t.getCustomPropertyValue(i.UserProperty);case 5:return t.getOrganizationLevelValue(i.UserProperty);default:return null}},t.isCustomProperty=function(t){var r=n.ForguncyData.userInfo,i,u;if(r.Properties)for(i=0;i<r.Properties.length;i++)if(u=r.Properties[i],u.PropertyName===t)return!0;return!1},t.getCustomPropertyValue=function(t){var r=n.ForguncyData.userInfo,i,u;if(r.Properties)for(i=0;i<r.Properties.length;i++)if(u=r.Properties[i],u.PropertyName===t)return u.Value;return null},t.isOrganizationLevel=function(t){var r=n.ForguncyData.userInfo,i,u;if(r.OrganizationLevelValues)for(i=0;i<r.OrganizationLevelValues.length;i++)if(u=r.OrganizationLevelValues[i],u.OrganizationLevelName===t)return!0;return!1},t.getOrganizationLevelValue=function(t){var r=n.ForguncyData.userInfo,i,u;if(r.OrganizationLevelValues)for(i=0;i<r.OrganizationLevelValues.length;i++)if(u=r.OrganizationLevelValues[i],u.OrganizationLevelName===t)return u.Value;return null},t.getUserPropertyValue=function(t,i){if(t.Properties){var r=n.ArrayHelper.firstOrDefault(t.Properties,function(t){return n.Common.IsEmpty(i)||n.Common.IsEmpty(t.PropertyName)?!1:t.PropertyName.toLowerCase()===i.toLowerCase()});return r?r.Value:""}return""},t}();n.UserInfoHelper=t;u=function(){function n(){}return n.WeChartBrowser_CantDownloadFileWarning="\u8bf7\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\u8be5\u7f51\u9875\u540e\u518d\u4e0b\u8f7d\u3002",n}();n.ChineseStaticValues=u}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(){}return t.isValidCompressImageExtension=function(t){if(typeof t!="string"||n.Common.IsEmpty(t))return!1;var i=t.substr(t.lastIndexOf(".")+1).toLowerCase();return i==="gif"?!1:!0},t.getCompressedImageFormData=function(n,t){var u=document.createElement("img");u.src=n.src;var r=document.createElement("canvas"),i=r.getContext("2d"),f=this;u.onload=function(){var o,e,h,s;if(n.width=u.width,n.height=u.height,n.width<=n.maxWidth&&n.height<=n.maxHeight){o=new FormData;o.append("file",n.file);t(o);return}e=f.getCompressImageSize(n);r.width=e.width;r.height=e.height;switch(n.orientation){case 6:r.width=e.height;r.height=e.width;i.rotate(Math.PI/2);i.drawImage(u,0,-e.height,e.width,e.height);break;case 3:i.rotate(Math.PI/1);i.drawImage(u,-e.width,-e.height,e.width,e.height);break;case 8:r.width=e.height;r.height=e.width;i.rotate(270*Math.PI/180);i.drawImage(u,-e.width,0,e.width,e.height);break;case 2:i.translate(e.width,0);i.scale(-1,1);i.drawImage(u,0,0,e.width,e.height);break;case 4:i.translate(e.width,0);i.scale(-1,1);i.rotate(Math.PI/1);i.drawImage(u,-e.width,-e.height,e.width,e.height);break;case 5:r.width=e.height;r.height=e.width;i.translate(e.width,0);i.scale(-1,1);i.rotate(Math.PI/2);i.drawImage(u,0,-e.height,e.width,e.height);break;case 7:r.width=e.height;r.height=e.width;i.translate(e.width,0);i.scale(-1,1);i.rotate(270*Math.PI/180);i.drawImage(u,-e.width,0,e.width,e.height);break;case 1:default:r.width=e.width;r.height=e.height;i.drawImage(u,0,0,e.width,e.height);break}h=r.toDataURL();s=new FormData;s.append("file",f.convertBase64ToFile(h),n.file.name);t(s)}},t.getCompressImageSize=function(t){return n.Common.IsEmpty(t.maxWidth)||n.Common.IsEmpty(t.maxHeight)?t:(t.width>t.maxWidth&&(t.height=t.height*(t.maxWidth/t.width),t.width=t.maxWidth),t.height>t.maxHeight&&(t.width=t.width*(t.maxHeight/t.height),t.height=t.maxHeight),t)},t.convertBase64ToFile=function(n){for(var i=n.split(","),f=i[0].match(/:(.*?);/)[1],r=atob(i[1]),t=r.length,u=new Uint8Array(t);t--;)u[t]=r.charCodeAt(t);return new Blob([u],{type:f})},t}();n.ImageCompressHelper=t}(Forguncy||(Forguncy={})),function(n){var t,f,i,r,u,e,o;typeof String.prototype.endsWith!="function"&&(String.prototype.endsWith=function(n){return this.indexOf(n,this.length-n.length)!==-1});t=jQuery;f=function(){function n(){}return n.dateTimeDefaultFormattingString="yyyy/M/d h:mm:ss",n.timeDefaultFormattingString="h:mm; @",n}();n.StaticFormatString=f;i=function(){function i(){}return i.isForguncyFile=function(n){return/^[0-9a-f]{8}-?[0-9a-f]{4}-?[1-5][0-9a-f]{3}-?[89ab][0-9a-f]{3}-?[0-9a-f]{12}_.+$/i.test(n)},i.enumAllCommandsMetaData=function(n){var t=[],r,u,o,f,e,s;if(n)for(r=0;r<n.length;r++){if(u=n[r],u.$type==="Forguncy.Model.ConditionCommand, Forguncy"&&(o=u,f=o.ConditionAndCommandPairList,f))for(e=0;e<f.length;e++)s=i.enumAllCommandsMetaData(f[e].CommandList),t=t.concat(s);t.push(u)}return t},i.isBindingInfoEquals=function(n,t){return i.IsEmpty(n)||i.IsEmpty(t)?!1:n.TableName===t.TableName&&n.ColumnName===t.ColumnName&&JSON.stringify(n.AttachType)===JSON.stringify(t.AttachType)&&this.isRelationBindinInfoEquals(n.RelationBinding,t.RelationBinding)},i.isRelationBindinInfoEquals=function(n,t){return typeof n=="undefined"&&typeof t=="undefined"?!0:typeof n=="undefined"||typeof t=="undefined"?!1:n.RelatedTable===t.RelatedTable&&n.RelatedColumn===t.RelatedColumn&&n.DisplayColumn===t.DisplayColumn&&this.isRelationBindinInfoEquals(n.NextRelationBinding,t.NextRelationBinding)},i.getBindingInfoColumnName=function(n){for(var i=n.ColumnName,t=n.RelationBinding;t!==undefined&&t!==null;)i=t.DisplayColumn,t=t.NextRelationBinding;return i},i.cannotEditedBindingInfo=function(t){return!t||!t.ColumnName||!t.TableName||t.RelationBinding?!0:t.AttachType?!0:n.GUIDColumnName.toArray().indexOf(t.ColumnName)!==-1?!0:!1},i.getMousePosition=function(n){return n.pageX||n.pageY?{x:n.pageX,y:n.pageY}:{x:n.clientX+document.body.scrollLeft-document.body.clientLeft,y:n.clientY+document.body.scrollTop-document.body.clientTop}},i.GetUrlQuery=function(n){for(var u={},r=window.location.search.substring(1),i=r.split("&"),t=0;t<i.length;t++)if(i[t].indexOf(n)===0)try{return decodeURIComponent(i[t].substring(n.length+1))}catch(f){return null}},i.getIdStr=function(n,t,i){return"r"+n+"c"+t+i},i.parseIDStr=function(n){var t,u,f,r,e;if(!i.IsEmpty(n)&&(t=n.substring(1),u=t.indexOf("c"),!(u<0))&&(f=Number(t.substring(0,u)),!isNaN(f))){for(r=u+1;r<t.length;r++)if(t[r]>"9"||t[r]<"0")break;if(e=Number(t.substring(u+1,r)),!isNaN(e))return{suffix:t.substring(r),row:f,col:e}}},i.back=function(){history.go(n.ForguncyData.enterHistoryCount-history.length-1)},i.openWindow=function(n){var t=window.open(n);t||(window.location.href=window.location.origin+n)},i.trimStr=function(n){var i,t;if(typeof n!="string"||n.length===0)return n;if(n.trim)return n.trim();else{for(i=0;i<n.length;i++)if(n[i]!==" ")break;for(t=n.length-1;t>=0;t--)if(n[t]!==" "){t++;break}return i<n.length&&t>=0&&i<t?n.substring(i,t):""}},i.JsonUrlSwitch=function(n){for(var r,u,f,t,i="",e=0;e<n.length;e++){for(r=n[e],u=!1,f=0;f<this.JsonUrlSwitchKeyWords.length;f++)if(t=this.JsonUrlSwitchKeyWords[f],r===t[0]){i+=t[1];u=!0;break}else if(r===t[1]){i+=t[0];u=!0;break}u||(i+=r)}return i},i.getPageContext=function(){var f,t=n.Common.GetUrlQuery("pageContext"),r,e,u;return(i.IsEmpty(t)&&(((f=n.ForguncyData.GlobalSettings)===null||f===void 0?void 0:f.ReserveUrlQuery)||n.SessionStorageManager.isInIframe||(t=n.SessionStorageManager.pageContext)),t)?(t=this.JsonUrlSwitch(t),JSON.parse(t,i.dateReviver)):(r=n.Common.GetUrlQuery("currentRowInfoList"),r)?(r=decodeURIComponent(r),e=JSON.parse(r),u={},u.currentRowInfoList=e,u.loadBindingDataOption=1,u):null},i.dateReviver=function(n,t){var i;return typeof t=="string"&&(i=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(t),i)?new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],+i[6])):t},i.format=function(n){for(var r,t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.length===0?n:t.length===1&&typeof t[0]=="object"?(r=/{([^{}]+)}/gm,n.replace(r,function(n,i){return t[0][i]})):(r=/{(\d+)}/gm,n.replace(r,function(n,i){return t[~~i]}))},i.initalTimeStamp=function(){return n.ForguncyData.timeStamp=i.getUniqueNumber(),i.postOrder={},n.Common.getTimeStamp()},i.checkTimeStamp=function(t){return t===n.ForguncyData.timeStamp?!0:!1},i.getTimeStamp=function(){return n.ForguncyData.timeStamp},i.forguncyPost=function(r,u,f,e,o,s){var l,c,h;return s===void 0&&(s=!0),l=n.Common.getTimeStamp(),i.IsEmpty(u)==!1&&s&&(u=i.jsonPostData(u)),r=encodeURI(n.ForguncyData.ForguncyRoot+r),c=i.getUniqueNumber(),e&&(i.postOrder[e]=c),h=this.createAjaxSetting(r,u),h.success=function(t,r,u){var o;e&&i.postOrder[e]!==c||n.Common.checkTimeStamp(l)&&((o=f)===null||o===void 0?void 0:o(t,r,u))},h.error=function(t,i,u){var f;(f=o)===null||f===void 0?void 0:f(t,i,u);n.MetadataLoader.loggedError(r,t)},t.ajax(r,h)},i.jsonPostData=function(n){var r,t;if(n=i.adjustDate(n),n!=null&&typeof n=="object")for(r in n)t=n[r],t!=null&&typeof t=="object"&&(n[r]=JSON.stringify(t));return n},i.adjustDate=function(n){if(n instanceof Date)return u.adjustDateWith485Timezone(n);if(n!=null&&typeof n=="object")for(var t in n)n[t]=this.adjustDate(n[t]);return n},i.createAjaxSetting=function(n,t){var r={};return r.type="POST",r.url=n,i.IsEmpty(t)==!1&&(typeof t=="object"&&n&&n.toLowerCase().indexOf("customapi")<0?(r.contentType="application/json",r.data=JSON.stringify(t)):r.data=t),r},i.forguncyPostSync=function(r,u,f,e){var s,o;return e===void 0&&(e=function(){}),s=n.Common.getTimeStamp(),i.IsEmpty(u)==!1&&(u=i.jsonPostData(u)),r=encodeURI(n.ForguncyData.ForguncyRoot+r),o=this.createAjaxSetting(r,u),o.success=function(n,t,i){var r;(r=f)===null||r===void 0?void 0:r(n,t,i)},o.error=function(t,i,u){n.MetadataLoader.loggedError(r,t);e()},o.async=!1,t.ajax(r,o)},i.getColumnIndex=function(n,t){if(i.IsEmpty(n))return-1;var r=i.getColumnIndexByColumnName(n,t);return r===-1&&n[0]==="="&&(r=i.getColumnIndexByFormula(n,t)),r},i.getColumnIndexByColumnName=function(n,t){return t.getColIndexOfNamedColumn(n,!1)},i.getColumnIndexByFormula=function(n,t){var f=i.parseCellReferenceFormulaToCellLocation(n),u,r;return!f||f.length<=0?-1:(u=t.getContentRangeInfo(),r=f[0].Column-u.Column,(r<0||r>=u.Column+u.ColumnCount)&&(r=-1),r)},i.typeContains=function(n,t){if(n){var i=n.$type;return typeof i=="string"&&i.indexOf(t)!==-1}return!1},i.dealWithMultiLineText=function(n,i){var e,r,o,s,u,f;if(i===void 0&&(i=!1),typeof n!="string")return n;if(e=n.replace(/(\r\n|\r)/g,"\n"),i&&(r=e.split("\n"),o=r.length,o>0)){for(s=t("<label/>"),u=r[0],f=1;f<o;f++)u=u.concat("<br/>",s.text(r[f]).html());return u}return e},i.updateFile=function(r,u,f,e,o,s,h,c){var a,l,v;o===void 0&&(o=null);s===void 0&&(s=null);h===void 0&&(h=null);c===void 0&&(c=!1);a=u?"multiple":"";l=t("#FGC_UploadFile_Input");l.length>0&&l.remove();l=t("<input type='file' name='file' ' id='FGC_UploadFile_Input' "+a+"><\/input>");n.Platform.isAndroid()&&n.Platform.isWeChatOrQQBrowser()&&(r=null);l.attr("accept",r);l.hide();l.appendTo("body");c&&l.attr(n.StaticValues.isInListview,!0);v=this;l.on("change",function(){var r,t,u;if(l.val())for(r=l[0],t=0;t<r.files.length;t++)if(u=r.files[t],u.size===0){alert(n.RS.cantAddEmptyFile);return}else h&&h(),i.uploadFileByHTML5(u,function(n){f(n)},e,o,s)});n.ForguncyData.IsAutoTest||l.trigger("click")},i.uploadImage=function(r,u,f,e,o,s){o===void 0&&(o=null);s===void 0&&(s=!1);var h=t("#FGC_UploadImage_Input");h.length>0&&h.remove();h=t("<input type='file' name='file' accept='image/*' id='FGC_UploadImage_Input'><\/input>");h.hide();h.appendTo("body");s&&h.attr(n.StaticValues.isInListview,!0);h.on("change",function(){var c,l,t,a,v,s,p,y;if(h.val()){if(c=h[0],l=c.files.length,l===0)return;if(t=c.files[l-1],u){for(a=u.split(","),v=!1,s=0;s<a.length;s++)if(p=a[s],t.name.trim().toLowerCase().endsWith(p.trim().toLowerCase())){v=!0;break}if(!v){e(i.format(n.RS.uploadFileNotMatchExtension,t.name));return}}if(t.size===0){e(n.RS.cantAddEmptyFile);return}o&&o();!i.IsEmpty(r)&&r.IsCompressImage&&n.ImageCompressHelper.isValidCompressImageExtension(t.name)?EXIF.getData(t,function(){EXIF.getAllTags(this);var o=EXIF.getTag(this,"Orientation"),u=new FileReader;u.onload=function(){var u={src:this.result,file:t,maxWidth:r.MaxWidth,maxHeight:r.MaxHeight,orientation:o};n.ImageCompressHelper.getCompressedImageFormData(u,function(n){i.uploadFileWithAjax(i.uploadImageUrl,n,f,e)})};u.readAsDataURL(t)}):(y=new FormData,y.append("file",t),i.uploadFileWithAjax(i.uploadImageUrl,y,f,e))}});n.ForguncyData.IsAutoTest||h.trigger("click")},i.uploadFileByHTML5=function(t,r,u,f,e){var h,c,o,l,s;if(f===void 0&&(f=null),e===void 0&&(e=null),f){if(f.ExtensionFilter){for(h=f.ExtensionFilter.split(","),c=!1,o=0;o<h.length;o++)if(l=h[o],t.name.trim().toLowerCase().endsWith(l.trim().toLowerCase())){c=!0;break}if(!c){u(i.format(n.RS.uploadFileNotMatchExtension,t.name));return}}if(f.SizeLimit&&f.SizeLimit*1048576<t.size){u(i.format(n.RS.uploadFileBiggerThanMaxSize,t.name,f.SizeLimit));return}}s=new FormData;s.append("file",t);s.append("uploadLimitId",e);i.uploadFileWithAjax(i.uploadUrl,s,r,u)},i.uploadFileWithAjax=function(n,i,r,u){t.ajax({url:n,type:"POST",success:function(n,t,i){r&&r(i.responseText)},error:function(n,t,i){u&&u(i,n)},data:i,cache:!1,contentType:!1,processData:!1,headers:{Accept:"application/json"}})},i.getiframeDocument=function(n){var i=n[0],t=i.contentWindow||i.contentDocument;return t.document&&(t=t.document),t},i.clone=function(n){var i,r,t;if(n===null||typeof n!="object")return n;if(n instanceof Array){i=[];for(t in n)i[t]=this.clone(n[t]);return i}else if(n instanceof Date)return new Date(n.getTime());r={};for(t in n)r[t]=this.clone(n[t]);return r},i.getPageConver=function(t,i){var r=n.Common.getCover(t,i);return r.addClass("fgc-page-cover"),r},i.getCover=function(i,r){var u=t('<div style="filter:alpha(opacity:1);"/>');return u.css("background",n.ColorHelper.Convert(i)),u.css("opacity",r),u.addClass("disableSelect"),u},i.equals=function(n,t){if(n===t)return!0;else if(n instanceof Date&&t instanceof Date)return n.valueOf()===t.valueOf();return!1},i.getA1ReferenceString=function(t,i,r,u){return n.FormulaHelper.unparse(n.FormulaHelper.createCellExpression(null,null,t,i,r,u))},i.parseCellReferenceFormulaToCellLocation=function(t){var u,h,c,i,r,o,s,l;if(!t)return[];var f=[],e=t.split(","),a=e.length;for(u=0;u<a;u++)if(h=void 0,c=e[u].indexOf("!"),h=c>0?e[u].split("!")[1]:e[u],i=n.FormulaHelper.parse(h),i.type===GC.Spread.CalcEngine.ExpressionType.reference)if(r=i.getRange(0,0),n.FormulaHelper.isCellExpression(i))f.push({Row:r.row,Column:r.col,ColumnRelative:i.columnRelative,RowRelative:i.rowRelative});else for(o=r.row;o<r.row+r.rowCount;o++)for(s=r.col;s<r.col+r.colCount;s++)f.push({Row:o,Column:s,ColumnRelative:i.columnRelative,RowRelative:i.rowRelative});else i.type===GC.Spread.CalcEngine.ExpressionType.name&&(l=i,f.push({Name:l.value}));return f},i.returnArrayFormulaItems=function(t){var r,u,i;if(!t)return null;if(u=t.indexOf("!"),r=u>0?t.split("!")[1]:t,i=n.FormulaHelper.parse(r),i.type===GC.Spread.CalcEngine.ExpressionType.array)try{return i.value.array[0]}catch(f){return null}return null},i.parseCellReferenceFormula=function(t,i){for(var u,f=n.Common.parseCellReferenceFormulaToCellLocation(t),e=[],o=f.length,r=0;r<o;r++)u=f[r],e.push(n.Common.getIdStr(u.Row,u.Column,i));return e},i.IsEmpty=function(n){return n===null||n===""||n===undefined?!0:!1},i.isObjEmpty=function(n){if(typeof n!="object")return!1;for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},i.IsString=function(n){return typeof n=="string"?!0:!1},i.getLocatedListview=function(t,i,r){var u=n.ListviewBase.getAllListviews([t]).filter(function(n){var t=n.getContentRangeInfo();return i>=t.Row&&i<t.Row+t.RowCount&&r>=t.Column&&r<t.Column+t.ColumnCount});return u.length>0?u[0]:null},i.AdjustCellRange=function(n){typeof n.Row=="undefined"&&(n.Row=0);typeof n.Column=="undefined"&&(n.Column=0);typeof n.RowCount=="undefined"&&(n.RowCount=0);typeof n.ColumnCount=="undefined"&&(n.ColumnCount=0)},i.GetLastBindingInfoColumnName=function(n){if(!n)return null;var t=n.RelationBinding;if(i.IsEmpty(t))return n.ColumnName;while(!i.IsEmpty(t.NextRelationBinding))t=t.NextRelationBinding;return t.DisplayColumn},i.rgbToHex=function(n,t,i){return"#"+(16777216+(n<<16)+(t<<8)+i).toString(16).slice(1)},i.hexToRgb=function(n){var i=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,t;return n=n.replace(i,function(n,t,i,r){return t+t+i+i+r+r}),t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n),t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},i.isEquals=function(n,t){if(i.IsEmpty(n)||i.IsEmpty(t))return i.IsEmpty(n)&&i.IsEmpty(t);else if(n===!0&&(t===1||t==="1")||t===!0&&(n===1||n==="1")||n===!1&&(t===0||t==="0")||t===!1&&(n===0||n==="0"))return!1;return n==t},i.isQueryEqual=function(t,i){if(n.Common.IsEmpty(t)||n.Common.IsEmpty(i))return!1;try{for(var r in t)if(t[r]!=i[r])return!1}catch(u){return!1}return!0},i.getUniqueNumber=function(){return(new Date).valueOf()},i.isValidateTime=function(n){var t=/^(?:[01]\d|2[0-3]):[0-5]\d(:[0-5]\d(\.\d{3})?)?$/;return t.test(n)?!0:!1},i.isPageContainsTableBinding=function(t,i){if(n.ForguncyData.PageBindingTables){var r=n.ForguncyData.PageBindingTables[t];if(r&&r.length>0)return r.indexOf(i)>=0}return!1},i.htmlEncode=function(n){var t=document.createElement("div"),i=document.createTextNode(n);return t.appendChild(i),t.innerHTML},i.getFileNameFromResponseHeader=function(n){var r="",i=n.getResponseHeader("Content-Disposition"),u,t;return i&&i.indexOf("attachment")!==-1&&(u=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/,t=u.exec(i),t!=null&&t[1]&&(r=decodeURI(t[1].replace(/['"]/g,"")))),r},i.saveFileByBlob=function(n,t){if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(n,t);else{var i=window.document.createElement("a");i.href=window.URL.createObjectURL(n);i.download=t;document.body.appendChild(i);i.click();document.body.removeChild(i)}},i.postInHiddenFormAndDownloadFile=function(n,i,r){var e=this,u,f;r===void 0&&(r=function(){});u=t("<form action = '"+n+"' name='exportForm' method='post'><\/form>");f=t("<input type='hidden' name='exportParam'/>");f.val(JSON.stringify(i));u.append(f);u.submit(function(n){n.preventDefault();var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===XMLHttpRequest.HEADERS_RECEIVED&&i.status===200&&(i.responseType="blob"),i.readyState===XMLHttpRequest.DONE)if(i.status===200){var n=i.response,r=e.getFileNameFromResponseHeader(i);e.saveFileByBlob(n,r)}else t("html").html(i.response)};i.onloadend=r;i.open("post",u.attr("action"),!0);i.setRequestHeader("Content-Type","application/x-www-form-urlencoded");i.send(u.serialize())});u.appendTo("body").submit().remove()},i.GetImeMode=function(n){var t="auto";switch(n.ImeMode){case 1:t="active";break;case 2:t="inActive";break;case 3:t="disabled";break;default:break}return t},i.getElementContentSize=function(n){var t=n.clone(),i;return t.css("display","inline"),t.appendTo("body"),i={width:t.width(),height:t.height()},t.remove(),i},i.isBuiltInDataBaseView=function(t){return n.ForguncyData.pageInfo.ViewInfoList.filter(function(n){return n.ViewName===t}).length===1},i.openTab=function(t){var r=n.PageManager.getContainerCell(t),u;r&&(r.cellType instanceof n.TabControlCellType&&(u=r.cellType,u.showTab(u.getTabIndex(t))),i.openTab(r.runTimePageName))},i.scrollToElement=function(n,t){i.openTab(t);var r=n.parents("#placeHolderDiv");r.length>0?(i._scrollPlaceHolderToElement(n,r),i._scrollWindowToElement(n)):i._scrollWindowToElement(n)},i._scrollWindowToElement=function(r){var c=t(window).width(),l=t(window).height(),u=r[0].getBoundingClientRect(),f=u.top<0||u.bottom>l,e=u.left<0||u.right>c;if(f||e){var o=r.offset(),s=f?o.top-i._scrollBufferDistance:undefined,h=e?o.left-i._scrollBufferDistance:undefined;n.DelayRefresh.NeedDelayRun?t("html, body").animate({scrollTop:s,scrollLeft:h},400):window.scrollTo({top:s,left:h})}},i._scrollPlaceHolderToElement=function(n,t){var f;if(t.css("overflow-x")==="auto"){var r=n.offset(),u=t.offset(),e=t.width(),o=r.left<u.left||r.left>=u.left+e;o&&(f=r.left+t.scrollLeft()-u.left-i._scrollBufferDistance,t.scrollLeft(f))}},i.operateODataPost=function(t,i,r,u,f,e){var o,s,h;f===void 0&&(f=!0);e===void 0&&(e=null);o={};o.ODataString=i;s=function(n){n.Success?r&&(n.Data&&n.Data.$values?r(n.Data.$values):(n.Data===undefined&&(n.Data=null),r(n.Data))):u&&u(n.ErrorMessage)};f?e!=null?(h="GetOData:"+e,n.Common.forguncyPost(t,o,s,h)):n.Common.forguncyPost(t,o,s):n.Common.forguncyPostSync(t,o,s)},i.convertMetaDataDefaultValue=function(t,i){return t=n.KeyWords.GetKeyWordValue(t,i),t===undefined?null:t},i.getRunTimePageNameFromFormulaCalcContext=function(t){if(t)if(i.IsEmpty(t.PageID)){if(t.IsInMasterPage)return n.StaticValues.RunTimeMasterPage}else return t.PageID;return n.StaticValues.RunTimeNormalPage},i.remove=function(n,t){if(!n)return!1;var i=n.indexOf(t);return i>=0?(n.splice(i,1),!0):!1},i.JsonUrlSwitchKeyWords=[["{","A"],['"',"B"],["[","C"],["}","D"],["]","E"],[":","F"],[",","G"]],i.postOrder={},i.uploadUrl=n.ForguncyData.ForguncyRoot+"FileDownloadUpload/Upload",i.uploadImageUrl=n.ForguncyData.ForguncyRoot+"FileDownloadUpload/UploadImage",i.getLowerCaseString=function(n){return n=String(n),n.toLowerCase()},i._scrollBufferDistance=100,i}();n.Common=i;r=function(){function t(){}return t.fromDateToOADate=function(t){return n.SpreadJSHelpMethods._DateTimeHelper.___toOADate(t)},t.fromOADateToDate=function(t){return n.SpreadJSHelpMethods._DateTimeHelper._fromOADate(t)},t}();n.Convertor=r;u=function(){function n(){}return n.getToday=function(){var n=new Date;return n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),n},n.isValidDateValue=function(t){return t instanceof Date?!isNaN(t.valueOf()):typeof t=="number"?n.isValidDateValue(r.fromOADateToDate(t)):!1},n.adjustDateWith485Timezone=function(n){var t=n.getTimezoneOffset();return t===-485?r.fromDateToOADate(n):n},n}();n.DateHelper=u;e=function(){function t(){}return t.isFormatSetted=function(n){return!i.IsEmpty(n)&&n!=="General"},t.format=function(n,t){var r=new GC.Spread.Formatter.GeneralFormatter(n,null),i={},u=r.format(t,i);return{text:u,color:i.conditionalForeColor}},t.getValueFromText=function(n,t){if(t===void 0&&(t=null),typeof n!="string")return n;var i={value:null};try{new GC.Spread.Formatter.GeneralFormatter(t,null).getPreferredDisplayFormatter(n,i)}catch(r){return n}return i.value!==null?i.value:n},t.getTextFromValue=function(n){if(n instanceof Date){var t=new GC.Spread.Formatter.GeneralFormatter("",null),r=t.getPreferredEditingFormatter(n);n=r.format(n,{})}return i.IsEmpty(n)&&(n=""),n},t.formatValue=function(t,r,u){if(n.Common.IsEmpty(t))return"";if(i.IsEmpty(r)&&t instanceof Date&&(r=n.StaticFormatString.dateTimeDefaultFormattingString),i.IsEmpty(r)||typeof r!="string")return t+"";else{var f=new GC.Spread.Formatter.GeneralFormatter(r,null);return f.format(t,u)}},t}();n.FormatHelper=e;o=function(){function t(){}return t.printJavascriptAIPError=function(i,r,u){try{var f=n.Common.format(n.RS.ForguncyApiExceptionString,"ForguncyApiException",i,r,u);throw new Error(f);}catch(e){t.printError(e)}},t.printError=function(i){var f="",u,o,r;if(i instanceof Error){var h=n.ForguncyData.ForguncyRoot+"Resources/JS.js?v=",s=i.stack+"",e="\n";for(s.indexOf("\r\n")>=0&&(e="\r\n"),u=s.split(e),o=[],r=0;r<u.length;r++)u[r].indexOf(h)===-1&&o.push(u[r]);f=o.join(e)}else f=i+"";t.printErrorStr(f)},t.printErrorStr=function(n){console.error(n)},t}();n.ErrorHelper=o}(Forguncy||(Forguncy={})),function(n){var t=function(){function n(){}return n.addCSSRules=function(n){var t=this.getForguncycssStyleSheet();t&&n.forEach(function(n){var i=t.cssRules.length;t.insertRule(n,i)})},n.getForguncycssStyleSheet=function(){var t,n;for(t in document.styleSheets)if(n=document.styleSheets[t].href,n&&(n.indexOf("forguncycss.css")!==-1||n.indexOf("Forguncy.css")!==-1))return document.styleSheets[t];return null},n}(),i;n.CSSHelper=t;i=function(){function i(){}return i.getClassName=function(r){var u,f;return n.Common.IsEmpty(r)?"":(u=i.classPrefix+r.toLowerCase(),this._addedClassList.indexOf(u)===-1&&(f="."+u+"{ color: "+r+" !important}",t.addCSSRules([f]),this._addedClassList.push(u)),u)},i.classPrefix="useFormatColor_",i._addedClassList=["useFormatColor_red"],i}();n.FormatColorClassManager=i}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(){}return t.isRelationCondition=function(t){return!n.Common.IsEmpty(t.Condition1)||!n.Common.IsEmpty(t.Condition2)||!n.Common.IsEmpty(t.RelationType)},t.enumAllConditions=function(n){if(n)if(t.isRelationCondition(n)){var i=[];return i=i.concat(t.enumAllConditions(n.Condition1)),i.concat(t.enumAllConditions(n.Condition2))}else return[n];else return[]},t.getCondtionResult=function(n,i,r){var u=t.handlingConditionValue(n,i,r);return t.excuteConditionResult(u,r)},t.handlingConditionValue=function(i,r,u){var f,e,o,s;if(!i)return i;if(t.isRelationCondition(i))return{Condition1:t.handlingConditionValue(i.Condition1,r,u),Condition2:t.handlingConditionValue(i.Condition2,r,u),RelationType:i.RelationType};else{if(f=n.Common.clone(i),f.value=t.calcValue(f.value,r,u.needUnparseValue2(f)),f.value instanceof Date&&n.DateHelper.isValidDateValue(f.value)){if(e=f.value,t.isDateHaveTimePart(e))return f;if(o=null,s=null,f.compareType)if(f.compareType===1)return o=n.Common.clone(f),s=n.Common.clone(f),o.compareType=4,s.compareType=2,o.value=t.getFirstMomentOfDay(e),s.value=t.getLastMomentOfDay(e),{Condition1:o,Condition2:s,RelationType:1};else f.compareType===2?f.value=t.getLastMomentOfDay(e):f.compareType===3?f.value=t.getFirstMomentOfDay(e):f.compareType===4?f.value=t.getFirstMomentOfDay(e):f.compareType===5&&(f.value=t.getLastMomentOfDay(e));else return o=n.Common.clone(f),s=n.Common.clone(f),o.compareType=3,s.compareType=5,o.value=t.getFirstMomentOfDay(e),s.value=t.getLastMomentOfDay(e),{Condition1:o,Condition2:s,RelationType:0}}return f}},t.calcValue=function(i,r,u){return i=n.ShareCommandParamsContext.Update(i),n.Common.IsEmpty(i)?"":i===t.NullValueKeyWord?null:n.KeyWords.IsKeyWord(i)?n.KeyWords.GetKeyWordValue(i,r.runTimePageName):n.FormulaManager.shouldEvaluateFormula(i)?n.ForguncyData.pageInfo.formulaManager.evaluateFormula(i,r):u?n.FormatHelper.getValueFromText(i):i},t.isDateHaveTimePart=function(n){return n.getHours()!==0||n.getMinutes()!==0||n.getSeconds()!==0||n.getMilliseconds()!==0},t.getLastMomentOfDay=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59,999)},t.getFirstMomentOfDay=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0)},t.excuteConditionResult=function(i,r){var h,c,f,l,s;if(i===null||i===undefined)return!0;if(t.isRelationCondition(i))return h=t.excuteConditionResult(i.Condition1,r),c=t.excuteConditionResult(i.Condition2,r),i.RelationType?h||c:h&&c;else{var u=i,e=u.value,o=r.calc(u);if(!u.compareType||u.compareType<6)return t.getNonStringCompareResult(o,u.compareType,e);else if(u.compareType===12||u.compareType===13){if(f=void 0,n.Common.IsString(e))for(f=!1,l=e.split(",").filter(function(n){return n!=""}),s=0;s<l.length;s++)f=f||t.getNonStringCompareResult(o,0,l[s]);else f=t.getNonStringCompareResult(o,0,e);return u.compareType===12?f:!f}else return t.getStringCompareResult(o,u.compareType,e)}},t.getStringCompareResult=function(n,t,i){var u,f,r;if(n===null||n===undefined||i===null||i===undefined)return!1;if(u=n.toString(),f=i.toString(),t===6)return u.indexOf(f)===0;else if(t===7)return u.indexOf(f)!==0;else if(t===8)return r=u.lastIndexOf(f),r>=0&&r+f.length===u.length;else if(t===9)return r=u.lastIndexOf(f),!(r>=0&&r+f.length===u.length);else if(t===10)return r=u.lastIndexOf(f),r!==-1;else if(t===11)return r=u.lastIndexOf(f),r===-1;return!1},t.getNonStringCompareResult=function(i,r,u){if(typeof u=="number"&&typeof i=="string"){var f=Number(i);isNaN(f)||(i=f)}if(i instanceof Date&&(i=n.Convertor.fromDateToOADate(i)),u instanceof Date&&(u=n.Convertor.fromDateToOADate(u)),r){if(r===1)return t.ExceptedValueAndParamValueEmptyEquals(u,i)?!1:i!=u;else if(r===2)return i>u;else if(r===3)return i>=u;else if(r===4)return i<u;else if(r===5)return i<=u}else return t.ExceptedValueAndParamValueEmptyEquals(u,i)?!0:i==u;return!1},t.getComputedSqlConditionFormula=function(i,r,u,f,e,o){if(f===void 0&&(f=0),e===void 0&&(e=0),o===void 0&&(o=null),!i)return null;var h={runTimePageName:r,supportReferToListview:!0,nullAsException:!0,listInfo:o,rowOffset:f,columnOffset:e},s=n.Common.clone(i);return t.computeSqlConditionFormula(s,h,u),s},t.computeSqlConditionFormula=function(i,r,u){var e,f;if(typeof i=="undefined"||i===null)return null;e=i;t.computeSqlConditionFormula(e.Condition1,r,u);t.computeSqlConditionFormula(e.Condition2,r,u);f=i;f.Value!==null&&(f.Value=n.ShareCommandParamsContext.Update(f.Value),(""+f.Value).search("=")===0&&(f.Value=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(f.Value,r),n.Common.IsEmpty(f.Value)&&u===n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull&&(f.Value="D212D897-53A6-4450-BBC3-9EB6523B527F")))},t.NullValueKeyWord="%Null%",t.ExceptedValueAndParamValueEmptyEquals=function(t,i){return n.Common.IsEmpty(t)&&n.Common.IsEmpty(i)?!0:!1},t}();n.ConditionHelper=t}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(){}return t.addDependenceCellValueChangeHandler=function(i,r,u){var f,o,e;i&&(f=!1,o=function(e,o){i.every(function(i,e,s){var h=t.needRefresh(o,i,u);return h?f?void 0:(f=!0,n.DelayOperateHelper.Push(null,function(){f=!1;r(o.arg.uiAction)},1),!1):!0})},n.ForguncyData.pageInfo.dataModel.bind(n.Events.ValueChanged,o),e=n.ForguncyData.pageInfo.dependenceCellValueChangedEventHandlers,e[u]||(e[u]=[]),e[u].push(o))},t.destoryRunTimePage=function(t){t.forEach(function(t){var i=n.ForguncyData.pageInfo.dependenceCellValueChangedEventHandlers,r=i[t];r&&(delete i[t],r.forEach(function(t){return n.ForguncyData.pageInfo.dataModel.unbind(n.Events.ValueChanged,t)}))})},t.needRefresh=function(n,i,r){return typeof i=="string"?t.needRefreshCellName(n,i):t.needRefreshCellRange(n,i,r)},t.needRefreshCellName=function(t,i){if(!n.Common.IsEmpty(t.calcName))return!1;var u=t.arg,r=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(u.id);return r&&r.lowerCaseName?r.lowerCaseName.indexOf(i.toLowerCase())>=0:!1},t.needRefreshCellRange=function(i,r,u){var f=t.getLocatedListviewCalcName(r,u);return n.Common.IsEmpty(i.calcName)&&n.Common.IsEmpty(f)?t.needRefreshNormalCellRange(i.arg,r,u):i.calcName===f?t.needRefreshListviewCellRange(f,i.arg,r):!1},t.needRefreshNormalCellRange=function(t,i,r){var u=n.Common.parseIDStr(t.id);return u.suffix===r&&(u.row>=i.Row&&u.row<i.Row+i.RowCount||i.Row===-1||i.RowCount===-1)&&(u.col>=i.Column&&u.col<i.Column+i.ColumnCount||i.Column===-1||i.ColumnCount===-1)},t.needRefreshListviewCellRange=function(t,i,r){if(i.cellRange.Column===-1||i.cellRange.ColumnCount===-1||r.Column===-1||r.ColumnCount===-1)return!0;var f=n.ListviewBase.getListviewByCalcSheetName(t),u=r.Column-f.getContentRangeInfo().Column;return!(u+r.ColumnCount<=i.cellRange.Column||i.cellRange.Column+i.cellRange.ColumnCount<=u)},t.getLocatedListviewCalcName=function(t,i){for(var r,e,u=null,f=t.Row;f<t.Row+t.RowCount;f++)for(r=t.Column;r<t.Column+t.ColumnCount;r++)if(e=n.Common.getLocatedListview(i,f,r),f===t.Row&&r===t.Column)u=e;else if(e!==u)return null;return u===null?null:u.getCalcSheetName()},t}();n.DependenceCellValueChangeHelper=t}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(){}return t.register=function(t,i,r){r===void 0&&(r=!0);var u="opacity",e=t.css(u),s="0.5",f="background-color",o=t.css(f),h="gray";t.on("drop",function(s){for(var h,a,l=event.dataTransfer.files,c=0;c<l.length;c++){if(h=l[c],h&&h.size===0){alert(n.RS.cantAddEmptyFile);continue}if(a=i(h),!a)break;if(!r)break}return t.css(u,e),t.css(f,o),!1});t.on("dragenter",function(){t.css(u,s);t.css(f,h)});t.on("dragleave",function(){t.css(u,e);t.css(f,o)});t.on("dragover",function(n){return!1},!1)},t.unRegister=function(n){n.off("drop");n.off("dragenter");n.off("dragleave");n.off("dragover")},t}();n.DragFileToUploadHelper=t}(Forguncy||(Forguncy={})),function(n){var i=null,t=function(){function t(){}return t.isChrome=function(){return!this.isOldEdge()&&navigator.userAgent.indexOf("Chrome/")!==-1},t.isOldEdge=function(){return navigator.userAgent.indexOf("Edge/")!==-1},t.isEdge=function(){return navigator.userAgent.indexOf("Edg/")!==-1},t.isIpad=function(){return navigator.userAgent.toLowerCase().indexOf("ipad")!==-1||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1},t.isIOSDevice=function(){return/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1},t.isMac=function(){return new RegExp("Mac").test(navigator.userAgent)},t.isIE=function(){return!!window.ActiveXObject||"ActiveXObject"in window?!0:!1},t.isMobile=function(){return n.ForguncyData.forceMobileChild?!0:(i===null&&(i=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))),i)},t.isAndroid=function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("android")>-1||n.indexOf("adr")>-1},t.isQqBrowser=function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("qqbrowser")>-1},t.isWechatBrowser=function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("micromessenger")>-1},t.isWeChatOrQQBrowser=function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("micromessenger")>-1||n.indexOf("qqbrowser")>-1},t.getBrowserScrollbarWidth=function(){var n=document.createElement("div"),t;return n.className="scrollbar-measure",document.body.appendChild(n),t=n.offsetWidth-n.clientWidth,document.body.removeChild(n),t},t}(),r;n.Platform=t;(t.isAndroid()&&t.isQqBrowser()||t.isIE())&&(r=String.prototype.localeCompare,String.prototype.localeCompare=function(n,t){return r.apply(this,[n])})}(Forguncy||(Forguncy={})),function(n){var t=function(){function n(){}return n.init=function(){n._operationList=[]},n.Push=function(t,i,u){var e=new r,f;e.obj=t;e.functions={f:i};f=n.getPriority(u);n._operationList[f]||(n._operationList[f]=[]);n._operationList[f].push(e);n.doOperation()},n.getPriority=function(n){switch(n){case 0:return 0;default:return 1}},n.doOperation=function(){i.setTimeout(function(){if(n.haveNoActiveAjaxCall()){var t=n.getNextOperation();if(t)t.functions.f.apply(t.obj);else return}n.doOperation()})},n.getNextOperation=function(){for(var t=n._operationList.length-1;t>=0;t--)if(n._operationList[t]&&n._operationList[t].length>0)return n._operationList[t].shift();return null},n.haveNoActiveAjaxCall=function(){return jQuery.active===0},n}(),i,r;n.DelayOperateHelper=t;i=function(){function n(){}return n.Init=function(){n._refreshing=!1;n._objectMethods=[]},n.Push=function(t,i,r,u){var o,f,e;for(u===void 0&&(u=!1),o=!1,f=0;f<n._objectMethods.length;f++)if(n._objectMethods[f].obj===t){n._objectMethods[f].functions[r]=i;o=!0;break}o===!1&&(e={obj:t,functions:{}},e.functions[r]=i,u?n._objectMethods=[e].concat(n._objectMethods):n._objectMethods.push(e));n.Refresh()},n.Refresh=function(){n._refreshing||(n._refreshing=!0,n.DelayRun())},n.DelayRun=function(){if(!n.NeedDelayRun||n._isUnitTest){t.haveNoActiveAjaxCall()?n.RunNow():n.setTimeout(function(){n.DelayRun()},0);return}n.setTimeout(function(){t.haveNoActiveAjaxCall()?n.RunNow():n.DelayRun()},50)},n.DisableDelayRun=function(){n.NeedDelayRun=!1;n.DelayRun()},n.HasDelayRunItem=function(){return n._refreshing===!0||n._objectMethods&&n._objectMethods.length!=0},n.RunNow=function(){try{while(n.HasDelayRunItem())n.Run()}finally{n._refreshing=!1}},n.Run=function(){var r=n._objectMethods,t,i,u;for(n._objectMethods=[],n._refreshing=!1,t=0;t<r.length;t++){i=r[t];for(u in i.functions)i.functions[u].apply(i.obj)}},n.setTimeout=function(t,i){return n._executingSetTimeoutCount++,setTimeout(function(){t();n._executingSetTimeoutCount--},i)},n.clearTimeout=function(t){clearTimeout(t);n._executingSetTimeoutCount--},n.HasExecutingSetTimeout=function(){return n._executingSetTimeoutCount>0},n._objectMethods=[],n._refreshing=!1,n.NeedDelayRun=!0,n._executingSetTimeoutCount=0,n._isUnitTest=!1,n}();n.DelayRefresh=i;r=function(){function n(){}return n}()}(Forguncy||(Forguncy={})),function(n){var t=function(){function n(){}return n.firstOrDefault=function(n,t){for(var i=0;i<n.length;i++)if(t(n[i]))return n[i];return null},n}();n.ArrayHelper=t}(Forguncy||(Forguncy={})),function(n){var i=function(){function n(){}return n.Convert=function(n){var t;if(n&&this.ColorCache[n])return this.ColorCache[n];if(t=n,this.IsThemeColor(n)?t=this.GetThemeColor(n):this.IsGradient(n)&&(t=this.GetGradient(n)),t&&t.charAt(0)=="#"&&t.length==9)if(t.indexOf("#FF")===0)t="#"+t.substring(3);else{var i=parseInt(t.substring(1,3),16),r=parseInt(t.substring(3,5),16),u=parseInt(t.substring(5,7),16),f=parseInt(t.substring(7,9),16);t="rgba("+r+","+u+","+f+","+(i/255).toFixed(2)+")"}return n&&(this.ColorCache[n]=t),t},n.ConvertBorder=function(n){return this.ReplaceCombineCssColor(n)},n.ConvertShadow=function(n){return this.ReplaceCombineCssColor(n)},n.ReplaceCombineCssColor=function(t){var i=/((Background|Text)_[12]|Accent_[123456])(_-?[\.\d]{1,3}(_\d{1,3})?)?|#[a-fA-F0-9]+/g;return t.replace(i,function(t){return n.Convert(t.replace(/_/g," "))})},n.IsGradient=function(n){return n?n.indexOf("linear-gradient")==0||n.indexOf("radial-gradient")==0:!1},n.GetGradient=function(n){return this.ReplaceCombineCssColor(n)},n.GetThemeColor=function(t){var r,i,u,f,e;return t?(r=-1,i=t.split(" "),i!=null&&(i.length>1&&(i[0]=="Background"?(u=Number(i[1]),r=u-1):i[0]=="Text"?(u=Number(i[1]),r=u+1):i[0]=="Accent"&&(u=Number(i[1]),r=u+3)),f=0,i.length>2&&(f=Number(i[2])),e=255,i.length>3&&(e=Number(i[3])),r>-1))?n.UpdateTint(this.Convert(this.Colors[r]),f/100,e):"":""},n.UpdateTint=function(n,t,i){var r,f,o,u,e;return t==0&&i==255?n:(r=this._getHLSColor(n),t>0?(o=240-r._luminosity,u=o*t,f=r._luminosity+u):(u=r._luminosity*-t,f=r._luminosity-u),e=this._fromHLS(r._hue,f,r._saturation),e.a=i,this._toString(e))},n.IsThemeColor=function(n){var t,i;if(!n)return!1;t=this.ThemeColorPrefix;for(i in t)if(n.indexOf(t[i])==0)return!0;return!1},n._toHexString=function(n){var t=n.toString(16);return t.length%2&&(t="0"+t),t},n.Colors=["#FFFFFF","#000000","#EEECE1","#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646"],n.ThemeColorPrefix=["Background 1","Text 1","Background 2","Text 2","Accent 1","Accent 2","Accent 3","Accent 4","Accent 5","Accent 6"],n.ColorCache={},n._toString=function(n){var t=n.a,i=n.r,r=n.g,u=n.b;return(arguments.length===3&&(t=255,i=arguments[0],r=arguments[1],u=arguments[2]),arguments.length===4&&(t=arguments[0],i=arguments[1],r=arguments[2],u=arguments[3]),t===255)?"#"+this._toHexString(i,!0,2)+this._toHexString(r,!0,2)+this._toHexString(u,!0,2):"rgba("+i+","+r+","+u+","+t/255+")"},n._hueToRGB=function(n,t,i){return(i<0&&(i+=240),i>240&&(i-=240),i<40)?n+((t-n)*i+20)/40:i<120?t:i<160?n+((t-n)*(160-i)+20)/40:n},n.saturate=function(n,t,i){return Math.min(parseInt(((this._hueToRGB(n,t,i)*255+120)/240).toString()),255)},n._fromHLS=function(n,t,i){var f,e,o,u,r;return i===0?f=e=o=parseInt((t*255/240).toString(),10):(u=void 0,r=void 0,r=t<=120?parseInt(((t*(240+i)+120)/240).toString()):t+i-parseInt(((t*i+120)/240).toString()),u=2*t-r,f=this.saturate(u,r,n+80),e=this.saturate(u,r,n),o=this.saturate(u,r,n-80)),{a:255,r:f,g:e,b:o}},n.stringToARGB=function(n){var t=this._ctx,i,r;return(t||(i=document.createElement("canvas"),i&&i.getContext&&(t=this._ctx=i.getContext("2d"))),!t)?n:(t.clearRect(1,1,1,1),t.fillStyle=n,t.fillRect(1,1,1,1),r=t.getImageData(1,1,1,1),r)?r.data:null},n._fromString=function(n){var i=0,r=0,u=0,f=0,t;return n&&(t=this.stringToARGB(n),t&&(r=t[0],u=t[1],f=t[2],i=t[3])),{a:i,r:r,g:u,b:f}},n._getHLSColor=function(n){var i=this._fromString(n);return new t(i)},n}(),t;n.ColorHelper=i;t=function(){function n(n){var t=this,f=n.r,e=n.g,o=n.b,r=Math.max(Math.max(f,e),o),s=Math.min(Math.min(f,e),o),u=r+s,i;if(t._luminosity=parseInt(((u*240+255)/510).toString(),10),i=r-s,i===0)t._saturation=0,t._hue=160;else{t._saturation=t._luminosity<=120?parseInt(((i*240+u/2)/u).toString(),10):parseInt(((i*240+(510-u)/2)/(510-u)).toString(),10);var h=((r-f)*40+i/2)/i,c=((r-e)*40+i/2)/i,l=((r-o)*40+i/2)/i;t._hue=f===r?parseInt((l-c).toString(),10):e===r?parseInt((80+h-l).toString(),10):parseInt((160+c-h).toString(),10);t._hue<0&&(t._hue+=240);t._hue>240&&(t._hue-=240)}}return n}()}(Forguncy||(Forguncy={})),function(n){var u=function(){function n(n){this.ruleArr=n}return n.prototype.FeedStyle=function(n,t){this.ruleArr.push(n+":"+t+";")},n.prototype.Digest=function(){this.resultString="{ "+this.ruleArr.join("")+" }"},n.prototype.GetResultString=function(){return this.Digest(),this.resultString},n}(),r;n.NormalStyleFeeder=u;var i=function(){function n(n){this.Dom=n}return n.prototype.FeedStyle=function(n,t){this.Dom.css(n,t)},n.prototype.Digest=function(){},n}(),f=function(){function t(n,t,i){this.styleArr=t;this.className=i;this.Dom=n}return t.prototype.FeedStyle=function(n,t){this.styleArr.push(n+":"+t+";")},t.prototype.Digest=function(){var t="."+this.className+" { "+this.styleArr.join("")+" }";n.CellTypeStyleTemplateUtils.AddCSSTextToDocument(t,this.className);this.Dom.addClass(this.className)},t}(),t=function(){function t(){}return t.setPropertyToDom=function(n,i,r,u){t._init();for(var f=0;f<u.length;f++)t.funcs[u[f]](n,i,r)},t.setPropertyToClass=function(n,i,r,u){t._initClassMethods();for(var f=0;f<u.length;f++)t.classMethods[u[f]](n,i,r);i.Digest()},t.addCustomCommand=function(t,i,r,u){t.css("cursor","pointer");t.on(n.Events.Click,function(){return u.isEnabled&&n.ForguncyData.commandExcutor.excuteCommand(i,u.runTimePageName,u,r,n.Events.Click),!1})},t.createJqueryDomElement=function(n){return $("<"+n+"/>")},t.createAlignmentContainer=function(n,i,r,u){n.addClass("fgc-align__inner");n.addClass(t.getHorizontalAlignmentClass(i));n.addClass(t.getVerticalAlignmentClass(r));u&&n.css("max-height",u);var f=t.createJqueryDomElement("div");return f.addClass("fgc-align"),f.append(n),f},t.createGridContainer=function(t){var i=this.createGridContainerInternal().addClass("fgc-grid"),r=this.repeat("1fr ",t);return i.css("grid-template-columns",r),n.Platform.isIE()&&(i.css("-ms-grid-column",t),i.css("-ms-grid-columns",r)),i},t.setGridRowAndColumn=function(n,t,i){var r=Math.floor(i/t+1).toString(),u=(i%t+1).toString();n[0].style.gridRow=r;n[0].style.gridColumn=u;n[0].style.msGridRow=r;n[0].style.msGridColumn=u},t.repeat=function(n,t){for(var i="",r=0;r<t;r++)i+=n;return i},t.createGridContainerEx=function(t,i){var f,e,r,u,o,s;return t&&(f=t.join(" ")),i&&(e=i.join(" ")),r=this.createGridContainerInternal(),u=n.Platform.isIE(),e?(o=u?"-ms-grid-columns":"grid-template-columns",r.css(o,e)):u?r.css("-ms-grid-columns","1fr"):r.css("grid-template-columns","100%"),f?(s=u?"-ms-grid-rows":"grid-template-rows",r.css(s,f)):u?r.css("-ms-grid-rows","1fr"):r.css("grid-template-rows","100%"),r},t.setGridItemPos=function(t,i,r,u,f){u===void 0&&(u=1);f===void 0&&(f=1);var e=n.Platform.isIE();e?(t.css("-ms-grid-column",r+""),t.css("-ms-grid-row",i+""),u>1&&t.css("-ms-grid-column-span",u),f>1&&t.css("-ms-grid-row-span",f)):(t.css("grid-column-start",r+""),t.css("grid-row-start",i+""),u>1&&t.css("grid-row-end",i+u),f>1&&t.css("grid-column-end",r+f))},t.createGridContainerInternal=function(){var t=this.createJqueryDomElement("div"),i=n.Platform.isIE(),r=i?"-ms-grid":"grid";return t.css("display",r),t},t.createDropDownListForFormUser=function(i,r,u){var o=t.createContainerDiv(),e=t.createContainerDiv(),f,s,h,c;return e.append(r),e.attr("data-toggle","_dropdown"),e.attr("id",u.ID+"_dropdown"),o.append(e),f=t.createJqueryDomElement("ul"),i.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Right?f.attr("class","dropdown-menu pull-right"):f.attr("class","dropdown-menu"),f.attr("role","menu"),n.ForguncyData.AuthenticationType===3&&(s=$("<li><a style='text-decoration:none' href='#' id = 'FGX_ChangeProfile' ignoreInMoveFocus='true'>"+n.RS.CurrentUserCell_ChangeProfile+"<\/a><\/li>"),t.createNavigateCommand(s,n.BuiltInPageManager.builtInPages[n.BuiltInPageType.ChangeUserSettings],"FGX_ChangeProfile",u),f.append(s),h=$("<li><a style='text-decoration:none' href='#' id = 'FGX_ChangePassword' ignoreInMoveFocus='true'>"+n.RS.CurrentUserCell_ChangePassword+"<\/a><\/li>"),t.createNavigateCommand(h,n.BuiltInPageManager.builtInPages[n.BuiltInPageType.ChangePassword],"FGX_ChangePassword",u),f.append(h)),c=u.cellTypeData.metaData&&u.cellTypeData.metaData.NavigateToHomePageWhenLogout?$("<li><a style='text-decoration:none' href='#' forguncyattr='LogoutAndNavigateToHomePage' ignoreInMoveFocus='true'>"+n.RS.CurrentUserCell_Logout+"<\/a><\/li>"):$("<li><a style='text-decoration:none' href='#' forguncyattr='Logout' ignoreInMoveFocus='true'>"+n.RS.CurrentUserCell_Logout+"<\/a><\/li>"),f.append(c),n.Platform.isMobile()&&f.find("a").css("padding-top",10).css("padding-bottom",10),o.append(f),o},t.createNavigateCommand=function(i,r,u,f){var e=[{$type:n.CommandTypeStr.NavigateCommand,PageName:r,navigateType:"normal"}];t.addCustomCommand(i,e,u,f)},t.createContainerDiv=function(){var n=t.createJqueryDomElement("div");return n.addClass("fgc-container"),n},t.createLoadingIndicator=function(){var i=t.createContainerDiv().addClass("indicator").css("display","none").css("top",0),r=t.createContainerDiv().css("background-color","gray").css("opacity",.2).css("top",0),u=t.createContainerDiv().css("background-repeat","no-repeat").css("background-position","center").css("background-image",'url("'+n.ForguncyData.ForguncyRoot+'Resources/Images/SiteBuiltInImages/loading.gif")').css("top",0);return i.append(r),i.append(u),i},t._init=function(){t.inited||(t.funcs[0]=t._initalFont,t.funcs[1]=t._initalIndent,t.funcs[3]=t._initalCommand,t.funcs[4]=t._initalFormatString,t.funcs[2]=t._initalId,t.funcs[5]=t._initalForguncyAttribute,t.funcs[6]=t._initWaterMark,t.inited=!0)},t._initClassMethods=function(){t.classMethodsInited||(t.classMethods[0]=t._initalFontClass,t.classMethods[1]=t._initalIndentClass,t.classMethods[3]=t._initalCommandClass,t.classMethods[4]=t._initalFormatStringClass,t.classMethods[2]=t._initalIdClass,t.classMethods[5]=t._initalForguncyAttributeClass,t.classMethods[6]=t._initWaterMarkClass,t.classMethodsInited=!0)},t._initalFontClass=function(n,i,r){t.setFontStyleClass(n.StyleInfo,i)},t._initalFont=function(n,i,r){t.setFontStyle(n.StyleInfo,i)},t.setFontStyle=function(n,r){var u=new i(r);t.setFontStyleClass(n,u)},t._initalIndent=function(n,r,u){var f=new i(r);t._initalIndentClass(n,f,u)},t._initalFormatString=function(n,r,u){var f=new i(r);t._initalFormatStringClass(n,f,u)},t._initalCommand=function(n,r,u){var f=new i(r);t._initalCommandClass(n,f,u)},t._initalForguncyAttribute=function(n,r,u){var f=new i(r);t._initalForguncyAttributeClass(n,f,u)},t._initalId=function(n,t,i){t.attr("id",i.id);t.attr("name",i.id)},t._initWaterMark=function(n,r,u){var f=new i(r);t._initWaterMarkClass(n,f,u)},t.getFontFamily=function(t){return t&&!n.Common.IsEmpty(t.FontFamily)?t.FontFamily:n.LocaleFonts.default?n.LocaleFonts.default:null},t.setFontStyleClass=function(i,r,u){if(u===void 0&&(u=!0),i&&(!u||r.Dom)){var f=t.getFontFamily(i);f&&r.FeedStyle("font-family",'"'+f+'"');i.FontSize!==-1&&(isNaN(i.FontSize)?r.FeedStyle("font-size",i.FontSize):r.FeedStyle("font-size",i.FontSize+"px"));r.FeedStyle("color",n.ColorHelper.Convert(i.Foreground));i.WordWrap?(r.FeedStyle("word-wrap","break-word"),r.FeedStyle("word-break","break-word"),r.FeedStyle("white-space","pre-wrap")):r.FeedStyle("white-space","pre");n.Common.IsEmpty(i.Underline)&&n.Common.IsEmpty(i.Strikethrough)?r.FeedStyle("text-decoration","none"):i.Underline&&i.Strikethrough?r.FeedStyle("text-decoration","underline line-through"):i.Underline?r.FeedStyle("text-decoration","underline"):i.Strikethrough?r.FeedStyle("text-decoration","line-through"):r.FeedStyle("text-decoration","none");n.Common.IsEmpty(i.FontWeight)?r.FeedStyle("font-weight",""):r.FeedStyle("font-weight",t.getFontWeightText(i.FontWeight));n.Common.IsEmpty(i.FontStyle)?r.FeedStyle("font-style",""):r.FeedStyle("font-style",t.getFontStlyeText(i.FontStyle))}},t._initalIndentClass=function(n,i,r){var u=n.StyleInfo;u&&t.setTextIndent(u,i)},t.setTextIndent=function(t,i){t.TextIndent&&(t.HorizontalAlignment===n.CellHorizontalAlignment.Left?i.FeedStyle("padding-left",t.TextIndent):t.HorizontalAlignment===n.CellHorizontalAlignment.Right&&i.FeedStyle("padding-right",t.TextIndent))},t._initalFormatStringClass=function(n,t,i){var r=n.StyleInfo;r&&typeof r.Formatter!="undefined"&&t.Dom.attr("formatString",r.Formatter)},t._initalCommandClass=function(n,t,i){n.CellType&&n.CellType.CommandList&&t.FeedStyle("cursor","pointer")},t._initalForguncyAttributeClass=function(n,t,i){!i.isInListview&&n.CellType&&n.CellType.ForguncyAttribute&&t.Dom.attr("forguncyattr",n.CellType.ForguncyAttribute)},t._initalIdClass=function(n,t,i){t.Dom.attr("id",i.id);t.Dom.attr("name",i.id)},t._initWaterMarkClass=function(t,i,r){t&&t.CellType&&!n.Common.IsEmpty(t.CellType.WaterMark)&&i.Dom.attr("placeholder",t.CellType.WaterMark)},t.getHorizontalAlignmentText=function(t){switch(t){case n.CellHorizontalAlignment.Left:return"left";case n.CellHorizontalAlignment.Center:return"center";case n.CellHorizontalAlignment.Right:default:return"right"}},t.getHorizontalAlignmentClass=function(t){switch(t){case n.CellHorizontalAlignment.Left:return"fgc-textalign-left";case n.CellHorizontalAlignment.Center:return"fgc-textalign-center";case n.CellHorizontalAlignment.Right:default:return"fgc-textalign-right"}},t.getVerticalAlignmentText=function(t){switch(t){case n.CellVerticalAlignment.Top:return"top";case n.CellVerticalAlignment.Center:return"middle";case n.CellVerticalAlignment.Bottom:default:return"bottom"}},t.getVerticalAlignmentClass=function(t){switch(t){case n.CellVerticalAlignment.Top:return"fgc-verticalalign-top";case n.CellVerticalAlignment.Center:return"fgc-verticalalign-middle";case n.CellVerticalAlignment.Bottom:default:return"fgc-verticalalign-bottom"}},t.getFontStlyeText=function(t){return n.Common.IsEmpty(t)?"":t.toLowerCase()},t.getFontWeightText=function(t){return n.Common.IsEmpty(t)?"":t.toLowerCase()},t.setContainerOverFlow=function(t,i){t.css("overflow",i);(i==="scroll"||i==="auto")&&n.Platform.isIOSDevice()&&t.css("-webkit-overflow-scrolling","touch")},t.appleSimpleBar=function(t){return n.Platform.isMobile()?null:new SimpleBar(t[0])},t.funcs={},t.classMethods={},t.inited=!1,t.classMethodsInited=!1,t}();n.DomUtilities=t;r=function(){function i(){}return i.createTextElement=function(i,r,u,f,e,o){var s,c,h;return(f===void 0&&(f=!0),e===void 0&&(e=!0),o===void 0&&(o=!1),s=[1,4,2,3],o||s.push(0),t.setPropertyToDom(i,r,u,s),r.addClass("fgc-whitespace-pre"),e&&i.Value!==undefined&&i.Value!==null&&(c=n.Common.dealWithMultiLineText(i.Value),r.append(document.createTextNode(c))),n.Common.typeContains(i.CellType,"HyperlinkCellType")&&(i.RightOverflowSpace>0||i.LeftOverflowSpace>0)||r.css("display","block"),f)?(h=t.createJqueryDomElement("div"),h.append(r),t.createAlignmentContainer(h,i.StyleInfo.HorizontalAlignment,i.StyleInfo.VerticalAlignment,i.Height)):r},i.createCantSelectLabel=function(){return $("<label style='-moz-user-select: none; -webkit-user-select: none; -ms-user-select:none; user-select:none;' unselectable='on' onselectstart='return false;' onmousedown='return false;'><\/label>")},i.createControlContainer=function(){var n=t.createJqueryDomElement("div");return n.css("width","100%"),n.css("height","100%"),n},i.initalInputBox=function(i,r,u){r.addClass("fgc-inputbox");i.StyleInfo.Background&&r.css("background-color",n.ColorHelper.Convert(i.StyleInfo.Background));var f=[0,2,5,6];t.setPropertyToDom(i,r,u,f)},i.GenerateInputClassName=function(){var n=(new Date).getTime()+"_"+Math.floor(Math.random()*1e3);return"input_"+n},i.initalInputBoxWithClassName=function(n,r,u){var h=i.GenerateInputClassName(),e=[],o,s;e.push("border:none;");e.push("padding:2px;");e.push("width:100%;");e.push("height:100%;");e.push("position:inherit;");e.push("box-sizing:border-box;");n.StyleInfo.Background&&e.push("background-color:"+n.StyleInfo.Background);o=[0,2,5,6];s=new f(r,e,h);t.setPropertyToClass(n,s,u,o)},i.AllInputClassName={},i}();n.CellDomCreateHelper=r}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(){}return Object.defineProperty(t,"emptyImageUrl",{get:function(){return n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/no_image.png"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"emptyUploadImageUrl",{get:function(){return n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/upload_no_image.png"},enumerable:!0,configurable:!0}),t.encodeImageUrl=function(t){if(!n.Common.IsEmpty(t)&&typeof t=="string"&&!this.isBase64StringUrl(t)){var r=t.lastIndexOf("/"),i=t.lastIndexOf("?"),u=t.slice(0,r===-1?0:r+1),f=t.slice(r+1,i===-1?undefined:i),e=i===-1?"":t.slice(i);return u+encodeURIComponent(f)+e}return t},t.encodeImageUrlAndUpdateQuery=function(t,r,u){if(!n.Common.IsEmpty(t)&&typeof t=="string"){var o=n.ForguncyData.ForguncyRoot+"Upload/",s=t.toString().indexOf(o)===0,e=t.lastIndexOf("/"),f=t.lastIndexOf("?"),h=t.slice(0,e===-1?0:e+1),c=t.slice(e+1,f===-1?undefined:f),l=f===-1?"":t.slice(f),a=s?i.getImageQueryString(r,u):l;return h+encodeURIComponent(c)+a}return t},t.getImageSrcFromCellContentElement=function(i,r,u){var f=null;return f=n.Common.IsEmpty(i.Value)?t.getImageSrcFromElementImagePath(i):t.getImageSrcFromElementValue(i,u),n.Common.isForguncyFile(f)&&(f=t.getUploadImageSrc(f)),f},t.getImageUrlFromImagePath=function(t,i,r){r===void 0&&(r=!1);var u="";return t?(u=r?"Resources/Themes/"+n.ForguncyData.GlobalSettings.ThemeBasePath+"/Images/":"Resources/Images/CellTypeBuiltInImage/",n.ForguncyData.ForguncyRoot+u+i):(u="GeneratedResources/Images/GenerateImages/ImageCellType/",n.ForguncyData.ForguncyRoot+u+i+"?v="+n.StaticData.MetaDataVersion)},t.setImageSource=function(i,r){var u,e,f;r||(u=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(i.attr("id")),r=!n.Common.IsEmpty(u)&&u.cellType instanceof n.ImageCellType?t.getImageSrcFromElementImagePath(u.cellType.CellElement):t.emptyImageUrl);i.attr("forguncyImage")?(e=n.Common.isForguncyFile(r)?t.getUploadImageSrc(r):r,f=t.encodeImageUrl(e),i.css("background-image",'url("'+n.Helper.preProcessImageSrc(f)+'")')):(f=t.encodeImageUrl(r),i.attr("src",n.Helper.preProcessImageSrc(f)))},t.convertPathToFileName=function(t){if(!n.Common.IsEmpty(t)&&t.toString().indexOf(n.ForguncyData.ForguncyRoot+"Upload/")!==-1){var i=t.toString(),u=i.lastIndexOf("/"),r=i.lastIndexOf("?");return i.slice(u+1,r===-1?undefined:r)}return t},t.convertFileNameToPath=function(t){return n.Common.IsEmpty(t)?null:n.Common.isForguncyFile(t)?n.ForguncyData.ForguncyRoot+"Upload/"+t:t},t.getImageSrcFromElementValue=function(t,r){var u=null,f;return n.Common.isForguncyFile(t.Value)?(f=r?i.getImageQueryString(t.Width,t.Height):"",u=t.Value+f):u=t.Value,u},t.getImageSrcFromElementImagePath=function(i,r){var u=i.CellType,f=u.ImagePath;return n.Common.IsEmpty(f)?u.$type==="Forguncy.ImageCellType, Forguncy"?this.emptyImageUrl:this.emptyUploadImageUrl:t.getImageUrlFromImagePath(u.BuiltIn,u.ImagePath,r)},t.getUploadImageSrc=function(t){return n.ForguncyData.ForguncyRoot+"Upload/"+t},t.isBase64StringUrl=function(n){return n.indexOf("data:")===0?!0:!1},t}(),i,r,u;n.ImageHelper=t;i=function(){function n(){}return n.getImageQueryString=function(n,t){return"?imageSize="+this.getSuitableImageMode(n,t)},n.getSuitableImageMode=function(n,t){return n<150&&t<150?1:n<400&&t<400?2:0},n}();n.ImageQueryHelper=i;r=function(){function r(){}return r.registerDragFile=function(t,i){var u=this;n.DragFileToUploadHelper.register(t,function(u){n.Common.uploadFileByHTML5(u,function(n){r.uploadSuccess(n,t,i)},function(n){n&&alert(n)},{ExtensionFilter:n.UploadImageCellType.allowDragFileType})},!1)},r.uploadSuccess=function(r,u,f){var e,o;u.empty();r?(u.attr("imagename",r),n.Common.isForguncyFile(r)&&(e=f.CellElement,r=r+i.getImageQueryString(e.Width,e.Height)),o=n.ForguncyData.ForguncyRoot+"Upload/"+r,t.setImageSource(u,o)):(u.attr("imagename",""),t.setImageSource(u,null));f.commitValue();f.validate()},r}();n.ImageUploadHelper=r;u=function(){function i(){}return i.CreateImage=function(r,u){var f,e,o;return r&&r.Name?(f=void 0,i.IsSvg(r.Name)?(f=n.DomUtilities.createJqueryDomElement("div"),e=t.getImageUrlFromImagePath(r.BuiltIn,r.Name),o=t.encodeImageUrl(e),this.AppendSvg(f,o,r.Color)):(f=n.DomUtilities.createJqueryDomElement("img"),e=t.getImageUrlFromImagePath(r.BuiltIn,r.Name),o=t.encodeImageUrl(e),f.attr("src",o)),f.css("vertical-align","middle"),f.css("width",u),f.css("height",u),f):null},i.AppendSvg=function(t,i,r,u){$.get(i,function(f){var e=$(f.documentElement);e.css("width","100%");e.css("height","100%");e.attr("focusable",!1);$("*",e).attr("fill",n.ColorHelper.Convert(r));u&&u(i)||t.append(e)})},i.IsBuiltInSvg=function(n){return n&&i.IsSvg(n)&&n.indexOf("Resources/Images/CellTypeBuiltInImage/")>0},i.GetColoredSvgRectInfo=function(t,r){var e=t+r,o=i.coloredSvgRectInfoCache[e],f,u;return o?o:(u={},u.type="GET",u.url=t,u.async=!1,u.success=function(t){var u=$(t.documentElement),o,s;$("*",u).attr("fill",n.ColorHelper.Convert(r));o=$("<div>").append(u.clone()).html();s="data:image/svg+xml;base64,"+btoa(o);f={value:s,width:u.width(),height:u.height()};i.coloredSvgRectInfoCache[e]=f},$.ajax(u),f)},i.IsSvg=function(n){return n&&n.length>4&&n.substr(n.length-4,4).toLowerCase()==".svg"},i.coloredSvgRectInfoCache={},i}();n.ImageDataHelper=u}(Forguncy||(Forguncy={})),function(n){n.Platform.isMobile()||(window.GCIM={ph:"UFdVX9UgKeMPokThU+ji+o2sGk1KGTj9H4cDfHyG83v="})}(Forguncy||(Forguncy={})),function(n){var t={};t["TouchToolBar.Undo"]="\uc2e4\ud589\ucde8\uc18c";t["TouchToolBar.Cut"]="\uc798\ub77c\ub0b4\uae30";t["TouchToolBar.Copy"]="\ubcf5\uc0ac";t["TouchToolBar.Paste"]="\ubd99\uc5ec\ub123\uae30";t["TouchToolBar.Delete"]="\uc0ad\uc81c";t["TouchToolBar.SelectAll"]="\uc804\uccb4\uc120\ud0dd";t["ToolTip.PreviousYear"]="\uc774\uc804 \ud574";t["ToolTip.Today"]="\uc624\ub298";t["ToolTip.NextYear"]="\ub2e4\uc74c \ud574";t["ToolTip.NextDecade"]="\ub2e4\uc74c 10\ub144";t["ToolTip.PreviousDecade"]="\uc774\uc804 10\ub144";t["ToolTip.ZoomIn"]="\uc90c \uc778";t["ToolTip.ZoomOut"]="\uc90c \uc544\uc6c3";t["Weekday.Monday"]="\uc6d4";t["Weekday.Tuesday"]="\ud654";t["Weekday.Wednesday"]="\uc218";t["Weekday.Thursday"]="\ubaa9";t["Weekday.Friday"]="\uae08";t["Weekday.Saturday"]="\ud1a0";t["Weekday.Sunday"]="\uc77c";t["ContextMenu.Undo"]="\uc2e4\ud589\ucde8\uc18c(U)";t["ContextMenu.Cut"]="\uc798\ub77c\ub0b4\uae30(T)";t["ContextMenu.Copy"]="\ubcf5\uc0ac(C)";t["ContextMenu.Paste"]="\ubd99\uc5ec\ub123\uae30(P)";t["ContextMenu.Delete"]="\uc0ad\uc81c(D)";t["ContextMenu.SelectAll"]="\uc804\uccb4\uc120\ud0dd(A)";t["ContextMenu.UndoDescription"]="\ub9c8\uc9c0\ub9c9 \uc791\uc5c5 \ub418\ub3cc\ub9ac\uae30";t["ContextMenu.CutDescription"]="\uc120\ud0dd\ud55c \ub0b4\uc6a9 \uc798\ub77c\ub0b4\uc11c \ud074\ub9bd\ubcf4\ub4dc\uc5d0 \ub123\uae30";t["ContextMenu.CopyDescription"]="\uc120\ud0dd\ud55c \ub0b4\uc6a9\uc744 \ud074\ub9bd\ubcf4\ub4dc\uc5d0 \ubcf5\uc0ac\ud558\uae30";t["ContextMenu.PasteDescription"]="\uc785\ub825 \uc9c0\uc810\uc5d0 \ud074\ub9bd\ubcf4\ub4dc \ub0b4\uc6a9 \uc0bd\uc785\ud558\uae30";t["ContextMenu.DeleteDescription"]="\uc120\ud0dd\ud55c \ub0b4\uc6a9 \uc0ad\uc81c";t["ContextMenu.SelectAllDescription"]="\ucee8\ud2b8\ub864\uc758 \uc804\uccb4 \ub0b4\uc6a9 \uc120\ud0dd\ud558\uae30";t["Number.CurrencySymbol"]="\u20a9";t["Calculator.DivideByZeroInfo"]="0\uc73c\ub85c \ub098\ub20c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.";t["Calculator.InvalidInputInfo"]="\uc785\ub825\uc774 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4.";t["Calculator.OverFlowInfo"]="\uc0b0\uc220\uc5f0\uc0b0\uc73c\ub85c \uc778\ud574 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc600\uc2b5\ub2c8\ub2e4.";t["Calculator.SqrtParameterException"]="\ud568\uc218 \uc785\ub825\uc774 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4.";t["ValidatorAction.DefaultErroInformation"]="\uc798\ubabb\ub41c \uac12";t.DateTabDefaultText="\ub0a0\uc9dc";t.TimeTabDefaultText="\uc2dc\uac04";t["Notifier.defaultFailMessage"]="Input value is incorrect.";t["Notifier.defaultSuccessMessage"]="Input value is correct.";n.gcimResource_kr=t}(Forguncy||(Forguncy={})),function(n){var t;(function(n){var t=null,i=undefined,r=function(){function n(){}return n.___toOADate=function(r){return r===i||r===t?0:(typeof r=="number"&&(r=new Date(r)),(r.getTime()*1440+3181192704e6-n._getTimezoneOffset(r)*864e5)/124416e6)},n._fromOADate=function(t){var r=t-25569,u=new Date(r*864e5),f=r>=0?1:-1,i=new Date((t*124416e6+f-3181192704e6+n._getTimezoneOffset(u)*864e5)/1440);return i.getMilliseconds()===999?new Date(i.valueOf()+1):i},n._getTimezoneOffset=function(n){var t=n.getTimezoneOffset();return t===-485&&(t=-485-43/60),t},n}();n._DateTimeHelper=r})(t=n.SpreadJSHelpMethods||(n.SpreadJSHelpMethods={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(n){var y="undefined",s="number",h="string",e="boolean",p="TRUE",w="FALSE",ut="ARRAY",ft="ARRAYROW",b="#NULL!",k="#DIV/0!",d="#VALUE!",g="#REF!",nt="#NAME?",tt="#N/A",it="#NUM!",et="expr",ot="arrayInfo",st="workingExpr",ht=[b,k,d,g,nt,tt,it],ct=[0,7,15,23,29,42,36],lt=[1,26,676],i=null,u=undefined,at=Math.min,vt=Math.max,rt=Math.abs,yt=Math.pow,f="InvalidCastException",o=function(){function n(){}return n.getReg=function(t){var i=n.regDict[t];return i||(i=n.regDict[t]=new RegExp(t,"g")),i.lastIndex=0,i},n.getRegIgnoreCase=function(t){var i=n.regDictIgnoreCase[t];return i||(i=n.regDictIgnoreCase[t]=new RegExp(t,"gi")),i.lastIndex=0,i},n.getWildcardCriteria=function(i){if(n.wildcardParseRecord[i])return n.wildcardParseResultBuffer[i];if(n.getReg("[~?*]+").test(i)){var r=i,u=n.getReplaceSymbol("asterisk",r),f=n.getReplaceSymbol("question",r),e=n.getReplaceSymbol("tilde",r);return r=t.replace(r,"~~",e),r=t.replace(r,"~*",u),r=t.replace(r,"~?",f),r=r.replace(n.getReg("([.+$^\\[\\](){}|/])"),"\\$1"),r=t.replace(r,"*",".*"),r=t.replace(r,"?","."),r=t.replace(r,u,"\\*"),r=t.replace(r,f,"\\?"),r=t.replace(r,e,"~"),n.wildcardParseResultBuffer[i]=r,n.wildcardParseRecord[i]=!0,r}return null},n.getWildcardCriteriaFullMatch=function(t){var i=n.getWildcardCriteria(t);return i&&(i="^"+i+"$"),i},n.getReplaceSymbol=function(n,i){for(var r="#"+n+"0#",u=1;u<1e4;u++){if(i.indexOf(r)>0){r=t.replace(r,"#"+n+(u-1)+"#","#"+n+u+"#");continue}return r}},n.regDict={},n.regDictIgnoreCase={},n.wildcardParseRecord={},n.wildcardParseResultBuffer={},n}(),t,r,c,l,a,v;n.RegUtil=o;t=function(){function n(){}return n.replace=function(n,t,i){return n.split(t).join(i)},n}();n.StringUtil=t;r=function(){function t(){}return t.num=function(n,t){return typeof n===s||n instanceof Date||!t&&(typeof n===e||!isNaN(n)&&!isNaN(parseFloat(n)))},t._isNaNOrInfinite=function(n){return isNaN(n)||!isFinite(n)},t.I=function(n){var i=t.D(n);if(rt(i)<1e21)return parseInt(i,10);throw f;},t.D=function(n){var i={value:0};if(t.rD(n,i))return i.value;throw f;},t.rD=function(r,u){var f=i,o,a,c,l;if(!r)return u.value=0,!0;o=typeof r;try{if(o===s)f=r;else if(o===h){if(r=r.trim(),r.length===0)return u.value=0,!0;if(a=!1,r.charAt(r.length-1)==="%"&&(a=!0,r=r.substr(0,r.length-1)),r.length>=2&&r[0]==="0"&&r[1]==="x")return!1;if(f=new Number(r).valueOf(),t._isNaNOrInfinite(f)){if((c=r.charCodeAt(0),c|=32,r.length>4&&c>=96&&c<=122&&(l=r[0]+r[1]+r[2],l=l.toUpperCase(),!t.monthStrings[l]))||r[0]==="/"||r[r.length-1]==="/"||(f=new Date(r),t._isNaNOrInfinite(f.valueOf())))return!1;f=n._DateTimeHelper.___toOADate(f)}a&&(f/=100)}else if(o===e)f=r?1:0;else if(r instanceof Date)f=n._DateTimeHelper.___toOADate(r);else return!1}catch(v){return!1}return u.value=f,!0},t.arr=function(n){return n instanceof GC.Spread.CalcEngine.CalcArray},t.S=function(r){try{if(typeof r===y||r===i)return"";else if(typeof r===e)return r?p:w;else if(typeof r===h)return r;else if(r instanceof Date)return n._DateTimeHelper.___toOADate(r).toString();else if(t.arr(r))throw f;else return r.toString()}catch(u){throw f;}},t.monthStrings={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},t}();n.Convert=r;c=function(){function n(){}return n._argumentExists=function(t,i){return t&&i<t.length&&t[i]!==n.missingArgument},n.missingArgument={},n}();n._Helper=c;l=function(){function n(){}return n._buildCriteria=function(n,t){var f,l,e,s,a,c,h,v;switch(n){case 0:f=function(n,t){return n<=t};e=function(n,t){return n<=t};break;case 1:f=function(n,t){return n>=t};e=function(n,t){return n>=t};break;case 2:f=function(n,t){return n!==t};e=function(n,t){return n!==t};break;case 3:f=function(n,t){return n<t};e=function(n,t){return n<t};break;case 4:f=function(n,t){return n===t};e=function(n,t){return n===t};s=o.getWildcardCriteriaFullMatch(t);s&&(a=o.getRegIgnoreCase(s),l=function(n){return a.lastIndex=0,a.test(n)});break;case 5:f=function(n,t){return n>t};e=function(n,t){return n>t};break;default:return function(n){return!1}}c=-1;h=!0;try{v={value:0};t===u||t===i?c=0:s?h=!1:r.rD(t.toString(),v)?c=v.value:h=!1}catch(y){h=!1}return function(n){var a,o;if((n===u||n===i)&&(n=""),h){a=-1;try{if(o={value:0},r.rD(n,o))return e(o.value,c)}catch(v){}}return s&&l?l(n.toString()):f(n.toString().toUpperCase(),t!==u&&t!==i?t.toString().toUpperCase():"")}},n._parseCriteria=function(t){var s=t,e=n.criteriaCaches,f,c,l;if(e||(n.criteriaCaches=e={}),f=e[s],f)return f;if(r.num(t))return e[s]=n._buildCriteria(4,t);var a="=><",o=t!==u&&t!==i?t.toString().toUpperCase():"",h='\0';for(c=0;c<2&&c<o.length;c++)if(l=o[c],a.indexOf(l)!==-1)if(l==="="){switch(h){case"<":f=n._buildCriteria(0,o.substring(2));break;case">":f=n._buildCriteria(1,o.substring(2));break;default:f=n._buildCriteria(4,h==='\0'?o.substring(1):t)}return e[s]=f,f}else{if(h==='\0'){h=l;continue}if(h==="<")return f=l===">"?n._buildCriteria(2,o.substring(2)):n._buildCriteria(3,o.substring(1)),e[s]=f,f;else if(h===">")return e[s]=f=n._buildCriteria(5,o.substring(1)),f}else switch(h){case"<":return e[s]=f=n._buildCriteria(3,o.substring(1)),f;case">":return e[s]=f=n._buildCriteria(5,o.substring(1)),f;default:break}return f=n._buildCriteria(4,t),e[s]=f,f},n}();n._MathHelper=l;a=function(){function n(){}return n.getPreferredZIndex=function(n){for(var t=n,i,r;t&&t.parentElement&&t.parentElement!==document.body;)t=t.parentElement;return i=1e3,t&&t.parentElement===document.body&&(r=parseInt($(t).css("z-index")),isNaN(r)||(i+=r)),i},n.getLinearGradientColors=function(n){var s,r,h,t,c;if(!n)return[];var y=n.indexOf("("),p=n.lastIndexOf(")"),i=n.substring(y+1,p);if(!i)return[];for(var e=[],o=0,l="",s=0,r=0;r<i.length;)s=i.indexOf("rgb",o),r=i.indexOf("rgb",o+1),r===-1&&(r=i.length),l=i.substring(s,r),e.push(l),o=s=r;for(h=[],t=0,c=e.length;t<c;t++){var f=e[t],a=f.indexOf(")"),v=f.substring(0,a+1),u=parseFloat(f.substring(a+1,f.length));(isNaN(u)&&(t===c-1?u=100:t<=1&&(u=0)),v||t!==0)&&(u=u/100,h.push({color:v,point:u}))}return h},n}();n.util=a;v=function(){function n(){}return n.paintBackground=function(t,i,r,u,f,e,o,s,h,c,l,a){(c===void 0&&(c=0),l===void 0&&(l=0),a===void 0&&(a=null),e||o)&&(t.save(),t.beginPath(),e&&(t.fillStyle!==e&&(t.fillStyle=e),t.fillRect(i,r,u,f)),a&&(i=a.x,r=a.y,u=a.width,f=a.height),n.paintBackgroundImage(t,i,r,u,f,o,s,h,c,l),t.restore())},n.paintBackgroundImage=function(n,t,i,r,u,f,e,o,s,h){s===void 0&&(s=0);h===void 0&&(h=0);var d=o._getState||o.ko,g=o._getImage||o.lo,nt=o._addImage||o.fo;if(f&&f!=="none"&&o)try{if(d.call(o,f)){var w=g.call(o,f),c=w.width||s,l=w.height||h,tt=0,it=0,a=c,v=l,y=r,p=u,b=t,k=i;e===1?(a=r>=c?c:r,v=u>=l?l:u,b=r>c&&c>0?Math.ceil(t+r/2-c/2):t,k=u>l&&l>0?Math.ceil(i+u/2-l/2):i,y=a,p=v):e===2?u>0&&l>0&&r/u>c/l?(y=c/l*u,b=t+r/2-y/2):r>0&&c>0&&u/r>l/c&&(p=l/c*r,k=i+u/2-p/2):e===3&&(a=r>=c?c:r,v=u>=l?l:u,y=a,p=v);n.drawImage(w,tt,it,a,v,b,k,y,p)}else nt.call(o,f)}catch(rt){}},n}();n.CellTypeContext=v})(t=n.SpreadJSHelpMethods||(n.SpreadJSHelpMethods={}))}(Forguncy||(Forguncy={})),function(){function g(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent&&n.attachEvent("on"+t,i)}function u(n){return!!n.exifdata}function v(n,t){var i;t=t||n.match(/^data\:([^\;]+)\;base64,/mi)[1]||"";n=n.replace(/^data\:([^\;]+)\;base64,/gmi,"");var r=atob(n),u=r.length,f=new ArrayBuffer(u),e=new Uint8Array(f);for(i=0;i<u;i++)e[i]=r.charCodeAt(i);return f}function y(n,t){var i=new XMLHttpRequest;i.open("GET",n,!0);i.responseType="blob";i.onload=function(n){(this.status==200||this.status===0)&&t(this.response)};i.send()}function p(n,t){function f(i){var r=s(i),u=w(i);n.exifdata=r||{};n.iptcdata=u||{};t&&t.call(n)}var e,r,u;n.src?/^data\:/i.test(n.src)?(e=v(n.src),f(e)):/^blob\:/i.test(n.src)?(u=new FileReader,u.onload=function(n){f(n.target.result)},y(n.src,function(n){u.readAsArrayBuffer(n)})):(r=new XMLHttpRequest,r.onload=function(){if(this.status==200||this.status===0)f(r.response);else throw"Could not load image";r=null},r.open("GET",n.src,!0),r.responseType="arraybuffer",r.send(null)):window.FileReader&&(n instanceof window.Blob||n instanceof window.File)&&(u=new FileReader,u.onload=function(n){i&&console.log("Got file of length "+n.target.result.byteLength);f(n.target.result)},u.readAsArrayBuffer(n))}function s(n){var r=new DataView(n),t,f,u;if(i&&console.log("Got file of length "+n.byteLength),r.getUint8(0)!=255||r.getUint8(1)!=216)return i&&console.log("Not a valid JPEG"),!1;for(t=2,f=n.byteLength;t<f;){if(r.getUint8(t)!=255)return i&&console.log("Not a valid marker at offset "+t+", found: "+r.getUint8(t)),!1;if(u=r.getUint8(t+1),i&&console.log(u),u==225)return i&&console.log("Found 0xFFE1 marker"),d(r,t+4,r.getUint16(t+2)-2);else t+=2+r.getUint16(t+2)}}function w(n){var u=new DataView(n),t,f,e;if(i&&console.log("Got file of length "+n.byteLength),u.getUint8(0)!=255||u.getUint8(1)!=216)return i&&console.log("Not a valid JPEG"),!1;for(var r=2,o=n.byteLength,s=function(n,t){return n.getUint8(t)===56&&n.getUint8(t+1)===66&&n.getUint8(t+2)===73&&n.getUint8(t+3)===77&&n.getUint8(t+4)===4&&n.getUint8(t+5)===4};r<o;){if(s(u,r)){return t=u.getUint8(r+7),t%2!=0&&(t+=1),t===0&&(t=4),f=r+8+t,e=u.getUint16(r+6+t),b(n,f,e);break}r++}}function b(n,t,i){for(var s=new DataView(n),r={},h,u,c,l,a,o=t;o<t+i;)s.getUint8(o)===28&&s.getUint8(o+1)===2&&(l=s.getUint8(o+2),l in e&&(c=s.getInt16(o+3),a=c+5,u=e[l],h=f(s,o+5,c),r.hasOwnProperty(u)?r[u]instanceof Array?r[u].push(h):r[u]=[r[u],h]:r[u]=h)),o++;return r}function o(n,t,r,u,f){for(var c=n.getUint16(r,!f),h={},e,s,o=0;o<c;o++)e=r+o*12+2,s=u[n.getUint16(e,!f)],!s&&i&&console.log("Unknown tag: "+n.getUint16(e,!f)),h[s]=k(n,e,t,r,f);return h}function k(n,t,i,r,u){var y=n.getUint16(t+2,!u),s=n.getUint32(t+4,!u),h=n.getUint32(t+8,!u)+i,c,o,v,e,l,a;switch(y){case 1:case 7:if(s==1)return n.getUint8(t+8,!u);else{for(c=s>4?h:t+8,o=[],e=0;e<s;e++)o[e]=n.getUint8(c+e);return o}case 2:return c=s>4?h:t+8,f(n,c,s-1);case 3:if(s==1)return n.getUint16(t+8,!u);else{for(c=s>2?h:t+8,o=[],e=0;e<s;e++)o[e]=n.getUint16(c+2*e,!u);return o}case 4:if(s==1)return n.getUint32(t+8,!u);else{for(o=[],e=0;e<s;e++)o[e]=n.getUint32(h+4*e,!u);return o}case 5:if(s==1)return l=n.getUint32(h,!u),a=n.getUint32(h+4,!u),v=new Number(l/a),v.numerator=l,v.denominator=a,v;else{for(o=[],e=0;e<s;e++)l=n.getUint32(h+8*e,!u),a=n.getUint32(h+4+8*e,!u),o[e]=new Number(l/a),o[e].numerator=l,o[e].denominator=a;return o}case 9:if(s==1)return n.getInt32(t+8,!u);else{for(o=[],e=0;e<s;e++)o[e]=n.getInt32(h+4*e,!u);return o}case 10:if(s==1)return n.getInt32(h,!u)/n.getInt32(h+4,!u);else{for(o=[],e=0;e<s;e++)o[e]=n.getInt32(h+8*e,!u)/n.getInt32(h+4+8*e,!u);return o}}}function f(t,i,r){var u="";for(n=i;n<i+r;n++)u+=String.fromCharCode(t.getUint8(n));return u}function d(n,t){var h,v,u,e,y,s,p;if(f(n,t,4)!="Exif")return i&&console.log("Not valid EXIF data! "+f(n,t,4)),!1;if(s=t+6,n.getUint16(s)==18761)h=!1;else if(n.getUint16(s)==19789)h=!0;else return i&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;if(n.getUint16(s+2,!h)!=42)return i&&console.log("Not valid TIFF data! (no 0x002A)"),!1;if(p=n.getUint32(s+4,!h),p<8)return i&&console.log("Not valid TIFF data! (First offset less than 8)",n.getUint32(s+4,!h)),!1;if(v=o(n,s,s+p,l,h),v.ExifIFDPointer){e=o(n,s,s+v.ExifIFDPointer,c,h);for(u in e){switch(u){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":e[u]=r[u][e[u]];break;case"ExifVersion":case"FlashpixVersion":e[u]=String.fromCharCode(e[u][0],e[u][1],e[u][2],e[u][3]);break;case"ComponentsConfiguration":e[u]=r.Components[e[u][0]]+r.Components[e[u][1]]+r.Components[e[u][2]]+r.Components[e[u][3]];break}v[u]=e[u]}}if(v.GPSInfoIFDPointer){y=o(n,s,s+v.GPSInfoIFDPointer,a,h);for(u in y){switch(u){case"GPSVersionID":y[u]=y[u][0]+"."+y[u][1]+"."+y[u][2]+"."+y[u][3];break}v[u]=y[u]}}return v}var i=!1,h=this,t=function(n){if(n instanceof t)return n;if(!(this instanceof t))return new t(n);this.EXIFwrapped=n},e;typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=t),exports.EXIF=t):h.EXIF=t;var c=t.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},l=t.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},a=t.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},r=t.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};e={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};t.getData=function(n,t){return(n instanceof Image||n instanceof HTMLImageElement)&&!n.complete?!1:(u(n)?t&&t.call(n):p(n,t),!0)};t.getTag=function(n,t){if(u(n))return n.exifdata[t]};t.getAllTags=function(n){if(!u(n))return{};var t,i=n.exifdata,r={};for(t in i)i.hasOwnProperty(t)&&(r[t]=i[t]);return r};t.pretty=function(n){if(!u(n))return"";var t,i=n.exifdata,r="";for(t in i)i.hasOwnProperty(t)&&(r+=typeof i[t]=="object"?i[t]instanceof Number?t+" : "+i[t]+" ["+i[t].numerator+"/"+i[t].denominator+"]\r\n":t+" : ["+i[t].length+" values]\r\n":t+" : "+i[t]+"\r\n");return r};t.readFromBinaryFile=function(n){return s(n)};typeof define=="function"&&define.amd&&define("exif-js",[],function(){return t})}.call(this),function(n){var e=function(){function n(){}return n.isBuiltInPage=function(i){for(var r in t)if(n.builtInPages[r]===i)return!0;return!1},n}(),t,o,i,r,u,f,s;n.BuiltInPageManager=e,function(n){n.MasterPage="MasterPage";n.ChangePassword="ChangePassword";n.ForgetPassword="ForgetPassword";n.ChangeUserSettings="ChangeUserSettings";n.Login="Login";n.ResetPasswordMailSended="ResetPasswordMailSended";n.ResetPassword="ResetPassword";n.Pag401="Pag401";n.MaintenancePage="MaintenancePage";n.MailSubscriptPage="MailSubscriptPage"}(t=n.BuiltInPageType||(n.BuiltInPageType={})),function(n){n[n.None=0]="None";n[n.Custom=1]="Custom";n[n.Insert=2]="Insert";n[n.Delete=3]="Delete";n[n.Duplicate=4]="Duplicate"}(o=n.ContextMenuOperationType||(n.ContextMenuOperationType={}));i=function(){function n(){}return n}();n.DataValidationInfo=i;r=function(){function n(){}return n}();n.TableDataCache=r;u=function(){function n(){}return n}();n.ValueAndFormatPair=u;f=function(){function n(){}return n}();n.OffsetConditionInfo=f,function(n){n[n.None=0]="None";n[n.MouseWheel=1]="MouseWheel";n[n.SpinButton=2]="SpinButton";n[n.UpDownKeys=4]="UpDownKeys";n[n.All=7]="All"}(s=n.SpinType||(n.SpinType={}))}(Forguncy||(Forguncy={}));__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var i=function(){function n(){}return n.ValueChanged="valuechanged",n.SelectionChanged="selectionchanged",n.Reloaded="reloaded",n.Click="click",n.MouseEnter="mouseenter",n.MouseLeave="mouseleave",n.Loaded="loaded",n.PageDefaultDataLoaded="pagedefaultdataloaded",n.PopupClosed="popupclosed",n.SubPageChanged="subpagechanged",n.CurrentRowInfoChanged="currentrowinfochanged",n.PageLoaded="pageloaded",n.PageingInfoChanged="pageingInfoChanged",n.PageingRowcountChanged="pageingRowcountChanged",n.PageingUIInvalide="pageingUIInvalide",n.SelectedRowsChanged="selectedrowschanged",n.PivottableClick="pivottableclick",n.PivottableCommandEvent="pivottablecommand",n.RepeaterCurrentRowChanged="RepeaterCurrentRowChanged",n}(),t;n.Events=i;t=function(){function n(){this._events=[]}return n.prototype.bind=function(n,t,i){arguments.length===2&&(i=t,t=undefined);this._events.push({eventType:n,data:t,fn:i})},n.prototype.unbind=function(n,t){for(var r,u=arguments.length===1||t===undefined,f=this._events.length,i=f-1;i>=0;i--)r=this._events[i],r.eventType===n&&(u||r.fn===t)&&this._events.splice(i,1)},n.prototype.unbindAll=function(){this._events=[]},n.prototype.isEventHasBeenBinding=function(n){for(var i,r=this._events.length,t=0;t<r;t++)if(i=this._events[t],i.eventType===n)return!0;return!1},n.prototype.trigger=function(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];i=[];this._events.forEach(function(t){t.eventType===n&&i.push(t)});i.forEach(function(n){n.fn.apply(n,__spreadArrays([{data:n.data===undefined?null:n.data}],r))})},n}();n.EventClassBase=t}(Forguncy||(Forguncy={}));__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var t=function(){function t(){}return t.Init=function(t){n.ForguncyData.forceMobileChild||(n.ForguncyData.forceMobileChild=n.Common.GetUrlQuery("mobileChild")==="true");n.ForguncyData.pageInfo=new i;n.ForguncyData.userInfo={};n.ForguncyData.ForguncyRoot=t;n.ForguncyData.commandExcutor=new n.CommandExcutor;n.ForguncyData.pageInfoStack=[];n.DelayOperateHelper.init();n.ForguncyData.pageingInfoList=new n.PageingInfoList;n.SpreadJSModifier.init();n.ListviewBase.init();n.PageBuilder.init()},t.ClearTempDataWhenNavigate=function(i,r){n.ForguncyData.pageInfo.pageElementManager&&(n.ForguncyData.pageInfo.pageElementManager=undefined);t.pageInfo.formulaManager&&(t.pageInfo.formulaManager.destroy(),t.pageInfo.formulaManager=undefined);n.ForguncyData.pageInfo.commandQuerys={};n.ForguncyData.pageInfo.sortInfoCache={};n.ForguncyData.pageInfo.dataModel=new n.DataModel},t.updatePopupCoverVisbility=function(n){var i,r,u;if(n)i=this.pageInfo.dialogUI,i&&i.target.displayMode!==1&&t.pageInfoStack.forEach(function(n){n.dialogUI&&n.dialogUI.cover.css("opacity","0")});else if(i=this.pageInfo.dialogUI,i)if(i.target.displayMode!==1)i.cover.css("opacity","");else for(r=t.pageInfoStack.length-1;r>=0;r--)if(u=t.pageInfoStack[r],u.dialogUI&&u.dialogUI.target.displayMode!==1){u.dialogUI.cover.css("opacity","");break}},t.getRelatedTableWithForeignKey=function(n){var i=[];return t.getRelatedTablesWithForeignKeyInternal(n,i),i},t.getRelatedTablesWithForeignKeyInternal=function(i,r){if(!n.Common.IsEmpty(n.ForguncyData.pageInfo.PrimaryTableForeignKeyInfo)&&!n.Common.IsEmpty(n.ForguncyData.pageInfo.PrimaryTableForeignKeyInfo[i])){var u=n.ForguncyData.pageInfo.PrimaryTableForeignKeyInfo[i];u.forEach(function(n,i){r.indexOf(n)===-1&&(r.push(n),t.getRelatedTablesWithForeignKeyInternal(n,r))})}},t.columnFilterQueryCache={},t.doNotCacheUserProfileAvator=!1,t}(),i,r;n.ForguncyData=t;i=function(){function i(){this.allowZoomScreen=!1;this.moveFocusByEnter=!1;this.extraDialogCount=0}return Object.defineProperty(i.prototype,"hasExtraDialog",{get:function(){return this.extraDialogCount&&this.extraDialogCount>0},enumerable:!0,configurable:!0}),i.getCurrentPageInfo=function(){var r=n.ForguncyData.pageInfo,t=new i;return t.pageElementManager=r.pageElementManager,t.commandQuerys=r.commandQuerys,t.sortInfoCache=r.sortInfoCache,t.formulaManager=r.formulaManager,t.dataModel=r.dataModel,t.currentRowInfoCollection=r.currentRowInfoCollection,t.normalCellBindingManager=r.normalCellBindingManager,t.pageName=r.pageName,t.masterPageName=r.masterPageName,t.pageID=r.pageID,t.enableTabIndex=r.enableTabIndex,t.ReturnUrl=r.ReturnUrl,t.noPermissionPage=r.noPermissionPage,t.tableColumnsCacheManager=r.tableColumnsCacheManager,t.PrimaryTableForeignKeyInfo=r.PrimaryTableForeignKeyInfo,t.ViewInfoList=r.ViewInfoList,t.pageStretchInfos=r.pageStretchInfos,t.defaultFormulaManager=r.defaultFormulaManager,t.dependenceCellValueChangedEventHandlers=r.dependenceCellValueChangedEventHandlers,t.dialogUI=r.dialogUI,t.extraDialogCount=r.extraDialogCount,t.isPopup=r.isPopup,n.Page._pushCurrentState(),t},i.setCurrentPageInfo=function(t){var i=n.ForguncyData.pageInfo;i.pageElementManager=t.pageElementManager;i.commandQuerys=t.commandQuerys;i.sortInfoCache=t.sortInfoCache;i.formulaManager=t.formulaManager;i.dataModel=t.dataModel;i.currentRowInfoCollection=t.currentRowInfoCollection;i.normalCellBindingManager=t.normalCellBindingManager;i.pageName=t.pageName;i.masterPageName=t.masterPageName;i.pageID=t.pageID;i.enableTabIndex=t.enableTabIndex;i.ReturnUrl=t.ReturnUrl;i.noPermissionPage=t.noPermissionPage;i.tableColumnsCacheManager=t.tableColumnsCacheManager;i.PrimaryTableForeignKeyInfo=t.PrimaryTableForeignKeyInfo;i.ViewInfoList=t.ViewInfoList;i.pageStretchInfos=t.pageStretchInfos;i.defaultFormulaManager=t.defaultFormulaManager;i.dependenceCellValueChangedEventHandlers=t.dependenceCellValueChangedEventHandlers;i.dialogUI=t.dialogUI;i.extraDialogCount=t.extraDialogCount;i.isPopup=t.isPopup;n.Page._popupState()},i.prototype.releaseDialog=function(){this.dialogUI&&(this.dialogUI.target.dispose(),this.dialogUI=null)},i.prototype.appendExtralPopup=function(n){t.pageInfo.extraDialogCount+=1;n.on("Dispose",function(){t.pageInfo.extraDialogCount-=1})},i}();n.PageInfo=i;r=function(){function i(){}return i.getRunTimePageName=function(i){switch(i){case t.pageInfo.pageName:return n.StaticValues.RunTimeNormalPage;case t.pageInfo.masterPageName:return n.StaticValues.RunTimeMasterPage;default:var r=t.pageInfo.pageElementManager.cells.getAllContainerCells().map(function(n){return n.cellType.getRunTimePageName(i)}).filter(function(n){return n});return r.length>0?r[0]:null}},i.getRunTimeNormalPageName=function(t){return t[0]===n.StaticValues.RunTimeNormalPage?t:n.StaticValues.RunTimeNormalPage+t.substr(1)},i.getDesignerPageName=function(r,u){switch(r){case n.StaticValues.RunTimeNormalPage:return t.pageInfo.pageName;case n.StaticValues.RunTimeMasterPage:return u?t.pageInfo.pageName:t.pageInfo.masterPageName;default:var f=i.getContainerCell(r);return f?f.cellType.getDesignerPageName(r,u):t.pageInfo.pageName}},i.isNormalCellID=function(t){var i=n.Common.parseIDStr(t);return i&&i.suffix&&i.suffix.length>0&&(i.suffix[0]===n.StaticValues.RunTimeMasterPage||i.suffix[0]===n.StaticValues.RunTimeNormalPage)},i.isMasterPageName=function(t){return t&&t.length>0&&t[0]===n.StaticValues.RunTimeMasterPage},i.getPageStretchInfo=function(n){return t.pageInfo.pageStretchInfos?t.pageInfo.pageStretchInfos[n]:null},i.whetherExistPageStretch=function(n){var t,i;for(t in n)if(i=n[t],i.StretchMode!==0)return!0;return!1},i.getLocationString=function(t){var r;switch(t){case n.StaticValues.RunTimeNormalPage:return n.ForguncyData.pageInfo.pageName;case n.StaticValues.RunTimeMasterPage:return n.ForguncyData.pageInfo.masterPageName;default:if(r=i.getContainerCell(t),r){var u=r.cellType,f=u.getDesignerPageName(t,!1),e=u.getTabIndex(t);return i.getLocationString(r.runTimePageName)+","+r.row+","+r.column+","+e+","+f}else return n.Common.getUniqueNumber()+""}},i.getLocatedNormalPageNames=function(t){var r,u;switch(t){case n.StaticValues.RunTimeNormalPage:case n.StaticValues.RunTimeMasterPage:return[n.ForguncyData.pageInfo.pageName];default:if(r=i.getContainerCell(t),r)return u=r.cellType.getDesignerPageName(t,!0),i.getLocatedNormalPageNames(r.runTimePageName).concat([u]);else[]}},i.getContainerCell=function(i){var r=t.pageInfo.pageElementManager.cells.getAllCells().filter(function(t){return t.cellType instanceof n.ContainerCellTypeBase&&t.cellType.containRunTimePage(i)});return r.length>0?r[0]:null},i.isPageIsLoading=function(t){if(t===n.StaticValues.RunTimeNormalPage||t===n.StaticValues.RunTimeMasterPage)return n.PageBuilder.pageIsLoading;var r=i.getContainerCell(t);return r?r.cellType.isLoading():!1},i.getSubRunTimePageNames=function(r,u){if(u===void 0&&(u=null),n.Common.IsEmpty(r))return[];u||(u=t.pageInfo.pageElementManager.cells.getAllCells().filter(function(t){return t.cellType instanceof n.SubPageContainerCellTypeBase}).map(function(n){return n.cellType}));var f=[];return u.length>0&&u.forEach(function(n){n.runTimePageName===r&&n.subPageInfos.forEach(function(n){n&&(f.push(n.runTimeNormalPageName),f.push(n.runTimeMasterPageName),i.getSubRunTimePageNames(n.runTimeNormalPageName,u).forEach(function(n){return f.push(n)}))})}),f},i.getAllRunTimePageNames=function(n){if(!n)return null;var t=n.runTimeNormalPageName,r=n.runTimeMasterPageName;return __spreadArrays([r,t],i.getSubRunTimePageNames(r),i.getSubRunTimePageNames(t))},i}();n.PageManager=r}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(){}return t.AllowMoveFocusByEnterKey=function(i,r,u){n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.moveFocusByEnter&&i&&!r&&u.Width&&u.Height&&i.keydown(function(i){if(!i.altKey&&!i.ctrlKey&&i.keyCode===13){var r=this;n.DelayRefresh.setTimeout(function(){i.shiftKey?t.MoveFocusToPreviousControl(r):t.MoveFocusToNextControl(r)})}})},t.MoveFocusToNextControl=function(n){t.MoveFocus(n,t.getNextIndex)},t.MoveFocusToPreviousControl=function(n){t.MoveFocus(n,t.getPreviousIndex)},t.MoveFocusToFirstElement=function(){var n=t.GetSortedElements();return n.length<=0?!1:(t.SetElementFocus(n[0]),!0)},t.MoveFocus=function(n,i){var r,f,u,e;if(n&&(r=t.GetSortedElements(),!(r.length<2))){for(f=-1,u=0;u<r.length;u++)if(n===r[u].ElementObj){f=u;break}f!==-1&&(e=i(f,r.length),t.SetElementFocus(r[e]))}},t.getNextIndex=function(n,t){return n===t-1?0:n+1},t.getPreviousIndex=function(n,t){return n===0?t-1:n-1},t.GetSortedElements=function(){var i,r,u;return(n.ForguncyData.pageInfo.hasExtraDialog?(i=$(".FUI-dialog").not(":hidden").last(),r=!1):(i=$("#centerDiv_"+n.ForguncyData.pageInfo.pageID),r=!0),u=t.GetElements(i,r),n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.enableTabIndex)?t.SortElements(u):u},t.GetElements=function(t,i){var f,e,u,r,o,s;for(i===void 0&&(i=!0),f=[],e=t.find("button,input,a,select,textarea,div[gcuielement='gcSheetFocusElementForTab'],div[tabindex]"),u=0;u<e.length;u++)if(r=e[u],!r.disabled&&!$(r).attr("disabled")&&!$(r).attr("ignoreInMoveFocus")&&r.style.visibility!=="hidden"&&r.style.display!=="none"&&!(r.tabIndex<=-1)&&!$(r).is(":hidden")){if(r.tagName==="DIV"){if(r.getAttribute("gcuielement")==="gcSheetFocusElementForTab"){if(o=n.SpreadJSView.getWorkBookByHost($(r).parent()).getActiveSheet(),o.getRowCount()===0||o.getColumnCount()===0)continue}else if(i)continue}else if(r.tagName==="A"){if($(r).attr("href")===undefined)continue}else if(s=r.getAttribute("isCalculatorButton"),s==="true")continue;(n.Common.IsEmpty(r.id)||r.id[0]!=="a")&&(typeof r.id!="string"||r.id.indexOf("wijspread_toolstrip_")!==0)&&f.push({ElementObj:r,ID:r.id,TabIndex:r.tabIndex})}return f},t.SortElements=function(n){var i,r,f,t,u;if(!n||n.length===0)return n;for(i=[],t=0;t<n.length;t++)r=n[t].TabIndex,i[r]===undefined&&(i[r]=[]),i[r].push(n[t]);for(f=[],t=0;t<i.length;t++)if(i[t]!==undefined)for(u=0;u<i[t].length;u++)f.push(i[t][u]);return f},t.SetElementFocus=function(t){try{if(t.ElementObj.tagName==="DIV"&&t.ElementObj.getAttribute("gcuielement")==="gcSheetFocusElementForTab"){var i=n.SpreadJSView.getWorkBookByHost($(t.ElementObj).parents("[gcuielement='gcSpread']"));i.focus(!0)}else t.ElementObj.focus()}catch(r){}},t}();n.FocusMoveHelper=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=GC.Spread.CalcEngine,l=function(i){function r(n){var t=i.call(this,n)||this;return t._needRemovedPages=[],t}return __extends(r,i),r.prototype.addCustomName=function(t,i,r){var u,o,f,e;if(!n.Common.IsEmpty(i.Name)&&!n.Common.IsEmpty(i.Formula)&&(u=this,o=u.getCalcService(),o)){u._names||(u._names={});f=i.Name.toUpperCase();for(e in u._names)u._needRemovedPages.indexOf(e)>=0||u._names[e][f]&&(n.ErrorHelper.printErrorStr(n.Common.format(n.RS.NameConflict,f,n.PageManager.getDesignerPageName(e,!1),n.PageManager.getDesignerPageName(t,!1))),delete u._names[e][f]);u._names[t]||(u._names[t]={});u._names[t][f]=new GC.Spread.Sheets.NameInfo(f,r,i.BaseRow,i.BaseColumn,null);o.getGlobalSourceModel().updateNameCalc(f,!0)}},r.prototype.preRemoveCustomNames=function(n){this._needRemovedPages.push(n)},r.prototype.removeCustomNames=function(n){var t=this,i,r,u;if(t._names&&(i=t._names[n],i)&&(r=t.getCalcService(),r)){delete t._names[n];for(u in i)i[u]&&r.getGlobalSourceModel().updateNameCalc(u,!1)}},r.prototype.getCustomName=function(i){var r=this,f=typeof i=="string"&&!n.Common.IsEmpty(i)?i.toUpperCase():null,e,u;if(f&&r._names)for(e in r._names)if(u=r._names[e][f],u)return u.getExpression();return n.FormulaHelper.createErrorExpressionfunction(t.Errors.Name,null,null)},r}(t.CalcSource),i,r,f,e,u,o,s,h,c;n.GlobalSource=l;i=function(i){function r(n,t){var r=i.call(this,n)||this;return r._name=t,r}return __extends(r,i),r.prototype.getName=function(){return this._name},r.prototype.getColumnCount=function(){throw n.StaticValues.NeedImplementException;},r.prototype.getRowCount=function(){throw n.StaticValues.NeedImplementException;},r.prototype.getValue=function(t,i){throw n.StaticValues.NeedImplementException;},r.prototype.setValue=function(t,i){throw n.StaticValues.NeedImplementException;},r.prototype.getReference=function(n){var r=n.row,u=n.col,f=n.rowCount,e=n.colCount,i=this;return r===-1&&u===-1?i.getSheetReference():r===-1?new t.CalcReference(i,[{row:0,rowCount:i.getRowCount(),col:u,colCount:e}]):u===-1?new t.CalcReference(i,[{row:r,rowCount:f,col:0,colCount:i.getColumnCount()}]):new t.CalcReference(i,[{row:r,rowCount:f,col:u,colCount:e}])},r.prototype.referenceToArray=function(n,t,r,u,f,e,o,s){var h=i.prototype.referenceToArray.call(this,n,t,r,u,f,e,o,s);return h.isError&&(h.length==0||h.length===1&&h[0].length===0)?[]:h},r.prototype.getCustomName=function(n){return null},r.prototype.getParserContext=function(t,r,u){n.Common.IsEmpty(r)&&(r={row:0,col:0});var f=i.prototype.getParserContext.call(this,t,r,u);return f.addResolver(new GC.Spread.Sheets.CalcEngine.SheetReferenceResolver(null)),f.addResolver(new GC.Spread.Sheets.CalcEngine.StructureReferenceResolver(null)),f},r}(t.CalcSource);n.CalcSourceBase=i;r=function(t){function i(n,i,r){var u=t.call(this,n,i)||this;return u._formulaSheetDataModel=r,u.useFormulaSheetData=!1,u}return __extends(i,t),i.prototype.getValue=function(n,t){var i,r,u;return typeof n=="number"?(i=arguments[0],r=arguments[1]):(i=n.row,r=n.col),u=this.useFormulaSheetData&&this._formulaSheetDataModel?this._formulaSheetDataModel.getValue(i,r):this.getActualValue(i,r),this.useFormulaSheetData=!1,u},i.prototype.getActualValue=function(t,i){throw n.StaticValues.NeedImplementException;},i.prototype.setValue=function(t,i){var r,u;typeof t=="number"?(r=arguments[0],u=arguments[1],i=arguments[2]):(r=t.row,u=t.col);try{n.FormulaManager.suspendChange();this._formulaSheetDataModel.setValue(r,u,this.ajustFormulaResult(i))}finally{n.FormulaManager.resumeChange()}},i.prototype.ajustFormulaResult=function(n){return n},i.prototype.getSheet=function(){return new f(this)},i}(i);n.SheetCalcSourceBase=r;f=function(){function n(n){this._source=n}return n.prototype.name=function(){return this._source.getName()},n.prototype._getSheetSource=function(){return this._source},n}();e=function(t){function i(n,i,r,u,f){var e=t.call(this,n,i,r)||this;return e._dataModel=f,e._rowCount=u.RowCount,e._columnCount=u.ColumnCount,e}return __extends(i,t),i.prototype.getColumnCount=function(){return this._columnCount},i.prototype.getRowCount=function(){return this._rowCount},i.prototype.getActualValue=function(t,i){if(!this._dataModel)return null;var r=n.Common.getIdStr(t,i,this._name);return this._dataModel.getValue(r)},i}(r);n.PageCalcSource=e;u=function(n){function t(t,i,r,u){var f=n.call(this,t,i,r)||this;return f._dataModel=u,f}return __extends(t,n),t.prototype.getColumnCount=function(){return this._dataModel.getColumnCount()},t.prototype.getRowCount=function(){return this._dataModel.getRowCount()},t.prototype.getActualValue=function(n,t){return this._dataModel?this._dataModel.getValue(n,t):null},t.prototype.ajustFormulaResult=function(n){return typeof n=="number"&&(n=Math.round(n*1e9)/1e9),n},t}(r);n.ListCalcSource=u;o=function(t){function i(n,i){var r=t.call(this,n,"temp")||this;return r._formulaManager=i,r}return __extends(i,t),i.prototype.prepare=function(t){this._formulaCalcInfo={runTimePageName:t.runTimePageName,supportReferToListview:t.supportReferToListview,nullAsException:!!t.nullAsException,listInfo:t.listInfo?t.listInfo:null,rowOffset:n.Common.IsEmpty(t.rowOffset)?0:t.rowOffset,columnOffset:n.Common.IsEmpty(t.columnOffset)?0:t.columnOffset};this.updateRowCountAndColumnCount()},i.prototype.updateRowCountAndColumnCount=function(){var r=n.Common.IsEmpty(this._formulaCalcInfo.runTimePageName)?n.StaticValues.RunTimeNormalPage:this._formulaCalcInfo.runTimePageName,i=this._formulaManager.getCalcSource(r),t;i?(this._rowCount=i.getRowCount(),this._columnCount=i.getColumnCount()):(t=n.PageManager.getContainerCell(r),t&&t.cellType instanceof n.RepeaterCellType&&(this._rowCount=t.cellType.getTempalteRowCount(),this._columnCount=t.cellType.getTempalteColumnCount()))},i.prototype.getColumnCount=function(){return this._columnCount},i.prototype.getRowCount=function(){return this._rowCount},i.prototype.getValue=function(t,i){var e,f,r,h,u,l;typeof t=="number"?(e=arguments[0],f=arguments[1]):(e=t.row,f=t.col);var c=null,o=e,s=f;if(this._formulaCalcInfo.supportReferToListview&&(r=this._getLocatedListview(e,f),r!==null&&(h=r.getCalcSheetName(),c=this._formulaManager.getCalcSource(h),o=this._formulaCalcInfo.listInfo&&typeof this._formulaCalcInfo.listInfo[h]=="number"?this._formulaCalcInfo.listInfo[h]:r.getSelectedRowIndex(),s=f-r.getRangeInfo().Column,r.isEditing()&&s===r.getSelectedColIndex()&&o===r.getSelectedRowIndex())))return r.getEditingValue();if(u=null,c?u=c.getValue({row:o,col:s}):(l=n.Common.getIdStr(o,s,this._formulaCalcInfo.runTimePageName),u=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(l)),this._formulaCalcInfo.nullAsException&&(u===null||u===undefined))throw"";return u},i.prototype._getLocatedListview=function(t,i){return n.Common.getLocatedListview(this._formulaCalcInfo.runTimePageName,t,i)},i}(n.CalcSourceBase);n.FormulaCalculator=o;s=function(n){function t(t,i,r,u){var f=n.call(this,t,i,null,r)||this;return f._spreadJSView=u,f}return __extends(t,n),t.prototype.getRowCount=function(){return this._spreadJSView.getSheetRowCount()},t.prototype.getSheet=function(){return this._spreadJSView.getControl().getActiveSheet()},t}(u);n.ConditionFormatCalcSource=s;h=function(n){function t(t,i){return n.call(this,t,i)||this}return __extends(t,n),t.prototype.getColumnCount=function(){return 0},t.prototype.getRowCount=function(){return 0},t.prototype.getValue=function(n,t){return null},t.prototype.setValue=function(n,t){},t}(i);n.MockCalcSourceBase=h;c=function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u._sheet=r,u}return __extends(t,n),t.prototype.getName=function(){return this._name},t.prototype.getColumnCount=function(){return this._sheet.getColumnCount()},t.prototype.getRowCount=function(){return this._sheet.getRowCount()},t.prototype.getValue=function(n,t){var i,r;return typeof n=="number"?(i=arguments[0],r=arguments[1]):(i=n.row,r=n.col),this._sheet.getValue(i,r)},t.prototype.getSheet=function(){return this._sheet},t}(i);n.PivotTableCalcSource=c}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var y=function(t){function i(){return t.call(this,"ODATA",1,1)||this}return __extends(i,t),i.prototype.defaultValue=function(){return null},i.prototype.getCellCacheKey=function(t){var i="";return t.ctx&&t.ctx.source&&t.ctx.source.getName&&(i=t.ctx.source.getName()),i=n.Common.IsEmpty(i)?"":i,n.ForguncyData.pageInfo.pageName+","+i+","+t.row+","+t.col},i.prototype.evaluateAsync=function(t,r){var u=!n.FormulaManager.syncExecuteAyncFunction,o=this,e,f;return(u&&(i.CellCache[this.getCellCacheKey(t)]=r),e=t.ctx.arrayFormulaMode?i.requestArrayFormulaValueCache:i.requestValueCache,f=e[r],f!==undefined)?f:u&&t.ctx.arrayFormulaMode?this.processODateServerRequest(r,t,u,function(n){for(var f,h,e,i,o,r=[],s=0,u=0;u<n.length;u++){f=n[u];i=[];for(h in f)i.push(f[h]),s++;r.push(i)}if(n.length===1)for(e=1;e<t.ctx.arrayIdentity.rowCount;e++){for(i=[],o=0;o<s;o++)i.push(GC.Spread.CalcEngine.Errors.NotAvailable);r.push(i);break}return new GC.Spread.CalcEngine.CalcArray(r)}):this.processODateServerRequest(r,t,u,function(n){return o.processNormalFomrulaData(n)})},i.prototype.processODateServerRequest=function(t,r,u,f){var o=this,e=null,s=r.ctx.arrayFormulaMode?i.requestArrayFormulaCache:i.requestCache,h=s[t];return h===undefined||u===!1?(u&&(s[t]={contexts:[{contexts:r,shouldCoverBindingValueByFormulaResult:n.FormulaManager.shouldCoverBindingValueByFormulaResult}]}),this._getTableDataByODataFormula(t,r.ctx.source.getName()+"_r"+r.row+"c"+r.col+"_"+t,function(n){n=f(n);e=o.setResult(u,o,t,r,n,e)},function(n){n=f(GC.Spread.CalcEngine.Errors.Value);e=o.setResult(u,o,t,r,n,e)},u)):h.contexts.push({contexts:r,shouldCoverBindingValueByFormulaResult:n.FormulaManager.shouldCoverBindingValueByFormulaResult}),e},i.prototype.setResult=function(n,t,i,r,u,f){return n?t.setAsyncResult(i,r,u,r.ctx.arrayFormulaMode):f=u,f},i.prototype._getTableDataByODataFormula=function(t,i,r,u,f){f===void 0&&(f=!0);n.Common.operateODataPost("Home/GetTableDataODataFormula",t,r,u,f,i)},i.prototype.setAsyncResult=function(t,r,u,f){var e,s,h,o;for((t+"").toLowerCase().indexOf("now()")<0&&(f?i.requestArrayFormulaValueCache[t]=u:i.requestValueCache[t]=u),e=i.requestCache,r.ctx.arrayFormulaMode&&(e=i.requestArrayFormulaCache),s=function(r){var f=e[t].contexts[r],o=f.contexts.ctx.source,l,s,c;if(o instanceof n.ListCalcSource)n.DelayRefresh.Push(null,function(){n.FormulaManager.isReady()&&n.ForguncyData.pageInfo.formulaManager.recalc(f.shouldCoverBindingValueByFormulaResult,o)},"recalcSheet "+o.getName(),!0);else if(o instanceof n.PageCalcSource){l=n.FormulaManager.shouldCoverBindingValueByFormulaResult;n.FormulaManager.shouldCoverBindingValueByFormulaResult=f.shouldCoverBindingValueByFormulaResult;s=f.contexts;try{c=i.CellCache[h.getCellCacheKey(s)];(c===undefined||c===t)&&s.setAsyncResult(u)}finally{n.FormulaManager.shouldCoverBindingValueByFormulaResult=l}}},h=this,o=0;o<e[t].contexts.length;o++)s(o);e[t]=undefined},i.prototype.processNormalFomrulaData=function(n){if(n instanceof Object)if(n.length>0){var t=n[0];return this.getFirstSingleValue(t)}else if(n.length===0)return GC.Spread.CalcEngine.Errors.NotAvailable;return n},i.prototype.getFirstSingleValue=function(n){if(n instanceof Object)for(var t in n)if(t!=="$type")return this.getFirstSingleValue(n[t]);return n},i.clearCache=function(t,r){if(r===void 0&&(r=null),t){t=t.toLocaleLowerCase();var u=i._clearCache(i.requestValueCache,t),f=i._clearCache(i.requestArrayFormulaValueCache,t);r===null&&(r=u||f)}else r===null&&(r=i._hasODataFunctionInCurrentPage()),i.requestValueCache={},i.requestArrayFormulaValueCache={};r&&n.FormulaManager.isReady()&&n.ForguncyData.pageInfo.formulaManager.recalc(!1)},i._hasODataFunctionInCurrentPage=function(){var t=n.ForguncyData.pageInfo.pageName+",";for(var r in i.CellCache)if(r.length>t.length&&r.substr(0,t.length)===t)return!0;return!1},i._clearCache=function(n,t){var r=!1,i;t=t.toLocaleLowerCase();for(i in n)i&&i.toLocaleLowerCase().indexOf(t)!=-1&&(delete n[i],r=!0);return r},i.requestArrayFormulaCache={},i.requestCache={},i.CellCache={},i.requestValueCache={},i.requestArrayFormulaValueCache={},i._recalcSuspended=!1,i}(GC.Spread.CalcEngine.Functions.AsyncFunction),f,r,i,u,e,o,s,h,c,l,a,v;t.ODataFunction=y;var w=function(){function n(){}return n}(),b=function(){function n(){}return n}(),p=function(t){function i(n){var r=t.call(this,i.NAME,1,1)||this;return r._asyncFuncName=n,r}return __extends(i,t),i.prototype.evaluate=function(t){var i=GC.Spread.CalcEngine.Functions.findGlobalFunction(this._asyncFuncName);if(!i)return null;var r=n.ForguncyData.pageInfo.formulaManager.getCalcSource("temp"),u=r.getEvaluatorContext({row:0,col:0},!1,null),f=new GC.Spread.CalcEngine.AsyncEvaluateContext(u);return i.evaluateAsync(f,t)},i.NAME="ASYNCTOSYNC",i}(GC.Spread.CalcEngine.Functions.Function);t.AsyncToSyncFunction=p;f=function(t){function i(){return t.call(this,"TEXTJOINIF",4,5)||this}return __extends(i,t),i.prototype.acceptsReference=function(n){return n===0||n===2||n===4?!0:!1},i.prototype.acceptsArray=function(n){return n===0?!0:!1},i.prototype.evaluate=function(t){var c=[],l=[],b=!!arguments[1],e=arguments[3],a=arguments[2],v=arguments[4]?arguments[4]:arguments[2],r,o,y,s,u,f;if(i.addResult(l,arguments[0],!1),a instanceof GC.Spread.CalcEngine.CalcReference&&v instanceof GC.Spread.CalcEngine.CalcReference){if(r=a,o=v,r.getRangeCount()<1||o.getRangeCount()<1)return null;for(y=e===0||e==="*",s=n.SpreadJSHelpMethods._MathHelper._parseCriteria(e),u=0;u<r.getRowCount(0);u++)for(f=0;f<r.getColumnCount(0);f++){var p={row:u,col:f},w=r.getValue(p,0),h=o.getValue(p,0);if(!(h instanceof GC.Spread.CalcEngine.CalcError)&&(!y||w!==null)&&s&&s(w)){if(b&&n.Common.IsEmpty(h))continue;c.push(h)}}}return i.textJoin(l,c)},i.addResult=function(n,t,r){var o,e,c,h,u,f,s;if(t instanceof GC.Spread.CalcEngine.CalcReference)for(o=t,e=0;e<o.getRangeCount();e++)for(u=0;u<o.getRowCount(e);u++)for(f=0;f<o.getColumnCount(e);f++)c={row:u,col:f},s=o.getValue(c,e),i.addSingleValue(n,s,r);else if(t instanceof GC.Spread.CalcEngine.CalcArray)for(h=t,u=0;u<h.getRowCount();u++)for(f=0;f<h.getColumnCount();f++)s=h.getValue(u,f),i.addSingleValue(n,s,r);else i.addSingleValue(n,t,r)},i.addSingleValue=function(t,i,r){if(n.Common.IsEmpty(i))if(r)return;else i="";t.push(i)},i.textJoin=function(n,t){var u,r,i;if(t.length===0)return"";if(n.length===1)return t.join(n[0]);for(u=t[0],r=1,i=0;r<t.length;r++,i++)i===n.length&&(i=0),u+=n[i]+t[r];return u},i}(GC.Spread.CalcEngine.Functions.Function);t.TextJoinIfFunction=f,function(n){n[n.SingleByte=0]="SingleByte";n[n.DoubleByte=1]="DoubleByte";n[n.FourByte=2]="FourByte"}(r||(r={})),function(n){n[n.SingleByte_All=0]="SingleByte_All";n[n.DoubleByte_FirstHalf=1]="DoubleByte_FirstHalf";n[n.DoubleByte_SecondHalf=2]="DoubleByte_SecondHalf";n[n.FourByte_FirstHalf=3]="FourByte_FirstHalf";n[n.FourByte_SecondHalf=4]="FourByte_SecondHalf";n[n.FourByte_ThirdHalf=5]="FourByte_ThirdHalf";n[n.FourByte_FourthHalf=6]="FourByte_FourthHalf"}(i||(i={}));u=function(){function n(n){this.originStr=n;this.initLength();this.initIterator()}return n.prototype.determineType=function(n){var t=n.charCodeAt(0);return t>=0&&t<129||t===63728||t>=65377&&t<65440||t>=63729&&t<63732?r.SingleByte:t>=55296&&t<=57343?r.FourByte:r.DoubleByte},n.prototype.initLength=function(){this.length=0;for(var n=0;n<this.originStr.length;n++)switch(this.determineType(this.originStr[n])){case r.SingleByte:this.length+=1;break;case r.DoubleByte:case r.FourByte:this.length+=2;break;default:break}},n.prototype.initIterator=function(){var n=1,t;for(this.iteratorType=[],this.iteratorPosition=[],t=0;t<this.originStr.length;t++)switch(this.determineType(this.originStr[t])){case r.SingleByte:this.iteratorType[n]=i.SingleByte_All;this.iteratorPosition[n]=t.toString();++n;break;case r.DoubleByte:this.iteratorType[n]=i.DoubleByte_FirstHalf;this.iteratorPosition[n]=t.toString();++n;this.iteratorType[n]=i.DoubleByte_SecondHalf;this.iteratorPosition[n]=t.toString();++n;break;case r.FourByte:this.iteratorType[n]=i.FourByte_FirstHalf;this.iteratorPosition[n]=t.toString()+"+"+(t+1).toString();++n;this.iteratorType[n]=i.FourByte_SecondHalf;this.iteratorPosition[n]=t.toString()+"+"+(t+1).toString();++n;this.iteratorType[n]=i.FourByte_ThirdHalf;this.iteratorPosition[n]=t.toString()+"+"+(t+1).toString();++n;this.iteratorType[n]=i.FourByte_FourthHalf;this.iteratorPosition[n]=t.toString()+"+"+(t+1).toString();++n;++t;break;default:break}this.iteratorLength=n-1},n}();e=function(t){function i(){return t.call(this,"LENB",1,1)||this}return __extends(i,t),i.prototype.evaluate=function(){for(var i,r,f=[],t=0;t<arguments.length;t++)f[t]=arguments[t];return i=n.SpreadJSHelpMethods.Convert.S(arguments[0]),r=new u(i),r.length},i}(GC.Spread.CalcEngine.Functions.Function);t.LenBFunction=e;o=function(t){function r(){return t.call(this,"FINDB",2,3)||this}return __extends(r,t),r.prototype.evaluate=function(){for(var o,l,y,f,s,p=[],e=0;e<arguments.length;e++)p[e]=arguments[e];var h=n.SpreadJSHelpMethods.Convert,w=n.SpreadJSHelpMethods._Helper,a=h.S(arguments[0]),c=h.S(arguments[1]),t=w._argumentExists(arguments,2)?h.I(arguments[2]):1,r=new u(c),v=r.iteratorLength;if(n.Common.IsEmpty(a)||n.Common.IsEmpty(c))return t>0?v+1:GC.Spread.CalcEngine.Errors.Value;else if(t<1||t>v)return GC.Spread.CalcEngine.Errors.Value;o=-1;switch(r.iteratorType[t]){case i.DoubleByte_FirstHalf:case i.SingleByte_All:case i.FourByte_FirstHalf:break;case i.DoubleByte_SecondHalf:if(t===r.iteratorLength){t=-1;break}++t;break;case i.FourByte_SecondHalf:if(t+3>r.iteratorLength){t=-1;break}t+=3;break;case i.FourByte_ThirdHalf:if(t+2>r.iteratorLength){t=-1;break}t+=2;break;case i.FourByte_FourthHalf:if(t+1>r.iteratorLength){t=-1;break}t+=1;break}if(t===-1)return GC.Spread.CalcEngine.Errors.Value;else t!=-1&&o===-1&&(o=r.iteratorPosition[t].indexOf("+")>0?Number(r.iteratorPosition[t].split("+")[0]):Number(r.iteratorPosition[t]));if(l=c.indexOf(a,o),l===-1)return GC.Spread.CalcEngine.Errors.Value;for(y=0,f=1;f<=r.iteratorLength;f++)if(s=r.iteratorPosition[f],s.indexOf("+")>0&&(s=r.iteratorPosition[f].split("+")[0],++y),s===l.toString())return f},r}(GC.Spread.CalcEngine.Functions.Function);t.FindBFunction=o;s=function(t){function r(){return t.call(this,"LEFTB",1,2)||this}return __extends(r,t),r.prototype.evaluate=function(){for(var r,h,o,c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var s=n.SpreadJSHelpMethods.Convert,l=n.SpreadJSHelpMethods._Helper,e=s.S(arguments[0]),t=l._argumentExists(arguments,1)?s.I(arguments[1]):1;if(n.Common.IsEmpty(e))return n.Common.IsEmpty(t)||t>=0?"":GC.Spread.CalcEngine.Errors.Value;if(r=new u(e),t<0)return GC.Spread.CalcEngine.Errors.Value;else if(t===0)return"";else if(t>=r.iteratorLength)return e;else{h=r.iteratorType[t];o=-1;switch(h){case i.DoubleByte_FirstHalf:if(t===1)return"";--t;break;case i.DoubleByte_SecondHalf:case i.SingleByte_All:case i.FourByte_FourthHalf:break;case i.FourByte_FirstHalf:if(t-1<1)return"";t-=1;break;case i.FourByte_SecondHalf:if(t-2<1)return"";t-=2;break;case i.FourByte_ThirdHalf:if(t-3<1)return"";t-=3;break}return o===-1&&(o=r.iteratorPosition[t].indexOf("+")>0?Number(r.iteratorPosition[t].split("+")[1]):Number(r.iteratorPosition[t])),e.substring(0,Number(o)+1)}},r}(GC.Spread.CalcEngine.Functions.Function);t.LeftBFunction=s;h=function(t){function r(){return t.call(this,"RIGHTB",1,2)||this}return __extends(r,t),r.prototype.evaluate=function(){for(var t,c,o,l=[],e=0;e<arguments.length;e++)l[e]=arguments[e];var h=n.SpreadJSHelpMethods.Convert,a=n.SpreadJSHelpMethods._Helper,f=h.S(arguments[0]),r=new u(f),s=a._argumentExists(arguments,1)?h.I(arguments[1]):1;if(s<0)return GC.Spread.CalcEngine.Errors.Value;else if(s===0)return"";if(t=r.iteratorLength-s+1,n.Common.IsEmpty(f))return n.Common.IsEmpty(t)||t>=0?"":GC.Spread.CalcEngine.Errors.Value;if(isNaN(Number(t))||t<=0)return f;else if(t===0)return"";else{c=r.iteratorType[t];o=-1;switch(c){case i.DoubleByte_FirstHalf:case i.SingleByte_All:case i.FourByte_FirstHalf:break;case i.DoubleByte_SecondHalf:if(t===r.iteratorLength)return"";++t;break;case i.FourByte_SecondHalf:if(t+3>r.iteratorLength){t=-1;break}t+=3;break;case i.FourByte_ThirdHalf:if(t+2>r.iteratorLength){t=-1;break}t+=2;break;case i.FourByte_FourthHalf:if(t+1>r.iteratorLength){t=-1;break}t+=1;break}if(t===-1)return"";else t!=-1&&o===-1&&(o=r.iteratorPosition[t].indexOf("+")>0?Number(r.iteratorPosition[t].split("+")[0]):Number(r.iteratorPosition[t]));return f.substring(Number(o),f.length)}},r}(GC.Spread.CalcEngine.Functions.Function);t.RightBFunction=h;c=function(t){function r(){return t.call(this,"MIDB",3,3)||this}return __extends(r,t),r.prototype.evaluate=function(){for(var l=[],s=0;s<arguments.length;s++)l[s]=arguments[s];var e=n.SpreadJSHelpMethods.Convert.S(arguments[0]),t=n.SpreadJSHelpMethods.Convert.I(arguments[1]),r=new u(e),f=n.SpreadJSHelpMethods.Convert.I(arguments[2]),a=r.iteratorType[t],o=-1,v=r.iteratorType[t+f-1],h=-1,c=t;if(n.Common.IsEmpty(e))return t>0?"":GC.Spread.CalcEngine.Errors.Value;if(t<0||f<0)return GC.Spread.CalcEngine.Errors.Value;if(t>r.iteratorLength)return"";switch(a){case i.DoubleByte_FirstHalf:case i.SingleByte_All:case i.FourByte_FirstHalf:break;case i.DoubleByte_SecondHalf:if(t===r.iteratorLength){t=-1;break}++t;break;case i.FourByte_SecondHalf:if(t+3>r.iteratorLength){t=-1;break}t+=3;break;case i.FourByte_ThirdHalf:if(t+2>r.iteratorLength){t=-1;break}t+=2;break;case i.FourByte_FourthHalf:if(t+3>r.iteratorLength){t=-1;break}t+=1;break}if(t===-1)return"";else t!=-1&&o===-1&&(o=r.iteratorPosition[t].indexOf("+")>0?Number(r.iteratorPosition[t].split("+")[0]):Number(r.iteratorPosition[t]));if(t+f-1>r.iteratorLength)return e.substring(Number(o),e.length);switch(v){case i.DoubleByte_FirstHalf:if(f===1)return"";--f;break;case i.DoubleByte_SecondHalf:case i.SingleByte_All:case i.FourByte_FourthHalf:break;case i.FourByte_FirstHalf:if(t+f-2<1)return"";f-=1;break;case i.FourByte_SecondHalf:if(t+f-3<1)return"";f-=2;break;case i.FourByte_ThirdHalf:if(t+f-4<1)return"";f-=3;break}return h===-1&&(h=r.iteratorPosition[c+f-1].indexOf("+")>0?Number(r.iteratorPosition[c+f-1].split("+")[1]):Number(r.iteratorPosition[c+f-1])),Number(o)!=-1&&Number(h)!=-1?e.substring(Number(o),Number(h)+1):void 0},r}(GC.Spread.CalcEngine.Functions.Function);t.MidBFunction=c;l=function(t){function r(){return t.call(this,"REPLACEB",4,4)||this}return __extends(r,t),r.prototype.evaluate=function(){for(var f,l,v=[],s=0;s<arguments.length;s++)v[s]=arguments[s];var e=n.SpreadJSHelpMethods.Convert.S(arguments[0]),t=n.SpreadJSHelpMethods.Convert.I(arguments[1]),r=n.SpreadJSHelpMethods.Convert.I(arguments[2]),a=n.SpreadJSHelpMethods.Convert.S(arguments[3]);if(n.Common.IsEmpty(e)||n.Common.IsEmpty(t)||n.Common.IsEmpty(a))return"";if((f=new u(e),isNaN(Number(r))||r<0)||isNaN(Number(t))||t<1||t>f.iteratorLength)return GC.Spread.CalcEngine.Errors.Value;r>f.iteratorLength&&(r=f.iteratorLength-1);var y=f.iteratorType[t],o=-1,p=f.iteratorType[t+r-1],h=-1,c=t;switch(y){case i.DoubleByte_FirstHalf:case i.DoubleByte_SecondHalf:case i.SingleByte_All:case i.FourByte_FirstHalf:break;case i.FourByte_SecondHalf:if(t+3>f.iteratorLength){t=-1;break}t+=3;break;case i.FourByte_ThirdHalf:if(t+2>f.iteratorLength){t=-1;break}t+=2;break;case i.FourByte_FourthHalf:if(t+3>f.iteratorLength){t=-1;break}t+=1;break}if(t===-1)return"";else t!=-1&&o===-1&&(o=f.iteratorPosition[t].indexOf("+")>0?Number(f.iteratorPosition[t].split("+")[0]):Number(f.iteratorPosition[t]));if(t+r-1>f.iteratorLength)return e.substring(Number(o),e.length);switch(p){case i.DoubleByte_FirstHalf:case i.DoubleByte_SecondHalf:case i.SingleByte_All:break;case i.FourByte_FirstHalf:if(t+r-2<1)return"";r-=1;break;case i.FourByte_SecondHalf:if(t+r-3<1)return"";r-=2;break;case i.FourByte_ThirdHalf:if(t+r-4<1)return"";r-=3;break;case i.FourByte_FourthHalf:break}return h===-1&&(h=f.iteratorPosition[c+r-1].indexOf("+")>0?Number(f.iteratorPosition[c+r-1].split("+")[1]):Number(f.iteratorPosition[c+r-1])),r=Number(h)-Number(o)+1,l=e.split(""),l.splice(Number(o),r,a),l.join("")},r}(GC.Spread.CalcEngine.Functions.Function);t.ReplaceBFunction=l;a=function(t){function r(){return t.call(this,"SEARCHB",2,3)||this}return __extends(r,t),r.prototype.evaluate=function(){for(var h,e,v,w,y,b,f,c,k=[],o=0;o<arguments.length;o++)k[o]=arguments[o];var l=n.SpreadJSHelpMethods.Convert,d=n.SpreadJSHelpMethods._Helper,a=l.S(arguments[0]),s=l.S(arguments[1]),t=d._argumentExists(arguments,2)?l.I(arguments[2]):1,r=new u(s),p=r.iteratorLength;if(n.Common.IsEmpty(a)||n.Common.IsEmpty(s))return t>0?p+1:GC.Spread.CalcEngine.Errors.Value;else if(t<1||t>p)return GC.Spread.CalcEngine.Errors.Value;switch(r.iteratorType[t]){case i.DoubleByte_FirstHalf:case i.SingleByte_All:case i.FourByte_FirstHalf:break;case i.DoubleByte_SecondHalf:if(t===r.iteratorLength){t=-1;break}++t;break;case i.FourByte_SecondHalf:if(t+3>r.iteratorLength){t=-1;break}t+=3;break;case i.FourByte_ThirdHalf:if(t+2>r.iteratorLength){t=-1;break}t+=2;break;case i.FourByte_FourthHalf:if(t+1>r.iteratorLength){t=-1;break}t+=1;break}if(h=-1,t===-1)return GC.Spread.CalcEngine.Errors.Value;else t!=-1&&h===-1&&(h=r.iteratorPosition[t].indexOf("+")>0?Number(r.iteratorPosition[t].split("+")[0]):Number(r.iteratorPosition[t]));e=-1;try{v=n.SpreadJSHelpMethods.RegUtil.getWildcardCriteria(a);v?(w=n.SpreadJSHelpMethods.RegUtil.getRegIgnoreCase(v),y=w.exec(s),e=n.Common.IsEmpty(y)?-1:y.index):e=s.toLowerCase().indexOf(a.toLowerCase(),h)}catch(g){}if(e===-1)return GC.Spread.CalcEngine.Errors.Value;for(b=0,f=1;f<=r.iteratorLength;f++)if(c=r.iteratorPosition[f],c.indexOf("+")>0&&(c=r.iteratorPosition[f].split("+")[0],++b),c===e.toString())return f},r}(GC.Spread.CalcEngine.Functions.Function);t.SearchBFunction=a;v=function(t){function i(){return t.call(this,"GETURLQUERYVALUE",1,1)||this}return __extends(i,t),i.prototype.evaluate=function(){for(var i,r,u=[],t=0;t<arguments.length;t++)u[t]=arguments[t];return(i=n.SpreadJSHelpMethods.Convert.S(arguments[0]),n.Common.IsEmpty(i))?GC.Spread.CalcEngine.Errors.NotAvailable:(r=n.MetadataLoader.GetUrlQuery(i,!1),r===null)?GC.Spread.CalcEngine.Errors.NotAvailable:r},i}(GC.Spread.CalcEngine.Functions.Function);t.GetUrlQueryValueFunction=v})(t=n.CustomFunction||(n.CustomFunction={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var u=GC.Spread.CalcEngine,f=function(){function i(n){this._isReady=!1;this._bindDataModelEvent(n);this._initCalcService()}return i.prototype._initCalcService=function(){this._calcService=new u.CalcService;this._calcSourceList=[];this._formulaResultSyncOperator=[];this._formulaSheetDataModel=[];this._calcService.getGlobalSourceModel(new n.GlobalSource(this._calcService));this._formulaCalculator=new n.FormulaCalculator(this._calcService,this);this._calcSourceList.push(this._formulaCalculator)},i.isReady=function(){return n.ForguncyData.pageInfo.formulaManager&&n.ForguncyData.pageInfo.formulaManager._isReady},i.prototype.init=function(n,t,i,r){this._initCalcSource(n,t,i,r);this._initDefinedNames(i,this.getDefinedNameInfos(n,i,r));this._initFormula(this.getFormulaInfos(n,i,r));this._isReady=!0},i.prototype._initCalcSource=function(n,t,i,r){var f=this,u;this.addSheetCalcSource(i,n.PageSettings,t.normalCellDataModel);n.MasterPage&&this.addSheetCalcSource(r,n.MasterPage.PageSettings,t.normalCellDataModel);u=t.getListDataList([i,r]);u.forEach(function(n){return f.addListviewSheetCalcSource(n)})},i.prototype.addSheetCalcSource=function(i,r,u){var f=new t(i+t.nameSuffix);this.addCalcSource(new n.PageCalcSource(this._calcService,i,f,r,u));this._formulaSheetDataModel.push(f);this._formulaResultSyncOperator.push(new e(f,i))},i.prototype.addListviewSheetCalcSource=function(i){var r=new t(i.name+t.nameSuffix);this.addCalcSource(new n.ListCalcSource(this._calcService,i.name,r,i));this._formulaSheetDataModel.push(r);this._formulaResultSyncOperator.push(new o(r,i))},i.prototype.getDefinedNameInfos=function(n,t,i){var r={},u;return r[n.PageSettings.Name]=t,n.MasterPage&&(r[n.MasterPage.PageSettings.Name]=i),u=this._translateDefinedNameInfo(t,r,n.DefinedNameInfos),n.MasterPage&&(u=u.concat(this._translateDefinedNameInfo(i,r,n.MasterPage.DefinedNameInfos))),u},i.prototype._translateDefinedNameInfo=function(t,i,r){if(!r)return[];var u=new n.CustomNameFormulaTranslater(t,i);return r.forEach(function(n){return n.Formula=u.translate(n.Formula)}),r},i.prototype._initDefinedNames=function(n,t){var r,i,u;if(t)for(r=this._calcService.getGlobalSourceModel().getSource(),i=0;i<t.length;i++)u=this._calcService.parse(this._calcSourceList[0],t[i].Formula,t[i].BaseRow,t[i].BaseColumn),r.addCustomName(n,t[i],u)},i.prototype.addCalcSource=function(n){var t=this._calcService.getSourceModel(n),i=t.recalculateCell;t.recalculateCell=function(n,t){var r=this.getSource();try{return typeof r.useFormulaSheetData=="boolean"&&(r.useFormulaSheetData=!0),i.apply(this,arguments)}finally{typeof r.useFormulaSheetData=="boolean"&&(r.useFormulaSheetData=!1)}};this._calcSourceList.push(n)},i.prototype.getFormulaInfos=function(n,t,i){var r={};return this._translateFormula(t,n.FormulaInfos,r),n.MasterPage&&this._translateFormula(i,n.MasterPage.FormulaInfos,r),r},i.prototype._translateFormula=function(t,i,r){var u,f,e;if(i){u=n.ListviewBase.getAllListviews([t]);f=function(f){if(!i[f])return"continue";var e=n.Common.IsEmpty(f)?t:n.ListviewBase.getListview(f,t).getCalcSheetName(),o=new n.CellFormulaTranslater(e,t,u);i[f].forEach(function(n){return n.Formula=o.translate(n.Formula)});r[e]=i[f]};for(e in i)f(e)}},i.prototype._initFormula=function(n){var t,r,u,i;this.suspend();try{for(t in n)if(r=this.getCalcSource(t),r&&n[t])for(u=r.getCalcSourceModel(),i=0;i<n[t].length;i++)this._setFormula(u,n[t][i])}finally{this.resume(!1)}},i.prototype._setFormula=function(n,t){t.IsArraryFormula?n.setArrayFormula(t.RowIndex,t.ColumnIndex,t.RowCount,t.ColumnCount,t.Formula):n.setFormula(t.RowIndex,t.ColumnIndex,t.Formula)},i.prototype.setFormula=function(n,t,i){var r=this.getCalcSource(n),u;r&&(this.getRelatedFormulaResultSyncOperator(n).cacheShouldSyncFormulaResultMethod(t.RowIndex,t.ColumnIndex,i),u=r.getCalcSourceModel(),this._setFormula(u,t))},i.prototype.getRelatedFormulaResultSyncOperator=function(n){var t=this._formulaResultSyncOperator.filter(function(t){return t.getRelatedCalcSheetName()===n});return t.length<=0?null:t[0]},i.prototype.preDestroyRunTimePage=function(n){var t=this._calcService.getGlobalSourceModel().getSource();n.forEach(function(n){return t.preRemoveCustomNames(n)})},i.prototype.destroyRunTimePage=function(n){this._removeCustomName(n);this._removeCalcSources(n)},i.prototype._removeCustomName=function(n){var t=this._calcService.getGlobalSourceModel().getSource();n.forEach(function(n){return t.removeCustomNames(n)})},i.prototype._removeCalcSources=function(t){var i=this;t.forEach(function(n){return i._removeCalcSourceAndRelatedModels(n)});n.ListviewBase.getAllListviews(t).forEach(function(n){return i._removeCalcSourceAndRelatedModels(n.getCalcSheetName())})},i.prototype._removeCalcSourceAndRelatedModels=function(n){this.removeCalcSource(n);this._formulaResultSyncOperator=this._formulaResultSyncOperator.filter(function(t){return t.getRelatedCalcSheetName()!==n});this._formulaSheetDataModel=this._formulaSheetDataModel.filter(function(i){return i.name!==n+t.nameSuffix})},i.prototype.removeCalcSource=function(n){var t=this.getCalcSource(n),i;t&&(i=this._calcSourceList.indexOf(t),this._calcService.removeSource(t),this._calcSourceList.splice(i,1))},i.prototype._bindDataModelEvent=function(t){var i=this;t.bind(n.Events.ValueChanged,function(n,t){if(i._calcService)if(t.calcName)i.onListviewValueChanged(t.calcName,t.arg);else i.onNormalCellValueChanged(t.arg)})},i.prototype.onNormalCellValueChanged=function(t){if(!i.isSuspended()){var r=n.Common.parseIDStr(t.id),u=this.getCalcSource(r.suffix);u&&this.recalc(t.valueType!==2,u,r.row,r.col)}},i.prototype.onListviewValueChanged=function(n,t){var r,u;if((this.updateFormulaSheetDataModel(n,t),!i.isSuspended())&&(r=t.cellRange,u=this.getCalcSource(n),u!==null)){var f=u,e=void 0,o=void 0;r.RowCount===1&&r.ColumnCount===1&&r.Row>=0&&r.Column>=0?(e=r.Row,o=r.Column):t.newRowCount<t.oldRowCount&&(f=null);this.recalc(t.valueType!==2,f,e,o)}},i.prototype.updateFormulaSheetDataModel=function(n,i){var f=n+t.nameSuffix,u=this._formulaSheetDataModel.filter(function(n){return n.name===f}),r;if(!(u.length<=0)){r=u[0];switch(i.actionType){case 0:r.clean();break;case 2:r.deleteRow(i.deleteRow);break;case 4:r.insertRow(i.cellRange.Row,i.cellRange.RowCount);default:break}}},i.prototype.recalc=function(t,r,u,f){var s=i.shouldCoverBindingValueByFormulaResult,e,o;i.shouldCoverBindingValueByFormulaResult=t;try{n.Common.IsEmpty(r)||n.Common.IsEmpty(u)||n.Common.IsEmpty(f)?n.Common.IsEmpty(r)?this._calcService.recalculateAll(!0):(e=r.getColumnCount(),o=r.getRowCount(),this._calcService.recalcRange(r,0,0,o,e)):this._calcService.recalculate(r,u,f)}catch(h){}finally{i.shouldCoverBindingValueByFormulaResult=s}},i.prototype.suspend=function(){this._calcService.suspend()},i.prototype.resume=function(n){var t=i.shouldCoverBindingValueByFormulaResult;i.shouldCoverBindingValueByFormulaResult=n;try{this._calcService.resume()}finally{i.shouldCoverBindingValueByFormulaResult=t}},i.prototype.isSuspended=function(){return this._calcService.IsSuspended()},i.prototype.getCalcSource=function(n){for(var i=this._calcSourceList.length,t=0;t<i;t++)if(this._calcSourceList[t].getName()===n)return this._calcSourceList[t];return null},i.prototype.getCalcService=function(){return this._calcService},i.prototype._getMockSheet=function(){return i._mockSheet||(i._mockSheet=new GC.Spread.Sheets.Worksheet("mock"),i._mockSheetCalcService=i._mockSheet.getCalcService(),i._mockSheetSource=new n.MockCalcSourceBase(i._mockSheetCalcService,i._mockSheet.name())),i._mockSheet},i.prototype.restoreMockSheet=function(){i._mockSheet&&i._mockSheet.setCalc(i._mockSheetCalcService,i._mockSheetSource)},i.prototype.evaluateFormula=function(t,r){var f,s,c;if(t=n.ShareCommandParamsContext.Update(t),!i.shouldEvaluateFormula(t))return t;if(t.charAt(0)==="=")try{n.Common.IsEmpty(r.rowOffset)&&(r.rowOffset=0);n.Common.IsEmpty(r.columnOffset)&&(r.columnOffset=0);var u=null,e=0,o=0;r.isTranslatedFormula&&(u=this.getCalcSource(r.runTimePageName),e=r.runTimePageName[0]==="s"?0:r.rowOffset,o=r.columnOffset);u||(this._formulaCalculator.prepare(r),u=this._formulaCalculator);f=this.getCalcService().parse(u,t,e,o);f=(new h).visit(f,e,o);try{return i.syncExecuteAyncFunction=!0,s=this._getMockSheet(),s.setCalc(this._calcService,u),c={convertNullToZero:!1},GC.Spread.Sheets.CalcEngine.evaluateExpression(s,f,r.rowOffset,r.columnOffset,c)}finally{i.syncExecuteAyncFunction=!1}}catch(l){return null}else if(t.charAt(0)==="'")return t.substring(1);return t},i.shouldEvaluateFormula=function(n){return i.isFormula(n)||i.isValueStartWithSingleQuotes(n)},i.isFormula=function(t){return n.Common.IsEmpty(t)||typeof t!="string"||t.length<1||t.charAt(0)!=="="?!1:!0},i.isValueStartWithSingleQuotes=function(t){return n.Common.IsEmpty(t)||typeof t!="string"||t.length<1||t.charAt(0)!=="'"?!1:!0},i.prototype.getValue=function(n,t){try{return this._formulaCalculator.prepare(t),this._formulaCalculator.getValue({row:n.Row,col:n.Column})}catch(i){return null}},i.isSuspended=function(){return this._suspendCount>0},i.suspendChange=function(){this._suspendCount++},i.resumeChange=function(){this._suspendCount--},i.prototype.destroy=function(){this.restoreMockSheet()},i.syncExecuteAyncFunction=!1,i.shouldCoverBindingValueByFormulaResult=!1,i._mockSheet=null,i._mockSheetCalcService=null,i._mockSheetSource=null,i._suspendCount=0,i}(),t,r,e,o,i,s,h;n.FormulaManager=f;t=function(t){function i(n){var i=t.call(this)||this;return i.name=n,i._data=[],i}return __extends(i,t),i.prototype.clean=function(){this._data=[]},i.prototype.insertRow=function(n,t){for(var i,r=[],u=0;u<t;u++)r.push([]);(i=this._data).splice.apply(i,__spreadArrays([n,0],r))},i.prototype.deleteRow=function(n){this._data.splice(n,1)},i.prototype.getValue=function(n,t){if(this._data[n]===undefined)return null;var i=this._data[n][t];return i===undefined?null:i},i.prototype.setValue=function(t,i,r){var f=t,u=this.getValue(t,i);u!==r&&(this._data[t]===undefined&&(this._data[t]=[]),this._data[t][i]=r,this.trigger(n.Events.ValueChanged,{row:t,col:i,oldValue:u,newValue:r}))},i.nameSuffix="__",i}(n.EventClassBase);n.FormulaSheetDataModel=t;r=function(){function t(t){var i=this;this._shouldSyncFormulaResultMethodCache={};t.bind(n.Events.ValueChanged,function(n,t){i.onDataModelValueChanged(t)})}return t.prototype.onDataModelValueChanged=function(n){var t=this.getCurrentValueType(n.row,n.col);this.shouldSyncFormulaResult(n.row,n.col,t)&&this.syncValue(n.row,n.col,n.newValue,!1)},t.prototype.shouldSyncFormulaResult=function(n,t,i){var r=this._shouldSyncFormulaResultMethodCache[n+","+t];return r?r(i):i!==2||f.shouldCoverBindingValueByFormulaResult},t.prototype.getCurrentValueType=function(t,i){throw n.StaticValues.NeedImplementException;},t.prototype.syncValue=function(t,i,r,u){throw n.StaticValues.NeedImplementException;},t.prototype.getRelatedCalcSheetName=function(){throw n.StaticValues.NeedImplementException;},t.prototype.cacheShouldSyncFormulaResultMethod=function(n,t,i){this._shouldSyncFormulaResultMethodCache[n+","+t]=i},t}();n.FormulaResultSyncOperator=r;e=function(t){function i(n,i){var r=t.call(this,n)||this;return r._runTimePageName=i,r}return __extends(i,t),i.prototype.getCurrentValueType=function(t,i){return n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValueType(this.getID(t,i))},i.prototype.syncValue=function(t,i,r){n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.getID(t,i),{newValue:r},4)},i.prototype.getID=function(t,i){return n.Common.getIdStr(t,i,this.getRelatedCalcSheetName())},i.prototype.getRelatedCalcSheetName=function(){return this._runTimePageName},i}(r);n.NormalCellFormulaResultSyncOperator=e;o=function(n){function t(t,i){var r=n.call(this,t)||this;return r._listDataModel=i,r}return __extends(t,n),t.prototype.getCurrentValueType=function(n,t){return this._listDataModel.getValueType(n,t)},t.prototype.syncValue=function(n,t,i){this._listDataModel.setValue(n,t,i,4)},t.prototype.getRelatedCalcSheetName=function(){return this._listDataModel.name},t}(r);n.ListviewCellFormulaResultSyncOperator=o;i=function(){function t(){}return t.getCellLocation=function(i,r){var e,f,o,u;if(i=n.ShareCommandParamsContext.Update(i),e=n.ForguncyData.pageInfo.formulaManager.getCalcSource(r),e||(e=n.ForguncyData.pageInfo.formulaManager.getCalcSource(n.StaticValues.RunTimeNormalPage)),f=n.ForguncyData.pageInfo.formulaManager.getCalcService().parse(e,i,0,0),f.type===GC.Spread.CalcEngine.ExpressionType.name){if(o=f.value,u=n.ForguncyData.pageInfo.pageElementManager.cells.getCellByName(o,!1),u)return{Row:u.row,Column:u.column,PageName:n.PageManager.getDesignerPageName(u.runTimePageName,!1),PageID:u.runTimePageName}}else if(f.type===GC.Spread.CalcEngine.ExpressionType.reference&&(u=f,t.isCellExpression(u)))return{Row:u.row,Column:u.column,PageName:n.PageManager.getDesignerPageName(r,!1),PageID:r};return null},Object.defineProperty(t,"SheetParserContext",{get:function(){return t._sheetParserContext||(t._sheetParserContext=new GC.Spread.Sheets.CalcEngine.SheetParserContext(null,!1,{row:0,col:0})),t._sheetParserContext},enumerable:!0,configurable:!0}),t.parse=function(i,r){var u,e,o;return r===void 0&&(r=!1),f.isReady()||r?(u=n.ForguncyData.pageInfo.formulaManager.getCalcService(),e=n.ForguncyData.pageInfo.formulaManager.getCalcSource("temp"),u.parse(e,i,0,0)):(o=new GC.Spread.CalcEngine.Parser,o.parse(t.SheetParserContext,i))},t.unparse=function(n){var i=new GC.Spread.CalcEngine.Parser;return i.unparse(t.SheetParserContext,n)},t.createCellExpression=function(n,t,i,r,u,f){var e=new GC.Spread.CalcEngine.ReferenceExpression(GC.Spread.CalcEngine.ExpressionType.reference);return e.row=i,e.column=r,e.rowRelative=u,e.columnRelative=f,n&&(e.source=n),t&&(e.endSource=t),e},t.createColumnRangeExpression=function(n,i,r,u,f){return t.createRangeExpression(n,null,GC.Spread.CalcEngine.BAND_INDEX_CONST,i,GC.Spread.CalcEngine.BAND_INDEX_CONST,r,!0,u,!0,f)},t.createRangeExpression=function(n,t,i,r,u,f,e,o,s,h){var c=new GC.Spread.CalcEngine.ReferenceExpression(GC.Spread.CalcEngine.ExpressionType.reference),l;return c.isFullRow=r===GC.Spread.CalcEngine.BAND_INDEX_CONST,c.isFullRow&&i===0&&u===GC.Spread.CalcEngine.MAX_ROW_COUNT-1&&(i=u=GC.Spread.CalcEngine.BAND_INDEX_CONST),c.isFullColumn=i===GC.Spread.CalcEngine.BAND_INDEX_CONST,i>u&&(l=i,i=u,u=l,l=e,e=s,s=l),r>f&&(l=r,r=f,f=l,l=o,o=h,h=l),c.row=i,c.column=r,c.endRow=u,c.endColumn=f,c.rowRelative=e,c.columnRelative=o,c.endRowRelative=s,c.endColumnRelative=h,n&&(c.source=n),t&&(c.endSource=t),c},t.createErrorExpressionfunction=function(n,t,i){var r=new GC.Spread.CalcEngine.Expression(GC.Spread.CalcEngine.ExpressionType.error);return t&&(r.source=t),i&&(r.endSource=i),r.value=n,r},t.createFunctionExpression=function(n,t){var i=new GC.Spread.CalcEngine.Expression(GC.Spread.CalcEngine.ExpressionType.function);return i.arguments=t,n instanceof GC.Spread.CalcEngine.Expression?(i.function=n.function,i.functionName=n.functionName):(i.function=n.name&&n,i.functionName=n.name||n),i},t.createParenthesesExpression=function(n){var t=new GC.Spread.CalcEngine.Expression(GC.Spread.CalcEngine.ExpressionType.parentheses);return t.value=n,t},t.createOperatorExpression=function(n,t,i){var r=new GC.Spread.CalcEngine.Expression(GC.Spread.CalcEngine.ExpressionType.operator);return r.operatorType=n,r.value=t,r.value2=i,r},t.isCellExpression=function(n){return n.endRow===undefined},t}();n.FormulaHelper=i;s=function(){function n(){}return n.prototype.visit=function(n,t,r){if(!n)return n;var f=u.ExpressionType;switch(n.type){case f.reference:return i.isCellExpression(n)?this.visitCellExpression(n,t,r):this.visitRangeExpression(n,t,r);case f.function:return this.visitFunctionExpression(n,t,r);case f.name:return this.visitNameExpression(n,t,r);case f.operator:return this.visitOperatorExpression(n,t,r);case f.parentheses:return this.visitParenthesesExpression(n,t,r);default:return n}},n.prototype.visitCellExpression=function(n,t,i){return n},n.prototype.visitRangeExpression=function(n,t,i){return n},n.prototype.visitFunctionExpression=function(n,t,r){for(var e,o=!1,f=[],u=0;u<n.arguments.length;u++)e=n.arguments[u],f[u]=this.visit(e,t,r),e!=f[u]&&(o=!0);return o?i.createFunctionExpression(n,f):n},n.prototype.visitNameExpression=function(n,t,i){return n},n.prototype.visitOperatorExpression=function(n,t,r){var u=this.visit(n.value,t,r),f=this.visit(n.value2,t,r);return u!==n.value||f!==n.value2?i.createOperatorExpression(n.operatorType,u,f):n},n.prototype.visitParenthesesExpression=function(n,t,r){var u=this.visit(n.value,t,r);return u!==n.value?i.createParenthesesExpression(u):n},n}();n.ExpressionVisitor=s;h=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.visitFunctionExpression=function(r,f,e){var o=t.prototype.visitFunctionExpression.call(this,r,f,e),s;return o.function instanceof u.Functions.AsyncFunction&&(s=new n.CustomFunction.AsyncToSyncFunction(o.functionName),o=i.createFunctionExpression(s,o.arguments)),o},r}(s)}(Forguncy||(Forguncy={})),function(n){var i=function(){function i(){this._defaultFormulas=new t}return i.prototype.setDefaultFormula=function(t){var i=this;i.addDefaultFormulaToCollection(t);t.forEach(function(t){var r=i._defaultFormulas.getDefaultFormulaArray(t);r.forEach(function(i){n.ForguncyData.pageInfo.formulaManager.setFormula(t,i,function(n){return n===0||n===1||n===4})})})},i.prototype.clearDefaultFormula=function(t){var i=this;t.forEach(function(t){var r=i._defaultFormulas.getDefaultFormulaArray(t);r.forEach(function(i){i.Formula="";n.ForguncyData.pageInfo.formulaManager.setFormula(t,i,null)});i._defaultFormulas.clear(t)})},i.prototype.addDefaultFormulaToCollection=function(n){this.addNormalCellDefaultFomrulas(n);this._defaultFormulas.translateFormula(n)},i.prototype.addNormalCellDefaultFomrulas=function(t){var i=this,r=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(t);r.forEach(function(t){var u=t.getDefaultFormula(),r;n.Common.IsEmpty(u)||(r=n.Common.parseIDStr(t.id),i._defaultFormulas.addDefaultFormula(r.suffix,r.row,r.col,u))})},i}(),t;n.DefaultFormulaManager=i;t=function(){function t(){this.defaultFormulas={}}return t.prototype.addDefaultFormula=function(n,t,i,r){var u=this.getDefaultFormulaArray(n),f=this.createFormulaInfo(t,i,r);u.push(f)},t.prototype.getDefaultFormulaArray=function(n){return this.defaultFormulas[n]||(this.defaultFormulas[n]=[]),this.defaultFormulas[n]},t.prototype.createFormulaInfo=function(n,t,i){return{RowIndex:n,ColumnIndex:t,RowCount:1,ColumnCount:1,IsArraryFormula:!1,Formula:i}},t.prototype.translateFormula=function(t){var i=this;t.forEach(function(t){var r=i.getDefaultFormulaArray(t),u,f;r&&(u=n.ListviewBase.getAllListviews([t]),f=new n.CellFormulaTranslater(t,t,u),r.forEach(function(n){return n.Formula=f.translate(n.Formula)}))})},t.prototype.clear=function(n){delete this.defaultFormulas[n]},t}()}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i=function(){function t(){}return t.prototype.translate=function(t,i,r){if(i===void 0&&(i=0),r===void 0&&(r=0),n.Common.IsEmpty(t))return t;var u=n.FormulaHelper.parse(t,!0),f=this.createExpressionVisitor(),e=f.visit(u,i,r);return n.FormulaHelper.unparse(e)},t}(),r,u;n.FormulaTranslater=i;r=function(n){function t(t,i,r){var u=n.call(this)||this;return u._calcSourceName=t,u._runTimePageName=i,u._listviewList=r,u}return __extends(t,n),t.prototype.createExpressionVisitor=function(){return this._calcSourceName===this._runTimePageName?new f(this._listviewList):new e(this._calcSourceName,this._runTimePageName,this._listviewList)},t}(i);n.CellFormulaTranslater=r;var t=function(){function t(){}return t.getCalcSource=function(t){return n.ForguncyData.pageInfo.formulaManager.getCalcSource(t)},t.getLocatedListview=function(n,i,r,u,f){var o,e,s,h;if(n)for(o=n.length,e=0;e<o;e++)if(s=n[e].getRangeInfo(),h=n[e].getColumnHeaderRangeInfo(),t.isRangeIncluded(s,i,r,u,f)&&!t.isRangeIncluded(h,i,r,u,f))return n[e];return null},t.isRangeIncluded=function(n,t,i,r,u){return t>=n.Row&&r<n.Row+n.RowCount&&i>=n.Column&&u<n.Column+n.ColumnCount},t.getColumnIndexInListview=function(n,t){var r=n.getMergedColumnInfos(),i;if(r)for(i=0;i<r.length;i++)if(r[i].DesignerColumnIndex<=t&&r[i].DesignerColumnIndex+r[i].DesignerColumnCount>t){t=r[i].DesignerColumnIndex;break}return t-n.getRangeInfo().Column},t}(),f=function(i){function r(n){var t=i.call(this)||this;return t._listviewList=n,t}return __extends(r,i),r.prototype.visitNameExpression=function(n,t,i){return n.source=null,n},r.prototype.visitCellExpression=function(i,r,u){var f,o,e;return i.source?i:(f=t.getLocatedListview(this._listviewList,i.row,i.column,i.row,i.column),!f)?i:(o=t.getCalcSource(f.getCalcSheetName()),e=t.getColumnIndexInListview(f,i.column),n.FormulaHelper.createColumnRangeExpression(o,e,e,!0,!0))},r.prototype.visitRangeExpression=function(i,r,u){var f;if(i.source||(f=t.getLocatedListview(this._listviewList,i.row,i.column,i.endRow,i.endColumn),!f))return i;var e=t.getCalcSource(f.getCalcSheetName()),o=t.getColumnIndexInListview(f,i.column),s=t.getColumnIndexInListview(f,i.endColumn);return n.FormulaHelper.createColumnRangeExpression(e,o,s,!0,!0)},r}(n.ExpressionVisitor),e=function(i){function r(n,t,r){var u=i.call(this)||this;return u._calcSourceName=n,u._runTimePageName=t,u._listviewList=r,u}return __extends(r,i),r.prototype.visitNameExpression=function(n,t,i){return n.source=null,n},r.prototype.visitCellExpression=function(i,r,u){var f,e,o;return i.source?i:(f=t.getLocatedListview(this._listviewList,i.row,i.column,i.row,i.column),e=t.getCalcSource(f?f.getCalcSheetName():this._runTimePageName),f?(o=t.getColumnIndexInListview(f,i.column),f.getCalcSheetName()===this._calcSourceName?n.FormulaHelper.createCellExpression(e,null,0,o,i.rowRelative,i.columnRelative):n.FormulaHelper.createColumnRangeExpression(e,o,o,!0,!0)):(i.source=e,i))},r.prototype.visitRangeExpression=function(i,r,u){var f,e,o,s;return i.source?i:(f=t.getLocatedListview(this._listviewList,i.row,i.column,i.endRow,i.endColumn),e=t.getCalcSource(f?f.getCalcSheetName():this._runTimePageName),f?(o=t.getColumnIndexInListview(f,i.column),s=t.getColumnIndexInListview(f,i.endColumn),f.getCalcSheetName()===this._calcSourceName?n.FormulaHelper.createRangeExpression(e,null,0,o,0,s,i.rowRelative,i.columnRelative,i.endRowRelative,i.endColumnRelative):n.FormulaHelper.createColumnRangeExpression(e,o,s,!0,!0)):(i.source=e,i))},r}(n.ExpressionVisitor),o=function(n){function t(t,i){var r=n.call(this)||this;return r._runTimePageName=t,r._namePair=i,r}return __extends(t,n),t.prototype.createExpressionVisitor=function(){return new u(this._runTimePageName,this._namePair)},t}(i);n.CustomNameFormulaTranslater=o;u=function(i){function r(n,t){var r=i.call(this)||this;return r._runTimePageName=n,r._namePair=t,r}return __extends(r,i),r.prototype.visitNameExpression=function(n,t,i){return n.source=null,n},r.prototype.visitCellExpression=function(n,t,i){return this.visitRangeExpression(n,t,i)},r.prototype.visitRangeExpression=function(i,r,u){var f=this._runTimePageName,e;return i.source instanceof GC.Spread.CalcEngine.CalcSource&&(e=i.source.getName(),f=this._namePair[e],n.Common.IsEmpty(f))?i:(i.source=t.getCalcSource(f),i)},r}(n.ExpressionVisitor)}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(){}return t.GetEditorInfo=function(t,i,r){var u={editorDataInfos:t};n.Common.forguncyPost("Home/GetEditorInfo",u,function(t,r){var u=n.Common.IsEmpty(t)?null:JSON.parse(t);i&&i.apply(null,[u])},r+" GetEditorInfo")},t.GetTableDataWithOffset=function(t,i,r,u){var f={bindingInfos:t.columnBindingInfos,currentRowInfo:t.rowInfo,demandRowCount:t.demandRowCount,currentDataLength:t.currentDataLength,needRowVersion:t.needRowVersion,queryCommandInfo:t.queryData,editorDataInfos:t.editorDataInfos,sortCommandID:t.sortCommandID,orderByInfo:t.sortInfo,offsetConditionInfo:t.offsetCondition,columnFilterQueries:t.columnFilterQueries,totalRowBindingInfos:t.totalRowBindingInfos};n.Common.forguncyPost("Home/GetTableDataWithOffset",f,function(t,r){var u=n.Common.IsEmpty(t)?null:JSON.parse(t);i&&i.apply(null,[u])},u+" GetTableDataWithOffset",function(){r()})},t.GetTotalRowValues=function(t,i,r){var u={bindingInfos:t.columnBindingInfos,currentRowInfo:t.rowInfo,queryCommandInfo:t.queryData,columnFilterQueries:t.columnFilterQueries,totalRowBindingInfos:t.totalRowBindingInfos};n.Common.forguncyPost("Home/GetTotalRowValues",u,function(n,t){i&&i.apply(null,[n])},r+" GetTotalRowValues")},t.GetRowCount=function(t,i){var r="Home/GetRowCount";n.Common.forguncyPostSync(r,t,function(n){i&&i.apply(null,[n])})},t.GetRowsDataForColumnFilter=function(t,i,r){var u={bindingInfos:t.columnBindingInfos,currentRowInfo:t.rowInfo,queryCommandInfo:t.queryData,sortCommandID:t.sortCommandID,orderByInfo:t.sortInfo,offsetConditionInfo:t.offsetCondition,columnFilterQueries:t.columnFilterQueries};n.Common.forguncyPost("Home/GetRowsDataForColumnFilter",u,function(n,t){i&&i.apply(null,[n])},r+" GetRowsDataForColumnFilter")},t.GetTableDataByColumnBindingInfo=function(t,i,r,u){u===void 0&&(u=!0);var f="Home/GetTableDataByColumnBindingInfos",e=function(t,r){var u=n.Common.IsEmpty(t)?null:JSON.parse(t);i&&i.apply(null,[u])};u?n.Common.forguncyPost(f,t,e,r+" GetTableDataByColumnBindingInfos"):n.Common.forguncyPostSync(f,t,e)},t.GetTableRowData=function(t,i){var r={bindingInfos:t.columnBindingInfos,query:t.query,currentTableName:t.table};n.Common.forguncyPost("Home/GetTableRowData",r,function(t,r){var u=n.Common.IsEmpty(t)?null:JSON.parse(t);i&&i.apply(null,[u])},"GetTableRowData "+t.table)},t.SetUserSelectorItemsInfo=function(t,i){var r="Account/GetUsers",u={role:typeof t.Role=="undefined"?"":t.Role,displayColumnName:t.DisplayColumnName===undefined?"":t.DisplayColumnName,columns:t.Columns,customColumns:t.CustomColumns===undefined?"":t.CustomColumns.join(",")};n.Common.forguncyPost(r,u,function(i){var o,f,e,u,r;if(t.ItemsInfo=i||{Items:[]},t.haveLoadItems=!0,t.UserInfo=[],i!=null&&i.Properties!=null)for(o=i.Properties.users,f=JSON.parse(i.Properties.columns),e=0;e<o.length;e++){u=o[e];r=null;switch(t.DisplayColumnName){case"Name":r=u.UserName;break;case"FullName":r=u.FullName;break;case"Email":r=u.Email;break;default:r=n.UserInfoHelper.getUserPropertyValue(u,t.DisplayColumnName);break}n.Common.IsEmpty(r)&&n.Common.IsEmpty(t.DisplayColumnName)&&(f.Name?r=u.UserName:f.FullName?r=u.FullName:f.Email?r=u.Email:t.CustomColumns&&t.CustomColumns.length>0&&(r=n.UserInfoHelper.getUserPropertyValue(u,t.CustomColumns[0])));t.UserInfo.push({Value:u.UserName,DisplayValue:r})}},"GetUsers "+i)},t.CommitEditedTable=function(t,i,r){var u={editedTableInfo:t.tableInfo,columnBindingInfos:t.bindingInfos,listviewName:t.viewName,masterQuery:t.masterQuery};n.Common.forguncyPost("Home/CommitEditedTable",u,function(n){i&&i.apply(null,[n])},null,r)},t.RefreshToken=function(){var i=setInterval(function(){var r,u;if(n.ForguncyData.IsConcurrenyUserLicense){for(r in n.BuiltInPageManager.builtInPages)if(n.BuiltInPageManager.builtInPages[r]===n.ForguncyData.pageInfo.pageName)return;n.ForguncyData.AutoDisconnectTimeout&&(u=n.ForguncyData.AutoDisconnectTimeout,(new Date).valueOf()-t.lastOperateTime.valueOf()>u*6e4&&($(window.document.body).children().remove(),clearInterval(i),$(window.document.body).append(t.CreateDisconnectedPage()),$(window.document.body).css("height","90%"),$("html").css("height","100%")));n.Common.forguncyPost("Refresh/B0DA262E-08A7-48FE-B478-BDE2B817B902",null,function(){})}},6e4)},t.CreateDisconnectedPage=function(){var t=n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/pageDisconnected.png";return $('\n    <div style="margin:auto" class="container">\n        <style>\n            .container{\n                width: 100%;\n                height: 80%;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                flex-direction: column;\n            }\n            .reloadButton{\n                background: #4A90E2;\n                padding: 10px 30px;\n                color: white;\n                border: none;\n            }\n            .reloadButton:hover{\n                background: #8AB7EC;\n                cursor:pointer;\n            }\n            .reloadButton:active{\n                background: #3080DD;\n            }\n          <\/style>\n        <img src="'+t+'" style="margin-bottom:55px"><img>\n        <div style="margin-bottom:10px">'+n.RS.LongTimeNoOperation+'<\/div>\n        <div style="margin-bottom:40px">'+n.RS.PleaseClickButtonToReload+'<\/div>\n        <button class="reloadButton" onclick="location.reload()">'+n.RS.ReloadPage+"<\/button>\n    <\/div>\n")},t.Operate=function(){t.lastOperateTime=new Date},t.GetQueryInfo=function(t,i,r){var u={tableName:t,queryDic:i};n.Common.forguncyPost("Home/GetQueryInfo",u,function(n){r&&r.apply(null,[n])},"GetQueryInfo"+t)},t.GetQueryInfoByCondition=function(t,i){var r={queryCondition:t};n.Common.forguncyPost("Home/GetQueryInfoByCondition",r,function(n){i&&i.apply(null,[n])},"GetQueryInfoByCondition"+t.Id)},t.lastOperateTime=new Date,t}();n.HomeController=t;n.HomeController.RefreshToken();window.addEventListener("mousedown",function(){t.Operate()},!0);window.addEventListener("keydown",function(){t.Operate()},!0);window.addEventListener("touchstart",function(){t.Operate()},!0)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var t;(function(t){var f=function(){function t(){this.events=new n.EventClassBase}return t.prototype.on=function(n,t){return this.events.bind(n,t),this},t.prototype.off=function(n,t){return this.events.unbind(n,t),this},t.prototype.dispatch=function(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return(i=this.events).trigger.apply(i,__spreadArrays([n],r)),this},t.prototype.dispose=function(){this.events.unbindAll()},t}(),i,r,u,e,o;t.EventDispatcher=f;i=function(n){function t(){var t=n.call(this)||this;return t.enabled=!0,t.visibility=!0,t.focusable=!1,t.isFocus=!1,t.properties=[],t.registDefaultProperties(),t}return __extends(t,n),t.prototype.registDefaultProperties=function(){this.registProperty("id");this.registProperty("enabled");this.registProperty("visibility");this.registProperty("focusable");this.registProperty("isFocus")},t.prototype.refresh=function(){return this.dispatch("Refresh"),this},t.prototype.identify=function(n){return this.id=n,this},t.prototype.show=function(){return this.refresh(),this.visibility=!0,this},t.prototype.hide=function(){return this.visibility=!1,this},t.prototype.focus=function(){return this.isFocus=!0,this},t.prototype.blur=function(){return this.isFocus=!1,this},t.prototype.enable=function(){return this.enabled=!0,this},t.prototype.disable=function(){return this.enabled=!1,this},t.prototype.dispose=function(){this.dispatch("Dispose");n.prototype.dispose.call(this)},t.prototype.createUI=function(n){return n===void 0&&(n=this.defaultUI),new n(this)},t.prototype.bindProperty=function(n,t,i){var r=this;this.properties.indexOf(i)<0&&this.registProperty(i);n.properties.indexOf(t)<0&&n.registProperty(t);n[t]=this[i];n.on("PropertyChanged",function(u,f){f===t&&n&&(r[i]=n[t])});this.on("PropertyChanged",function(u,f){f===i&&n&&(n[t]=r[i])})},t.prototype.registProperty=function(n,t){var u,i,r;t===void 0&&(t=this[n]);i=this;r="_"+n;this[r]=t;Object.defineProperties(this,(u={},u[n]={get:function(){return i[r]},set:function(t){if(t!==i[r]){i[r]=t;i.onPropertyChanged(n)}}},u));this.properties.push(n)},t.prototype.onPropertyChanged=function(n){this.dispatch("PropertyChanged",n)},t}(f);t.UserControl=i;r=function(){function n(n){this.target=n;this.createContainer();this.createContainerEvents();this.createModifiers();this.invokeModifyContainer();this.refresh()}return n.prototype.refresh=function(){return this.disposeChildren(),this.container.empty(),this.createChildren(),this},n.prototype.dispose=function(){this.disposeChildren();this.container.remove()},n.prototype.applyModifier=function(n){return this.modifiers||(this.modifiers=[]),this.modifiers.push(n),this},n.prototype.createContainer=function(){this.container=$("<div><\/div>")},n.prototype.createContainerEvents=function(){},n.prototype.createModifiers=function(){},n.prototype.invokeModifyContainer=function(){this.modifiers&&this.modifiers.forEach(function(n){n.modifyContainer()})},n.prototype.createChildren=function(){},n.prototype.disposeChildren=function(){var n;(n=this.childrenUI)===null||n===void 0?void 0:n.forEach(function(n){var t;(t=n)===null||t===void 0?void 0:t.dispose()});this.childrenUI=[]},n.prototype.addChild=function(n,t){return t===void 0&&(t=this.container),n&&t&&(this.childrenUI.push(n),t.append(n.container)),n},n}();t.JQueryUIBase=r;u=function(t){function i(n){var i=t.call(this,n)||this;i.target.on("Refresh",function(){i.refresh()});i.target.on("PropertyChanged",function(n,t){i[t]=i.target[t]});i.target.on("Dispose",function(){i.dispose()});return i}return __extends(i,t),Object.defineProperty(i.prototype,"id",{set:function(t){n.Common.IsEmpty(t)?this.container.removeAttr("id"):this.container.attr("id",t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"enabled",{set:function(n){this.setEnabledProperty(n)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visibility",{set:function(n){n?this.container.show():this.container.hide()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"focusable",{set:function(n){n&&this.target.enabled?this.focusableContainer.attr("tabindex","0"):this.focusableContainer.removeAttr("tabindex")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isFocus",{set:function(n){n&&this.target.focusable?this.focusableContainer[0].focus():this.focusableContainer[0].blur()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"focusableContainer",{get:function(){return this.container},enumerable:!0,configurable:!0}),i.prototype.refresh=function(){return t.prototype.refresh.call(this),this.initializeProperties(),this.invokeModifyProperties(),this.bindFocusAndBlurEvent(),this},i.prototype.initializeProperties=function(){var n=this;this.target.properties.forEach(function(t){n[t]=n.target[t]})},i.prototype.invokeModifyProperties=function(){this.modifiers&&this.modifiers.forEach(function(n){n.modifyProperties()})},i.prototype.bindFocusAndBlurEvent=function(){var n=this;this.focusableContainer.on("focus",function(){n.target.focus();n.container.toggleClass("FUI-focus",!0)});this.focusableContainer.on("blur",function(){n.target.blur();n.container.toggleClass("FUI-focus",!1)})},i.prototype.setEnabledProperty=function(n,t){t===void 0&&(t=this.container);n?(t.removeClass("FUI-disable"),t.removeAttr("disabled"),this.focusable=this.target.focusable):(t.addClass("FUI-disable"),t.attr("disabled","disabled"),this.focusable=!1)},i}(r);t.ControlUIBase=u;e=function(n){function t(){var t=n.call(this)||this;return t.moveable=!1,t.registProperty("location"),t}return __extends(t,n),t.prototype.updateSizeFromUI=function(){this.dispatch("UpdateSizeFromUI")},t}(i);t.MoveableControl=e;o=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"location",{set:function(n){n&&this.target.moveable&&this.container.offset({left:n.x,top:n.y})},enumerable:!0,configurable:!0}),i.prototype.createContainerEvents=function(){t.prototype.createContainerEvents.call(this);this.bindUpdateSizeEvent()},i.prototype.bindUpdateSizeEvent=function(){var n=this;this.target.on("UpdateSizeFromUI",function(){n.onUpdateSizeEvent()})},i.prototype.onUpdateSizeEvent=function(t){t===void 0&&(t=this.container);this.target.sizeFromUI=new n.Numerics.Vector2(t.width(),t.height())},i}(u);t.MoveableControlUI=o})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=function(){function n(n){this.ui=n}return n.prototype.modifyContainer=function(){},n.prototype.modifyProperties=function(){},n}(),r,u,f,e;t.UIModifier=i;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.modifyContainer=function(){(n.Platform.isIE()||n.Platform.isOldEdge())&&this.ui.container.addClass("FUI-no-animation")},i}(i);t.DialogNoAnimationModifier=r;u=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.modifyContainer=function(){this._enforceFocusToPopupContainer()},i.prototype._enforceFocusToPopupContainer=function(){$(document).off("focusin #"+this.ui.target.id,"",i._documentFocusinHandler);$(document).on("focusin #"+this.ui.target.id,"",this.ui,i._documentFocusinHandler)},i._documentFocusinHandler=function(t){var o=t.data,f=document.activeElement,r=$(f),e,u;if(r.attr("imcontroltype")!=="Calendar"&&r.attr("ignoreFocusInPopup")!=="true"&&!(r.closest('[ignoreFocusInPopup="true"]').length>0)&&r.attr("FGCPopup")!=="true"&&!(r.closest('[FGCPopup="true"]').length>0)&&!(r.parents("#fgc-columnfilter-contextmenu").length>0)&&!(r.parents("#fgc-rowheader-contextmenu").length>0)&&r.parents("#pagesContainer").length!==0){if(e=$(".FUI-dialog").not(":hidden"),e.length===0){$(document).off("focusin #"+o.target.id,i._documentFocusinHandler);return}u=e.last();u[0]===f||u.has(f).length||(r.attr("gcuielement")==="gcSheetFocusElementForTab"?n.DelayRefresh.setTimeout(function(){i.lostAllListviewsFocus();i.moveFocusToFirstElement(u[0])}):i.moveFocusToFirstElement(u[0]))}},i.lostAllListviewsFocus=function(){var t=n.ListviewBase.getAllListviews();t.forEach(function(n){n.focus(!1)})},i.moveFocusToFirstElement=function(t){var i=n.FocusMoveHelper.MoveFocusToFirstElement();i||t.focus()},i}(i);t.DialogFocusModifier=u;f=function(){function t(n){this.placement=n}return Object.defineProperty(t.prototype,"location",{get:function(){var t=this.placement.offset();return new n.Numerics.Vector2(t.left,t.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var t=this.placement.outerWidth(),i=this.placement.outerHeight();return new n.Numerics.Vector2(t,i)},enumerable:!0,configurable:!0}),t}();t.Anchor=f;e=function(t){function i(n,i){var r=t.call(this,n)||this;r.anchor=i;n.target.on("Dispose",function(){r.releaseResizeEvent()});return r}return __extends(i,t),i.prototype.modifyProperties=function(){this.releaseResizeEvent();this.bindResizeEvent();this.adjustLocation()},i.prototype.bindResizeEvent=function(){var n=this;this.resizeHandler=function(){window.requestAnimationFrame(function(){return n.adjustLocation()})};$(window).on("resize",this.resizeHandler)},i.prototype.releaseResizeEvent=function(){this.resizeHandler&&$(window).off("resize",this.resizeHandler)},i.prototype.adjustLocation=function(){var e=this.anchor.location,r=e.x,u=e.y,o=this.anchor.size,y=o.x,f=o.y,s=this.ui.dialog.width(),h=this.ui.dialog.height(),c=$(document).scrollLeft(),l=$(document).scrollTop(),a=c+$(window).innerWidth(),v=l+$(window).innerHeight(),i=r,t;r+s>a&&(i=r+y-s);(i<c||i>a)&&(i=r);t=u+f;u+f+h>v&&(t=u-h);(t<l||t>v)&&(t=u+f);this.ui.target.location=new n.Numerics.Vector2(i,t)},i}(i);t.DialogLocationModifier=e})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t,r,i;n.FlexDirectionCSSNames=(t={},t[0]="FUI-flex-direction-row",t[1]="FUI-flex-direction-column",t[2]="FUI-flex-direction-row-reverse",t[3]="FUI-flex-direction-column-reverse",t);r=function(n){function t(t){t===void 0&&(t=0);var r=n.call(this)||this;return r.items=[],r.defaultUI=i,r.registProperty("items"),r.registProperty("layout",t),r}return __extends(t,n),t.prototype.add=function(n){this.items.push(n);this.onPropertyChanged("items")},t}(n.UserControl);n.FlexLayout=r;i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"items",{set:function(n){this.container.empty();this.createChildren()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"layout",{set:function(t){for(var i in n.FlexDirectionCSSNames)this.container.removeClass(n.FlexDirectionCSSNames[i]);this.container.addClass(n.FlexDirectionCSSNames[t])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cssName",{get:function(){return""},enumerable:!0,configurable:!0}),i.prototype.createContainer=function(){this.container=$('<div class="FUI-flexlayout '+this.cssName+'"><\/div>')},i.prototype.createChildren=function(){var n=this;this.target.items&&this.target.items.forEach(function(t){n.addChild(t.createUI())})},i}(n.ControlUIBase);n.FlexLayoutUI=i})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var r=function(n){function i(i,r,u){i===void 0&&(i="");r===void 0&&(r="");u===void 0&&(u="");var f=n.call(this)||this;return f.focusable=!0,f.defaultUI=t,f.registProperty("text",i),f.registProperty("svg",r),f.registProperty("tooltip",u),f}return __extends(i,n),i.prototype.click=function(){this.dispatch("Clicked")},i}(n.UserControl),t,u,i;n.Button=r;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"text",{set:function(n){this.textContainer.text(n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"svg",{set:function(n){this.svgContainer.empty();this.svgContainer.append($(n))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltip",{set:function(n){this.container.attr("title",n)},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<div class="FUI-button"><\/div>')},t.prototype.createChildren=function(){this.svgContainer=$('<span class="FUI-button-svg"><\/span>');this.textContainer=$('<span class="FUI-button-text"><\/span>');this.container.append(this.svgContainer,this.textContainer)},t.prototype.createContainerEvents=function(){var t=this;n.prototype.createContainerEvents.call(this);this.container.on("mousedown",function(n){n.stopPropagation()});this.container.on("mouseup",function(n){n.stopPropagation()});this.container.on("click",function(n){n.stopPropagation();t.target.click()});this.container.on("keypress",function(n){(n.keyCode===13||n.keyCode===32)&&(n.preventDefault(),n.stopPropagation(),t.target.click())})},t}(n.ControlUIBase);n.ButtonUI=t;u=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.defaultUI=i,t}return __extends(t,n),t.prototype.click=function(){n.prototype.click.call(this);this.isChecked=!this.isChecked},t}(r);n.ToggleButton=u;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"isChecked",{set:function(n){this.container.toggleClass("FUI-checked",n)},enumerable:!0,configurable:!0}),t}(t);n.ToggleButtonUI=i})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var i=function(n){function i(){var i=n!==null&&n.apply(this,arguments)||this;return i.defaultUI=t,i}return __extends(i,n),i}(n.FlexLayout),t;n.ButtonGroup=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"cssName",{get:function(){return"FUI-button-group"},enumerable:!0,configurable:!0}),t}(n.FlexLayoutUI);n.ButtonGroupUI=t})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var i=function(n){function i(i){var r=n.call(this)||this;return r.isChecked=!1,r.focusable=!0,r.defaultUI=t,r.registProperty("text",i),r.registProperty("isChecked"),r}return __extends(i,n),i}(n.UserControl),t;n.Toggle=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"text",{set:function(n){this.textContainer.text(n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{set:function(n){this.inputContainer[0].checked=n;this.container.toggleClass("FUI-checked",n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusableContainer",{get:function(){return this.inputContainer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cssName",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return""},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<label class="FUI-toggle '+this.cssName+'"><\/label>')},t.prototype.createChildren=function(){this.createInnerContainer();this.createTextContainer();this.container.append(this.innerContainer,this.textContainer)},t.prototype.createInnerContainer=function(){var n=this;this.innerContainer=$('<label class="FUI-toggle-inner"/>');this.inputContainer=$('<input type="'+this.type+'" class="FUI-toggle-input"/>').on("change",function(t){n.target.isChecked=n.inputContainer[0].checked});this.innerContainer.append(this.inputContainer)},t.prototype.createTextContainer=function(){this.textContainer=$('<span class="FUI-toggle-text"><\/span>').text(this.target.text)},t.prototype.setEnabledProperty=function(t){n.prototype.setEnabledProperty.call(this,t);t?this.inputContainer.removeAttr("disabled"):this.inputContainer.attr("disabled","disabled")},t}(n.ControlUIBase);n.ToggleUI=t})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var i=function(n){function i(){var i=n!==null&&n.apply(this,arguments)||this;return i.defaultUI=t,i}return __extends(i,n),i}(n.Toggle),t;n.Radio=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"cssName",{get:function(){return"FUI-radio"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return"radio"},enumerable:!0,configurable:!0}),t.prototype.createInnerContainer=function(){var t=this;n.prototype.createInnerContainer.call(this);this.inputContainer.on("change",function(n){t.target.isChecked&&$("input[name="+t.inputContainer.attr("name")+"]").not(t.inputContainer).trigger("change")})},t}(n.ToggleUI);n.RadioUI=t})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var i=function(n){function i(){var i=n!==null&&n.apply(this,arguments)||this;return i.defaultUI=t,i}return __extends(i,n),i}(n.FlexLayout),t;n.RadioGroup=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"cssName",{get:function(){return"FUI-radio-group"},enumerable:!0,configurable:!0}),t}(n.FlexLayoutUI);n.RadioGroupUI=t})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var i=function(n){function i(i){var r=n.call(this,i)||this;return r.indeterminate=!1,r.defaultUI=t,r.registProperty("indeterminate"),r}return __extends(i,n),i}(n.Toggle),t;n.CheckBox=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"indeterminate",{set:function(n){this.inputContainer[0].indeterminate=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cssName",{get:function(){return"FUI-checkbox"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return"checkbox"},enumerable:!0,configurable:!0}),t.prototype.createContainerEvents=function(){var t=this;n.prototype.createContainerEvents.call(this);this.container.on("keydown",function(n){n.keyCode===32&&(n.preventDefault(),n.stopPropagation(),t.target.isChecked=!t.target.isChecked)})},t.prototype.createInnerContainer=function(){var t=this;n.prototype.createInnerContainer.call(this);this.inputContainer.on("change",function(n){t.target.indeterminate=t.inputContainer[0].indeterminate});this.inputContainer.on("mousedown",function(n){t.target.indeterminate&&(t.target.indeterminate=!1,t.inputContainer.trigger("change"))})},t}(n.ToggleUI);n.CheckBoxUI=t})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var i=function(n){function i(){var i=n!==null&&n.apply(this,arguments)||this;return i.defaultUI=t,i}return __extends(i,n),i}(n.FlexLayout),t;n.CheckBoxGroup=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"cssName",{get:function(){return"FUI-checkbox-group"},enumerable:!0,configurable:!0}),t}(n.FlexLayoutUI);n.CheckBoxGroupUI=t})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var c='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><title>Check menu button<\/title><g fill="#4A9F26" fill-rule="nonzero"><path d="M8 1C4.135 1 1 4.135 1 8s3.135 7 7 7 7-3.135 7-7-3.135-7-7-7zm0 12.833A5.835 5.835 0 0 1 2.167 8 5.82 5.82 0 0 1 8 2.167 5.82 5.82 0 0 1 13.833 8 5.82 5.82 0 0 1 8 13.833z"/><path d="M10.07 6.192L7.11 9.544l-1.203-1.36a.506.506 0 0 0-.757 0c-.2.226-.2.63 0 .856l1.581 1.79c.2.227.557.227.757 0l3.362-3.806c.2-.227.2-.63 0-.857a.513.513 0 0 0-.78.025z"/><\/g><\/svg>',l=function(n){function t(t){t===void 0&&(t=[]);var r=n.call(this)||this;return r.moveable=!0,r.defaultUI=i,r.registProperty("items",t),r}return __extends(t,n),t.prototype.add=function(){for(var t,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return(t=this.items).push.apply(t,i),this},t}(t.MoveableControl),i,r,o,u,s,f,h,e;t.ContextMenu=l;i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"id",{set:function(t){n.Common.IsEmpty(t)?this.contextMenu.removeAttr("id"):this.contextMenu.attr("id",t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"location",{set:function(n){if(n&&this.target.moveable){var t=this.contextMenu.width(),i=this.contextMenu.height();n.x+t-$(document).scrollLeft()>$(window).width()&&(n.x-=t);n.y<0&&(n.y=0);n.y+i-$(document).scrollTop()>$(window).innerHeight()&&(n.y-=i,n.y<0&&(n.y=0));this.contextMenu.offset({left:n.x,top:n.y})}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"items",{set:function(n){var t=this;this.contextMenu.empty();n&&n.forEach(function(n){n&&t.addChild(n.createUI(),t.contextMenu)})},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){t.prototype.dispose.call(this);this.escKeyDownHandler&&$(document).off("keydown",this.escKeyDownHandler)},i.prototype.createContainer=function(){this.container=$('<div class="FUI-contextmenu-outer"><\/div>')},i.prototype.createContainerEvents=function(){var n=this;t.prototype.createContainerEvents.call(this);this.container.on("mousedown",function(t){n.target.dispose()});this.escKeyDownHandler=function(t){t.keyCode===27&&(t.stopPropagation(),document.activeElement===document.body?n.target.dispose():document.activeElement.blur())};$(document).on("keydown",this.escKeyDownHandler)},i.prototype.createChildren=function(){this.cover=$('<div class="FUI-contextmenu-cover"><\/div>');this.contextMenu=$('<div class="FUI-contextmenu"><\/div>');this.contextMenu.on("mousedown",function(n){n.stopPropagation()});this.container.append(this.cover,this.contextMenu)},i.prototype.onUpdateSizeEvent=function(n){n===void 0&&(n=this.contextMenu);t.prototype.onUpdateSizeEvent.call(this,n)},i.prototype.setEnabledProperty=function(n){t.prototype.setEnabledProperty.call(this,n,this.contextMenu)},i}(t.MoveableControlUI);t.ContextMenuUI=i;r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){n.prototype.createChildren.call(this);this.cover.hide()},t}(i);t.ContextMenuChildUI=r;o=function(n){function t(t){var i=n.call(this)||this;return i.defaultUI=u,i.registProperty("inner",t),i.registProperty("child"),i}return __extends(t,n),t}(t.UserControl);t.ContextMenuItem=o;u=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"inner",{set:function(n){this.container.empty();n&&this.addChild(n.createUI())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"child",{set:function(n){n?(this.container.addClass("FUI-contextmenu-parent"),n.hide(),this.addChild(n.createUI(r))):this.container.removeClass("FUI-contextmenu-parent")},enumerable:!0,configurable:!0}),i.prototype.createContainer=function(){this.container=$('<div class="FUI-contextmenu-item"><\/div>')},i.prototype.createContainerEvents=function(){var t=this;this.container.on("mouseenter",function(i){var r;if(t.target.child){t.target.child.show();t.target.child.updateSizeFromUI();var o=t.container.width(),c=t.container.height(),s=t.target.child.sizeFromUI.x,h=t.target.child.sizeFromUI.y,f=t.container.offset().left,e=t.container.offset().top,u=f+o;f+o+s-$(document).scrollLeft()>$(window).innerWidth()&&(u=f-s);r=e;e+h-$(document).scrollTop()>$(window).innerHeight()&&(r=e+c-h);u=Math.max(0,u);r=Math.max(0,r);t.target.child.location=new n.Numerics.Vector2(u,r)}});this.container.on("mouseleave",function(n){t.target.child&&t.target.child.hide()})},i}(t.ControlUIBase);t.ContextMenuItemUI=u;s=function(n){function t(t,i,r){t===void 0&&(t="");i===void 0&&(i=c);r===void 0&&(r="");var u=n.call(this,t,i)||this;return u.defaultUI=f,u.registProperty("uncheckedSVG",r),u}return __extends(t,n),t}(t.ToggleButton);t.ContextMenuButton=s;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"isChecked",{set:function(n){this.container.toggleClass("FUI-checked",n);this.svg=this.target.svg;this.uncheckedSVG=this.target.uncheckedSVG},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"svg",{set:function(n){this.target.isChecked&&(this.svgContainer.empty(),this.svgContainer.append($(n)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uncheckedSVG",{set:function(n){this.target.isChecked||(this.svgContainer.empty(),this.svgContainer.append($(n)))},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<div class="FUI-contextmenu-button"><\/div>')},t}(t.ToggleButtonUI);t.ContextMenuButtonUI=f;h=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.defaultUI=e,t}return __extends(t,n),t}(t.UserControl);t.ContextMenuSpliter=h;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createContainer=function(){this.container=$('<div class="FUI-contextmenu-spliter"><\/div>')},t}(t.ControlUIBase);t.ContextMenuSpliterUI=e})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var c=[{flag:1,css:"FUI-resize-up"},{flag:2,css:"FUI-resize-down"},{flag:4,css:"FUI-resize-left"},{flag:8,css:"FUI-resize-right"},{flag:5,css:"FUI-resize-nw"},{flag:9,css:"FUI-resize-ne"},{flag:6,css:"FUI-resize-sw"},{flag:10,css:"FUI-resize-se"},],r=function(){function n(){}return n}(),s,u,i,f,e,o,h;t.DialogEventArgs=r;s=function(i){function f(){var r=i.call(this)||this;return r.title="Dialog",r.resizeable=!0,r.centerWhenOpen=!0,r.alwaysCenter=!1,r.closeByEscKey=!0,r.closeButton=new t.Button("\u00d7"),r.footerButtonGroup=new t.ButtonGroup(2),r.moveable=!0,r.visibility=!1,r.defaultUI=u,r.registProperty("title"),r.registProperty("resizeable"),r.registProperty("centerWhenOpen"),r.registProperty("alwaysCenter"),r.registProperty("closeByEscKey"),r.closeButton.focusable=!1,r.closeButton.on("Clicked",function(){r.close()}).identify("FUI-dialog-close"),r.footerButtonGroup.add(new t.Button(n.RS.ForguncyUI_Dialog_OK).on("Clicked",function(){r.confirm()}).identify("FUI-dialog-ok")),r.footerButtonGroup.add(new t.Button(n.RS.ForguncyUI_Dialog_Cancel).on("Clicked",function(){r.cancel()}).identify("FUI-dialog-cancel")),r}return __extends(f,i),f.prototype.confirm=function(){var n=new r;this.dispatch("Confirm",n);n.cancel||this.dispose()},f.prototype.cancel=function(){var n=new r;this.dispatch("Cancel",n);n.cancel||this.dispose()},f.prototype.close=function(){var n=new r;this.dispatch("Close",n);n.cancel||this.dispose()},f}(t.MoveableControl);t.Dialog=s;u=function(i){function r(){var n=i!==null&&i.apply(this,arguments)||this;return n.resizeFlag=0,n}return __extends(r,i),Object.defineProperty(r.prototype,"header",{get:function(){return new f(this.target)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"content",{get:function(){return new e(this.target)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"footer",{get:function(){return new o(this.target)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"id",{set:function(t){n.Common.IsEmpty(t)?this.dialog.removeAttr("id"):this.dialog.attr("id",t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"location",{set:function(n){if(n&&this.target.moveable){var t=Math.max(0,n.x),i=Math.max(0,n.y);this.dialog.offset({left:t,top:i})}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visibility",{set:function(n){n?($(document.activeElement).blur(),this.cover.addClass("FUI-show"),this.dialog.addClass("FUI-show")):(this.cover.removeClass("FUI-show"),this.dialog.removeClass("FUI-show"))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"resizeable",{set:function(n){this.clearResizes();n&&this.createResizes()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"centerWhenOpen",{set:function(n){n&&this.moveDialogToCenter()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"alwaysCenter",{set:function(n){var t=this;if(n){this.alwaysCenterHandler=function(){window.requestAnimationFrame(function(){t.moveDialogToCenter()})};$(window).on("resize",this.alwaysCenterHandler)}else this.alwaysCenterHandler&&$(window).off("resize",this.alwaysCenterHandler)},enumerable:!0,configurable:!0}),r.prototype.dispose=function(){var t=this,n;this.visibility=!1;n=this.setTimeout||window.setTimeout;n(function(){i.prototype.dispose.call(t)},150);this.removeMouseHandlers();this.escKeyDownHandler&&$(document).off("keydown",this.escKeyDownHandler);this.alwaysCenterHandler&&$(window).off("resize",this.alwaysCenterHandler)},r.prototype.createContainer=function(){this.container=$('<div class="FUI-dialog-outer"><\/div>')},r.prototype.createModifiers=function(){this.modifiers=[new t.DialogFocusModifier(this),new t.DialogNoAnimationModifier(this)]},r.prototype.createChildren=function(){this.cover=$('<div class="FUI-dialog-cover"><\/div>');this.cursorCover=$('<div class="FUI-cursor-cover"><\/div>');this.dialog=$('<div class="FUI-dialog"><\/div>');this.actualHeader=this.addChild(this.header,this.dialog);this.actualContent=this.addChild(this.content,this.dialog);this.actualFooter=this.addChild(this.footer,this.dialog);this.container.append(this.cover,this.dialog);this.container.on("dragstart",function(n){n.preventDefault()})},r.prototype.createContainerEvents=function(){var n=this;i.prototype.createContainerEvents.call(this);this.escKeyDownHandler=function(t){n.target.closeByEscKey&&t.keyCode===27&&(t.stopPropagation(),document.activeElement===document.body&&n.target.close())};$(document).on("keydown",this.escKeyDownHandler)},r.prototype.createResizes=function(){var t,n=this,i=c.map(function(t){var i=$('<div class="'+t.css+'"><\/div>');i.on("mousedown",function(r){return n.resizeWindowByMouseDown(r,t.flag,i)});return i});this.removeMouseHandlers();this.mouseMoveHandler=function(t){window.requestAnimationFrame(function(){return n.resizeWindowByMouseMove(t,n.resizeFlag)})};this.mouseUpHandler=function(){n.resizeFlag=0;n.cursorCover.remove()};$(document).on("mousemove",this.mouseMoveHandler);$(document).on("mouseup",this.mouseUpHandler);this.resizes=i;(t=this.dialog).append.apply(t,this.resizes)},r.prototype.clearResizes=function(){this.removeMouseHandlers();this.resizes&&this.resizes.forEach(function(n){return n.remove()})},r.prototype.resizeWindowByMouseDown=function(t,i,r){t.stopPropagation();this.resizeFlag=i;this.mouseDownPosition=new n.Numerics.Vector2(t.screenX,t.screenY);this.oldSize=new n.Numerics.Vector2(this.dialog.width()||0,this.dialog.height()||0);this.oldLocation=new n.Numerics.Vector2(this.dialog.offset().left||0,this.dialog.offset().top||0);r.append(this.cursorCover)},r.prototype.resizeWindowByMouseMove=function(t,i){var r,u,f,e;i!==0&&(t.preventDefault(),t.stopPropagation(),r=new n.Numerics.Vector2(t.screenX,t.screenY).subtract(this.mouseDownPosition),u=this.oldSize.add(r),(i&1)!=0&&(f=this.target.location||this.oldLocation,this.target.location=new n.Numerics.Vector2(f.x,this.oldLocation.y+r.y),this.target.location.y>0&&this.dialog.height(this.oldSize.y-r.y)),(i&2)!=0&&this.dialog.height(u.y),(i&4)!=0&&(e=this.target.location||this.oldLocation,this.target.location=new n.Numerics.Vector2(this.oldLocation.x+r.x,e.y),this.target.location.x>0&&this.dialog.width(this.oldSize.x-r.x)),(i&8)!=0&&this.dialog.width(u.x))},r.prototype.removeMouseHandlers=function(){this.mouseMoveHandler&&$(document).off("mousemove",this.mouseMoveHandler);this.mouseUpHandler&&$(document).off("mouseup",this.mouseUpHandler)},r.prototype.moveDialogToCenter=function(){var t=new n.Numerics.Vector2(this.cover.width(),this.cover.height()),i=new n.Numerics.Vector2(this.dialog.width(),this.dialog.height()),r=new n.Numerics.Vector2(this.cover.offset().left,this.cover.offset().top);this.target.location=t.subtract(i).multiply(.5).add(r)},r}(t.MoveableControlUI);t.DialogUI=u;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"id",{set:function(n){return},enumerable:!0,configurable:!0}),t}(t.ControlUIBase);t.DialogInnerUI=i;f=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"title",{set:function(n){this.titleContainer.text(n)},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){t.prototype.dispose.call(this);this.removeHandlers()},i.prototype.createContainer=function(){this.container=$('<div class="FUI-dialog-header"><\/div>')},i.prototype.createChildren=function(){var t=this,i,r,u;this.cursorCover=$('<div class="FUI-cursor-cover"><\/div>');this.titleContainer=$('<span class="FUI-dialog-header-title"><\/span>').text(this.target.title);i=!1;this.container.on("mousedown",function(f){i=!0;r=new n.Numerics.Vector2(f.screenX,f.screenY);u=new n.Numerics.Vector2(t.container.offset().left||0,t.container.offset().top||0);t.container.append(t.cursorCover)});this.removeHandlers();this.mouseMoveHandler=function(f){i&&window.requestAnimationFrame(function(){var i=new n.Numerics.Vector2(f.screenX,f.screenY).subtract(r);t.target.location=u.add(i)})};this.mouseUpHandler=function(n){i=!1;t.cursorCover.remove()};$(document).on("mousemove",this.mouseMoveHandler);$(document).on("mouseup",this.mouseUpHandler);this.container.append(this.titleContainer);this.addChild(this.target.closeButton.createUI(h))},i.prototype.removeHandlers=function(){this.mouseMoveHandler&&$(document).off("mousemove",this.mouseMoveHandler);this.mouseUpHandler&&$(document).off("mouseup",this.mouseUpHandler)},i}(i);t.DialogHeaderUI=f;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createContainer=function(){this.container=$('<div class="FUI-dialog-content"><\/div>')},t}(i);t.DialogContentUI=e;o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createContainer=function(){this.container=$('<div class="FUI-dialog-footer"><\/div>')},t.prototype.createChildren=function(){this.addChild(this.target.footerButtonGroup.createUI())},t}(i);t.DialogFooterUI=o;h=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createContainer=function(){this.container=$('<div class="FUI-dialog-header-close"><\/div>')},t}(t.ButtonUI)})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var r=function(){function n(){}return n}(),i,t;n.ListBoxItem=r;i=function(n){function i(i){i===void 0&&(i=!1);var r=n.call(this)||this;return r.items=[],r.selections=[],r.focusable=!0,r.defaultUI=t,r.registProperty("items"),r.autoSort=i,r.compareFn=function(n,t){return n.displayText.localeCompare(t.displayText)},r}return __extends(i,n),i.prototype.add=function(){for(var i,r=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i=!1;t&&t.forEach(function(n){n&&(r.items.push(n),i=!0)});i&&(this.autoSort&&this.items.sort(this.compareFn),this.dispatch("ItemsChanged",this.items))},i.prototype.remove=function(){for(var t,r,u=this,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];t=[];r=!1;i&&i.forEach(function(n){if(n){var i=u.items.indexOf(n);i>=0&&(t.push.apply(t,u.items.splice(i,1)),r=!0)}});r&&(this.autoSort&&this.items.sort(this.compareFn),this.unSelect.apply(this,t),this.dispatch("ItemsChanged",this.items))},i.prototype.active=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.dispatch("ActiveItemsChanged",t)},i.prototype.selectAll=function(){this.select.apply(this,this.items)},i.prototype.select=function(){for(var i,r=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i=!1;t&&t.forEach(function(n){n&&r.selections.indexOf(n)<0&&(r.selections.push(n),i=!0)});i&&this.dispatch("SelectionsChanged",this.selections)},i.prototype.selectNew=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];n&&n.every(function(n){return n!==null&&n!==undefined})&&(this.selections=[],this.select.apply(this,n))},i.prototype.unSelect=function(){for(var i,r=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i=!1;t&&t.forEach(function(n){if(n){var t=r.selections.indexOf(n);t>=0&&(r.selections.splice(t,1),i=!0)}});i&&this.dispatch("SelectionsChanged",this.selections)},i.prototype.clear=function(){this.items=[];this.selections=[];this.dispatch("SelectionsChanged",this.selections);this.dispatch("ItemsChanged",this.selections)},i.prototype.clearSelect=function(){this.selections=[];this.dispatch("SelectionsChanged",this.selections)},i.prototype.moveUpSelect=function(){var n=this,t=this.selections.sort(function(t,i){return n.items.indexOf(t)-n.items.indexOf(i)});t.forEach(function(t){var i=n.items.indexOf(t);i>0&&n.selections.indexOf(n.items[i-1])<0&&(n.items.splice(i-1,0,t),n.items.splice(i+1,1))});this.dispatch("ItemsChanged",this.items)},i.prototype.moveDownSelect=function(){var n=this,t=this.selections.sort(function(t,i){return n.items.indexOf(i)-n.items.indexOf(t)});t.forEach(function(t){var i=n.items.indexOf(t);i<n.items.length-1&&n.selections.indexOf(n.items[i+1])<0&&(n.items.splice(i+2,0,t),n.items.splice(i,1))});this.dispatch("ItemsChanged",this.items)},i.prototype.moveSelectionToViewport=function(){this.dispatch("MoveSelectionToViewport",this.selections)},i}(n.UserControl);n.ListBox=i;t=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.lastIndex=0,t}return __extends(t,n),Object.defineProperty(t.prototype,"items",{set:function(n){var t,i=this;this.container.empty();this.itemContainers=n.map(function(n){return i.createListBoxItem(n)});(t=this.container).append.apply(t,this.itemContainers);this.refreshSelections(this.target.selections)},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<div class="FUI-listbox"><\/div>')},t.prototype.createContainerEvents=function(){var t=this;n.prototype.createContainerEvents.call(this);this.target.on("ItemsChanged",function(){t.items=t.target.items});this.target.on("SelectionsChanged",function(n,i){t.refreshSelections(i)});this.target.on("MoveSelectionToViewport",function(n,i){t.moveSelectionToViewport(i)});this.container.on("click",function(){t.target.focus()});this.container.on("keydown",function(n){n.ctrlKey&&n.keyCode===65&&(n.preventDefault(),n.stopPropagation(),t.target.selectAll(),t.lastIndex=0)})},t.prototype.createListBoxItem=function(n){var t=this,i=$('<div class="FUI-listbox-item"><\/div>');return i.data("value",n),i.text(n.displayText),i.attr("title",n.displayText),i.dblclick(function(){t.target.clearSelect();t.target.select(n);t.lastIndex=t.target.items.indexOf(n);t.target.active(n)}),i.click(function(i){var u,f,r;i.ctrlKey?(t.target.selections.indexOf(n)>=0?t.target.unSelect(n):t.target.select(n),t.lastIndex=t.target.items.indexOf(n)):i.shiftKey?(r=t.target.items.indexOf(n),r<t.lastIndex?(u=t.target).selectNew.apply(u,t.target.items.slice(r,t.lastIndex+1)):(f=t.target).selectNew.apply(f,t.target.items.slice(t.lastIndex,r+1))):(t.target.selectNew(n),t.lastIndex=t.target.items.indexOf(n))}),i},t.prototype.refreshSelections=function(n){this.itemContainers.forEach(function(t){n.indexOf(t.data("value"))>=0?t.addClass("FUI-selected"):t.removeClass("FUI-selected")})},t.prototype.moveSelectionToViewport=function(n){for(var t,f=this.itemContainers.length,r=0;r<f;r++)if(t=this.itemContainers[r],n.indexOf(t.data("value"))>=0){var u=this.container.scrollTop(),i=t.position().top,e=this.container.height()-t.height();i<=0?this.container.scrollTop(u+i):i>e&&this.container.scrollTop(u+i);break}},t}(n.ControlUIBase);n.ListBoxUI=t})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var e=function(i){function r(){var r=i.call(this)||this;return r.nodes=[],r.progress=new n.Progress,r.defaultUI=t,r.registProperty("nodes"),r}return __extends(r,i),r.prototype.add=function(n){this.nodes.push(n);this.dispatch("ItemsChanged")},r.prototype.clear=function(){this.nodes=[];this.dispatch("ItemsChanged")},r}(n.UserControl),t,f,i,r,u;n.TreeView=e;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"nodes",{set:function(n){this.refreshNodes(n)},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<div class="FUI-treeview"><\/div>')},t.prototype.createContainerEvents=function(){var t=this;n.prototype.createContainerEvents.call(this);this.target.on("ItemsChanged",function(){t.refreshNodes(t.target.nodes)})},t.prototype.createChildren=function(){this.contentContainer=$('<div class="FUI-treeview-content"><\/div>');this.container.append(this.contentContainer);this.addChild(this.target.progress.createUI())},t.prototype.refreshNodes=function(n){var t=this;this.target.progress.show();this.updateRootTimer&&clearTimeout(this.updateRootTimer);this.updateRootTimer=setTimeout(function(){t.contentContainer.empty();n&&n.forEach(function(n){t.addChild(n.createUI(),t.contentContainer)});t.target.progress.hide()},0)},t}(n.ControlUIBase);n.TreeViewUI=t;f=function(t){function u(u,f){f===void 0&&(f=!1);var e=t.call(this)||this;e.isExpand=!1;e.isChecked=!1;e.indeterminate=!1;e.children=[];e.defaultUI=i;e.registProperty("text",u);e.registProperty("isExpand",f);e.registProperty("isChecked");e.registProperty("indeterminate");e.registProperty("children");e.expandButton=new r;e.expandButton.visibility=!(e.children.length===0);e.bindProperty(e.expandButton,"isChecked","isExpand");e.checkBox=new n.CheckBox(u);e.bindProperty(e.checkBox,"text","text");e.bindProperty(e.checkBox,"isChecked","isChecked");e.bindProperty(e.checkBox,"indeterminate","indeterminate");e.on("PropertyChanged",function(n,t){t==="children"&&(e.expandButton.visibility=!(e.children.length===0));t==="isChecked"&&(e.children&&e.children.forEach(function(n){return n.selectAll(e.isChecked)}),e.parent&&e.updateCheckState(e.parent));t==="indeterminate"&&e.parent&&(e.parent.indeterminate=e.indeterminate)});return e}return __extends(u,t),Object.defineProperty(u.prototype,"leafs",{get:function(){return this.children&&this.children.length!==0?this.children.map(function(n){return n.leafs}).reduce(function(n,t){return n.concat(t)}):[this]},enumerable:!0,configurable:!0}),u.prototype.refreshAll=function(){this.expandButton.visibility=!(this.children.length===0);this.children.forEach(function(n){return n.refreshAll()})},u.prototype.selectAll=function(n){this.isChecked=n},u.prototype.addChildren=function(n){var t=this;n.forEach(function(n){n.parent=t});this.children=n;this.updateCheckState()},u.prototype.updateCheckState=function(n){n===void 0&&(n=this);var t=n.children.every(function(n){return n.isChecked===!0}),i=n.children.every(function(n){return n.isChecked===!1});n.indeterminate=!(t||i);t&&(n.isChecked=!0);i&&(n.isChecked=!1)},u}(n.UserControl);n.TreeViewNode=f;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"isExpand",{set:function(n){this.childrenContainer.toggleClass("FUI-show",n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"children",{set:function(n){var t=this;this.childrenContainer.empty();this.target.children&&this.target.children.forEach(function(n){t.addChild(n.createUI(),t.childrenContainer)})},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<div class="FUI-treeview-node"><\/div>')},t.prototype.createChildren=function(){this.addChild(this.target.expandButton.createUI());var n=this.target.checkBox.createUI();this.addChild(n);this.childrenContainer=$('<div class="FUI-treeview-node-children"><\/div>');this.container.append(this.childrenContainer)},t}(n.ControlUIBase);n.TreeViewNodeUI=i;r=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.defaultUI=u,t}return __extends(t,n),t}(n.ToggleButton);n.ExpandTreeViewNodeButton=r;u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createContainer=function(){this.container=$('<div class="FUI-treeview-node-expand"><\/div>')},t}(n.ToggleButtonUI);n.ExpandTreeViewNodeButtonUI=u})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var i=function(n){function i(i){i===void 0&&(i="");var r=n.call(this)||this;return r.defaultUI=t,r.registProperty("text",i),r}return __extends(i,n),i}(n.UserControl),t;n.TextBlock=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"text",{set:function(n){this.container.text(n)},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<div class="FUI-textblock"><\/div>')},t}(n.ControlUIBase);n.TextBlockUI=t})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var u=function(n){function t(t,r){t===void 0&&(t="");r===void 0&&(r="");var u=n.call(this)||this;return u.defaultUI=i,u.registProperty("text",t),u.registProperty("icon",r),u}return __extends(t,n),t}(t.UserControl),i,r;t.IconText=u;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"text",{set:function(n){this.textContainer.text(n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"icon",{set:function(n){this.svgContainer.empty();this.svgContainer.append($(n))},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<div class="FUI-svgtext"><\/div>')},t.prototype.createChildren=function(){this.svgContainer=$('<span class="FUI-svgtext-icon"><\/span>');this.textContainer=$('<span class="FUI-svgtext-text"><\/span>');this.container.append(this.svgContainer,this.textContainer)},t}(t.ControlUIBase);t.SVGTextUI=i;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"text",{set:function(n){this.textContainer.text(n)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"icon",{set:function(t){n.Common.IsEmpty(t)?this.imageContainer.hide():(this.imageContainer.show(),this.imageContainer.attr("src",n.ImageHelper.encodeImageUrl(t)))},enumerable:!0,configurable:!0}),i.prototype.createContainer=function(){this.container=$('<div class="FUI-imagetext"><\/div>')},i.prototype.createChildren=function(){this.imageContainer=$('<img class="FUI-imagetext-icon"><\/img>');this.textContainer=$('<span class="FUI-imagetext-text"><\/span>');this.container.append(this.imageContainer,this.textContainer)},i}(t.ControlUIBase);t.ImageTextUI=r})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var i=function(n){function i(){var i=n!==null&&n.apply(this,arguments)||this;return i.defaultUI=t,i}return __extends(i,n),i}(n.UserControl),t;n.Progress=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createContainer=function(){this.container=$('<div class="FUI-progress"><\/div>')},t.prototype.createChildren=function(){var n=$('<div class="spinner"><i><\/i><\/div>');this.container.append(n)},t}(n.ControlUIBase);n.ProgressUI=t})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var i=function(n){function i(i){i===void 0&&(i="");var r=n.call(this)||this;return r.focusable=!0,r.defaultUI=t,r.registProperty("text",i),r}return __extends(i,n),i.prototype.confirm=function(){this.dispatch("Confirm")},i}(n.UserControl),t;n.TextBox=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"text",{set:function(n){this.container[0].value=n},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<input type="text" class="FUI-textbox"><\/input>')},t.prototype.createContainerEvents=function(){var t=this;n.prototype.createContainerEvents.call(this);this.container.on("change",function(){t.target.text=t.container[0].value});this.container.on("keypress",function(n){n.keyCode===13&&(n.stopPropagation(),t.target.text=t.container[0].value,t.target.confirm())})},t}(n.ControlUIBase);n.TextBoxUI=t})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var i=function(n){function i(i){i===void 0&&(i=[]);var r=n.call(this)||this;return r.focusable=!0,r.defaultUI=t,r.registProperty("value"),r.registProperty("items",i),r.registProperty("displayName"),r}return __extends(i,n),i}(n.UserControl),t;n.ComboBox=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"value",{set:function(n){this.container.val(JSON.stringify(n))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{set:function(n){this.container.empty();this.createChildren();this.value=this.target.value},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{set:function(n){this.container.empty();this.createChildren()},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<select class="FUI-combobox"><\/select>')},t.prototype.createContainerEvents=function(){var t=this;n.prototype.createContainerEvents.call(this);this.container.on("change",function(){t.target.value=JSON.parse(t.container.val())})},t.prototype.createChildren=function(){var n,t=this,i,r;this.target.items&&(i=!!this.target.displayName,r=this.target.items.map(function(n){var r=$('<option class="FUI-combobox-item"><\/option>'),u=JSON.stringify(n);return r.val(u),r.text(i?n[t.target.displayName]:n),u===JSON.stringify(t.target.value)&&r.attr("selected","selected"),r}),(n=this.container).append.apply(n,r))},t}(n.ControlUIBase);n.ComboBoxUI=t})(t=n.UI||(n.UI={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var h="popuptype",l=function(){function r(){}return r.createConfirmPopupDom=function(t,i,r,u,f){var s,h,c;return f===void 0&&(f=!0),s=(new e).identify("fgc-popup-dialog"),s.title=i,s.iconText.icon=r,s.iconText.text=u,s.closeButton.visibility=f,s.popupType="confirmbox",n.ForguncyData.pageInfo.appendExtralPopup(s),h=s.createUI(o),c=h.container,t.append(c),s.show(),h},r.createPopupDom=function(r,u,e,o,s,h){var c=(new i).identify("fgc-popup-dialog"),a;c.displayMode=h.popupDisplayMode;c.title=s;c.body=u;c.bodySize=new n.Numerics.Vector2(e,o);a=n.ForguncyData.GlobalSettings.HidePopUpCloseButton;c.closeButton.visibility=!a;c.closeByEscKey=!a;c.popupType=h.popupDisplayMode===0?"dialog":"dropdown";c.on("Close",function(t,i){if(n.ForguncyData.pageInfo.hasExtraDialog||n.ForguncyData.pageInfo.dialogUI.target!==c){i&&(i.cancel=!0);return}var r=new n.ClosePopupCommand;r.CommandParam={PassValueBack:!1};r.execute()});var y=h.popupDisplayMode===0?t:f,l=c.createUI(y),v=l.container;return r.append(v),h.popupDisplayMode===1&&h.anchor&&(c.centerWhenOpen=!1,l.applyModifier(new n.UI.DialogLocationModifier(l,h.anchor)),v.addClass("fgc-popup-transparentcover")),h.popupDisplayMode===2&&(c.alwaysCenter=!0),c.refresh(),l},r}(),i,u,t,r,f,e,o,s,c;n.PopupHelper=l;i=function(i){function r(){var r=i.call(this)||this;return r.mainBackColor=n.ColorHelper.Convert("Accent 1 0"),r.mainTextColor=n.ColorHelper.Convert("Text 1 0"),r.resizeable=!1,r.defaultUI=t,r.registProperty("body"),r.registProperty("bodySize"),r.registProperty("mainBackColor"),r.registProperty("mainTextColor"),r.registProperty("popupType"),r}return __extends(r,i),r}(n.UI.Dialog);n.PopupDialog=i;u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"mainBackColor",{set:function(n){this.container.css("background-color",n);this.container.css("border-color",n)},enumerable:!0,configurable:!0}),t}(n.UI.DialogHeaderUI);n.PopupDialogHeaderUI=u;t=function(t){function i(){var i=t!==null&&t.apply(this,arguments)||this;return i.setTimeout=n.DelayRefresh.setTimeout,i}return __extends(i,t),Object.defineProperty(i.prototype,"header",{get:function(){return new u(this.target)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"content",{get:function(){return new r(this.target)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"footer",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bodySize",{set:function(n){if(n){this.actualContent.container.width(n.x);this.actualContent.container.height(n.y);this.dialog.width(n.x);var t=this.actualHeader&&this.actualHeader.container.outerHeight()||0,i=this.actualFooter&&this.actualFooter.container.outerHeight()||0;this.dialog.height(t+i+n.y);this.centerWhenOpen=this.target.centerWhenOpen}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"zIndex",{set:function(n){this.container.css("z-index",n);this.cover.css("z-index",n);this.dialog.css("z-index",n)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"popupType",{set:function(n){this.container.attr(h,n);this.dialog.attr(h,n)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mainBackColor",{set:function(n){this.dialog.css("border-color",n)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mainTextColor",{set:function(n){this.dialog.css("color",n)},enumerable:!0,configurable:!0}),i}(n.UI.DialogUI);n.PopupDialogUI=t;r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"body",{set:function(n){n&&(this.container.empty(),this.container.append(n))},enumerable:!0,configurable:!0}),t}(n.UI.DialogContentUI);n.PopupDialogContentUI=r;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"header",{get:function(){return null},enumerable:!0,configurable:!0}),t.prototype.createChildren=function(){var t=this;n.prototype.createChildren.call(this);this.cover.on("click",function(n){n.stopPropagation();t.target.close()})},t}(t);n.PopupDropdownUI=f;e=function(t){function i(){var i=t!==null&&t.apply(this,arguments)||this;return i.iconText=(new n.UI.IconText).identify("fgc-confirmbox-icontext"),i.mainTextColor="#333",i}return __extends(i,t),i}(i);n.PopupConfirmBox=e;o=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"content",{get:function(){return new s(this.target)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"footer",{get:function(){return new n.UI.DialogFooterUI(this.target)},enumerable:!0,configurable:!0}),i}(t);n.PopupConfirmBoxUI=o;s=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.createChildren=function(){this.addChild(this.target.iconText.createUI(n.UI.ImageTextUI))},i.prototype.createModifiers=function(){t.prototype.createModifiers.call(this);this.applyModifier(new c(this))},i}(r);n.PopupConfirmBoxContentUI=s;c=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.modifyProperties=function(){var t=this.ui.container.clone().css("opacity","0"),i,r;$("body").append(t);t.css("position","absolute");i=t.outerWidth(!0);r=t.outerHeight(!0);t.remove();this.ui.target.bodySize=new n.Numerics.Vector2(i,r)},i}(n.UI.UIModifier)}(Forguncy||(Forguncy={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var t=function(){function t(){}return t.appendSendEmailConfirm=function(t){var r={email:"",sendText:n.RS.ConcurrentLicenseError_SendEmail,cancelText:n.RS.ConcurrentLicenseError_Cancel,warningText:n.RS.ConcurrentLicenseError_NoEnoughLicense,fromAddressPlaceHolderText:n.RS.ConcurrentLicenseError_AddressPlaceHolder,messagePlaceHolderText:n.RS.ConcurrentLicenseError_MessagePlaceHolder,onSendEmail:function(t,i){var r=$("#fgc-sendemail-address").val(),u=$("#fgc-sendemail-message").val();n.PageBuilder.showPageLoadingCover();n.Common.forguncyPost("Home/NoticeAdmin",{title:n.RS.ConcurrentLicenseError_EmailTitle,address:r,message:u},function(r){n.PageBuilder.hidePageLoadingCover();r&&r.Result?(window.alert(n.RS.ConcurrentLicenseError_SendSuccess),t&&t()):(window.alert(n.RS.ConcurrentLicenseError_SendFailed+"\n"+r.Message),i&&i())})},onCancel:function(){}},i=__assign(__assign({},r),t);n.ListviewBase.lockListviewClick();n.PageBuilder.hidePageLoadingCover();n.Platform.isMobile()?this.createForMobile(i):this.createForPC(i)},t.createForMobile=function(t){var r='\n                <div id="fgc-sendemail-container" style="position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,0.2);color:#333">\n                    <div style="height:100%;padding:0 10px;background-color:#fff;">\n                        <p class="info" style="margin:0;padding:10px;text-align:left;">\n                        '+t.warningText+'\n                        <\/p>\n                        <div style="margin:0 10px 10px 10px;">\n                            <textarea id="fgc-sendemail-message"placeholder="'+t.messagePlaceHolderText+'" style="display:block;height:300px;width:100%;resize:none;font-family:\'Microsoft YaHei\';font-size:13.33px;box-sizing:border-box;" />\n                        <\/div>\n                        <div style="display:flex;align-items:center;margin:0 10px;">\n                            <label for="fgc-sendemail-address" style="font-size:14px;">'+n.RS.ConcurrentLicenseError_SenderAddress+'<\/label>\n                            <input id="fgc-sendemail-address" type="text" placeholder="'+t.fromAddressPlaceHolderText+'" style="flex-grow:1;margin-left:5px;padding:4px 1px;font-family:\'Microsoft YaHei\';font-size:13.33px;box-sizing:border-box;" />\n                        <\/div>\n                        <div style="text-align:right;margin:10px 10px 0 10px;">\n                            <button id="fgc-sendemail-send" style="padding:4px 10px;margin-right:10px;">'+t.sendText+'<\/button>\n                            <button id="fgc-sendemail-cancel" style="padding:4px 10px;">'+t.cancelText+"<\/button>\n                        <\/div>\n                    <\/div>\n                <\/div>\n            ";(n.Platform.isIOSDevice()||n.Platform.isMac())&&$("meta[name='viewport']").replaceWith("<meta name='viewport' content='width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi' />");var i=$(r),u=i.find("#fgc-sendemail-send"),f=i.find("#fgc-sendemail-cancel");i.find("#fgc-sendemail-address").val(t.email);u.click(t.onSendEmail);f.click(function(){$("#fgc-sendemail-container").remove();t&&t.onCancel()});$(document.body).append(i)},t.createForPC=function(t){var r=$('\n                    <div style="width:400px;padding-bottom:10px;background-color:#fff;">\n                        <p class="info" style="margin:0;padding:10px;text-align:left;">\n                        '+t.warningText+'\n                        <\/p>\n                        <div style="margin:0 10px 10px 10px;">\n                            <textarea id="fgc-sendemail-message" placeholder="'+t.messagePlaceHolderText+'" style="display:block;height:150px;width:100%;resize:none;font-family:\'Microsoft YaHei\';font-size:13.33px;box-sizing:border-box;" />\n                        <\/div>\n                        <div style="display:flex;align-items:center;margin:0 10px;">\n                            <label for="fgc-sendemail-address" style="font-size:14px;">'+n.RS.ConcurrentLicenseError_SenderAddress+'<\/label>\n                            <input id="fgc-sendemail-address" type="text" placeholder="'+t.fromAddressPlaceHolderText+'" style="flex-grow:1;margin-left:5px;padding:4px 1px;font-family:\'Microsoft YaHei\';font-size:13.33px;box-sizing:border-box;" />\n                        <\/div>\n                    <\/div>\n                '),i;r.find("#fgc-sendemail-address").val(t.email);i=n.PopupHelper.createConfirmPopupDom(n.PageBuilder.pagesContainer,"","","",!0);i.container.find(".FUI-dialog").width(400).css("height","auto");i.container.find(".FUI-dialog-content").empty().append(r).css({width:"",height:""});i.centerWhenOpen=!0;i.target.on("Confirm",function(){i.target.visibility=!1;t.onSendEmail&&t.onSendEmail(function(){i&&i.target.close()},function(){i.target.visibility=!0})});i.target.on("Close",function(){t.onCancel&&t.onCancel()});i.target.on("Cancel",function(){t.onCancel&&t.onCancel()})},t}();n.SendEmailHelper=t}(Forguncy||(Forguncy={})),function(n){var r=function(){function r(n,t,i){this.metadata=n;this.uniqueIndex=i===undefined?this.generateUniqueIndex():i;this.name=r.NamePrefix+this.uniqueIndex.toString();this.rowHeaderCheckBoxColmunIndex=this.isRowHeaderVisible()===!0?1:0;this.preprocessMetadata();this.initColumnBindingInfos();this.initColumns(t);this.initVisibleColumns();this.initRowHeaderInfo();this.initRowHeaderCheckBoxInfo()}return r.prototype.isRowHeaderContextMenuVisible=function(){return this.metadata.RowHeaderContextMenu&&this.metadata.RowHeaderContextMenu.ContextMenuItems&&this.metadata.RowHeaderContextMenu.ContextMenuItems.some(function(n){return n.Visible===!0})},r.prototype.getRowHeaderContextMenuData=function(){return this.metadata.RowHeaderContextMenu},r.prototype.isDoubleClickCommandsExists=function(){return this.metadata.DoubleClickCommands&&this.metadata.DoubleClickCommands.length>0},r.prototype.getDoubleClickCommands=function(){return this.metadata.DoubleClickCommands},r.prototype.generateUniqueIndex=function(){return r.Index++},r.prototype.getTabIndex=function(){return n.ForguncyData.pageInfo.enableTabIndex?this.metadata.TabIndex:null},r.prototype.getBindingInfoColumnTypeInDataModel=function(t){var i,r;if(this.metadata.Columns&&t>-1&&t<this.metadata.ColumnCount)for(i=0;i<this.metadata.Columns.length;i++)if(r=this.metadata.Columns[i],r&&r.Index===t)return r.BindingColumnDataType;return n.ColumnDataType.Other},r.prototype.preprocessMetadata=function(){var t=this.metadata;t.DataTableCanEdit==!!t.DataTableCanEdit;t.CanDelete=!!t.CanDelete;t.CanAddRow=!!t.CanAddRow;t.CanEdit=!!t.CanEdit;t.AlwaysInEditMode=!!t.AlwaysInEditMode;t.IsGroupMode=!!t.IsGroupMode;t.LoadOnDemandCount===undefined&&(t.LoadOnDemandCount=0);n.Common.AdjustCellRange(t.CellRange);t.SelectionMode===undefined&&(t.SelectionMode=0);t.AlwaysReservedSelections=!!t.AlwaysReservedSelections;t.IsSingleSelection=!!t.IsSingleSelection;t.DisableAutoSelectRow=!!t.DisableAutoSelectRow;t.AutoFitRowHeight=!!t.AutoFitRowHeight;t.AutoFitColumnWidth=!!t.AutoFitColumnWidth;this.metadata.ColumnOperation===undefined&&(this.metadata.ColumnOperation=0)},r.prototype.initColumnBindingInfos=function(){var t;this.columnBindingInfos=[];var i=this.metadata.Columns,u=function(t){var f=i[t],u,e;if(!f.TemplateCell||!f.TemplateCell.Element||(u=f.TemplateCell.Element.BindingInfo,!u))return"continue";e=r.columnBindingInfos.some(function(t){return n.Common.isBindingInfoEquals(t,u)});e||r.columnBindingInfos.push(u)},r=this;for(t=0;t<i.length;t++)u(t)},r.prototype.initColumns=function(t){var c,s,h,f,e,o,r,u;for(this.columnDataInfos=[],c=this.getColumnCount(),s=0;s<c;s++)this.columnDataInfos.push(new i);for(h=this.metadata.Columns,f=0;f<h.length;f++)if(e=h[f],o=this.columnDataInfos[e.Index],e.TemplateCell&&(r=e.TemplateCell.Element,r&&(n.Common.IsEmpty(r.Value)||(o.staticValue=n.KeyWords.GetKeyWordValue(r.Value,t)),o.columnName=r.Name&&r.Name.length>0?r.Name[0]:undefined,r.BindingInfo)))for(u=0;u<this.columnBindingInfos.length;u++)if(n.Common.isBindingInfoEquals(this.columnBindingInfos[u],r.BindingInfo)){o.bindingInfoIndex=u;break}},r.prototype.initVisibleColumns=function(){var e,o,r,u,i,f;if(this.visibleColumns=[],e=this.metadata.Columns,e)for(o=e.length,r=0;r<o;r++)this.isRowHeaderVisible()&&r===0||this.isRowHeaderCheckBoxVisible()&&r===this.rowHeaderCheckBoxColmunIndex||(u=e[r],u.Width<=0)||(i=new t(u,this.name,this.canEdit(),this.metadata.ColumnOfDetailTable),(i.cellType.constructor===n.RadioGroupCellType||i.cellType.constructor===n.CheckBoxGroupCellType||i.cellType.constructor===n.ComboBoxCellType_InputMan)&&(f=i.getTemplateCell(),f&&f.CellType&&(f.CellType.haveLoadItems=!f.CellType.IsBounding)),i.dependenceColumnsIndex=u.DependenceColumnsIndex,i.dependenceCells=u.DependenceCells,this.visibleColumns.push(i))},r.prototype.initRowHeaderInfo=function(){if(this.isRowHeaderVisible()){var n=this.metadata.Columns;if(!n||n.length<=0)return;this.rowHeaderColumnInfo=new t(n[0],this.name,this.canEdit(),this.metadata.ColumnOfDetailTable)}},r.prototype.initRowHeaderCheckBoxInfo=function(){if(this.isRowHeaderCheckBoxVisible()){var n=this.metadata.Columns;if(!n||n.length<=this.rowHeaderCheckBoxColmunIndex+1)return;this.rowHeaderCheckBoxColumnInfo=new t(n[this.rowHeaderCheckBoxColmunIndex],this.name,this.canEdit(),this.metadata.ColumnOfDetailTable)}},r.prototype.isColumnHeaderVisibleInDesigner=function(){return!!this.metadata.IsColumnHeaderVisibleInDesigner},r.prototype.getListviewName=function(){return this.metadata.Name},r.prototype.getDataTableName=function(){return this.metadata.DataTableName},r.prototype.getMasterDataTableName=function(){return this.metadata.MasterDataTableName},r.prototype.getColumnOfMasterTable=function(){return this.metadata.ColumnOfMasterTable},r.prototype.getColumnOfDetailTable=function(){return this.metadata.ColumnOfDetailTable},r.prototype.getRangeInfo=function(){return this.metadata.CellRange},r.prototype.getContentRangeInfo=function(){var n=this.getRangeInfo(),t;return this.metadata.IsColumnHeaderVisibleInDesigner?(t=this.getDesignerColumnHeaderRowCount(),{Column:n.Column,ColumnCount:n.ColumnCount,Row:n.Row+t,RowCount:n.RowCount-t}):n},r.prototype.getColumnHeaderRangeInfo=function(){var t=this.getDesignerColumnHeaderRowCount(),n=this.getRangeInfo();return{Row:n.Row,Column:n.Column,RowCount:t,ColumnCount:n.ColumnCount}},r.prototype.getDesignerColumnHeaderRowCount=function(){return this.metadata.ColumnHeaderHeight?this.metadata.ColumnHeaderHeight.length:0},r.prototype.getColumnMetaData=function(n){var i=this.metadata.Columns,r,t;if(!i)return null;for(r=i.length,t=0;t<r;t++)if(i[t].Index===n)return i[t];return null},r.prototype.getLoadOnDemandCount=function(){return this.metadata.LoadOnDemandCount},r.prototype.shouldLoadOnDemand=function(){return!!this.metadata.LoadOnDemandCount},r.prototype.getTemplateRowHeight=function(){return this.metadata.TemplateRowHeight},r.prototype.getColumnHeaderHeight=function(){return this.metadata.IsColumnHeaderVisibleInDesigner?this.metadata.ColumnHeaderHeight:[r.DefaultColumnHeaderHeight]},r.prototype.getConditionFormulas=function(){return this.metadata.ConditionFormulas},r.prototype.getDependenceCells=function(){return this.metadata.DependenceCells},r.prototype.getListViewStyleTemplate=function(){var i=this.metadata.ListViewStyleName,r,t;if(i)for(r=n.ListViewStyleTemplateUtils.ListViewStyleTemplates.length,t=0;t<r;t++)if(n.ListViewStyleTemplateUtils.ListViewStyleTemplates[t].Name===i)return n.Common.clone(n.ListViewStyleTemplateUtils.ListViewStyleTemplates[t]);return null},r.prototype.getAlternativeBackcolor=function(n){return n?this.getBackcolorStr(this.metadata.EvenRowBackcolor):this.getBackcolorStr(this.metadata.OddRowBackcolor)},r.prototype.getBackcolorStr=function(n){var t="#FFFFFF";return n&&n!==t?n:null},r.prototype.isColumnHeaderVisible=function(){return this.metadata.IsColumnHeaderVisible},r.prototype.isRowHeaderVisible=function(){var n=this.metadata.Columns;return(!n||n.length<=0)&&(this.metadata.IsRowHeaderVisible=!1),this.metadata.IsRowHeaderVisible===!0?!0:!1},r.prototype.isRowHeaderCheckBoxVisible=function(){var n=this.metadata.Columns;return(!n||n.length<this.rowHeaderCheckBoxColmunIndex+1)&&(this.metadata.IsRowHeaderCheckBoxVisible=!1),this.metadata.IsRowHeaderCheckBoxVisible===!0?!0:!1},r.prototype.isRowHeaderFillNumber=function(){return this.metadata.IsRowHeaderFillNumber===!0?!0:!1},r.prototype.isMasterTable=function(){return n.Common.IsEmpty(this.getMasterDataTableName())},r.prototype.getColIndexOfColumnOfDetailTable=function(){var n=this.getColumnOfDetailTable();return n?this.getColIndexByDataColumnName(n):-1},r.prototype.canEdit=function(){return!n.Platform.isMobile()&&this.metadata.CanEdit},r.prototype.canDelete=function(){return this.metadata.CanDelete},r.prototype.canAddRow=function(){return!n.Platform.isMobile()&&this.metadata.CanAddRow},r.prototype.allowShowTotalRow=function(){return!!this.metadata.IsTotalRowVisible},r.prototype.getIsTotalRowAtFirstRow=function(){return!!this.metadata.IsTotalRowAtFirstRow},r.prototype.getIsTotalRowAtLastRow=function(){return!this.metadata.IsTotalRowAtFirstRow},r.prototype.getTotalRowBindingInfosIgnoreNullValues=function(){return this.getTotalRowSettingsIgnoreNullValues().map(function(n){return n&&n.BindingInfo}).filter(function(t){return!n.Common.IsEmpty(t)})},r.prototype.getTotalRowSettingsIgnoreNullValues=function(){return this.metadata.Columns.map(function(n){return n.TotalRowCell}).filter(function(t){return!n.Common.IsEmpty(t)})},r.prototype.isGroupMode=function(){return this.metadata.IsGroupMode},r.prototype.isColumnFull=function(){return!!this.metadata.IsColumnFull},r.prototype.getBindingInfo=function(n){var t=this.getBindingInfoIndexOfColumn(n);return t===-1?null:this.columnBindingInfos[t]},r.prototype.isBindingColumn=function(n){return this.getBindingInfoIndexOfColumn(n)!==-1},r.prototype.getBindingInfoIndexOfColumn=function(n){var t=this.columnDataInfos[n];return t?t.bindingInfoIndex:-1},r.prototype.getStaticValue=function(n){var t=this.columnDataInfos[n];return t?t.staticValue:null},r.prototype.getColIndexByDataColumnName=function(n){return this.getColIndexByBindingInfo({TableName:this.metadata.DataTableName,ColumnName:n})},r.prototype.getColIndexByBindingInfo=function(t){var u,i,r;if(!t)return-1;for(u=this.getColumnCount(),i=0;i<u;i++)if((r=this.getBindingInfo(i),r)&&n.Common.isBindingInfoEquals(r,t))return i;return-1},r.prototype.getColIndexByName=function(n,t){var u,i,r;if(!n)return-1;for(t||(n=n.toLowerCase()),u=this.getColumnCount(),i=0;i<u;i++)if((r=this.columnDataInfos[i].columnName,r)&&(t||(r=r.toLowerCase()),r===n))return i;return-1},r.prototype.getColIndexByVisibleColIndex=function(n){return n<0||n>=this.visibleColumns.length?-1:this.visibleColumns[n].getColumnIndex()},r.prototype.getMergedColIndex=function(n){var i=this.metadata.OriginalColumns||this.metadata.Columns,r,t;if(!i)return-1;for(r=i.length,t=0;t<r;t++)if(i[t].Index===n)return t;return-1},r.prototype.getMergedColumnInfos=function(){return n.Common.IsEmpty(this._mergedColumnInfos)&&(this._mergedColumnInfos=this._createMergedColumnInfos(),this._mergedColumnInfos=this._mergedColumnInfos.sort(function(n,t){return n.DesignerColumnIndex-t.DesignerColumnIndex})),this._mergedColumnInfos},r.prototype._createMergedColumnInfos=function(){var i=this.metadata.Columns,r,u,t,f,e;if(!i)return[];for(r=[],u=this.getRangeInfo().Column,t=0;t<i.length;t++)f=this.columnDataInfos[i[t].Index],r.push({DesignerColumnIndex:i[t].Index+u,DesignerColumnCount:i[t].ColumnCount,ColumnName:f.columnName,ColumnDataType:this.getBindingInfoColumnTypeInDataModel(i[t].Index),ColumnType:n.ListviewColumnType.DataColumn});return this.isRowHeaderVisible()&&(r[0].ColumnType=n.ListviewColumnType.RowHeader),this.isRowHeaderCheckBoxVisible()&&(e=this.isRowHeaderVisible()?1:0,r[e].ColumnType=n.ListviewColumnType.SelectedColumn),r},r.prototype.getColumnCellType=function(t,i){var r=this.getColumnMetaData(t),u;return r&&r.TemplateCell?(u=n.ListivewEditorHelper.getCell(r.TemplateCell.Element,i),!u)?null:u.cellType:null},r.prototype.getDataColIndex=function(t){if(n.Common.IsEmpty(t))return-1;t=Number(t);var i=this.metadata.OriginalColumns||this.metadata.Columns;return!i||isNaN(t)||t<0||t>=i.length?-1:i[t].Index},r.prototype.getColumnCount=function(){return this.metadata.ColumnCount},r.prototype.showGridLine=function(){return this.metadata.ShowGridLine===!0?!0:!1},r.prototype.getGrayAreaBackColor=function(){return n.Common.IsEmpty(this.metadata.GrayAreaColor)?"transparent":n.ColorHelper.Convert(this.metadata.GrayAreaColor)},r.prototype.hideSelectionWhenLostFocus=function(){return this.metadata.HideSelectionWhenLostFocus===!0?!0:!1},r.prototype.getSelectionBackColor=function(){return n.Common.IsEmpty(this.metadata.SelectionBackColor)?undefined:this.metadata.SelectionBackColor==="transparent"?"transparent":n.ColorHelper.Convert(this.metadata.SelectionBackColor)},r.prototype.getSelectionBorderColor=function(){return n.ColorHelper.Convert(this.metadata.SelectionBorderColor)},r.prototype.canUserDragDrop=function(){return this.canEdit()&&(this.metadata.AllowDragMove===!0?!0:!1)},r.prototype.canUserDragFill=function(){return this.canEdit()&&(this.metadata.AllowDragFill===!0?!0:!1)},r.prototype.getSelectionMode=function(){return this.metadata.SelectionMode},r.prototype.getAlwaysReservedSelections=function(){return this.metadata.AlwaysReservedSelections},r.prototype.getIsSingleSelection=function(){return this.metadata.IsSingleSelection},r.prototype.getDisableAutoSelectRow=function(){return this.metadata.DisableAutoSelectRow},r.prototype.getAutoFitRowHeight=function(){return this.metadata.AutoFitRowHeight},r.prototype.getAutoFitColumnWidth=function(){return this.metadata.AutoFitColumnWidth},r.prototype.getAlwaysInEditMode=function(){return this.metadata.AlwaysInEditMode},r.prototype.bindingTableCanEdit=function(){return this.metadata.DataTableCanEdit},r.prototype.getAllowGetFocus=function(){return this.metadata.AllowGetFocus===!0?!0:!1},r.prototype.getMoveFocusHorizontally=function(){return this.metadata.MoveFocusHorizontally===!0?!0:!1},r.prototype.getColumnOperation=function(){return this.metadata.ColumnOperation},r.prototype.getDataCommitMode=function(){return this.metadata.DataCommitType===undefined?0:this.metadata.DataCommitType},r.prototype.getDataValidationTime=function(){return this.metadata.DataValidationTime===undefined?0:this.metadata.DataValidationTime},r.prototype.getDoNotLoadDataWhenLoadPage=function(){return this.metadata.DoNotLoadDataWhenLoadPage===!0},r.prototype.getIsAutoReload=function(){return this.metadata.IsAutoReload===!0},r.prototype.getAutoReloadInterval=function(){return this.metadata.AutoReloadInterval||0},r.prototype.getIsAutoScroll=function(){return this.metadata.IsAutoScroll===!0},r.prototype.getAutoScrollSpeed=function(){return this.metadata.AutoScrollSpeed===undefined?0:this.metadata.AutoScrollSpeed},r.prototype.getFrozenIndex=function(){return this.metadata.FrozenIndex},r.prototype.getFrozenIndexEnd=function(){return this.metadata.FrozenIndexEnd},r.prototype.getFrozenLineColor=function(){return this.metadata.FrozenLineColor?n.ColorHelper.Convert(this.metadata.FrozenLineColor):"#9B9B9B"},r.prototype.getDataColumnBindingInfo=function(n){var t,i;return!this.columnDataInfos||!this.columnBindingInfos?null:this.isValidIndex(n,this.columnDataInfos.length)?(t=this.columnDataInfos[n],!this.isValidIndex(t.bindingInfoIndex,this.columnBindingInfos.length))?null:(i=this.columnBindingInfos[t.bindingInfoIndex],i?i:null):null},r.prototype.isValidIndex=function(n,t){return n>=0&&n<t},r.prototype.isDataColumnAllowEdit=function(t){var i=this.getDataColumnBindingInfo(t);return n.Common.cannotEditedBindingInfo(i)?!1:!0},r.prototype.getAllHeaderCellContentElement=function(){var u=[],i=this.metadata.Columns,n,r,t;if(!i)return u;for(n=0;n<i.length;n++)if(i[n]&&i[n].HeaderCell)for(r=i[n].HeaderCell,t=0;t<r.length;t++)r[t]&&r[t].Element&&u.push(r[t].Element);return u},r.NamePrefix="s",r.Index=0,r.DefaultColumnHeaderHeight=25,r}(),i,t;n.ListviewData=r;i=function(){function n(){this.bindingInfoIndex=-1;this.staticValue=null}return n}();n.ListviewColumnDataInfo=i;t=function(){function t(t,i,r,u){var f,e,o;(this.columnInfo=t,this.IsOrMode=!1,this.isNotInMode=!1,this.idSuffix=i,this.canEditInForguncy=!1,this.canEnterEditMode=!1,this.needValidateWhenShowEditor=!1,f=this.getTemplateCell(),this.cellType=n.CellTypeHelper.getCellType(f?f:{},1,n.ListivewEditorHelper.getEditorID(),n.StaticValues.RunTimeNormalPage),f)&&r&&((e=this.getBindingInfo(),n.Common.cannotEditedBindingInfo(e))||e.ColumnName!==u&&(o=f.CellType,o&&!o.ReadOnly)&&this.cellType.cellTypeData instanceof n.InputCellTypeData&&(this.canEditInForguncy=!0,this.canEnterEditMode=this.cellType.cellTypeData.canEnterEditModeInListview()))}return Object.defineProperty(t.prototype,"totalRowSetting",{get:function(){return this.columnInfo&&this.columnInfo.TotalRowCell},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnFilterQuery",{get:function(){return{ColumnBindingInfo:this.getFilterBindingInfo(),IsNotInMode:this.isNotInMode,Values:this.filterValues,IsOrMode:this.IsOrMode,Conditions:this.filterConditions,filterComapreType:this.filterCompareType}},set:function(n){this.isNotInMode=n?n.IsNotInMode:!1;this.filterValues=n?n.Values:null;this.IsOrMode=n?n.IsOrMode:!1;this.filterConditions=n?n.Conditions:null;this.filterCompareType=n?n.filterComapreType:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isColumnFilterValid",{get:function(){return!(n.Common.IsEmpty(this.filterValues)&&n.Common.IsEmpty(this.filterConditions))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actualCompareType",{get:function(){return this.filterCompareType>99?0:this.filterCompareType},enumerable:!0,configurable:!0}),t.prototype.getTemplateCell=function(){return!this.columnInfo.TemplateCell||!this.columnInfo.TemplateCell.Element?null:this.columnInfo.TemplateCell.Element},t.prototype.getCommandsMetaData=function(){var n=this.getTemplateCell();return!n||!n.CellType||!n.CellType.CommandList?null:n.CellType.CommandList},t.prototype.getBindingInfo=function(){var n=this.getTemplateCell();return n&&n.BindingInfo?n.BindingInfo:null},t.prototype.getFilterBindingInfo=function(){return this.columnInfo.FilterBindingInfo||this.getBindingInfo()},t.prototype.getFilterDisplayBindingInfo=function(){return this.columnInfo.FilterDisplayBindingInfo},t.prototype.getFilterColumnDataType=function(){var t=this.columnInfo.FilterColumnDataType;return t!==undefined?t:this.columnInfo.BindingColumnDataType||n.ColumnDataType.Other},t.prototype.getIsFilterStatisticColumn=function(){return!!this.columnInfo.IsFilterStatisticColumn},t.prototype.getColumnIndex=function(){return this.columnInfo.Index},t.prototype.getName=function(){var n=this.getTemplateCell();return!n||!n.Name||n.Name.length===0||!n.Name[0]?null:n.Name[0]},t.prototype.allowSort=function(){return this.columnInfo.AllowSort},t.prototype.getRightBorderWidth=function(n,t){var i=t?GC.Spread.Sheets.LineStyle.thin:GC.Spread.Sheets.LineStyle.empty;return n?i=this.columnInfo.HeaderCell&&this.columnInfo.HeaderCell.length>0&&this.columnInfo.HeaderCell[0].BorderRight?this.columnInfo.HeaderCell[0].BorderRight.Style:GC.Spread.Sheets.LineStyle.thin:this.columnInfo.TemplateCell&&this.columnInfo.TemplateCell.BorderRight&&(i=this.columnInfo.TemplateCell.BorderRight.Style),this.getBorderWidth(i)},t.prototype.getBottomBorderWidth=function(n){var t=n?GC.Spread.Sheets.LineStyle.thin:GC.Spread.Sheets.LineStyle.empty;return this.columnInfo.TemplateCell&&this.columnInfo.TemplateCell.BorderBottom&&(t=this.columnInfo.TemplateCell.BorderBottom.Style),this.getBorderWidth(t)},t.prototype.getBorderWidth=function(n){switch(n){case GC.Spread.Sheets.LineStyle.hair:case GC.Spread.Sheets.LineStyle.thin:case GC.Spread.Sheets.LineStyle.dashDot:case GC.Spread.Sheets.LineStyle.dashDotDot:case GC.Spread.Sheets.LineStyle.dashed:case GC.Spread.Sheets.LineStyle.dotted:return 1;case GC.Spread.Sheets.LineStyle.medium:case GC.Spread.Sheets.LineStyle.mediumDashDot:case GC.Spread.Sheets.LineStyle.mediumDashDotDot:case GC.Spread.Sheets.LineStyle.mediumDashed:case GC.Spread.Sheets.LineStyle.slantedDashDot:return 2;case GC.Spread.Sheets.LineStyle.thick:case GC.Spread.Sheets.LineStyle.double:return 3;default:return 0}},t.prototype.getDefaultValue=function(t,i,r){var f=this.getTemplateCell(),u,e;return f?(u=f.DefaultFormula,n.Common.IsEmpty(u))?this.cellType.cellTypeData.getDefaultValue():(u=new n.CellFormulaTranslater(t,i,n.ListviewBase.getAllListviews([i])).translate(u),e={runTimePageName:t,supportReferToListview:!1,nullAsException:!1,listInfo:null,rowOffset:r,columnOffset:this.getColumnIndex(),isTranslatedFormula:!0},n.ForguncyData.pageInfo.formulaManager.evaluateFormula("="+u,e)):null},t.prototype.clearColumnFilter=function(){this.filterValues=null;this.filterConditions=null;this.filterCompareType=null;this.isNotInMode=!1;this.IsOrMode=!1},t.prototype.clearColumnFilterConditions=function(){this.filterConditions=null;this.filterCompareType=null;this.IsOrMode=!1},t.prototype.clearColumnFilterValues=function(){this.filterValues=null;this.isNotInMode=!1},t}();n.VisibleListviewColumnInfo=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var e=function(){function n(n,t,i,r){t===void 0&&(t=null);i===void 0&&(i=[]);r===void 0&&(r=-1);this.query=n;this.rowVersion=t;this.values=i;this.index=r}return n}(),t,i,r,u,f;n.CachedRowData=e;t=function(t){function i(i,r,u,f,e,o,s){var h,c;return o===void 0&&(o=!0),h=t.call(this)||this,h._containerDivID=i,h.listviewData=r,h.runTimePageName=u,h.bounds=f,h._isVisible=e,h._throwExceptionIfNotImplement=o,h.ResponsiveInfo=s,h.deletedRowQuerys=[],h._isLoading=!1,h.loadingIndicator=null,h.cover=null,h._deleteButton=undefined,h._masterValue=undefined,h.isFocused=!1,h._maxRowCountOfLoadOnDemand=0,h._haveTriggerOnLostFocusMethod=!1,h._hasDestoryed=!1,h._protectListview=!1,h._locationString=null,h._waitValidateRows=[],h._isLoaded=!1,h.locatedPageID=n.ForguncyData.pageInfo.pageID,h.operationTypeWhenValueChanged=0,h._commitingRows=[],c=n.ForguncyData.pageInfo.dataModel,h._listData=c.addListData(h.getListviewName(),h.getCalcSheetName(),h.listviewData.getColumnCount(),h.runTimePageName),h._listData.bind(n.Events.ValueChanged,function(n,t){h._onValueChangedInDataModel(t)}),h.bindCurrentRowInfoAndPagingInfoChangedEvent(),h.adjustColumnWidth(),h._initHeaderCellsValue(c),h._resolveAutoReload(),h}return __extends(i,t),Object.defineProperty(i.prototype,"isLoaded",{get:function(){return this._isLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataVersion",{get:function(){return this._dataVersion},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"totalRowDataVersion",{get:function(){return this._totalRowDataVersion},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxRowCountOfLoadOnDemand",{get:function(){return this._maxRowCountOfLoadOnDemand},enumerable:!0,configurable:!0}),i.prototype._resolveAutoReload=function(){var r=this,u,t,i;this.listviewData.getIsAutoReload()&&(u=this.listviewData.getAutoReloadInterval(),u>0&&(t=u*1e3,this._forceHideLoadingIndicator=!0,i=function(){if(r.hasDestroyed())return;else r.isInCurrentPage()?r.fillData(null,!1,!1,function(){n.DelayRefresh.setTimeout(i,t)}):n.DelayRefresh.setTimeout(i,t)},n.DelayRefresh.setTimeout(i,t)))},i.prototype.resetListviewDataForColumnOptionsCommand=function(t){this.listviewData=t;this._listData.resetColumnCount(this.listviewData.getColumnCount());this._initHeaderCellsValue(n.ForguncyData.pageInfo.dataModel)},i.prototype.bindCurrentRowInfoAndPagingInfoChangedEvent=function(){var t=this;this._currentRowInfoChangedEventHandler=function(n,i){t.onCurrentRowInfoChanged(i)};n.ForguncyData.pageInfo.currentRowInfoCollection.bind(n.Events.CurrentRowInfoChanged,this._currentRowInfoChangedEventHandler);n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(this.listviewData.getDependenceCells(),function(){t.onDependenceCellValueChanged()},this.runTimePageName);n.Common.IsEmpty(n.ForguncyData.pageingInfoList)&&(n.ForguncyData.pageingInfoList=new n.PageingInfoList);this._pagingInfoChangedEventHandler=function(n,i){t._hasDestoryed||t.getLocationString()!==i.listviewLocation||t.fillData(null,!1,!0)};n.ForguncyData.pageingInfoList.bind(n.Events.PageingInfoChanged,this._pagingInfoChangedEventHandler)},i.prototype.adjustColumnWidth=function(){for(var i,f,r=this.listviewData.showGridLine(),u=this.useHeaderCellWhenAdjustColumnWidth(),t=this.listviewData.visibleColumns,n=0;n<t.length;n++)i=0,n>0&&(i=t[n-1].getRightBorderWidth(u,r)),i=this.getBorderAdjustedWidth(i),f=this.getBorderAdjustedWidth(t[n].getRightBorderWidth(u,r)),t[n].columnInfo.Width=t[n].columnInfo.Width-i+f,t[n].columnInfo.Width=Math.max(t[n].columnInfo.Width,0)},i.prototype._initHeaderCellsValue=function(t){for(var u,f,e=this.getHeaderCellIDSuffix(),r=this.listviewData.getAllHeaderCellContentElement(),i=0;i<r.length;i++)u=n.Common.convertMetaDataDefaultValue(r[i].Value,this.runTimePageName),u!==null&&(f=n.Common.getIdStr(r[i].Row,r[i].Column,e),t.normalCellDataModel.setValue(f,{newValue:u},1,r[i].IgnoreExport))},i.prototype.getHeaderCellIDSuffix=function(){return this.listviewData.isColumnHeaderVisibleInDesigner()?this.runTimePageName:this.listviewData.name},i.prototype.getListDataModel=function(){return this._listData},i.prototype.onDependenceCellValueChanged=function(){this.resetToFirstPage();this.fillData()},i.prototype.getBorderAdjustedWidth=function(n){return n},i.prototype.useHeaderCellWhenAdjustColumnWidth=function(){return!1},i.prototype.onLoad=function(){this._isLoaded=!0;this.listviewData.canDelete()&&this.createDeleteButton()},i.prototype.onWindowResized=function(){},i.prototype.getColumnTypeByIndex=function(n){return this.listviewData.getBindingInfoColumnTypeInDataModel(n)},i.prototype.getVisibleColumnIndexInListViewByDataIndex=function(n){var t,i;if(this.listviewData.visibleColumns&&n>-1&&n<this.listviewData.getColumnCount())for(t=0;t<this.listviewData.visibleColumns.length;t++)if(i=this.listviewData.visibleColumns[t],i&&i.getColumnIndex()===n)return t;return-1},i.prototype.isInCurrentPage=function(){return this.locatedPageID===n.ForguncyData.pageInfo.pageID},i.prototype.getCellTypeByColIndex=function(n){return this.listviewData.getColumnCellType(n,this.runTimePageName)},i.prototype.onCurrentRowInfoChanged=function(n){this.syncSelectionOfListviewsHaveSameDataTable(n);this.refreshDetailListviewData(n)},i.prototype.syncSelectionOfListviewsHaveSameDataTable=function(t){var r,i;if(t.isQueryChanged&&(t.change===0||t.change===1)){if(this.isGroupMode()||t.rowInfo.currentTable!==this.getDataTableName())return;if(r=t.rowInfo.query,!n.Common.isQueryEqual(this._listData.getRowQuery(this._listData.getSelectIndex()),r)&&(i=this._listData.getRowIndexByQuery(r),i>=0&&i<this.getEditorRowCount())){this.onCurrentRowChanged(i,!1);this.selectInEditor(i);this.onSelectionChanged(!1)}}},i.prototype.refreshDetailListviewData=function(n){n.isQueryChanged&&this.getMasterDataTableName()===n.rowInfo.currentTable&&(n.change===2?this.clearData():this.fillData())},i.prototype._onValueChangedInDataModel=function(n){this.triggerAPIValueChangedEvent([__assign({},n.cellRange)],n.newRowCount,n.oldRowCount)},i.prototype.triggerAPIValueChangedEvent=function(t,i,r){var u=this;t.forEach(function(n){return n.Column=u.getMergedColIndexByDataColIndex(n.Column)});u.trigger(n.ListViewEvents.ValueChanged,{CellRanges:t,NewRowCount:i,OldRowCount:r})},i.prototype._onCellValueChanged=function(t,i,r,u){var s=this.listviewData.getColIndexByVisibleColIndex(i),f,h,c,e,o;if(s!==-1&&(this._listData.setValue(t,s,r,5,u),t===this.getSelectedRowIndex()&&(f=this.listviewData.getBindingInfo(s),f!=null&&!f.RelationBinding)))for(h=n.ListviewBase.getAllListviews(),c=h.length,e=0;e<c;e++)o=h[e],o.getMasterDataTableName()===this.getDataTableName()&&o.getColumnOfMasterTable()===f.ColumnName&&o.masterValueChanged(r)},i.prototype.setDataToSpreadJSNow=function(n,t){n===void 0&&(n=-1);t===void 0&&(t=-1)},i.prototype.triggerCommand=function(t,i){var r=this.mappedRowIndexFrowView(t),u=i,o=n.Common.getIdStr(r,u,this.getCalcSheetName()),s=this._listData.getRowCount(),h=this._listData.getColumnCount(),f,e;return r<0||r>=s||u<0||u>=h?!1:(f=this.listviewData.visibleColumns[u].getCommandsMetaData(),!f||f.length===0)?!1:(e=this._listData.getSelectIndex(),e!==r&&this.selectRow(r),n.ForguncyData.commandExcutor.excuteCommand(f,this.runTimePageName,this,o,n.Events.Click),!0)},i.prototype.shouldCancelCommand=function(n,t){return!1},i.prototype.masterValueChanged=function(n){var i=this.listviewData.getColIndexOfColumnOfDetailTable(),r,t;if(this.listviewData.canEdit()&&i!==-1&&this._masterValue!==n)for(r=this._listData.getRowCount(),t=0;t<r;t++)this._listData.setValue(t,i,n,5)},i.prototype.getRowInfo=function(t){var i=new n.CurrentRowInfo,r;return i.currentTable=this.getDataTableName(),i.viewname=this.getFullListviewName(),i.listviewLocation=this.getLocationString(),i.viewCondtionFormulaValues=this.GetQueryConditionFormulaValues(),i.masterTableQuery=this.getMasterQuery(),n.Common.IsEmpty(t)&&(t=this._listData.getSelectIndex()),r=this._listData.getRowCount(),t!==undefined&&t<r&&(i.selectedRowIndex=t,i.recordID=this.getRecordID(t),i.query=this._listData.getRowQuery(t)),i},i.prototype.getRowVersion=function(n){return this._listData.getRowInfo(n).rowVersion},i.prototype.getRecordID=function(t){var r=n.ForguncyData.pageingInfoList.GetPageIndex(this.getLocationString()),i;return r=this.isInvalidNumber(r)?0:r-1,i=n.ForguncyData.pageingInfoList.GetLimit(this.getLocationString()),i=this.isInvalidNumber(i)?0:i,r*i+t},i.prototype.isInvalidNumber=function(n){return typeof n!="number"||isNaN(n)||n<=0},i.prototype.getDataTableName=function(){return this.listviewData.getDataTableName()},i.prototype.getMasterDataTableName=function(){return this.listviewData.getMasterDataTableName()},i.prototype.getColumnOfMasterTable=function(){return this.listviewData.getColumnOfMasterTable()},i.prototype.getColumnOfDetailTable=function(){return this.listviewData.getColumnOfDetailTable()},i.prototype.getMasterQuery=function(){var i=this.getMasterDataTableName(),t;if(i&&(t=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(i),t))return t.query},i.prototype.allowLoadOnDemand=function(){if(!this.listviewData.shouldLoadOnDemand())return!1;var t=this._listData.getRowCount();return this._maxRowCountOfLoadOnDemand&&t===this._maxRowCountOfLoadOnDemand?!1:n.ForguncyData.pageingInfoList&&n.ForguncyData.pageingInfoList.IsPageing(this.getLocationString())?!1:!0},i.prototype.loadOnDemand=function(){if(this._isLoading!==!0&&this.allowLoadOnDemand()){this._isLoading=!0;this.showLoadingIndicator();var t=this;n.DelayRefresh.setTimeout(function(){t.hasDestroyed()||n.ListViewHelper.RequestHelper.queryDataFromServer(t,!0)},100)}},i.prototype.showLoadingIndicator=function(t){var f,a,v;if(t===void 0&&(t=!0),this._isVisible){if(this.loadingIndicator===null){if(f=this.getContainerDiv().parent(),!f||f.length===0)return;var h=!1,c=!1,e=-1,o=-1,s=this._getPageStretchInfo();s&&(h=n.Stretch.Common.canHorizontallyStretch(s.StretchMode),e=s.MainPartWidth,c=n.Stretch.Common.canVerticallyStretch(s.StretchMode),o=s.MainPartHeight);var l=999,u=17,i=this.bounds,r=this.getCoverBounds();this.cover=n.Common.getCover("transparent",1).css("position","absolute").css("zIndex",l).appendTo(f);this.loadingIndicator=$("<img class='loading-indicator'><\/img>").attr("src",n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/loading.gif").css("position","absolute").css("width",u).css("height",u).css("zIndex",l).appendTo(f);h&&e>0?(this.cover.css("left",100*r.left/e+"%"),this.cover.css("width",100*r.width/e+"%"),a=100*(i.left+i.width/2)/e,this.loadingIndicator.css("left","calc("+a+"% - "+u/2+"px)")):(this.cover.css("left",r.left).css("width",r.width),this.loadingIndicator.css("left",i.left+i.width/2-u/2));c&&o>0?(this.cover.css("top",100*r.top/o+"%"),this.cover.css("height",100*r.height/o+"%"),v=100*(i.top+i.height/2)/o,this.loadingIndicator.css("top","calc("+v+"% - "+u/2+"px)")):(this.cover.css("top",r.top).css("height",r.height),this.loadingIndicator.css("top",i.top+i.height/2-u/2))}this.protectListview(!0);this.cover.show();!this._forceHideLoadingIndicator&&t&&this.loadingIndicator.show();this.hideDeleteButton()}},i.prototype.hiddenLoadingIndicator=function(t){t===void 0&&(t=!1);this.loadingIndicator&&(t||!n.DelayRefresh.NeedDelayRun?(this.cover.hide(),this.loadingIndicator.hide()):(this.cover.hide(),this.loadingIndicator.hide()),this.protectListview(!1))},i.prototype.getCoverBounds=function(){return this.bounds},i.prototype.protectListview=function(n){this._protectListview=n},i.prototype.isProtected=function(){return this._protectListview},i.prototype.needQueryData=function(){if(!this.getDataTableName()||this.listviewData.columnBindingInfos.length===0)return!1;if(!this.isMasterTable()){var n=this.getMasterQuery();if(!n)return!1}return!0},i.prototype._setInitData=function(t,i){var r=this._listData.getSelectIndex();this.clearTemporaryThings();this._listData.setData(t);this._commitingRows=[];this._maxRowCountOfLoadOnDemand=i;this.onDataLoaded();this.initSelection(r);this.trigger(n.ListViewEvents.Reloaded,{})},i.prototype.initSelection=function(n){this.getEditorRowCount()>0?this.selectRowAfterInitData(n):this.isGroupMode()||this.clearCurrentRow()},i.prototype.onDataLoaded=function(){},i.prototype.allowShowTotalRow=function(){return this.listviewData.allowShowTotalRow()},i.prototype.isLoadOnDemanding=function(){return this.listviewData.shouldLoadOnDemand()&&this._listData.getRowCount()!==this._maxRowCountOfLoadOnDemand},i.prototype.allowAddRow=function(){return this.listviewData.canAddRow()&&!this.isLoadOnDemanding()?!0:!1},i.prototype.allowInsertRow=function(){return this.listviewData.canEdit()&&!this.isLoadOnDemanding()?!0:!1},i.prototype.allowDuplicateRow=function(){var t,n;return this.listviewData.canEdit()&&!this.isLoadOnDemanding()?(t=this.listviewData.getDataCommitMode(),t===0&&(n=this.getAllSelectedRowsOfData(),n&&n.length>1))?!1:!0:!1},i.prototype.addData=function(n){n!==[]&&(this._listData.addData(n,2),this.onDataLoaded(),this._isLoading=!1)},i.prototype.selectRowAfterInitData=function(t){var e=this.getEditorRowCount(),f,i,r,u;if(!(e<=0)){if(f=this._listData.getRowCount(),i=-1,this.isGroupMode())i=n.Common.IsEmpty(t)?-1:t;else if(r=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(this.getDataTableName()),r){if(r.query)for(u=0;u<f;u++)if(n.Common.isQueryEqual(this._listData.getRowInfo(u).query,r.query)){i=u;break}i!==-1||n.Common.IsEmpty(r.selectedRowIndex)||(i=Number(r.selectedRowIndex))}i=Math.min(f-1,i);i=Math.max(0,i);this.onCurrentRowChanged(i)}},i.prototype.selectRow=function(n){if(n>=0&&n<this.getEditorRowCount()&&n!==this.getSelectedRowIndex()){this.selectInEditor(n);this.onCurrentRowChanged(n)}},i.prototype.selectInEditor=function(t,i){if(this._throwExceptionIfNotImplement)throw n.StaticValues.NeedImplementException;},i.prototype.isMasterTable=function(){return this.listviewData.isMasterTable()},i.prototype.commitChangeRealTime=function(n,t){if(n<0||!t)return!1;var i=this._listData.getRowQuery(n);return i?!0:t==="add"&&(this.isMasterTable()||!!this.getMasterQuery())},i.prototype.getEditorInfo=function(t){t===void 0&&(t=!1);var i=this,r=i.getEditorDataInfos(t);r&&r.length!==0&&(i.showLoadingIndicator(),n.HomeController.GetEditorInfo(r,function(r){(r&&r.errorMessage&&alert(r.errorMessage),i.hasDestroyed())||(r&&r.editor&&i.setEditorDataInfos(r.editor.$values,t),n.DelayRefresh.Push(i,function(){i.hasDestroyed()||i.hiddenLoadingIndicator()},i.getCalcSheetName()+"hiddenLoadingIndicator"))},this.getCalcSheetName()))},i.prototype.fillData=function(t,i,r,u){t===void 0&&(t=null);i===void 0&&(i=!1);r===void 0&&(r=!1);var f=this;if(!f.hasDestroyed()){n.ForguncyData.pageingInfoList.RefeshRowCount(f.getLocationString());n.ListViewHelper.RequestHelper.queryDataFromServer(f,!1,t,i,r,u);return}},i.prototype.beforeRefeshUIWhenQueryDataFromServer=function(){},i.prototype.deleteCachedRowDataByRowIndex=function(n){},i.prototype.updateCachedRowAfterDeleteRow=function(n){},i.prototype.getColumnFilterQueries=function(n){return n===void 0&&(n=[]),this.listviewData.visibleColumns.filter(function(t){return n.indexOf(t.getFilterBindingInfo())<0&&t.isColumnFilterValid}).map(function(n){return n.columnFilterQuery})},i.prototype.getTotalRowSettingsIgnoreNullValues=function(){return this.listviewData.getTotalRowSettingsIgnoreNullValues()},i.prototype.getTotalRowBindingInfosIgnoreNullValues=function(){return this.listviewData.getTotalRowBindingInfosIgnoreNullValues()},i.prototype.resetToFirstPage=function(){var t=this.getLocationString();n.ForguncyData.pageingInfoList.ResetPageIndexToFirstPage(t)},i.prototype.restoreColumnFilterQueries=function(){var u=n.ForguncyData.columnFilterQueryCache[this.getLocationString()],t,i,r;if(!n.Common.IsEmpty(u)){if(t=this.listviewData.visibleColumns,!t)return;for(i=0;i<t.length;i++)for(t[i].columnFilterQuery=null,r=0;r<u.length;r++)if(n.Common.isBindingInfoEquals(u[r].ColumnBindingInfo,t[i].getFilterBindingInfo())){t[i].columnFilterQuery=u[r];break}}},i.prototype.GetQueryConditionFormulaValues=function(){var t=this.listviewData.getConditionFormulas(),r,i,u;if(t&&t.length!==0){for(r={},i=0;i<t.length;i++)u=t[i],n.FormulaManager.isReady()&&(r[u]=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(u,{runTimePageName:this.runTimePageName,supportReferToListview:!1,nullAsException:!0,listInfo:null,rowOffset:0,columnOffset:0}));return r}},i.prototype.rollbackBindingValue=function(n){for(var i,r,u=this.listviewData.getColumnCount(),t=0;t<u;t++)i=this.listviewData.columnDataInfos[t],i.bindingInfoIndex!==-1&&(r=this._listData.getBindingValue(n,t),this._listData.setValue(n,t,r,2))},i.prototype.reloadItemsEditor=function(t){var f=this,i,e,u,r;if(t&&(t=t.toLowerCase()),i=this.listviewData.visibleColumns,i)for(e=function(r){var o=i[r].getTemplateCell(),e;if(!o||(e=o.CellType,!e||!e.IsBounding||!e.DataSource)||t&&e.DataSource.toLowerCase()!==t||n.Common.typeContains(e,"DropDownListCellType"))return"continue";var s="Home/GetComboBindingOptions",h={tableName:e.DataSource,valueColumnBindingInfo:e.ValueColumnBindingInfo,displayColumnBindingInfo:e.DisplayColumnBindingInfo,dropDownSubItems:e.DropDownSubItems,itemQuery:n.ConditionHelper.getComputedSqlConditionFormula(e.ItemsQuery,u.runTimePageName,n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull),itemSort:e.ItemsSort},c=u.getCalcSheetName()+r;n.Common.forguncyPost(s,h,function(t,i){var r;r=n.Common.IsEmpty(t)?null:typeof t=="string"?JSON.parse(t):t;r||(r={Items:[]});e.ItemsInfo=r;n.ItemsCellTypeHelper.initItemsOfItemsCell(o,e.ItemsInfo,e);e.haveLoadItems=!0;e.hasInitItemsInfo=!1;e.initItemsInfoCallback=function(){f.autoFit()};f.refreshUI()},"GetComboBindingOptions "+c)},u=this,r=0;r<i.length;r++)e(r)},i.prototype.autoFit=function(){},i.prototype.getEditorDataInfos=function(n){for(var t,u=this.getBoundingItemsElementsWithItemsCellType(n),i=[],r=0;r<u.length;r++)t=u[r].CellType,i.push({tableName:t.DataSource,valueColumnBindingInfo:t.ValueColumnBindingInfo,displayColumnBindingInfo:t.DisplayColumnBindingInfo,itemSort:t.ItemsSort});return i.length===0?null:i},i.prototype.setEditorDataInfos=function(t,i){for(var r,f,o=this,e=this.getBoundingItemsElementsWithItemsCellType(i),u=0;u<e.length;u++)r=e[u].CellType,f=t[u],n.Common.IsEmpty(f)&&(f={Items:[]}),r.ItemsInfo=f,n.ItemsCellTypeHelper.initItemsOfItemsCell(e[u],r.ItemsInfo,r),r.haveLoadItems=!0,r.hasInitItemsInfo=!1,r.initItemsInfoCallback=function(){o.autoFit()}},i.prototype.getBoundingItemsElementsWithItemsCellType=function(n){var f=[],u=this.listviewData.visibleColumns,i,r,t;if(u)for(i=0;i<u.length;i++)if(r=u[i].getTemplateCell(),r){if(t=r.CellType,t&&t.$type==="Forguncy.DropDownListCellType, Forguncy")continue;if(!t||!t.IsBounding)continue;if(!n&&t.haveLoadItems)continue;t.DataSource&&(t.ValueColumnBindingInfo||t.DisplayColumnBindingInfo)&&f.push(r)}return f},i.prototype.getUserSelectorCellTypes=function(){var u=[],i=this.listviewData.visibleColumns,n,r,t;if(i)for(n=0;n<i.length;n++)r=i[n].getTemplateCell(),r&&(t=r.CellType,t&&t.$type==="Forguncy.UserCellType, Forguncy"&&u.push(t));return u},i.prototype.clearCurrentRow=function(){n.ForguncyData.pageInfo.currentRowInfoCollection.removeCurrentRowInfo(this.getDataTableName())},i.prototype.createDeleteButton=function(){var c=this,u,r,s,h,i;if(this.listviewData.canDelete()&&!this._deleteButton){if(u=this.getContainerDiv().parent(),!u||u.length===0)return;var t=$("<div/>"),f=-1,o=!1,e=this._getPageStretchInfo();e&&(o=n.Stretch.Common.canHorizontallyStretch(e.StretchMode),f=e.MainPartWidth);t.addClass("deleteButton");t.css("position","absolute");t.css("width",n.ListviewBase._deleteButtonLength);t.css("height",n.ListviewBase._deleteButtonLength);r=this.bounds.left-n.ListviewBase._deleteButtonLength-n.ListviewBase._deleteButtonRightSpace;r<0&&(r=0);o&&f>0&&this.ResponsiveInfo&&(s=this.ResponsiveInfo.ExtendWidth?this.bounds.left-this.ResponsiveInfo.ExtendWidth:this.bounds.left,h=100*s/f,r="calc("+h+"% - "+(n.ListviewBase._deleteButtonLength+n.ListviewBase._deleteButtonRightSpace)+"px)");t.css("left",r);t.css("zIndex",999);t.css("display","none");i=$("<img/>");i.addClass("deleteButton");i.css("position","absolute");i.css("width","100%");i.css("height","100%");i.css("cursor","pointer");i.attr("src",n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/delete.png");t.append(i);this._deleteButton=t;this._deleteButton.on("click",function(n){c.deleteOnUIClick()});this._deleteButton.css("display","none");u.append(this._deleteButton)}},i.prototype.deleteOnUIClick=function(){var n=this.commitCurrentEdit();n&&this.updateDataChange(this._listData.getSelectIndex(),!0)},i.prototype._showDeleteButton=function(){var i,r,u,f,t;this._deleteButton&&!this.isProtected()&&(i=this._listData.getSelectIndex(),this.isFocused&&i!==undefined?(r=this._listData.getRowCount(),r>0&&i<r&&(u=this.getSelectedRowCenterY(),u!==-1&&(f=u-n.ListviewBase._deleteButtonLength/2,t=this._getPageStretchInfo(),t&&n.Stretch.Common.canVerticallyStretch(t.StretchMode)&&t.MainPartHeight>0?this._deleteButton.css("top",this._covertDeleteButtonTopToPercent(f,t.MainPartHeight)):this._deleteButton.css("top",f),this._deleteButton.show()))):this.hideDeleteButton())},i.prototype._covertDeleteButtonTopToPercent=function(t,i){if(this._throwExceptionIfNotImplement)throw n.StaticValues.NeedImplementException;return""},i.prototype.getSelectedRowCenterY=function(){if(this._throwExceptionIfNotImplement)throw n.StaticValues.NeedImplementException;return 0},i.prototype.hideDeleteButton=function(){this._deleteButton&&this._deleteButton.hide()},i.prototype.isDeleteButtonVisible=function(){return this._deleteButton?this._deleteButton.css("display")==="block":!1},i.prototype.clearData=function(){this._maxRowCountOfLoadOnDemand=0;this.clearTotalRow();this._listData.clear();this.clearTemporaryThings();this.clearCurrentRow();this.updateDataVersion();this.updateTotalRowDataVersion()},i.prototype.clearTemporaryThings=function(){this._listData.select();this._masterValue=undefined;this.hideDeleteButton()},i.prototype.clearTotalRow=function(){if(this.listviewData.allowShowTotalRow()){var n=this.listviewData.getTotalRowSettingsIgnoreNullValues().filter(function(n){return n.BindingInfo!=null});n.forEach(function(n){n.Value=n.FormulaType===2?0:""})}},i.prototype.updateDataVersion=function(){this._dataVersion=n.Common.getUniqueNumber()},i.prototype.updateTotalRowDataVersion=function(){this._totalRowDataVersion=n.Common.getUniqueNumber()},i.prototype.mappedRowIndexFromData=function(n){return n},i.prototype.mappedRowIndexFrowView=function(n){return n},i.prototype.insertRow=function(n){var r=this,t=this.getAllSelectedRowsOfData(),u,i;t&&t.length>0&&(t.sort(function(n,t){return n-t}),u=t[0],i=[],t.forEach(function(){i.push(r.getNewRowData(!0));r._maxRowCountOfLoadOnDemand++}),this._listData.insertData(u,i,5,n))},i.prototype.duplicateRow=function(n){var u=this,t=this.getAllSelectedRowsOfData(),i,r;t&&t.length>0&&(t.sort(function(n,t){return n-t}),i=t.slice(-1)[0]+1,r=[],t.forEach(function(n){r.push(u.getDuplicateRowData(n));u._maxRowCountOfLoadOnDemand++}),this._listData.insertData(i,r,5,n,!0),this._listData.select(i))},i.prototype.addNewRow=function(t,i){var u,r;for(this._maxRowCountOfLoadOnDemand++,this._listData.addData([this.getNewRowData()],5,i),u=this._listData.getRowCount()-1,r=0;r<t.length;r++)t[r]!==undefined&&this._listData.setValue(u,r,t[r],5,i);n.Common.IsEmpty(this._listData.getSelectIndex())&&this.selectRow(0)},i.prototype.addNewRowWithText=function(n,t){for(var i in n)try{n[i]=this.validateValue(parseInt(i),n[i],!0)}catch(r){if(this.GetDataValidationTime()===0)throw r;}this.addNewRow(n,t)},i.prototype.setCellText=function(n,t,i,r){var u=i;try{u=this.validateValue(t,i,!0,n)}catch(f){if(this.GetDataValidationTime()===0)throw f;}this._listData.setValue(n,t,u,5,r)},i.prototype.validateValue=function(t,i,r,u){var o,s,h,c,l;u===void 0&&(u=-1);var a=i,e=this.getCellTypeByColIndex(t),f="";if(!n.Common.IsEmpty(i))if(e!=null&&r&&(i=e.getValueFromListviewText(i)),o=this.getColumnTypeByIndex(t),o===n.ColumnDataType.Date||o===n.ColumnDataType.Time)try{typeof i=="string"&&(i=e!=null?e.getValueFromListviewText(i):n.FormatHelper.getValueFromText(i));i instanceof Date&&(i=n.ConvertDateToOADate(i));n.DateHelper.isValidDateValue(i)||(f=n.RS.ListViewAddNewRowError_CantConvertToDateTime)}catch(v){f=v}else o===n.ColumnDataType.Number?(i=Number(i),isNaN(i)&&(f=n.RS.ListViewAddNewRowError_CantConvertToNumber)):o===n.ColumnDataType.Bool&&(i===1||i==="1"||i===!0||(i+"").toLowerCase()==="true"?i=1:i===0||i==="0"||i===!1||(i+"").toLowerCase()==="false"?i=0:f=n.RS.ListViewAddNewRowError_CantConvertToBool);if(e!=null&&(s={},s[this.getCalcSheetName()]=u===-1?this.getListDataCount():u,h=e.validateValue(i,s),n.Common.IsEmpty(h)||(f=h)),!n.Common.IsEmpty(f)){c=this.getMergedColIndexByDataColIndex(t);l={message:f,Message:f,CellValue:a,ColumnIndex:c};throw l;}return i},i.prototype.getListDataCount=function(){return this._listData.getRowCount()},i.prototype.getNewRowData=function(t){var u=[],f=this.listviewData.getColIndexOfColumnOfDetailTable(),r,i;return f!==-1&&(this._masterValue===undefined&&(this._masterValue=this._getMasterValueForDetailTable()),r=new n.ListDataValue,r.value=this._masterValue,r.valueType=5,u[f]=r),i=new n.ListRowData,i.data=u,i.isInsertRow=t,this._setStaticValueToListRowDatas(i),i},i.prototype.getDuplicateRowData=function(t){var r=this._listData.getRowData(t),i=new n.ListRowData;return i.data=n.Common.clone(r.data),i.data.forEach(function(t){t&&t.valueType===2&&!n.Common.IsEmpty(t.bindingValue)&&(t.value=t.bindingValue,t.bindingValue=undefined,t.valueType=5)}),i.isInsertRow=!0,i},i.prototype._setStaticValueToListRowDatas=function(t){for(var u,r,f=this.listviewData.getColumnCount(),i=0;i<f;i++)(u=this.listviewData.getStaticValue(i),u!==null)&&(r=new n.ListDataValue,r.value=u,r.valueType=1,t.data[i]=r)},i.prototype.deleteRow=function(n,t){var i,r,u;if(n===undefined||n===null){if(i=this._listData.getSelectIndex(),i==undefined)return 0;n=i}return(r=this.getActualDataLength(),n<0||r<=0||n>=r)?0:(u=this._listData.getRowInfo(n),u&&t)?0:(this._maxRowCountOfLoadOnDemand--,this.hideDeleteButton(),this.deleteCachedRowDataByRowIndex(n),this._listData.deleteRow(n),this.updateSelectedRowAfterDeleteRow(n,!0),this.updateCachedRowAfterDeleteRow(n),this.refreshUI(),1)},i.prototype.deleteRowInDataModel=function(n){n>=0&&n<this._listData.getRowCount()&&(this._listData.deleteRow(n),this.updateSelectedRowAfterDeleteRow(n,!1),this._maxRowCountOfLoadOnDemand--)},i.prototype.updateSelectedRowAfterDeleteRow=function(n,t){var i=this._listData.getSelectIndex(),r;if(this._listData.select(),r=this._listData.getRowCount()+(this.allowAddRow()?1:0),r>0){i>n&&(i=i-1);i=Math.min(r-1,Math.max(0,i));t&&this.allowAddRow()&&r>1&&i===r-1&&(i=r-2);this.onCurrentRowChanged(i)}},i.prototype.handleAfterUpdateDataChange=function(t,r,u){var a,e,s,h,o,l,c,f;if(this._commitingRows.indexOf(t)!==-1){if(u.Success){if(r==="delete")this.deleteRow(t,!1);else if(e=u.RowData,e){for(this.getRowVersionColumnNameInServerData()&&(s=void 0,e&&e.RowVersionInfo&&e.RowVersionInfo.RowVersion&&(s=e.RowVersionInfo.RowVersion),this._listData.setRowVersion(t,s)),h=e.Values,o=0;o<h.length;o++)for(l=h[o],c=this.listviewData.getColumnCount(),f=0;f<c;f++)this.listviewData.columnDataInfos[f].bindingInfoIndex===o&&this._listData.setValue(t,f,l,2);this._listData.setRowQuery(t,u.JustInsertedRowInfo.query?u.JustInsertedRowInfo.query:null);t===this.getSelectedRowIndex()&&n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfo(this.getRowInfo(),!0)}else if(r==="edit")for(c=this.listviewData.getColumnCount(),f=0;f<c;f++)this.listviewData.columnDataInfos[f].bindingInfoIndex!==-1&&this._listData.setValue(t,f,this._listData.getValue(t,f),2);else if(r==="add")return;if(r==="add"&&this.getSelectedRowIndex()===this.getActualDataLength()&&(a=i.getDetailListviews(this.getDataTableName()),a))for(o=0;o<a.length;o++)a[o].clearData()}else if(u.Message&&alert(u.Message),u.ConcurrentError){if(e=u.RowData,e)for(this.getRowVersionColumnNameInServerData()&&(s=void 0,e&&e.RowVersionInfo&&e.RowVersionInfo.RowVersion&&(s=e.RowVersionInfo.RowVersion),this._listData.setRowVersion(t,s)),h=e.Values,o=0;o<h.length;o++)for(l=h[o],c=this.listviewData.getColumnCount(),f=0;f<c;f++)this.listviewData.columnDataInfos[f].bindingInfoIndex===o&&this._listData.setValue(t,f,l,2)}else r==="edit"?this.rollbackBindingValue(t):r==="add"&&this.deleteRowInDataModel(t);this.removeFromCommitingRow(t)}},i.prototype.removeFromCommitingRow=function(n){var t=this._commitingRows.indexOf(n);t>=0&&this._commitingRows.splice(t,1)},i.prototype.pushToCommitingRow=function(n){var t=this._commitingRows.indexOf(n);t===-1&&this._commitingRows.push(n)},i.prototype.hasCommitingRow=function(){return this._commitingRows.length>0},i.prototype.refreshOtherListViewsBindingToSameTable=function(){var u=i.getAllListviews(),r=this,t=r.getDataTableName();u.forEach(function(n,i,u){n!=r&&n.getDataTableName()==t&&n.fillData()});n.NormalCellBindingManager.updateTableDataCacheForCombo(t,!0);n.clearGetTableDataByConditionCache();n.NormalCellBindingManager.reloadItemsCellType(t,!1,!0);n.CustomFunction.ODataFunction.clearCache(t)},i.prototype.onSelectionChanged=function(n){n===void 0&&(n=!0)},i.prototype.onCurrentRowChanged=function(t,i){var u,f,e,r;if((i===void 0&&(i=!0),u=this._listData.getSelectIndex(),t===undefined||t!==u)&&(f=this.commitEditChange(),f!=="cancel")){if(this._listData.select(t),this.isGroupMode()){this.triggerSelectionChangedEvent(u,t);return}e=this.getActualDataLength();t!==undefined&&(t<e?this._showDeleteButton():this.hideDeleteButton());t!==undefined&&i&&(r=this.getRowInfo(),r&&r.currentTable&&r.query?n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfo(r,!0):this.clearCurrentRow());this.onSelectionChanged(!1);this.triggerSelectionChangedEvent(u,t)}},i.prototype.triggerSelectionChangedEvent=function(t,i){this.trigger(n.Events.SelectionChanged,{oldSelectedRowIndex:t===undefined?-1:t,newSelectedRowIndex:i===undefined?-1:i})},i.prototype.getRowVersionColumnNameInServerData=function(){return"C"+this.listviewData.columnBindingInfos.length},i.prototype.needCommit=function(n,t){if(!this.getDataTableName()||(typeof n=="undefined"&&(n=this._listData.getSelectIndex()),n===undefined||this._commitingRows.indexOf(n)>=0))return!1;var i=this.getActualDataLength();return n<0||i<=0||n>=i?!1:t||this._listData.isDirty(n,-1)||this.GetDataCommitMode()!==0&&this.deletedRowQuerys.length>0||this.isDetailTableEdited()},i.prototype.deleteRowByJavascriptAPI=function(n){var t=this._listData.getRowInfo(n),i=t?t.query:null;i&&this.deletedRowQuerys.push(i);this.deleteRow(n,!1)},i.prototype.updateDataChange=function(t,i){var h=this,r,u,f;if(t==undefined)return 1;if(r=this._listData.getRowInfo(t),this.needCommit(t,i)){if(u=r?r.query:null,n.Common.IsEmpty(u)&&i)return this.deleteRow(t,!0),1;if(this.GetDataCommitMode()!==0)return i&&(this.deleteRow(t,!1),u&&this.deletedRowQuerys.push(u)),1;var e=this.isMasterTable(),o={ActualShowConfirm:i?!0:!1,currentTable:this.getDataTableName(),query:u,rowIndex:t,UpdateType:i?"delete":r?"edit":"add",rowVersion:r?r.rowVersion:null,columnBindingInfos:this.listviewData.columnBindingInfos,viewName:e?null:this.getFullListviewName(),masterQuery:e?null:this.getMasterQuery(),ConfirmText:i?n.RS.ConfirmDelete:null},s=new n.UpdateDataTableCommand;return s.CommandParam=o,f=s.UpdateDataTableCommand(o,this,function(){n.ListViewHelper.RequestHelper.queryTotalRowValues(h)}),f===1&&this.pushToCommitingRow(t),f}return 1},i.prototype.commitEditChange=function(t){var r,i,e,o,f,s,u,h;if((t===void 0&&(t=!1),this.isGroupMode())||(r=this._listData.getSelectIndex(),r===undefined||r===-1)||t==!1&&!this.listviewData.canEdit()||this._commitingRows.indexOf(r)!==-1||(i=r,e=this._listData.getRowCount(),i>=e))return 1;if(o=this.validateRow(i),!o)return"cancel";for(f=!1,s=this.listviewData.getColumnCount(),u=0;u<s;u++)if((h=this.listviewData.getBindingInfo(u),!n.Common.cannotEditedBindingInfo(h))&&this._listData.isDirty(i,u)){f=!0;break}return!f&&!this.isDetailTableEdited()?1:this.commitChangeRealTime(i,this._listData.getRowInfo(i)?"edit":"add")?this.updateDataChange(i,!1):1},i.prototype.checkCalcError=function(t){var u=this.listviewData.visibleColumns,i,f,r,e;if(!u)return-1;for(i=u.length-1;i>=0;i--)if((f=u[i],r=f.getBindingInfo(),r&&!r.RelationBinding)&&(e=this._listData.getValue(t,f.getColumnIndex()),e instanceof GC.Spread.CalcEngine.CalcError))return alert(n.Common.format(n.RS.InvalidValueErrorMessage,e.toString(),r.ColumnName,r.TableName)),i;return-1},i.prototype._validateRequired=function(t){var f=this.listviewData.visibleColumns,e,s,r,i,o,u,h;if(!f)return-1;for(e={},e[this.getCalcSheetName()]=t,s=f.length,r=0;r<s;r++)if(i=f[r],i.canEnterEditMode){if(i.cellType.constructor===n.CheckBoxCellType)continue;if(o=this._listData.getValue(t,i.getColumnIndex()),!n.Common.IsEmpty(o))continue;if(u=i.getTemplateCell(),!u||!u.DataValidation||u.DataValidation.IgnoreBlank)continue;if(h=n.ValidationMananger.validateDataValidation(u,o,this.runTimePageName,e),!n.Common.IsEmpty(h))return i.needValidateWhenShowEditor=!0,r}return-1},i.prototype._editAndValidateCellWithDelayRefresh=function(t,i,r){var u=this;r===void 0&&(r=null);this._waitValidateRows.indexOf(t)===-1&&this._waitValidateRows.push(t);n.DelayRefresh.NeedDelayRun?n.DelayRefresh.setTimeout(function(){!u.hasDestroyed()&&u.isInCurrentPage()&&u.editAndValidateCell(t,i,r)},100):this.editAndValidateCell(t,i,r)},i.prototype.editAndValidateCell=function(t,i,r){if(r===void 0&&(r=null),this._throwExceptionIfNotImplement)throw n.StaticValues.NeedImplementException;},i.prototype.getAllowEditedBindingInfo=function(t){var r=this.listviewData.columnBindingInfos,f=this.listviewData.columnDataInfos,i,u;return!f||!r?null:(i=f[t],i.bindingInfoIndex>=r.length||i.bindingInfoIndex<0)?null:(u=r[i.bindingInfoIndex],n.Common.cannotEditedBindingInfo(u))?null:u},i.prototype.buildEditedRowValue=function(n,t,i,r){var f,u,o,s;if(t===void 0&&(t=!1),i===void 0&&(i=!1),r===void 0&&(r=!1),f=this.listviewData.columnDataInfos,!f)return null;var e={},h=!1,c=f.length;for(u=0;u<c;u++)(o=this.getAllowEditedBindingInfo(u),o)&&(t||this._listData.isDirty(n,u))&&(h=!0,r?f[u].columnName&&(e[f[u].columnName]=this._listData.getValue(n,u)):e[o.ColumnName]=this._listData.getValue(n,u));if(h)return e;else{var l=i||this._listData.getRowInfo(n)===undefined,a=this._listData.getRowData(n),v=a.isInsertRow;return l&&!v&&(s=this._getFirstAllowEditedColumnName(),s)?(e[s]=null,e):null}},i.prototype._getFirstAllowEditedColumnName=function(){var t=this.listviewData.visibleColumns,n;if(!t)return null;for(n=0;n<t.length;n++)if(t[n].canEditInForguncy)return t[n].getBindingInfo().ColumnName;return null},i.prototype.isDetailTableEdited=function(){var i=n.ListviewBase.getDetailListviews(this.getDataTableName()),t;if(i)for(t=0;t<i.length;t++)if(i[t].hasEdited())return!0;return!1},i.prototype.hasEdited=function(){if(this.deletedRowQuerys.length>0)return!0;var n=this.buildDetailListviewValues(!1);return n?!0:!1},i.prototype._getMasterValueForDetailTable=function(){var r=this.listviewData.getColIndexOfColumnOfDetailTable(),u,t,i;if(r!==-1||!this.isMasterTable()){for(u=this._listData.getRowCount(),t=0;t<u;t++)if(!!this._listData.getRowQuery(t))return this._listData.getValue(t,r);return i=this._getMasterTable(),i?i.getCurrentRowValue(this.getColumnOfMasterTable()):n.ForguncyData.pageInfo.normalCellBindingManager.getBindingValue({TableName:this.getMasterDataTableName(),ColumnName:this.getColumnOfMasterTable()})}},i.prototype._getMasterTable=function(){var i,t;if(!this.isMasterTable())for(i=n.ListviewBase.getAllListviews(),t=0;t<i.length;t++)if(i[t].getDataTableName()===this.getMasterDataTableName())return i[t]},i.prototype.getCurrentRowValue=function(n){var i=this.listviewData.getColIndexByDataColumnName(n),t;return i===-1?null:(t=this._listData.getSelectIndex(),t===undefined)?null:this._listData.getValue(t,i)},i.prototype.buildDetailListviewValues=function(t,i,r){var f,o,s,l,u,e;if(r===void 0&&(r=!1),f={calcSheetName:this.getCalcSheetName(),TableName:this.getDataTableName(),EditValues:[],AddValues:[],ColumnOfMasterTable:this.getColumnOfMasterTable(),ColumnOfDetailTable:this.getColumnOfDetailTable(),DeletedValues:[]},o=i===n.UpdateType.add&&this.GetDataCommitMode()===1,!o)for(s=0;s<this.deletedRowQuerys.length;s++)f.DeletedValues.push({query:this.deletedRowQuerys[s]});for(l=this._listData.getRowCount(),u=0;u<l;u++)if(this._commitingRows.indexOf(u)===-1&&(this._listData.isDirty(u,-1)||o)){var a=null,v=null,c=null,h=null;if(o)c=f.AddValues,h=this.buildEditedRowValue(u,!0,!0,r);else{if(h=this.buildEditedRowValue(u,!1,!1,r),h===null)continue;e=this._listData.getRowInfo(u);a=e?e.query:null;v=e?e.rowVersion:null;c=e===undefined?f.AddValues:f.EditValues}t&&this.pushToCommitingRow(u);c.push({values:h,query:a,rowVersion:v,rowIndex:u})}return f.EditValues.length===0&&f.AddValues.length===0&&f.DeletedValues.length===0?null:f},i.prototype.getActualDataLength=function(){return this._listData.getRowCount()},i.prototype.getEditorRowCount=function(){return this._listData.getRowCount()+(this.allowAddRow()?1:0)},i.prototype.getSelectedRowIndex=function(){return this._listData.getSelectIndex()},i.prototype.getSelectedColIndex=function(){return-1},i.prototype.isEditing=function(){return!1},i.prototype.getEditingValue=function(){return null},i.prototype.getAllSelectedRowsOfData=function(){return[]},i.prototype.getAllSelectedRowsOfView=function(){return[]},i.prototype.getNewRowIndex=function(){throw Error("Need implements");},i.prototype.canEditInListview=function(){return this.listviewData.canEdit()||this.listviewData.canDelete()||this.listviewData.canAddRow()},i.prototype.allowEdit=function(){return this.listviewData.canEdit()},i.prototype.isGroupMode=function(){return this.listviewData.isGroupMode()},i.prototype.getColIndexOfNamedColumn=function(n,t){return this.listviewData.getColIndexByName(n,t)},i.prototype.getColIndexOfBindingColumn=function(n){return this.listviewData.getColIndexByBindingInfo(n)},i.prototype.getDataColIndexByMergedColIndex=function(n){return this.listviewData.getDataColIndex(n)},i.prototype.getMergedColIndexByDataColIndex=function(n){return this.listviewData.getMergedColIndex(n)},i.prototype.getMergedColumnInfos=function(){return this.listviewData.getMergedColumnInfos()},i.prototype.getRangeInfo=function(){return this.listviewData.getRangeInfo()},i.prototype.getContentRangeInfo=function(){return this.listviewData.getContentRangeInfo()},i.prototype.getColumnHeaderRangeInfo=function(){return this.listviewData.getColumnHeaderRangeInfo()},i.prototype.getCalcSheetName=function(){return this.listviewData.name},i.prototype.getListviewName=function(){return this.listviewData.getListviewName()},i.prototype.getFullListviewName=function(){return n.PageManager.getDesignerPageName(this.runTimePageName,!1)+this.getListviewName()},i.prototype.onCellClick=function(n,t){n!==undefined&&t!==undefined&&this._showDeleteButton()},i.prototype.refreshUI=function(n,t){n===void 0&&(n=-1);t===void 0&&(t=-1)},i.prototype.allowSortOrQuery=function(){return this.GetDataCommitMode()===0&&(this.isMasterTable()||this.getMasterQuery())?!0:this.containUncommitedValue()?!1:!0},i.prototype.containUncommitedValue=function(){return this.containUncommitedDeleteRows()?!0:this.canEditInListview()?this.containUncommitedEditOrAddValues()?!0:!1:!1},i.prototype.containUncommitedDeleteRows=function(){return this.deletedRowQuerys.length>0&&this.GetDataCommitMode()!==0},i.prototype.containUncommitedEditOrAddValues=function(){for(var t,i=this._listData.getRowCount(),r=this._listData.getColumnCount(),n=0;n<r;n++)if(this.listviewData.isDataColumnAllowEdit(n))for(t=0;t<i;t++)if(this._listData.isDirty(t,n))return!0;return!1},i.prototype.sortByColumn=function(t,i){var c=this.listviewData.getColumnOperation(),u,f,r,s,h,e,o,l;if(c===1||c===2){if(this.commitCurrentEdit()){if(this.commitEditChange()==="cancel")return}else return;if(!this.allowSortOrQuery()){alert(n.RS.ErrorInfo_Uncommited);return}if((u=this.listviewData.visibleColumns,u)&&(f=u[t],f.allowSort())){for(r=0;r<u.length;r++)s=this.listviewData.visibleColumns[r],h=null,t===r&&(h=n.Common.IsEmpty(i)?s.sortInfo===0?1:0:i),s.sortInfo=h;e=n.ForguncyData;o=this.getLocationString();e.pageInfo.sortInfoCache[o]||(e.pageInfo.sortInfoCache[o]={});l={ColumnBindingInfo:f.getBindingInfo(),Order:f.sortInfo};e.pageInfo.sortInfoCache[o].sortInfo=[l];this.isMasterTable()||this.getMasterQuery()?this.fillData():this.refreshUI()}}},i.prototype.isCommiting=function(n){return this._commitingRows.indexOf(n)!=-1},i.getDetailListviews=function(t){var r,u,i;if(typeof t=="undefined")return null;for(r=n.ListviewBase.getAllListviews(),u=[],i=0;i<r.length;i++)r[i].getMasterDataTableName()===t&&u.push(r[i]);return u.length===0?null:u},i.getAllListviews=function(t){return n.ForguncyData.pageInfo.pageElementManager.listviewCollection.getListviews(t)},i.getListviewsRelatedWithTable=function(t){for(var i,u=[],f=n.ListviewBase.getAllListviews(),r=0;r<f.length;r++)i=f[r],(i.getMasterDataTableName()===t||i.getDataTableName()===t)&&u.push(i);return u},i.getListviewByCalcSheetName=function(n){var t=i.getAllListviews().filter(function(t){return t.getCalcSheetName()===n});return t&&t.length>0?t[0]:null},i.getListviewByLocationString=function(t){var i=n.ListviewBase.getAllListviews().filter(function(n){return n.getLocationString()===t});return i&&i.length>0?i[0]:null},i.getListview=function(t,i){var r=n.ListviewBase.getAllListviews().filter(function(n){return n.getListviewName()===t&&n.runTimePageName===i});return r.length>=0?r[0]:null},i.lockListviewClick=function(){$(document.body).addClass("listview-click-lock")},i.getListviewClickLocked=function(){return $(document.body).hasClass("listview-click-lock")},i.init=function(){var t=this;$(document).on("click",function(r){var e,o,c,l,s,u,h,f,a;if(!t.getListviewClickLocked()){if(r.target){if(r.target.className==="deleteButton")return;if(e=$(r.target),o=e.attr("type"),(o==="checkbox"||o==="radio"||o==="file")&&(c=e.attr(n.StaticValues.isInListview),c))return;if(l=e.closest("[gcuielement='fgcDropDownWindow']"),l.length===1)return;if(s=e.closest(".gcim-calendar,.gcim-calendar__navigator_vertical"),s.length===1&&s.parents().last()[0].tagName!=="HTML")return}if(u=n.ListviewBase.getAllListviews(),u.length!==0)for(h=n.Common.getMousePosition(r||window.event),f=0;f<u.length;f++)a=u[f].getContainerDiv(),i.isPointInElement(h,a)?u[f].isDeleteButtonVisible()&&i.isPointInElement(h,u[f]._deleteButton)&&u[f].setIsFocused(!1):u[f].setIsFocused(!1)}})},i.isPointInElement=function(n,t){var i=t.offset(),r=t.width(),u=t.height();return n.y<i.top||n.y>i.top+u||n.x<i.left||n.x>i.left+r?!1:!0},i.onPageCreated=function(){$("#page_"+n.ForguncyData.pageInfo.pageID).on("focusin",i.OnPageFocusin)},i.onPageDestroyed=function(){$("#page_"+n.ForguncyData.pageInfo.pageID).off("focusin",i.OnPageFocusin)},i.OnPageFocusin=function(t){var i,u,f,r;if((!t.target||t.target.className!=="deleteButton")&&(i=n.ListviewBase.getAllListviews(),i.length!==0))for(u="",t.target&&(f=$(t.target).closest("[isListviewDiv='true']"),f.length===1&&(u="#"+f.attr("id"))),r=0;r<i.length;r++)i[r].setIsFocused("#"+i[r]._containerDivID===u)},i.prototype.setIsFocused=function(t){if(typeof t=="boolean"&&this.isFocused!==t&&(this.isFocused=t,!this.isFocused&&!this._haveTriggerOnLostFocusMethod)){this._haveTriggerOnLostFocusMethod=!0;var i=this;n.DelayRefresh.setTimeout(function(){i.hasDestroyed()||i.onLostFocus()})}},i.prototype.onLostFocus=function(){this.isFocused||(this.hideDeleteButton(),this.commitCurrentEdit()&&this.commitEditChange(),this._haveTriggerOnLostFocusMethod=!1)},i.prototype.validateRow=function(n){var t,r;return n===undefined?!0:(t=this._validateRequired(n),t!==-1)?(this._editAndValidateCellWithDelayRefresh(n,t),!1):(t=this.checkCalcError(n),t!==-1)?(this.selectInEditor(n,t),!1):(r=i.commitDetailListviewsEdit(this.getDataTableName()),!r)?!1:!0},i.validateAllListviewsData=function(){var t=n.ListviewBase.getAllListviews();return t?n.ListviewBase.isListviewsValidationPassed(t,!0):!0},i.commitDetailListviewsEdit=function(t,i){i===void 0&&(i=!1);var r,f=n.ListviewBase.getDetailListviews(t),u=(r=f)===null||r===void 0?void 0:r.filter(function(n){return n.getMasterDataTableName()===t});return u?n.ListviewBase.isListviewsValidationPassed(u,i):!0},i.isListviewsValidationPassed=function(n,t){for(var r,u,f=n.length,i=0;i<f;i++)if(r=n[i],u=r.isValidationPassed(),!u)return t&&r.scrollToView(),!1;return!0},i.prototype.isValidationPassed=function(){if(!this.commitCurrentEdit())return!1;var n=this.buildDetailListviewValues(!1);return n&&!this.validateCellValues(n)?!1:!0},i.prototype.scrollToView=function(){var t=this.getContainerDiv();t.length>0&&n.Common.scrollToElement(t,this.runTimePageName)},i.prototype.commitCurrentEdit=function(t){if(t===void 0&&(t=!1),this._throwExceptionIfNotImplement)throw n.StaticValues.NeedImplementException;return!0},i.prototype.tryCommitEdit=function(){return this.commitEditChange()==="cancel"?!1:this.commitCurrentEdit()?!0:!1},i.prototype.getListviewControl=function(){if(this._throwExceptionIfNotImplement)throw n.StaticValues.NeedImplementException;return null},i.prototype.destroy=function(){this._destroy();this._currentRowInfoChangedEventHandler&&n.ForguncyData.pageInfo.currentRowInfoCollection.unbind(n.Events.CurrentRowInfoChanged,this._currentRowInfoChangedEventHandler);this._pagingInfoChangedEventHandler&&n.ForguncyData.pageingInfoList.unbind(n.Events.PageingInfoChanged,this._pagingInfoChangedEventHandler);n.ForguncyData.pageInfo.dataModel.removeListData(this._listData);this._hasDestoryed=!0},i.prototype._destroy=function(){},i.prototype.hasDestroyed=function(){return this._hasDestoryed},i.prototype.GetDataCommitMode=function(){return this.listviewData.getDataCommitMode()},i.prototype.GetDataValidationTime=function(){return this.listviewData.getDataValidationTime()},i.prototype.getControl=function(){return null},i.prototype.validateCellValues=function(n){var t;if(n.EditValues)for(t=0;t<n.EditValues.length;t++){var i=n.EditValues[t].values,r=n.EditValues[t].rowIndex,u=this.validateRowValues(r,i,!0);if(!u)return!1}if(n.AddValues)for(t=0;t<n.AddValues.length;t++){var i=n.AddValues[t].values,r=n.AddValues[t].rowIndex,u=this.validateRowValues(r,i,!1);if(!u)return!1}return!0},i.prototype.validateRowValues=function(n,t,i){var o=this.listviewData.columnDataInfos,s,h,r,u,f,e,c;if(!o)return!0;for(s=Object.keys(t),h=o.length,r=0;r<h;r++)if(u=this.getAllowEditedBindingInfo(r),u){if(f=void 0,s.indexOf(u.ColumnName)>=0)f=t[u.ColumnName];else if(i)continue;else f=null;try{t[u.ColumnName]=this.validateValue(r,f,!1,n)}catch(l){if(e=this.getVisibleColumnIndexInListViewByDataIndex(r),e<0||!this.listviewData.visibleColumns[e].canEditInForguncy)continue;return this._listData.getSelectIndex()!==n&&(c=this.commitEditChange(),c==="cancel")?!1:(this._editAndValidateCellWithDelayRefresh(n,e,l),!1)}}return!0},i.prototype.updateMultiRows=function(t,i,r){var f=this,u=this.isMasterTable(),e={tableInfo:t,bindingInfos:this.listviewData.columnBindingInfos,viewName:u?null:this.getFullListviewName(),masterQuery:u?null:this.getMasterQuery()};n.HomeController.CommitEditedTable(e,function(t){i.apply(null,[t]);n.ListViewHelper.RequestHelper.queryTotalRowValues(f)},r)},i.prototype.isTextFormat=function(n){for(var i,t=0;t<this.listviewData.visibleColumns.length;t++)if(this.listviewData.visibleColumns[t].getColumnIndex()===n){if(i=this.listviewData.visibleColumns[t].getTemplateCell(),i)return i.StyleInfo.Formatter==="@";break}return!1},i.prototype.clearSelectionOutOfCurrentRow=function(){},i.prototype.addSelectedRow=function(n){},i.prototype.clearSelectedRow=function(n){},i.prototype.selectAllRows=function(){},i.prototype.clearAllSelectedRows=function(){},i.prototype.isSelectedRow=function(n){return!1},i.prototype.getSelectedRowsDataByAPI=function(){return[]},i.prototype.getSelectedRowsData=function(){return[]},i.prototype.clearSelectedRowByQuery=function(n){},i.prototype.selectRowsByValue=function(n,t){},i.prototype.getAlwaysReservedSelections=function(){return this.listviewData.getAlwaysReservedSelections()&&this.listviewData.isRowHeaderCheckBoxVisible()},i.prototype.getAlwaysInEditMode=function(){return this.listviewData.getAlwaysInEditMode()},i.prototype.bindingTableCanEdit=function(){return this.listviewData.bindingTableCanEdit()},i.prototype.getText=function(t,i){var u=this._listData.getValue(t,i),r;return n.Common.IsEmpty(u)?null:(r=this.listviewData.getColumnMetaData(i),r&&r.TemplateCell&&r.TemplateCell.Element&&r.TemplateCell.Element.StyleInfo&&r.TemplateCell.Element.StyleInfo.Formatter)?n.FormatHelper.format(r.TemplateCell.Element.StyleInfo.Formatter,u).text:u instanceof Date?n.FormatHelper.format(n.StaticFormatString.dateTimeDefaultFormattingString,u).text:u},i.prototype.getColumnHeaderText=function(t,i){var u=this.getHeaderCellIDSuffix(),r=this.getRangeInfo(),f=n.Common.getIdStr(t+r.Row,i+r.Column,u);return n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(f)},i.prototype._getPageStretchInfo=function(){return n.PageManager.getPageStretchInfo(this.runTimePageName)},i.prototype.getContainerDiv=function(){return $("#"+this._containerDivID)},i.prototype.getLocationString=function(){return n.Common.IsEmpty(this._locationString)&&(this._locationString=i.getLocationString(this.runTimePageName,this.getListviewName())),this._locationString},i.getLocationString=function(t,i){return n.PageManager.getLocationString(t)+i},i.prototype.getPagingInfo=function(){var i=this.getLocationString(),t;return n.ForguncyData.pageingInfoList.IsPageing(i)?(t=n.ForguncyData.pageingInfoList.GetInfo(i),{PageCount:t.getPageCount(),PageIndex:t.getCurrentPageIndex()-1,MaxRowCountOfOnePage:t.limit}):null},i.prototype.selectRowByQuery=function(t){for(var r=this._listData.getRowCount(),i=0;i<r;i++)if(n.Common.isQueryEqual(this._listData.getRowQuery(i),t))return this.selectRow(i),!0;return!1},i.prototype.focus=function(n){},i.prototype.getRowValue=function(n){return this._listData.getRowValue(n)},i.prototype.getColumnHeaderRowCount=function(){return this.listviewData.isColumnHeaderVisible()?this.listviewData.getColumnHeaderHeight().length:0},i.prototype.getExportColmnMetadatas=function(){var n=0;return this.listviewData.isRowHeaderVisible()&&n++,this.listviewData.isRowHeaderCheckBoxVisible()&&n++,this.listviewData.metadata.Columns.slice(n)},i.prototype.getColumnWidth=function(n){return 0},i._deleteButtonLength=16,i._deleteButtonRightSpace=5,i}(n.EventClassBase);n.ListviewBase=t;i=function(){function i(){this.listviews=[]}return i.prototype.addListview=function(i,r,u,f,e,o){n.Common.IsEmpty(i)&&(i=r.name);var s;return s=e&&r.visibleColumns.length>0?new n.SpreadJSView(i,r,u,f,e,o):new t(i,r,u,f,e,!1,o),this.listviews.push(s),s},i.prototype.getListviews=function(n){return n?this.listviews.filter(function(t){return n.indexOf(t.runTimePageName)>=0}):this.listviews},i.prototype.destroy=function(n){n===void 0&&(n=null);this.getListviews(n).forEach(function(n){return n.destroy()});n&&(this.listviews=this.listviews.filter(function(t){return n.indexOf(t.runTimePageName)===-1}))},i.prototype.onDefaultDataSetted=function(t){var i=this.getListviews(t).filter(function(t){return t instanceof n.SpreadJSView});i.forEach(function(n){return n.initConditionFormatCalc()});i.forEach(function(n){return n.initConditionFormatFormula()})},i}();n.ListviewCollection=i;r=function(){function n(n,t,i){var r=this;this._finishedCallBack=t;this._stopWhenHaveError=i;this._actions=[];this._errorInfos=[];this._finishedActionCount=0;this._actions=n.map(function(n){return r.getActionWrapper(n)})}return n.prototype.getActionWrapper=function(n){var t=this;return function(){if(t.shouldDoAction()){var i=n();i&&(t._errorInfos.push(i),t._stopWhenHaveError&&t._finishedCallBack(t._errorInfos))}t._finishedActionCount++;t.shouldCallBack()&&t._finishedCallBack(t._errorInfos)}},n.prototype.shouldDoAction=function(){return this._finishedActionCount>=this._actions.length?!1:this._errorInfos.length>0&&this._stopWhenHaveError?!1:!0},n.prototype.shouldCallBack=function(){return this._finishedActionCount<this._actions.length?!1:this._stopWhenHaveError&&this._errorInfos.length>0?!1:!0},n.prototype.execute=function(){var i=this,n,t;this._actions.length===0&&this._finishedCallBack(this._errorInfos);!!window.ActiveXObject||"ActiveXObject"in window?(n=0,t=function(){setTimeout(function(){var u,r;(r=(u=i._actions)[n])===null||r===void 0?void 0:r.call(u);n<i._actions.length&&(n++,t())},0)},t()):this._actions.forEach(function(n){setTimeout(n,0)})},n}();u=function(){function t(n){this._listview=n;this._dataModel=n.getListDataModel()}return t.prototype.importDataWithText=function(n,t,i,u,f,e){var o=this,s=this.getValidateActions(n,u),h=function(r){r&&r.length!==0?e({Success:!1,ErrorInfos:r}):o.importData(n,t,i,u,e)};new r(s,h,f).execute()},t.prototype.getValidateActions=function(t,i){for(var u=this,f=[],e=function(r){f.push(function(){try{i.forEach(function(n){t[r][n]=u._listview.validateValue(n,t[r][n],!0)})}catch(e){if(u._listview.GetDataValidationTime()===0){var f=e;return f.RowIndex=r,{ErrorType:n.ImportError.ValidateError,ErrorData:f}}}})},r=0;r<t.length;r++)e(r);return f},t.prototype.importData=function(t,i,r,u,f){var o,e;try{e=this.getImportDataInfo(t,i,r);this.onlyAddRows(e)?this.addData(t,u,e):this.replaceData(t,u,e);this._listview._maxRowCountOfLoadOnDemand+=this.getDifferenceRowCount(e);n.Common.IsEmpty(this._dataModel.getSelectIndex())&&this._listview.selectRow(0);o={Success:!0}}catch(s){o={Success:!1,ErrorInfos:[s]}}f(o)},t.prototype.getDifferenceRowCount=function(n){var t=0;return n.addRowIndexes&&(t+=n.addRowIndexes.length),n.deleteRowIndexesInListView&&(t-=n.deleteRowIndexesInListView.length),t},t.prototype.addData=function(n,t,i){var r=[];this.updateData(r,n,t,i);this._dataModel.addData(r,5)},t.prototype.replaceData=function(n,t,i){var r=this._dataModel.getData();this.updateData(r,n,t,i);this._dataModel.setData(r)},t.prototype.updateData=function(n,t,i,r){var u=this;r.editRowIndexes&&r.editRowIndexes.forEach(function(f,e){var o=t[f],s=r.editRowIndexesInListView[e],h=n[s];i.forEach(function(n){u.changeValue(o[n],n,h)})});r.deleteRowIndexesInListView&&r.deleteRowIndexesInListView.sort(function(n,t){return t-n}).forEach(function(t){n.splice(t,1).forEach(function(n){var t;((t=n.rowInfo)===null||t===void 0?void 0:t.query)&&u._listview.deletedRowQuerys.push(n.rowInfo.query)})});r.addRowIndexes&&r.addRowIndexes.forEach(function(r){var f=u._listview.getNewRowData();i.forEach(function(n){u.changeValue(t[r][n],n,f)});n.push(f)})},t.prototype.changeValue=function(t,i,r){var u=r.data[i];n.Common.IsEmpty(u)&&(u=new n.ListDataValue,u.bindingValue=null);u.value=t;u.valueType=5;r.data[i]=u},t.prototype.onlyAddRows=function(n){return n.editRowIndexes&&n.editRowIndexes.length>0?!1:n.deleteRowIndexesInListView&&n.deleteRowIndexesInListView.length>0?!1:!0},t.prototype.getImportDataInfo=function(t,i,r){switch(i){case n.ImportMode.Merge:return this.getImportDataInfoInMergeMode(t,r);case n.ImportMode.Replace:return this.getImportDataInfoInReplaceMode(t,r);case n.ImportMode.MergeIgnoreEdit:return this.getImportDataInfoInMergeIgnoreEditMode(t,r);case n.ImportMode.ReplaceIgnoreEdit:return this.getImportDataInfoInReplaceIgnoreEditMode(t,r);default:return this.getImportDataInfoInAddMode(t)}},t.prototype.getImportDataInfoInAddMode=function(n){return{addRowIndexes:n.map(function(n,t){return t})}},t.prototype.getImportDataInfoInMergeMode=function(t,i){var r=this.getPrimaryKeysFromData(t,i);if(this.isThereSameKey(r))throw{ErrorType:n.ImportError.ExistSameKeys};var u=this.getPrimaryKeysFromListview(i),f=[],e=[],o=[];return r.forEach(function(n,t){for(var r=[],i=u.indexOf(n);i!==-1;)r.push(i),i=u.indexOf(n,i+1);r.length===0?f.push(t):r.forEach(function(n){e.push(t);o.push(n)})}),{addRowIndexes:f,editRowIndexes:e,editRowIndexesInListView:o}},t.prototype.getPrimaryKeysFromData=function(n,t){var i=n.map(function(n){return t.map(function(t){return n[t]})});return this.getPrimaryKeyStrs(i)},t.prototype.getPrimaryKeysFromListview=function(n){for(var r=this,u=this._dataModel.getRowCount(),i=[],f=function(t){var u=n.map(function(n){return r._dataModel.getValue(t,n)});i.push(u)},t=0;t<u;t++)f(t);return this.getPrimaryKeyStrs(i)},t.prototype.getPrimaryKeyStrs=function(t){return t.map(function(t){var i=t.map(function(t){return n.Common.IsEmpty(t)&&(t=null),t&&(t=t+""),t});return JSON.stringify(i)})},t.prototype.isThereSameKey=function(t){var i=n.Common.clone(t).sort();return i.some(function(n,t,i){return n===i[t+1]})},t.prototype.getImportDataInfoInReplaceMode=function(n,t){var r=this.getImportDataInfoInMergeMode(n,t),u,i;for(r.deleteRowIndexesInListView=[],u=this._dataModel.getRowCount(),i=0;i<u;i++)r.editRowIndexesInListView.indexOf(i)===-1&&r.deleteRowIndexesInListView.push(i);return r},t.prototype.getImportDataInfoInReplaceIgnoreEditMode=function(n,t){var i=this.getImportDataInfoInReplaceMode(n,t);return i.editRowIndexes=[],i.editRowIndexesInListView=[],i},t.prototype.getImportDataInfoInMergeIgnoreEditMode=function(n,t){var i=this.getImportDataInfoInMergeMode(n,t);return i.editRowIndexes=[],i.editRowIndexesInListView=[],i},t}();n.ListviewDataImportHelper=u;f=function(){function t(n){this._listview=n}return t.prototype.showOrHideColumns=function(t,i){var r,f,u,e;if(this.containRowHeaderColumns(t))throw n.RS.HideShowColumns_CannotHideRowHeader;if(!this._listview.tryCommitEdit())throw n.RS.HideShowColumns_ListviewIsEditing;if(r=this._listview.listviewData.metadata,n.ListviewMetadataHelper.resolve(r),f=r.Columns.filter(function(n){return t.indexOf(n.Index)>=0}),this.willShowHiddenColumn(f,i))throw n.RS.HideShowColumns_CannotShowHiddenColumn;(u=!1,f.forEach(function(n){i?n.Width>0&&(u=!0,n.Width=0):n.Width===0&&(u=!0,n.Width=n.OriginalWidth)}),u)&&(e=new n.ListviewData(r,this._listview.runTimePageName,this._listview.listviewData.uniqueIndex),this._listview.resetListviewDataForColumnOptionsCommand(e))},t.prototype.containRowHeaderColumns=function(n){var t=-1,i;return(this._listview.listviewData.isRowHeaderVisible()&&t++,this._listview.listviewData.isRowHeaderCheckBoxVisible()&&t++,t===-1)?!1:(i=this._listview.listviewData.metadata.Columns[t].Index,n.some(function(n){return n<=i}))},t.prototype.willShowHiddenColumn=function(n,t){return t?!1:n.some(function(n){return n.OriginalWidth===0})},t}();n.ListivewColumnManager=f}(Forguncy||(Forguncy={})),function(n){var t;(function(t){var i=function(){function t(){}return t.autoMerge=function(i,r,u,f,e,o){var c,v,l,a,s,y,h;if(u===void 0&&(u=-1),f===void 0&&(f=-1),e===void 0&&(e=0),o===void 0&&(o=-1),!n.Common.IsEmpty(r)&&!(r.length<=0))for(c=t.getOriginalSpanInfos(i,r,u,f,e,o),t.clearOldSpans(i,c,u,f),v=i.getColumnCount(),l=[],s=0;s<v;s++)if(a=n.Common.IsEmpty(c[s])?l:[c[s]],l=[],r.indexOf(s)!==-1)for(y=a.length,h=0;h<y;h++)t.setSpan(i,a[h].row,s,a[h].span,l)},t.getOriginalSpanInfos=function(n,i,r,u,f,e){var l,c,o,s,h;for(f===void 0&&(f=0),e===void 0&&(e=-1),l=n.getColumnCount(),c=[],o=0;o<l;o++)t.isMergeAreaFirstColumn(i,o)&&(s=void 0,h=void 0,s=r===-1?f:t.getMergeAreaStartRow(n,r,o,f),h=u===-1?n.getRowCount():u+(r-s),e!==-1&&(h=Math.min(e,n.getRowCount())),c[o]={row:s,span:h});return c},t.isMergeAreaFirstColumn=function(n,t){return n.indexOf(t)!==-1&&n.indexOf(t-1)===-1},t.getMergeAreaStartRow=function(n,i,r,u){var e,f;for(u===void 0&&(u=0),e=n.getValue(i,r),f=i-1;f>=u;f--)if(!t.shouldAutoMerge(e,n.getValue(f,r)))return f+1;return u},t.clearOldSpans=function(n,i,r,u){var e=t.getOldSpans(n,i,r,u),f;if(e)for(f=0;f<e.length;f++)n.removeSpan(e[f].row,e[f].col)},t.getOldSpans=function(n,i,r,u){var f,o,e;if(r===-1||u===-1)return n.getSpans(new GC.Spread.Sheets.Range(-1,-1,-1,-1));for(f=[],o=t.getCrossArea(n,i,r,u),e=0;e<o.length;e++)f=f.concat(n.getSpans(o[e]));return f},t.getCrossArea=function(t,i,r,u){for(var e,o,l,s,h=[],c=t.getColumnCount(),f=0;f<c;f++)if(!n.Common.IsEmpty(i[f])&&(e=i[f].row,o=r-e,!(o<=0))){for(l=f,s=1,f++;f<c;f++)if(n.Common.IsEmpty(i[f]))s++;else{f--;break}h.push(new GC.Spread.Sheets.Range(e,l,o,s))}return h},t.setSpan=function(n,i,r,u,f){for(var s,c,e,h,o=i;o<i+u;)for(s=o,c=n.getValue(s,r),e=o+1;;e++)if(e===i+u||!t.shouldAutoMerge(c,n.getValue(e,r))){h=e-s;h>1&&(n.addSpan(s,r,h,1),f.push({row:s,span:h}));o=e;break}},t.shouldAutoMerge=function(t,i){return n.Common.IsEmpty(t)&&n.Common.IsEmpty(i)?!1:(t instanceof Date&&i instanceof Date&&(t=n.Convertor.fromDateToOADate(t),i=n.Convertor.fromDateToOADate(i)),t===i)},t}();t.AutoMergeHelper=i})(t=n.ListViewHelper||(n.ListViewHelper={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(n){var t=function(){function n(n){var t;this._scrollSpeedIntervals=(t={},t[0]=150,t[1]=100,t[2]=50,t);this._rearchBottomCount=0;this.listview=n}return Object.defineProperty(n.prototype,"sheet",{get:function(){return this.listview.getSheet()},enumerable:!0,configurable:!0}),n.prototype.apply=function(){var n=this,i,t,r;this.listview.listviewData.getIsAutoScroll()&&(i=this.listview.listviewData.getAutoScrollSpeed(),t=this._scrollSpeedIntervals[i],t>0&&(r=setInterval(function(){n.listview.hasDestroyed()?clearInterval(r):n.listview.isInCurrentPage()&&!n.listview.isMouseInListView()&&n._scrollListView()},t),this.listview.forceHideVerticalScrollBar=!0))},n.prototype._scrollListView=function(){var r,u,n,t,i;if(this._rearchBottomCount<0){this._rearchBottomCount++;return}if(this.listview.getSpread().options.scrollByPixel=!0,r=this.listview.getListDataCount(),r>0)if(u=this.sheet.getViewportTopRow(1),n=this.sheet.getViewportBottomRow(1),n>=this.listview.lastDataRowIndexInView-1)try{t=this.sheet.getCellRect(n,this.sheet.getViewportLeftColumn(1));this.sheet.scroll(1,0);i=this.sheet.getCellRect(n,this.sheet.getViewportLeftColumn(1));t.y===i.y&&t.height===i.height&&(this._rearchBottomCount<10?this._rearchBottomCount++:(this._rearchBottomCount=-5,this.sheet.showRow(this.listview.firstDataRowIndexInView,GC.Spread.Sheets.VerticalPosition.top)))}catch(f){}else this.sheet.scroll(1,0),window.devicePixelRatio%1!=0&&this.sheet.repaint()},n}();n.AutoScrollHelper=t})(t=n.ListViewHelper||(n.ListViewHelper={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(n){var t=function(){function n(){}return n.isSelectAllRows=function(n){var i=n.getSelections(),e=[],c=0,t,r,u;if(i.length!==0&&n.getRowCount()!==0){for(t=0;t<i.length;t++){var f=i[t].row,o=i[t].rowCount,s=i[t].col,h=i[t].colCount;if(s===-1||h===-1){if(f===-1||o===-1)return!0;for(r=f;r<f+o;r++)e[r]=!0}}for(u=0;u<n.getRowCount();u++)if(!e[u])return!1;return!0}return!1},n.isRowSelected=function(n,t){var r=n.getSelections(),i;if(r.length!==0&&n.getRowCount()!==0)for(i=0;i<r.length;i++){var u=r[i].row,f=r[i].rowCount,e=r[i].col,o=r[i].colCount;if((e===-1||o===-1)&&(u===-1||f===-1||t>=u&&t<u+f))return!0}return!1},n.existingRowSelected=function(n){var i=n.getSelections(),t,r,u;if(i.length!==0&&n.getRowCount()!==0)for(t=0;t<i.length;t++)if(r=i[t].col,u=i[t].colCount,r===-1||u===-1)return!0;return!1},n.getOldSelection=function(n){for(var s,h,f,u,o,e,i=n.getSelections(),r=[],t=0;t<i.length;t++)if(s=i[t].col,h=i[t].colCount,s===-1||h===-1){if(i[t].row===-1){for(f=0;f<n.getRowCount();f++)jQuery.inArray(f,r)===-1&&r.push(f);break}if(u=i[t].row,o=i[t].row+i[t].rowCount-1,u===o)jQuery.inArray(u,r)===-1&&r.push(u);else if(u<o)for(e=u;e<=o;e++)jQuery.inArray(e,r)===-1&&r.push(e)}return r},n.mergeSelection=function(n,t,i){var r={},u,f,e,o;if(i&&n.indexOf(t)===-1?n.push(t):i||n.indexOf(t)===-1||n.splice(n.indexOf(t),1),n.length===0)return r;if(n.length===1)return r[n[0]]=1,r;for(n.sort(function(n,t){return n-t}),u=n[0],f=n[0],e=0;e<n.length;e++)e!==0&&(o=n[e],o===f+1?(++f,e===n.length-1&&(r[u]=f-u+1)):o>f+1&&(r[u]=f-u+1,u=o,f=o,e===n.length-1&&(r[u]=1)));return r},n.clearSelectedRow=function(t,i){var r=t.getSheet(),e,o,s,f,u;if(n.isRowSelected(r,i)){if(e=n.getOldSelection(r),r.suspendPaint(),o=r.getActiveRowIndex(),s=r.getActiveColumnIndex(),e.length===1)r.clearSelection(),i!=o?r.setActiveCell(i,s):r.setActiveCell(o,s),t.clearSelectionIfDisableAutoSelectRow();else{r.clearSelection();f=n.mergeSelection(e,i,!1);for(u in f)n.existingRowSelected(r)?r.addSelection(Number(u),-1,f[u],-1):r.setSelection(Number(u),-1,f[u],-1)}r.resumePaint()}},n.addRowSelection=function(t,i){var r=t.getSheet(),e=n.getOldSelection(r),u,f;r.suspendPaint();r.clearSelection();u=[];r.selectionPolicy()===GC.Spread.Sheets.SelectionPolicy.single?u[i]=1:u=n.mergeSelection(e,i,!0);for(f in u)n.existingRowSelected(r)?r.addSelection(Number(f),-1,u[f],-1):r.setSelection(Number(f),-1,u[f],-1);r.resumePaint()},n.addSelectedRow=function(t,i){var r=t.getSheet();n.isRowSelected(r,i)||(r.suspendPaint(),n.getOldSelection(r).length===0&&i!=r.getActiveRowIndex()&&r.setActiveCell(i,0),n.existingRowSelected(r)?n.addRowSelection(t,i):r.setSelection(i,-1,1,-1),r.resumePaint())},n.setSelectedRows=function(t,i){var r=t.getSheet();r.suspendPaint();i&&i.length!==0?i.forEach(function(n,t){t===0?(r.setActiveCell(i[0],0),r.setSelection(n,-1,1,-1)):r.addSelection(n,-1,1,-1)}):n.clearAllSelectedRows(t);r.resumePaint()},n.selectAllRows=function(n){var t=n.getSheet();t.selectionPolicy()!==GC.Spread.Sheets.SelectionPolicy.single&&(t.clearSelection(),t.addSelection(-1,-1,t.getRowCount(GC.Spread.Sheets.SheetArea.viewport),t.getColumnCount(GC.Spread.Sheets.SheetArea.viewport)))},n.clearAllSelectedRows=function(n){var t=n.getSheet();t.clearSelection();t.setActiveCell(0,0);n.clearSelectionIfDisableAutoSelectRow()},n}();n.SelectionHelper=t})(t=n.ListViewHelper||(n.ListViewHelper={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(t){var i=function(){function t(n){this.getCachedRowDataHandler=n;this.indexCache=new f;this.selectionsCache=new r}return t.prototype.getCachedRows=function(){return this.selectionsCache.items},t.prototype.save=function(n){var t=this;this.indexCache.update(n);this.indexCache.adds.forEach(function(n){t.selectionsCache.add(t.getCachedRowDataHandler(n))});this.indexCache.deletes.forEach(function(n){t.selectionsCache.remove(t.getCachedRowDataHandler(n))})},t.prototype.reset=function(n){this.indexCache.reset(n);this.selectionsCache.clearInvalid()},t.prototype.update=function(n){var t=this;n.forEach(function(n){var i=t.getCachedRowDataHandler(n),r=t.selectionsCache.findIndex(i);r>=0&&(t.selectionsCache.items[r]=i)})},t.prototype.delete=function(n){this.indexCache.remove(n);this.selectionsCache.remove(this.getCachedRowDataHandler(n))},t.prototype.clearByQuery=function(t,i){var r=new n.CachedRowData(t);this.selectionsCache.exists(r)&&(this.selectionsCache.remove(r),i())},t.prototype.clearAll=function(){this.indexCache.reset();this.selectionsCache.clear()},t.prototype.saveSelectionDatas=function(n){var t=this;n.forEach(function(n){t.selectionsCache.add(n)})},t.prototype.exists=function(n){return this.selectionsCache.exists(n)},t}();t.SelectionCacheManager=i;var r=function(){function n(){this.equality=new u;this.items=[]}return n.prototype.add=function(n){n&&!this.exists(n)&&this.items.push(n)},n.prototype.remove=function(n){var t=this.findIndex(n);t>=0&&this.items.splice(t,1)},n.prototype.clear=function(){this.items=[]},n.prototype.clearInvalid=function(){this.items=this.items.filter(function(n){return n.query})},n.prototype.exists=function(n){return this.findIndex(n)>=0},n.prototype.findIndex=function(n){if(n)for(var t=0;t<this.items.length;t++)if(this.equality.equals(this.items[t],n))return t;return-1},n}(),u=function(){function t(){}return t.prototype.equals=function(n,t){return this.isIndexEqual(n,t)||this.isQueryEqual(n,t)},t.prototype.isQueryEqual=function(t,i){return n.Common.isQueryEqual(t.query,i.query)},t.prototype.isIndexEqual=function(n,t){return n.index>=0&&t.index>=0&&n.index===t.index},t}(),f=function(){function n(){this.items=[];this.adds=[];this.deletes=[]}return n.prototype.reset=function(n){n===void 0&&(n=[]);this.items=n;this.adds=[];this.deletes=[]},n.prototype.update=function(n){this.adds=this.diff(n,this.items);this.deletes=this.diff(this.items,n);this.items=n},n.prototype.remove=function(n){for(var t=0;t<this.items.length;t++)if(this.items[t]===n){this.items.splice(t,1);return}},n.prototype.diff=function(n,t){var i=[];return n.forEach(function(n){t.indexOf(n)<0&&i.push(n)}),i},n}()})(t=n.ListViewHelper||(n.ListViewHelper={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(t){var i=function(){function t(){}return t.generateStlyeObject=function(i){var r=new GC.Spread.Sheets.Style;return i?(r.backColor=n.ColorHelper.Convert(i.Background),r.foreColor=n.ColorHelper.Convert(i.Foreground),r.hAlign=i.HorizontalAlignment,r.vAlign=i.VerticalAlignment,r.font=t.generateFontText(i),r.textDecoration=t.generateTextDecorationType(i),r.textIndent=t.generateTextIndent(i.TextIndent),r.wordWrap=i.WordWrap,r.formatter=i.Formatter,r.borderBottom=t.generateLineBorderObject(i.BorderBottom),r.borderRight=t.generateLineBorderObject(i.BorderRight),r.borderLeft=t.generateLineBorderObject(i.BorderLeft),r.borderTop=t.generateLineBorderObject(i.BorderTop),r):r},t.generateFontText=function(t){var i=[];return t.FontStyle===n.StaticValues.FontStyle_Italic&&i.push(n.DomUtilities.getFontStlyeText(t.FontStyle)),t.FontWeight===n.StaticValues.FontWeight_Bold&&i.push(n.DomUtilities.getFontWeightText(t.FontWeight)),t.FontSize>0&&i.push(t.FontSize+"px"),t.FontFamily?i.push('"'+t.FontFamily+'"'):i.push('"'+n.LocaleFonts.default+'"'),i.length>0?i.join(" "):null},t.generateTextIndent=function(n){return n>0?n/8:this.defaultTextIndent},t.generateTextDecorationType=function(n){var t=GC.Spread.Sheets.TextDecorationType.none;return n.Strikethrough&&(t|=GC.Spread.Sheets.TextDecorationType.lineThrough),n.Underline&&(t|=GC.Spread.Sheets.TextDecorationType.underline),t},t.generateLineBorderObject=function(t){return n.Common.IsEmpty(t)?undefined:new GC.Spread.Sheets.LineBorder(n.ColorHelper.Convert(t.Color),t.Style)},t.needShowScrollbar=function(n,i,r){var u=!t.canDisplayAllColumnsInViewport(n,i),f=!t.canDisplayAllRowsInViewport(n,r);return u&&!f?f=!t.canDisplayAllRowsInViewport(n,r-t.hScrollbarHeight):f&&!u&&(u=!t.canDisplayAllColumnsInViewport(n,i-t.vScrollbarWidth)),{showHScrollBar:u,showVScrollbar:f}},t.canDisplayAllRowsInViewport=function(n,t){for(var r=n.getRowCount(),i=0;i<r;i++)if(t-=n.getRowHeight(i),t<0)return!1;return!0},t.canDisplayAllColumnsInViewport=function(n,t){for(var r=n.getColumnCount(),i=0;i<r;i++)if(t-=n.getColumnWidth(i),t<0)return!1;return!0},t.vScrollbarWidth=22,t.hScrollbarHeight=28,t.defaultTextIndent=.125,t}();t.SpreadJSStyleHelper=i})(t=n.ListViewHelper||(n.ListViewHelper={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(t){var i=function(){function n(n,t,i,r){this.oldRowCount=n;this.oldSelections=t;this.oldActiveRowIndex=i;this.oldActiveColIndex=r;this.changedCells=[];this.handled=!1;this.needParseValue=!1;this._changedCellsCount=0}return n.prototype.addChangedCell=function(n,t,i){if(this.changedCells[t]){for(var r=0;r<this.changedCells[t].length;r++)if(this.changedCells[t][r].row===n)return}else this.changedCells[t]=[];this._changedCellsCount++;this.changedCells[t].push({row:n,value:i})},n.prototype.getChangedCellCount=function(){return this._changedCellsCount},n}(),r=function(){function t(n){this.listview=n}return Object.defineProperty(t.prototype,"_sheet",{get:function(){return this.listview.getSheet()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_listData",{get:function(){return this.listview.getListDataModel()},enumerable:!0,configurable:!0}),t.prototype.onRangeChanged=function(n){if(n.changedCells&&n.changedCells.length!==0){this.listview.operationTypeWhenValueChanged=1;for(var t=0;t<n.changedCells.length;t++)this.listview.onValueChanged(n.changedCells[t].row,n.changedCells[t].col);if(this.listview.operationTypeWhenValueChanged=0,n.action===GC.Spread.Sheets.RangeChangedAction.dragFill)this.onRangeChangeOperationCompleted(n.action,!1,!1)}},t.prototype.clearRangeChangedInfo=function(){this.rangeChangedInfo=null},t.prototype.onRangeChangeOperationBegin=function(n){this.rangeChangedInfo=new i(this._listData.getRowCount(),this._sheet.getSelections(),this._sheet.getActiveRowIndex(),this._sheet.getActiveColumnIndex());this.rangeChangedInfo.needParseValue=n===GC.Spread.Sheets.RangeChangedAction.paste?!this.isPasteInternal:!1},t.prototype.onRangeChangeOperationCompleted=function(t,i,r,u){if(r&&this.restoreColumnsOnRangeChangeOperationCompleted(),!this.rangeChangedInfo||this.rangeChangedInfo.handled||this.rangeChangedInfo.getChangedCellCount()===0){this.rollBackRangeChange();this.listview.setDataToSpreadJSNow();this.listview.onCurrentRowChanged(this.listview.getMappedEditorSelectedRowIndex());this.rangeChangedInfo.handled=!0;return}this.rangeChangedInfo.handled=!0;this.listview.setDataToSpreadJSNow();var e=this.validateRangeChangedCells(),f,o=this.isRangeChangedInCurrentRow();if(!o&&n.Common.IsEmpty(e)&&(f=this.listview.buildDetailListviewValues(!1),f&&(e=n.UpdateDataTableCommand.checkCalcErrorValue(null,null,[f]))),!n.Common.IsEmpty(e)&&this.listview.GetDataValidationTime()===0){this.showErrorMessageAndRollBackRangeChange(e);return}if(this.listview.triggerAPIValueChangedEvent(this._getRangeChangedCellRanges(),this._listData.getRowCount(),this.rangeChangedInfo.oldRowCount),!o){if(this.clearRangeChangedInfo(),this.listview.GetDataCommitMode()!==0){this.listview.onSelectionChanged();return}f&&this.updateOnRangeChanged(f);this.listview.onSelectionChanged()}},t.prototype._getRangeChangedCellRanges=function(){var t=this,n=[];return this.rangeChangedInfo.changedCells.forEach(function(i,r){i.forEach(function(i){n.push({Row:i.row,Column:t.listview.listviewData.getColIndexByVisibleColIndex(r),RowCount:1,ColumnCount:1})})}),n},t.prototype.restoreColumnsOnRangeChangeOperationCompleted=function(){for(var t=this._sheet.getColumnCount(),i=[],n=0;n<t;n++)i[n]=this._sheet.getColumnWidth(n);for(this.listview.initColumnsBindingInfo(),this.listview.resetColumnHeaderText(),n=0;n<t;n++)this._sheet.setColumnWidth(n,i[n]);this.listview.onColumnWidthOrColumnCountChanged()},t.prototype.isRangeChangedInCurrentRow=function(){for(var n,t,r=this.rangeChangedInfo.changedCells,i=0;i<r.length;i++)if(n=r[i],n)for(t=0;t<n.length;t++)if(n[t].row!==this.rangeChangedInfo.oldActiveRowIndex)return!1;return!0},t.prototype.getEditRowsInRangeChange=function(n){return n.EditValues?n.EditValues.map(function(n){return{rowIndex:n.rowIndex,updateType:"edit",query:n.query}}):[]},t.prototype.getAddRowsInRangeChange=function(n){return n.AddValues?n.AddValues.map(function(n){return{rowIndex:n.rowIndex,updateType:"add",query:null}}):[]},t.prototype.updateOnRangeChanged=function(t){var f=this,r=this.getEditRowsInRangeChange(t),u=this.getAddRowsInRangeChange(t),e=r.concat(u),i;e.some(function(n){return!f.listview.commitChangeRealTime(n.rowIndex,n.updateType)})||(e.forEach(function(n){return f.listview.pushToCommitingRow(n.rowIndex)}),this.listview.showLoadingIndicator(),i=this,this.listview.updateMultiRows(t,function(t){var o,e,f;if(!i.listview.hasDestroyed()){if(t.ReloadData){i.listview.fillData();return}i._sheet.suspendPaint();t.UpdatedRowResults&&t.UpdatedRowResults.length?(o=t.UpdatedRowResults,e=[],o.forEach(function(t){for(var f=!0,u=0;u<r.length;u++)if(t.JustInsertedRowInfo&&n.Common.isQueryEqual(r[u].query,t.JustInsertedRowInfo.query)){f=!1;i.listview.handleAfterUpdateDataChange(r[u].rowIndex,r[u].updateType,t);break}f&&e.push(t)}),e.forEach(function(n,t){return i.listview.handleAfterUpdateDataChange(u[t].rowIndex,u[t].updateType,n)})):(f=t,f.Message&&alert(f.Message),f.Success=!1,f.Message=null,f.ConcurrentError=!1,u.sort(function(n,t){return t.rowIndex-n.rowIndex}),r.concat(u).forEach(function(n){return i.listview.handleAfterUpdateDataChange(n.rowIndex,n.updateType,f)}));i._sheet.resumePaint();i.listview.refreshOtherListViewsBindingToSameTable();i.listview.hiddenLoadingIndicator()}},function(){alert(n.RS.Commit_FailMessage)}))},t.prototype.validateRangeChangedCells=function(){for(var f,r,t,u,e=this.listview.listviewData.visibleColumns,o=this.rangeChangedInfo.changedCells,s=this._listData.getRowCount(),i=0;i<e.length;i++)if(f=n.ListivewEditorHelper.getCell(e[i].getTemplateCell(),this.listview.runTimePageName),f){if(r=o[i],r)for(t=0;t<r.length;t++)if(!(r[t].row>=this.rangeChangedInfo.oldRowCount)&&(u=this.validateRangeChangedCell(r[t].row,i,f.cellType),!n.Common.IsEmpty(u)))return this.generateValidateErrorMessage(r[t].row,i,u);for(t=this.rangeChangedInfo.oldRowCount;t<s;t++)if(u=this.validateRangeChangedCell(t,i,f.cellType),!n.Common.IsEmpty(u))return this.generateValidateErrorMessage(t,i,u)}return null},t.prototype.validateRangeChangedCell=function(n,t,i){var u=this._sheet.getValue(n,t),r;return this.listview.allowShowTotalRow()&&n===this.listview.totalRowIndex?null:(r={},r[this.listview.getCalcSheetName()]=this.listview.mappedRowIndexFrowView(n),i.validateValue(u,r))},t.prototype.generateValidateErrorMessage=function(t,i,r){var e=this._sheet.getValue(t,i),o=n.FormatHelper.getTextFromValue(e),f="",u;return this._sheet.options.colHeaderVisible&&(f=this._sheet.getText(0,i,GC.Spread.Sheets.SheetArea.colHeader)),n.Common.IsEmpty(f)&&(f=i+1+""),u="",this._sheet.options.rowHeaderVisible&&(u=this._sheet.getText(t,0,GC.Spread.Sheets.SheetArea.rowHeader)),n.Common.IsEmpty(u)&&(u=this.listview.mappedRowIndexFrowView(t)+1+""),n.Common.format(n.RS.ValidateErrorMessage,o,u,f,r)},t.prototype.showErrorMessageAndRollBackRangeChange=function(t){var i=this,r;this.rollBackRangeChange();r=this;n.DelayRefresh.NeedDelayRun===!0?(this.listview.showLoadingIndicator(!1),n.DelayRefresh.setTimeout(function(){i.listview.hasDestroyed()||(i.showErrorMessageAndRepaint(t),i.listview.hiddenLoadingIndicator())},100)):r.showErrorMessageAndRepaint(t)},t.prototype.rollBackRangeChange=function(){var u,f,n,t,e,i,o,s,r;for(this.listview.operationTypeWhenValueChanged=1,u=this.rangeChangedInfo.changedCells,f=this.listview.listviewData.visibleColumns,n=0;n<f.length;n++)if((t=u[n],t)&&(e=this.listview.listviewData.getColIndexByVisibleColIndex(n),e!==-1))for(i=0;i<t.length;i++)t[i].row>=this.rangeChangedInfo.oldRowCount||(o=this.listview.mappedRowIndexFrowView(t[i].row),this.listview._onCellValueChanged(o,n,t[i].value));for(s=this._listData.getRowCount()-this.rangeChangedInfo.oldRowCount,r=0;r<s;r++)this.listview.deleteRowInDataModel(this.rangeChangedInfo.oldRowCount);this.listview.operationTypeWhenValueChanged=0},t.prototype.showErrorMessageAndRepaint=function(n){var i,t;for(alert(n),this._sheet.suspendPaint(),this.listview.setDataToSpreadJSNow(),i=this.rangeChangedInfo.oldSelections,t=0;t<i.length;t++)t===0?this._sheet.setSelection(i[t].row,i[t].col,i[t].rowCount,i[t].colCount):this._sheet.addSelection(i[t].row,i[t].col,i[t].rowCount,i[t].colCount);this._sheet.resumePaint()},t}();t.RangeChangedManager=r})(t=n.ListViewHelper||(n.ListViewHelper={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(t){var i=function(){function t(){}return t.queryTotalRowValues=function(t,i){var r=this,u,f;(i===void 0&&(i=null),t.isLoaded&&t.needQueryData())&&t.allowShowTotalRow()&&t.getTotalRowBindingInfosIgnoreNullValues().length!==0&&(u=this.createTotalRowRequestParameters(t,i),t.updateTotalRowDataVersion(),f=t.totalRowDataVersion,n.HomeController.GetTotalRowValues(u,function(n){if((n&&n.errorMessage&&alert(n.errorMessage),n)&&!t.hasDestroyed()){if(t.totalRowDataVersion!==f){r.hideLoadingIndicator(t);return}r.assignTotalRowValues(t,n.values);t.refreshUI()}},t.getCalcSheetName()))},t.queryDataFromServer=function(i,r,u,f,e,o){var h=this,l,s;if(u===void 0&&(u=null),f===void 0&&(f=!1),e===void 0&&(e=!1),i.isLoaded&&i.needQueryData()){i.showLoadingIndicator();var c=this.createRequestParameters(i,r,f,u),a=c.param,v=c.demandRowCount;i.updateDataVersion();l=i.dataVersion;s=i.listviewData.getIsAutoReload();n.HomeController.GetTableDataWithOffset(a,function(n){var r=!1;try{if(n&&n.errorMessage&&alert(n.errorMessage),i.hasDestroyed())return;if(r=!0,i.dataVersion!==l)return;t.FillServerListviewData(i,n,f,v,e);o&&o();$(window).trigger("ForguncyRowCountChanged")}finally{(r||s)&&h.hideLoadingIndicator(i)}},function(){s&&h.hideLoadingIndicator(i)},i.getCalcSheetName());this.refreshUserSelectorItemsInfo(i)}},t.queryListviewDatasByQuery=function(t,i,r,u){var h=this,o,f=this.createRequestParameters(t,!1,!1,null).param,e,s;if(f.columnFilterQueries=[{ColumnBindingInfo:i,Values:r}],f.totalRowBindingInfos=[],f.editorDataInfos=null,f.offsetCondition=new n.OffsetConditionInfo,f.offsetCondition.targetPage=1,f.offsetCondition.pageLimitRowCount=0,f.queryData=null,e=(o=f.rowInfo)===null||o===void 0?void 0:o.viewCondtionFormulaValues,e)for(s in e)e[s]=null;n.HomeController.GetTableDataWithOffset(f,function(i){var r,f,e=n.Common.IsEmpty((r=i)===null||r===void 0?void 0:r.errorMessage)?h.createListRowData(t,(f=i)===null||f===void 0?void 0:f.table):[];u&&u(e)},function(){u&&u([])},t.getCalcSheetName())},t.FillServerListviewData=function(n,t,i,r,u){n.deletedRowQuerys=[];t&&t.editor&&n.setEditorDataInfos(t.editor.$values,i);var f=t&&t.table,e=this.createListRowData(n,f),o=f?f.RowCount:0;f&&this.saveSortInfo(n,f.SortInfo);this.assignTotalRowValues(n,f&&f.TotalRowValues);this.addListRowDataToListview(n,r,e,o,u);n.beforeRefeshUIWhenQueryDataFromServer();this.refreshListview(r,n,e)},t.createRequestParameters=function(t,i,r,u){var e=t.getListDataCount(),f=0;i&&e<t.maxRowCountOfLoadOnDemand&&(f=t.listviewData.getLoadOnDemandCount());var s=f>0?e:0,h=this.getOffsetConditionInfo(t),o=n.ForguncyData.pageInfo.sortInfoCache[t.getLocationString()],c=o&&o.sortInfo;t.restoreColumnFilterQueries();var l=t.getColumnFilterQueries(),a=t.listviewData.getTotalRowBindingInfosIgnoreNullValues(),v=t.getRowInfo(),y=f>0?null:t.getEditorDataInfos(r),p=n.ForguncyData.pageInfo.commandQuerys[t.getDataTableName()],w=!t.isGroupMode()&&!n.Common.isBuiltInDataBaseView(t.getDataTableName()),b={columnBindingInfos:t.listviewData.columnBindingInfos,rowInfo:v,demandRowCount:f,currentDataLength:s,needRowVersion:w,queryData:p,sortCommandID:u,editorDataInfos:y,sortInfo:c,offsetCondition:h,columnFilterQueries:l,totalRowBindingInfos:a};return{param:b,demandRowCount:f}},t.createTotalRowRequestParameters=function(t,i){var r=n.ForguncyData.pageInfo.sortInfoCache[t.getLocationString()],s=r&&r.sortInfo;t.restoreColumnFilterQueries();var u=t.getColumnFilterQueries(),f=t.listviewData.getTotalRowBindingInfosIgnoreNullValues(),e=t.getRowInfo(),o=n.ForguncyData.pageInfo.commandQuerys[t.getDataTableName()];return{columnBindingInfos:t.listviewData.columnBindingInfos,rowInfo:e,queryData:o,columnFilterQueries:u,totalRowBindingInfos:f}},t.refreshUserSelectorItemsInfo=function(t){for(var r=t.getUserSelectorCellTypes(),i=0;i<r.length;i++)n.HomeController.SetUserSelectorItemsInfo(r[i],t.getCalcSheetName()+i.toString())},t.hideLoadingIndicator=function(t){n.DelayRefresh.Push(t,function(){t.hasDestroyed()||t.hiddenLoadingIndicator()},t.getCalcSheetName()+"hiddenLoadingIndicator")},t.refreshListview=function(n,t,i){var r;r=n===0?t.allowShowTotalRow()&&t.listviewData.getIsTotalRowAtFirstRow()?1:-1:t.mappedRowIndexFromData(t.getListDataCount()-i.length);t.refreshUI(r,n===0?-1:i.length)},t.addListRowDataToListview=function(n,t,i,r,u){n.operationTypeWhenValueChanged=2;t===0?(n._setInitData(i,r),u&&n.clearSelectionOutOfCurrentRow()):n.addData(i);n.operationTypeWhenValueChanged=0},t.createListRowData=function(n,t){var r,i;return t&&(i=t.Data,i&&(r=this.getListDataFromBindingValues(n,i))),r},t.assignTotalRowValues=function(t,i){if(t.listviewData.allowShowTotalRow()){var r=t.listviewData.getTotalRowSettingsIgnoreNullValues().filter(function(n){return n.BindingInfo!=null});r.forEach(function(t,r){t.Value=i&&!n.Common.IsEmpty(i[r])?i[r]:t.FormulaType===2?0:""})}},t.getListDataFromBindingValues=function(n,t){var r=[],u,i,f,e;if(!t)return r;for(u=t.length,i=0;i<u;i++)f=t[i],e=this.convertServerRowDataToListRowData(n,f),r.push(e);return r},t.convertServerRowDataToListRowData=function(t,i){var o=new n.ListRowData,s=new n.ListRowInfo,h,c,u,f,r,l,e;for(s.query=i.Query?JSON.parse(i.Query):null,s.rowVersion=this.getRowVersion(t,i),o.rowInfo=s,h=[],c=t.listviewData.getColumnCount(),u=0;u<c;u++){if(f=t.listviewData.columnDataInfos[u],r=new n.ListDataValue,f.bindingInfoIndex!==-1)l="C"+f.bindingInfoIndex,e=i[l],e===undefined&&(e=null),r.bindingValue=e,r.valueType=2;else if(f.staticValue!==null)r.value=f.staticValue,r.valueType=1;else continue;h[u]=r}return o.data=h,o},t.getRowVersion=function(n,t){var i=t[n.getRowVersionColumnNameInServerData()];return i&&i.$value?i.$value:i},t.getOffsetConditionInfo=function(t){var r=t.getLocationString(),i=new n.OffsetConditionInfo,u=n.ForguncyData.pageingInfoList.GetPageIndex(r),f=n.ForguncyData.pageingInfoList.GetLimit(r);return i.targetPage=u,i.pageLimitRowCount=f,i},t.saveSortInfo=function(t,i){var e,o,r,u,f;if((i=!i||i.length===0?null:i,e=t.getLocationString(),n.ForguncyData.pageInfo.sortInfoCache[e]||(n.ForguncyData.pageInfo.sortInfoCache[e]={}),n.ForguncyData.pageInfo.sortInfoCache[e].sortInfo=i,o=t.listviewData.getColumnOperation(),o===1||o===2)&&(r=t.listviewData.visibleColumns,r))for(u=0;u<r.length;u++)if(r[u].allowSort()&&(r[u].sortInfo=null,i))for(f=0;f<i.length;f++)if(n.Common.isBindingInfoEquals(i[f].ColumnBindingInfo,r[u].getBindingInfo())){r[u].sortInfo=i[f].Order;break}},t}();t.RequestHelper=i})(t=n.ListViewHelper||(n.ListViewHelper={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(t){var i=function(){function i(t){this._spreadJSView=t;this._pageStretchInfo=n.PageManager.getPageStretchInfo(t.runTimePageName)}return i.prototype.cacheWidth=function(){this._clearCachedWidth();var n=this._calcColumnsWidth(!0);this._originalColumnsWidth=n.widths.slice();this._originalSolidColumnsWidth=n.solidWidth;this._originalTotalColumnsWidth=n.totalWidth},i.prototype.stretch=function(){var n=this._spreadJSView.getSpread(),t;if(n){n.suspendPaint();this.redraw();this._updateInnerContainerWidth();this._updateInnerContainerHeight();t=this._getScrollStatus(this._originalTotalColumnsWidth,this._originalSolidColumnsWidth,this._getSolidRowsHeight(),!0);this._stretchColumns(t.availableWidth);this._stretchContainer(this._innerContainerWidth);this._spreadJSView.onStretch(t);n.resumePaint()}},i.prototype.getCurrntScrollbarVisibility=function(){var n=this._calcColumnsWidth(!1),i=this._calcCurrentSolidRowsHeight(),t=this._getScrollStatus(n.totalWidth,n.solidWidth,i,!1);return{showHScrollBar:t.showHScrollBar,showVScrollbar:t.showVScrollbar}},i.prototype.destroy=function(){this._clearCachedWidth();this._spreadJSView=null},i.prototype._canDisplayAllSolidColumns=function(n,t){return t=Math.ceil(t),t>=n},i.prototype._canDisplayAllRows=function(n,t){return t=Math.ceil(t),t>=n},i.prototype._getSolidRowsHeight=function(){var n=this._spreadJSView.getSheet(),t=n.getRowCount(),i=n.getRowHeight(0);return t*i+this._spreadJSView.getColHeaderHeight()},i.prototype._getEmptyColumnWidthAfterStretch=function(n,t,i){if(!i)return n;var r=t/this._originalTotalColumnsWidth;return n*r},i.prototype._getScrollStatus=function(n,i,r,u){var s=this._innerContainerWidth,f=!this._canDisplayAllSolidColumns(n,s),e=!this._canDisplayAllRows(r,this._innerContainerHeight),o;return this._spreadJSView.forceHideVerticalScrollBar&&(e=!1),this._spreadJSView.forceHideHorizontalScrollBar&&(f=!1),f&&!e?e=!this._canDisplayAllRows(r,this._innerContainerHeight-t.SpreadJSStyleHelper.hScrollbarHeight):e&&!f&&(o=this._getEmptyColumnWidthAfterStretch(n-i,s,u),o=Math.round(o),f=o<t.SpreadJSStyleHelper.vScrollbarWidth),{showHScrollBar:f,showVScrollbar:e,availableHeight:this._innerContainerHeight,availableWidth:s}},i.prototype._calcCurrentSolidRowsHeight=function(){for(var t=this._spreadJSView.getSheet(),r=t.getRowCount(),i=0,n=0;n<r;n++)i+=t.getRowHeight(n);return i+this._spreadJSView.getColHeaderHeight()},i.prototype._calcOriginalColumnsWidth=function(n,t){for(var e,o,f=n.visibleColumns,h=n.isRowHeaderCheckBoxVisible(),c=n.isRowHeaderVisible(),r=[],i=0,s=0,u=0;u<f.length;u++)r[u]=f[u].columnInfo.Width,i+=r[u];return h&&(e=n.rowHeaderCheckBoxColumnInfo.columnInfo.Width,r.unshift(e),i+=e),c&&(o=n.rowHeaderColumnInfo.columnInfo.Width,r.unshift(o),i+=o),s=i,f.length>0&&i<t&&(i=t,r.push(t-i)),{widths:r,totalWidth:i,solidWidth:s}},i.prototype._calcCurrentColumnsWidth=function(n,t){var u=this._spreadJSView.getSheet(),l=n.isRowHeaderCheckBoxVisible(),a=n.isRowHeaderVisible(),y=this._originalColumnsWidth.length,e=0,r=[],i=0,v=0,o,s,h,f,c;for(a&&l?(o=u.getColumnWidth(0,GC.Spread.Sheets.SheetArea.rowHeader),s=u.getColumnWidth(1,GC.Spread.Sheets.SheetArea.rowHeader),i+=o+s,e=2,r.unshift(o,s)):(a||l)&&(h=u.getColumnWidth(0,GC.Spread.Sheets.SheetArea.rowHeader),i+=h,r.unshift(h),e=1),f=0;f<y-e;f++)c=u.getColumnWidth(f,GC.Spread.Sheets.SheetArea.viewport),i+=c,r.push(c);return v=i,i<t&&(i=t,r.push(t-i)),{widths:r,totalWidth:i,solidWidth:v}},i.prototype._calcColumnsWidth=function(n){var t=this._spreadJSView.listviewData,i;return n?(i=this._spreadJSView.bounds.width+this._spreadJSView.rightMostBorderAdjustment,this._calcOriginalColumnsWidth(t,i)):this._calcCurrentColumnsWidth(t,this._innerContainerWidth)},i.prototype._stretchColumns=function(n){var c=this._spreadJSView.listviewData,h,i,f,t,a;if(!c.getAutoFitColumnWidth()){var e=0,o=this._spreadJSView.getSheet(),l=c.isRowHeaderCheckBoxVisible(),s=c.isRowHeaderVisible(),r=this._originalColumnsWidth.slice(),u=[];if(this._originalTotalColumnsWidth<=Math.ceil(n)){if(h=n/this._originalTotalColumnsWidth,s&&l)for(u=r.splice(0,2),i=0,f=u.length;i<f;i++)t=u[i]*h,t=Math.round(t),e+=t,o.setColumnWidth(i,t,GC.Spread.Sheets.SheetArea.rowHeader),i===0?this._spreadJSView.updateRowHeaderWidth(t):this._spreadJSView.updateRowHeaderCheckBoxWidth(t);else(s||l)&&(u=r.splice(0,1),t=u[0]*h,t=Math.round(t),e+=t,o.setColumnWidth(0,t,GC.Spread.Sheets.SheetArea.rowHeader),s?this._spreadJSView.updateRowHeaderWidth(t):this._spreadJSView.updateRowHeaderCheckBoxWidth(t));for(i=0,f=r.length;i<f;i++)t=r[i]*h,t=Math.round(t),e+=t,i===f-1&&(a=n-e,t+=a,t=Math.floor(t)),o.setColumnWidth(i,t)}else this._resetAllColmnsWidth(o,r,s,l)}},i.prototype._resetAllColmnsWidth=function(n,t,i,r){var f=[],u,e;if(i&&r)for(f=t.splice(0,2),u=0,e=f.length;u<e;u++)n.setColumnWidth(u,f[u],GC.Spread.Sheets.SheetArea.rowHeader);else(i||r)&&(f=t.splice(0,1),n.setColumnWidth(0,f[0],GC.Spread.Sheets.SheetArea.rowHeader));for(u=0,e=t.length;u<e;u++)n.setColumnWidth(u,t[u])},i.prototype._stretchContainer=function(n){this._spreadJSView.isFullWidth&&(n=Math.floor(n));$(this._spreadJSView.getContainer()).width(n)},i.prototype._clearCachedWidth=function(){this._originalTotalColumnsWidth=0;this._originalSolidColumnsWidth=0;this._originalColumnsWidth=[]},i.prototype._updateInnerContainerWidth=function(){var n=$(this._spreadJSView.getContainer()),t=n.parent().width(),i=this._spreadJSView.isRightMost;this._innerContainerWidth=i?t:t+this._spreadJSView.rightMostBorderAdjustment;i&&n.css("overflow-x","hidden")},i.prototype._updateInnerContainerHeight=function(){var n=$(this._spreadJSView.getContainer()).parent().height();this._innerContainerHeight=this._spreadJSView.isBottomMost?n:n+this._spreadJSView.bottomMostBorderAdjustment},i.prototype.redraw=function(){if(this._pageStretchInfo.StretchMode===4){var n=this._spreadJSView.getContainer();n.style.display="none";n.offsetHeight;n.style.display=""}},i}();t.StretchHelper=i})(t=n.ListViewHelper||(n.ListViewHelper={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(t){var i=function(){function i(){}return i.mockRequestRemote=function(){$.get=function(){return null};$.post=function(){return null};$.ajax=function(){return null}},i.createImage=function(r){var u,l,a,c,v,y,h;try{n.DelayRefresh.DisableDelayRun();i.mockRequestRemote();u=r;typeof r=="string"&&(u=JSON.parse(r));l=u.MetaData;a=n.MetadataHelper.createPageMetadata(l,!1);n.PageBuilder.createPage(a,null);var f=u.TableElement,p=f.Width,w=f.Height,s=$("#listview");s.css("width",p);s.css("height",w);var b=new n.ListviewData(f.Data,n.StaticValues.RunTimeNormalPage),k={top:f.Top,left:f.Left,width:f.Width,height:f.Height},d={ExtendWidth:f.ExtendWidth||0,ExtendHeight:f.ExtendHeight||0},e=n.ForguncyData.pageInfo.pageElementManager.listviewCollection.addListview("listview",b,"p",k,!0,d);return e.initSpread(s[0]),c=0,u.PreviewData&&(c=u.PreviewData.length),v={table:{Data:u.PreviewData,RowCount:c,TotalRowValues:u.TotalRowData},editor:{$values:u.Editors}},t.RequestHelper.FillServerListviewData(e,v,!1,100,!1),e.showHorizontalScrollBar(!1),e.showVerticalScrollBar(!1),y=$("canvas",s)[0].toDataURL(),e.destroy(),y}catch(o){return console.error(o),h="Error:"+o,o&&o.stack&&(h=h+"\r\n"+o.stack),h}},i}();t.PreviewHelper=i})(t=n.ListViewHelper||(n.ListViewHelper={}))}(Forguncy||(Forguncy={})),function(n){var i=function(){function n(){}return n}(),t;n.ListViewStyleTemplateUtils=i;t=function(){function n(){}return n}();n.ListViewStyleTemplate=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var t=function(t){function i(i,r,u,f,e,o){var s=t.call(this,i,r,u,f,e,!0,o)||this;return s._loadedOnDemandCriticalRowIndex=0,s._rangeChangedManager=new n.ListViewHelper.RangeChangedManager(s),s._isMouseIn=!1,s._colHeaderCellIDDic={},s._selectedRows=[],s.cacheManager=new n.ListViewHelper.SelectionCacheManager(function(n){return s.getCachedRowData(s.mappedRowIndexFrowView(n))}),s._cancelInput=!1,s._newRowIndex=-1,s.evenRowBackcolor=s.listviewData.getAlternativeBackcolor(!0),s.oddRowBackcolor=s.listviewData.getAlternativeBackcolor(!1),s.listViewStyleTemplate=s.listviewData.getListViewStyleTemplate(),s.initBorderAdjustment(),s.initStretchInfo(),new n.ListViewHelper.AutoScrollHelper(s).apply(),s}return __extends(i,t),i.prototype.isMouseInListView=function(){return this._isMouseIn},Object.defineProperty(i.prototype,"totalRowIndex",{get:function(){return this.listviewData.allowShowTotalRow()?this.listviewData.getIsTotalRowAtFirstRow()?0:this._sheet.getRowCount()-1:-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"firstDataRowIndexInView",{get:function(){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?1:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastDataRowIndexInView",{get:function(){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?this.getListDataCount():this.getListDataCount()-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"activeRowIndexInDataArea",{get:function(){if(this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow())this._sheet.getActiveRowIndex()-1;else return this._sheet.getActiveRowIndex()},enumerable:!0,configurable:!0}),i.prototype.mappedRowIndexFromData=function(n){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?n+1:n},i.prototype.mappedRowIndexFrowView=function(n){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?n-1:n},i.prototype.isNewLineRow=function(n){return n===this.lastDataRowIndexInView+1?!0:!1},i.prototype.getContainer=function(){return this._divContainer},i.prototype.getSheet=function(){return this._sheet},i.prototype.getSpread=function(){return this._spread},i.prototype.resetListviewDataForColumnOptionsCommand=function(n){t.prototype.resetListviewDataForColumnOptionsCommand.call(this,n);this.evenRowBackcolor=this.listviewData.getAlternativeBackcolor(!0);this.oddRowBackcolor=this.listviewData.getAlternativeBackcolor(!1);this.canStretch&&this._stretchHelper.cacheWidth();this.resetSpreadColumnSetting();this.onWindowResized();this.fillData(null,!1,!0)},i.prototype.getBorderAdjustedWidth=function(n){return Math.min(2,n)},i.prototype.useHeaderCellWhenAdjustColumnWidth=function(){return this.listviewData.isColumnHeaderVisible()},i.prototype.onLoad=function(){var r=this,n=this.getContainerDiv(),i;n.length>0&&(this.initSpread(n[0]),this.modifyInternalMethod(),this.bindSpreadEvent());n.on("mouseenter",function(){r._isMouseIn=!0});n.on("mouseleave",function(){r._isMouseIn=!1});i=this.listviewData.getTabIndex();i&&$(this.getGcSheetFocusElementForTab()).attr("tabindex",i);t.prototype.onLoad.call(this)},i.prototype.onWindowResized=function(){this.listviewData.visibleColumns.length>0&&this.canStretch&&this._stretchHelper.stretch()},i.prototype.updateRowHeaderWidth=function(n){this._rowHeaderWidth=n},i.prototype.updateRowHeaderCheckBoxWidth=function(n){this._rowHeaderCheckBoxWidth=n},i.prototype.modifyInternalMethod=function(){var t="";t="Command_CLIPBOARD_PASTE_execute";i.OriginalSpreadJSMethod[t]||(i.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Commands.clipboardPaste.execute,function(t){GC.Spread.Sheets.Commands.clipboardPaste.execute=function(r,u,f){if(i.isListviewWorkbook(r)){var e=n.ListviewBase.getListviewByCalcSheetName(r.name);e&&(e._rangeChangedManager.isPasteInternal=!!(u.fromSheet&&u.fromRanges));u.pasteOption=GC.Spread.Sheets.ClipboardPasteOptions.values}i.OriginalSpreadJSMethod[t].apply(this,arguments)}}(t));t="Command_EDIT_CELL_execute";i.OriginalSpreadJSMethod[t]||(i.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Commands.editCell.execute,function(t){GC.Spread.Sheets.Commands.editCell.execute=function(r,u,f){var e,o;i.isListviewWorkbook(r)&&(u.autoFormat=!1,r instanceof GC.Spread.Sheets.Workbook&&(e=r.getActiveSheet(),e&&(o=e.getCellType(u.row,u.col),o instanceof n.CheckBoxCellTypeListView&&(u.newValue=n.CheckBoxCellTypeListView.convertValue(u.newValue)))));i.OriginalSpreadJSMethod[t].apply(this,arguments)}}(t));t="GC.Spread.Sheets.Worksheet.prototype.moveTo";i.OriginalSpreadJSMethod[t]||(i.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Worksheet.prototype.moveTo,function(n){GC.Spread.Sheets.Worksheet.prototype.moveTo=function(t,r,u,f,e,o,s){s=GC.Spread.Sheets.CopyToOptions.value;i.OriginalSpreadJSMethod[n].apply(this,arguments)}}(t));t="Command_CLEAR_execute";i.OriginalSpreadJSMethod[t]||(i.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Commands.clear.execute,function(t){GC.Spread.Sheets.Commands.clear.execute=function(r,u,f){var e=i.isListviewWorkbook(r)?n.ListviewBase.getListviewByCalcSheetName(r.name):null;if(e&&!e._sheet.isEditing())e._rangeChangedManager.onRangeChangeOperationBegin(GC.Spread.Sheets.RangeChangedAction.clear);if(i.OriginalSpreadJSMethod[t].apply(this,arguments),e&&!e._sheet.isEditing())e._rangeChangedManager.onRangeChangeOperationCompleted(GC.Spread.Sheets.RangeChangedAction.clear,!1,!1)}}(t));t="Command_CANCEL_INPUT_execute";i.OriginalSpreadJSMethod[t]||(i.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Commands.cancelInput.execute,function(t){GC.Spread.Sheets.Commands.cancelInput.execute=function(r,u,f){var e=i.isListviewWorkbook(r)?n.ListviewBase.getListviewByCalcSheetName(r.name):null;e&&(e._cancelInput=!0);i.OriginalSpreadJSMethod[t].apply(this,arguments);e&&(e._cancelInput=!1)}}(t))},i.prototype.initSpread=function(t){this._divContainer=t=this._initDIVContainer(t);GC.Spread.Sheets.CellTypes.Corner=n.MutiCheckCornerCellType;this._spread=new GC.Spread.Sheets.Workbook(t,{sheetCount:1});this._spread.suspendPaint();this.intSpreadSettings(this._spread);this._sheet=this._spread.getActiveSheet();this.initSheetSettings(this._sheet);this.onColumnWidthOrColumnCountChanged();this.refreshUI();this.initFocusBehavior(t);this._spread.resumePaint()},i.prototype.getFormulaListRowInfo=function(){var n;return n={},n[this.getCalcSheetName()]=this.activeRowIndexInDataArea,n},i.prototype.initStretchInfo=function(){this.canHorizontallyStretch=!1;this.canVerticallyStretch=!1;var t=this._getPageStretchInfo();t&&(this.canHorizontallyStretch=n.Stretch.Common.canHorizontallyStretch(t.StretchMode),this.canVerticallyStretch=n.Stretch.Common.canVerticallyStretch(t.StretchMode),this.isRightMost=this.bounds.left+this.bounds.width===t.MainPartWidth,this.isBottomMost=this.bounds.top+this.bounds.height===t.MainPartHeight,this.isFullWidth=this.bounds.width===t.MainPartWidth,this.isFullHeight=this.bounds.height===t.MainPartHeight);this._stretchHelper=new n.ListViewHelper.StretchHelper(this);this._stretchHelper.cacheWidth()},Object.defineProperty(i.prototype,"canStretch",{get:function(){return this.canHorizontallyStretch||this.canVerticallyStretch},enumerable:!0,configurable:!0}),i.prototype.onStretch=function(n){this.refresh();this.hideDeleteButton();this.canVerticallyStretch&&this.updateLoadedOnDemandCriticalRowIndex();this.changeHorizontalBarVisible(n.showHScrollBar);this.changeVerticalBarVisible(n.showVScrollbar);this.refreshUI()},i.prototype.initBorderAdjustment=function(){var t=this.listviewData.showGridLine(),n=this.getLastVisibleColumn();n&&(this.rightMostBorderAdjustment=this.getBorderAdjustedWidth(n.getRightBorderWidth(this.useHeaderCellWhenAdjustColumnWidth(),t)),this.bottomMostBorderAdjustment=this.getBorderAdjustedWidth(n.getBottomBorderWidth(t)))},i.prototype.getLastVisibleColumn=function(){if(this.hasVisibleColumn){var n=this.listviewData.visibleColumns;return n[n.length-1]}return null},Object.defineProperty(i.prototype,"hasVisibleColumn",{get:function(){var n=this.listviewData.visibleColumns;return n&&n.length>0},enumerable:!0,configurable:!0}),i.prototype._adjustContainerOverflowMode=function(n){this.canHorizontallyStretch&&this.canVerticallyStretch&&this.isFullHeight&&this.isFullWidth&&(n.style.overflow="hidden")},i.prototype._generateSpreadDiv=function(){var n=$("<div class='spreadDiv'/>");return this._spreadWidth=this.canHorizontallyStretch?"calc(100% + "+this.rightMostBorderAdjustment+"px)":this.bounds.width+this.rightMostBorderAdjustment,this._spreadHeight=this.canVerticallyStretch?this.isBottomMost?"100%":"calc(100% + "+this.bottomMostBorderAdjustment+"px)":this.bounds.height+this.bottomMostBorderAdjustment,n.css("width",this._spreadWidth),this.canVerticallyStretch?n.css({height:this._spreadHeight,"font-size":0}):n.css("height",this._spreadHeight),n},i.prototype._initDIVContainer=function(n){if(this.hasVisibleColumn){var t=this._generateSpreadDiv();this._adjustContainerOverflowMode(n);n.appendChild(t[0]);n=t[0]}else this._spreadWidth=this.bounds.width,this._spreadHeight=this.bounds.height;return n},i.prototype.intSpreadSettings=function(n){n.name=this.getCalcSheetName();n.options.allowUserEditFormula=!1;n.options.scrollbarMaxAlign=!0;n.options.backColor="transparent";n.options.grayAreaBackColor=this.getGrayAreaBackColor();n.options.tabStripVisible=!1;n.options.allowUserDragDrop=this.listviewData.canUserDragDrop();n.options.allowUserDragFill=this.listviewData.canUserDragFill();n.options.showHorizontalScrollbar=!1;n.options.showVerticalScrollbar=!1;n.options.showDragFillSmartTag=!1;n.options.autoFitType=GC.Spread.Sheets.AutoFitType.cellWithHeader;n.options.hideSelection=this.listviewData.hideSelectionWhenLostFocus();n.options.defaultDragFillType=GC.Spread.Sheets.Fill.AutoFillType.fillWithoutFormatting;n.options.allowUserZoom=!1;n.options.allowExtendPasteRange=!0;n.options.copyPasteHeaderOptions=GC.Spread.Sheets.CopyPasteHeaderOptions.noHeaders;n.options.allowCopyPasteExcelStyle=!1;n.options.allowUndo=!1;this.initTouchToolStripItems();this.initSpreadContextMenu()},i.prototype.initSpreadContextMenu=function(){this.listviewData.isRowHeaderContextMenuVisible()?this._spread.contextMenu=new n.SpreadContextMenu(this,i.getCanvas(this.getCalcSheetName())):this._spread.options.allowContextMenu=!1},i.prototype.initSheetSettings=function(n){this._sheet.frozenColumnCount(this.listviewData.getFrozenIndex());this._sheet.frozenTrailingColumnCount(this.listviewData.getFrozenIndexEnd());this._sheet.options.frozenlineColor=this.listviewData.getFrozenLineColor();this._sheet.options.allowCellOverflow=!1;this._sheet.selectionUnit(this.getSelecionUnit());this._sheet.options.selectionBackColor=this.getSelectionBackColor();this._sheet.options.selectionBorderColor=this.getSelectionBorderColor();this._sheet.defaults.rowHeight=this.listviewData.getTemplateRowHeight();this._sheet.options.gridline.showHorizontalGridline=this.listviewData.showGridLine();this._sheet.options.gridline.showVerticalGridline=this.listviewData.showGridLine();this._sheet.options.clipBoardOptions=GC.Spread.Sheets.ClipboardPasteOptions.values;this._sheet.autoGenerateColumns=!1;this.listviewData.getIsSingleSelection()?this._sheet.selectionPolicy(GC.Spread.Sheets.SelectionPolicy.single):this.listviewData.getSelectionMode()==1&&!this.listviewData.canEdit()&&this.listviewData.isRowHeaderCheckBoxVisible()&&(this._sheet.isCtrlPressed=function(n){return n===GC.Spread.Sheets.SheetArea.rowHeader||n===GC.Spread.Sheets.SheetArea.viewport},this._sheet.deselectIgnoreSpan=function(){return!0});this._initSheetCommand();var t=this.listviewData.visibleColumns.length;this._sheet.setColumnCount(t);this._sheet.setRowCount(0);this.clearSelectionIfDisableAutoSelectRow();this.allowShowTotalRow()&&(this.listviewData.getIsTotalRowAtFirstRow()?this._sheet.frozenRowCount(1):this._sheet.frozenTrailingRowCount(1));this._initRowHeader();this._initColumnHeader();this.initColumnsBindingInfo();this.initColumnsStyle();this.setSheetTag()},i.prototype.getSelectionBackColor=function(){var t=this.listviewData.getSelectionBackColor();return!!t&&t!="rgba(20,20,20,0.2)"?t:this.listViewStyleTemplate&&this.listViewStyleTemplate.SelectBack?n.ColorHelper.Convert(this.listViewStyleTemplate.SelectBack):null},i.prototype.getSelectionBorderColor=function(){var t=this.listviewData.getSelectionBorderColor();return!!t&&t!="#217346"?t:this.listViewStyleTemplate&&this.listViewStyleTemplate.SelectBorder?n.ColorHelper.Convert(this.listViewStyleTemplate.SelectBorder):null},i.prototype.getGrayAreaBackColor=function(){var t=this.listviewData.getGrayAreaBackColor();return!!t&&t!="transparent"?t:this.listViewStyleTemplate&&this.listViewStyleTemplate.GrayAreaBack?n.ColorHelper.Convert(this.listViewStyleTemplate.GrayAreaBack):"transparent"},i.prototype.setSheetTag=function(){this._sheet.tag({ListviewCalcSheetName:this.getCalcSheetName(),ListViewStyleTemplate:this.listViewStyleTemplate})},i.isListviewWorkbook=function(n){var t,i,r,u=(i=(t=n)===null||t===void 0?void 0:t.getActiveSheet())===null||i===void 0?void 0:i.tag();return!!((r=u)===null||r===void 0?void 0:r.ListviewCalcSheetName)},i.prototype.resetSpreadColumnSetting=function(){this._spread.suspendPaint();this._sheet=this._spread.getActiveSheet();var n=this.listviewData.visibleColumns.length;this._sheet.setColumnCount(n);this._initColumnHeader();this.initColumnsBindingInfo();this.clearColumnHeaderSpans();this.initColumnsStyle();this.onColumnWidthOrColumnCountChanged();this.refreshUI();this._spread.resumePaint()},i.prototype._initColumnHeader=function(){var i=this,u=GC.Spread.Sheets.SheetArea.colHeader,r,f,t;if(this.listviewData.isColumnHeaderVisible()){for(r=this.listviewData.getColumnHeaderHeight(),f=r.length,this._sheet.setRowCount(f,u),this._colHeaderHeight=0,t=0;t<f;t++)this._colHeaderHeight+=r[t],this._sheet.setRowHeight(t,r[t],u),this._sheet.setRowResizable(t,!1,u);this._colHeaderCellIDDic=this._getcolHeaderCellIDDic();this._onNormalCellValueChangedEventHandler=function(t,r){i._colHeaderCellIDDic[r.id]&&n.DelayRefresh.Push(i,function(){i.hasDestroyed()||i.resetColumnHeaderText()},"repaintColHeader"+i.getCalcSheetName())};n.ForguncyData.pageInfo.dataModel.normalCellDataModel.bind(n.Events.ValueChanged,null,this._onNormalCellValueChangedEventHandler);this.resetColumnHeaderText()}else this._colHeaderHeight=0,this._sheet.options.colHeaderVisible=!1;this._sheet.options.colHeaderAutoText=GC.Spread.Sheets.HeaderAutoText.blank},i.prototype.getColHeaderHeight=function(){return this._colHeaderHeight},i.prototype._getcolHeaderCellIDDic=function(){var u={},r=this.listviewData.visibleColumns,t,i,e;if(!r||r.length<=0)return u;var f=this.getRangeInfo(),o=GC.Spread.Sheets.SheetArea.colHeader,s=this._sheet.getRowCount(o),h=this.getHeaderCellIDSuffix();for(t=0;t<s;t++)for(i=0;i<r.length;i++)e=n.Common.getIdStr(f.Row+t,f.Column+r[i].getColumnIndex(),h),u[e]={Row:t,Column:i};return u},i.prototype.resetColumnHeaderText=function(){var i,t,r;this._sheet.suspendPaint();for(i in this._colHeaderCellIDDic)t=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(i),t=n.Common.IsEmpty(t)?"":t,r=this._colHeaderCellIDDic[i],this._sheet.setValue(r.Row,r.Column,t,GC.Spread.Sheets.SheetArea.colHeader);this._sheet.resumePaint()},i.prototype.autoFitRowHeight=function(){for(var t=this._sheet.getRowCount(GC.Spread.Sheets.SheetArea.viewport),n=0;n<t;n++)this._sheet.autoFitRow(n);this._restartEdit()},i.prototype.autoFitColumnWidth=function(){for(var t=this._sheet.getColumnCount(GC.Spread.Sheets.SheetArea.viewport),n=0;n<t;n++)this._sheet.autoFitColumn(n);this._restartEdit()},i.prototype._restartEdit=function(){var t=this;n.DelayRefresh.setTimeout(function(){t._sheet.isEditing()&&(t._sheet.endEdit(),t._sheet.startEdit())})},i.prototype._initRowHeader=function(){var t=GC.Spread.Sheets.SheetArea.rowHeader,f=0,e,u,o,r;for(this.listviewData.isRowHeaderVisible()?(++f,this._rowHeaderWidth=this.listviewData.rowHeaderColumnInfo.columnInfo.Width,this._sheet.setColumnWidth(0,this._rowHeaderWidth,t),this.initRowHeaderStyle(),this._sheet.setCellType(-1,0,new n.SpreadJSRowHeaderCellType(this.listViewStyleTemplate),t)):this._rowHeaderWidth=0,this.listviewData.isRowHeaderCheckBoxVisible()?(++f,this._sheet.setColumnCount(f,t),r=this.listviewData.rowHeaderCheckBoxColmunIndex,e=this.listviewData.rowHeaderCheckBoxColumnInfo.columnInfo.Width,this._sheet.setColumnWidth(r,e,t),this._rowHeaderCheckBoxWidth=e,u=i.createStyleByCell(this.listviewData.rowHeaderCheckBoxColumnInfo.columnInfo.TemplateCell),u&&(u.hAlign=GC.Spread.Sheets.HorizontalAlign.center,u.vAlign=GC.Spread.Sheets.VerticalAlign.center,u.textDecoration=GC.Spread.Sheets.TextDecorationType.none,this._sheet.setStyle(-1,r,u,t)),this._sheet.setCellType(-1,r,new n.CheckBoxRowHeader(this.listViewStyleTemplate),t),this._sheet.options.rowHeaderAutoTextIndex=0):this._rowHeaderCheckBoxWidth=0,f===0&&(this._sheet.options.rowHeaderVisible=!1),this._sheet.options.rowHeaderAutoText=this.listviewData.isRowHeaderFillNumber()?GC.Spread.Sheets.HeaderAutoText.numbers:GC.Spread.Sheets.HeaderAutoText.blank,o=this._sheet.getColumnCount(t),r=0;r<o;r++)this._sheet.setColumnResizable(r,!1,t)},i.prototype._initSheetCommand=function(){var t=this,i=this._spread.commandManager();i.register("SelectAll",function(){if(!t._sheet.isEditing()){n.ListViewHelper.SelectionHelper.selectAllRows(t);t.onSelectionChanged(!0)}},GC.Spread.Commands.Key.a,!0,!1,!1,!1);this.listviewData.canEdit()?i.register("PressF2EnterEditMode",{execute:function(){return t._sheet.startEdit()}},113):(i.setShortcutKey("",GC.Spread.Commands.Key.del,!1,!1,!1,!1),i.setShortcutKey("",GC.Spread.Commands.Key.v,!0,!1,!1,!1));this.supportMoveActiveCellHorizontallyByEnter();this.supportMoveFocusByEnter()},i.prototype.supportMoveFocusByEnter=function(){var t=this;n.ForguncyData.pageInfo.moveFocusByEnter&&(this._spread.commandManager().register("EnterHit",function(){var i=t._sheet,r;if(!i.isEditing()&&(r=t.listviewData.getMoveFocusHorizontally()?i.getActiveRowIndex()===i.getRowCount()-1&&i.getActiveColumnIndex()===i.getColumnCount()-1:i.getActiveRowIndex()===i.getRowCount()-1,r))return i.getParent().focus(!1),n.FocusMoveHelper.MoveFocusToNextControl(t.getGcSheetFocusElementForTab()),!0},GC.Spread.Commands.Key.enter,!1,!1,!1,!1),this._spread.commandManager().register("ShiftEnterHit",function(){var i=t._sheet,r;return r=t.listviewData.getMoveFocusHorizontally()?i.getActiveRowIndex()===0&&i.getActiveColumnIndex()===0:i.getActiveRowIndex()===0,r?(i.getParent().focus(!1),n.FocusMoveHelper.MoveFocusToPreviousControl(t.getGcSheetFocusElementForTab()),!0):void 0},GC.Spread.Commands.Key.enter,!1,!0,!1,!1))},i.prototype.supportMoveActiveCellHorizontallyByEnter=function(){this.listviewData.getMoveFocusHorizontally()&&(this._spread.commandManager().setShortcutKey("moveToNextCell",GC.Spread.Commands.Key.enter,!1,!1,!1,!1),this._spread.commandManager().setShortcutKey("moveToPreviousCell",GC.Spread.Commands.Key.enter,!1,!0,!1,!1))},i.prototype.getGcSheetFocusElementForTab=function(){return this.getContainerDiv().find("[gcuielement=gcSheetFocusElementForTab]")[0]},i.prototype.initTouchToolStripItems=function(){var n=this._spread.touchToolStrip,t="wijspread_toolstrip_autofill0",i="separator0",r="wijspread_toolstrip_cut0",u="wijspread_toolstrip_paste0";this.listviewData.canUserDragFill()||(n.remove(t),n.remove(i));this.listviewData.canEdit()||(n.remove(r),n.remove(u))},i.prototype.initColumnsStyle=function(){for(var n,i,r,u=this.listviewData.visibleColumns,f=u.length,t=0;t<f;t++){if(n=u[t],n.columnInfo.HeaderCell)for(i=0;i<n.columnInfo.HeaderCell.length;i++)r=n.columnInfo.HeaderCell[i],this.initColumnHeaderStyle(r.Row,t,r);this.initColumnStyle(t,n.columnInfo.TemplateCell,n.canEnterEditMode);this.initColumnInputMessageFromDataValidation(t,n.columnInfo.TemplateCell);this.initCellType(t,n,n.getTemplateCell())}},i.prototype.initColumnsBindingInfo=function(){for(var i,t=this.getBindingColumnInfos(),r=t.length,n=0;n<r;n++)i=t[n],this._sheet.bindColumn(n,i)},i.prototype.initFocusBehavior=function(n){this._spread.commandManager().setShortcutKey("moveToNextCellThenControl",GC.Spread.Commands.Key.tab,!1,!1,!1,!1);this._spread.commandManager().setShortcutKey("moveToPreviousCellThenControl",GC.Spread.Commands.Key.tab,!1,!0,!1,!1);this.listviewData.getAllowGetFocus()!==!0&&$(n).find("[gcuielement='gcSheetFocusElementForTab']").attr("tabindex",-1)},i.prototype.getSelecionUnit=function(){return this.listviewData.getSelectionMode()===1?GC.Spread.Sheets.SelectionUnit.row:GC.Spread.Sheets.SelectionUnit.cell},i.prototype.initColumnStyle=function(n,t,r){r===void 0&&(r=!1);var f,e,o,u=i.createStyleByCell(t,r);((o=(e=(f=t)===null||f===void 0?void 0:f.Element)===null||e===void 0?void 0:e.CellType)===null||o===void 0?void 0:o.$type)==="Forguncy.MultilineTextBox, Forguncy"&&r&&(u||(u=new GC.Spread.Sheets.Style),u.formatter="@");u&&this._sheet.setStyle(-1,n,u)},i.prototype.initColumnInputMessageFromDataValidation=function(t,i){if(i&&i.Element&&i.Element.DataValidation&&i.Element.DataValidation.ShowInputMessageWhenCellIsSelected){var r=GC.Spread.Sheets.DataValidation.createNumberValidator(GC.Spread.Sheets.ConditionalFormatting.ComparisonOperators.equalsTo,null,null,!0);r.showInputMessage(!0);r.inputMessage(n.Common.IsEmpty(i.Element.DataValidation.InputMessage)?"":i.Element.DataValidation.InputMessage);r.inputTitle(n.Common.IsEmpty(i.Element.DataValidation.InputMessageTitle)?"":i.Element.DataValidation.InputMessageTitle);r.type(GC.Spread.Sheets.DataValidation.CriteriaType.anyValue);r&&this._sheet.setDataValidator(-1,t,r)}},i.prototype.initColumnHeaderStyle=function(t,r,u){var f=i.createStyleByCell(u);this.listViewStyleTemplate&&(f=f||new GC.Spread.Sheets.Style,f.backColor==="#E1E1E1"&&(f.backColor=n.ColorHelper.Convert(this.listViewStyleTemplate.ColumnHeaderBack)),f.foreColor==="#262626"&&(f.foreColor=n.ColorHelper.Convert(this.listViewStyleTemplate.ColumnHeaderFore)));f&&this._sheet.setStyle(t,r,f,GC.Spread.Sheets.SheetArea.colHeader);u&&(u.RowSpan>1||u.ColumnSpan>1)&&this._sheet.addSpan(t,r,u.RowSpan,u.ColumnSpan,GC.Spread.Sheets.SheetArea.colHeader)},i.prototype.clearColumnHeaderSpans=function(){var n=this,t=this._sheet.getSpans(new GC.Spread.Sheets.Range(-1,-1,-1,-1),GC.Spread.Sheets.SheetArea.colHeader);t.forEach(function(t){n._sheet.removeSpan(t.row,t.col,GC.Spread.Sheets.SheetArea.colHeader)})},i.createStyleByCell=function(t,i){var u,r;return(i===void 0&&(i=!1),!t)?null:(u=t.Element&&t.Element.StyleInfo?n.Common.clone(t.Element.StyleInfo):{},u.BorderBottom=t.BorderBottom,u.BorderRight=t.BorderRight,r=n.ListViewHelper.SpreadJSStyleHelper.generateStlyeObject(u),!n.Common.IsEmpty(r.formatter)&&r.formatter!=="@"&&i&&(r.formatter=null),r)},i.prototype.initCellType=function(t,i,r){var h=n.SpreadJSCellTypeHelper.getColumnCellType(this,i,r),f,u,e;this._sheet.setCellType(-1,t,h);var c=i.allowSort(),l=c,a=i.columnInfo.BindingColumnDataType,o=this.listviewData.getColumnOperation(),v=o===1,y=o===2&&!n.Common.IsEmpty(i.getFilterBindingInfo())&&n.SpreadJSFilterHeaderCellType.supportedTypes.indexOf(a)>=0,s=[],p=this._sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader);for(f=p-1;f>=0;f--)(u=this._sheet.getSpans(new GC.Spread.Sheets.Range(f,t,1,1),GC.Spread.Sheets.SheetArea.colHeader),u.length!==1||u[0].row===f&&u[0].col===t)&&(e=null,v&&(!u||u.length===0||u[0].colCount===1)?e=new n.SpreadJSSortHeaderCellType(i,this.getCalcSheetName(),this.listViewStyleTemplate):l&&y&&(!u||u.length===0||u[0].colCount===1)&&s[t]!==!0?(s[t]=!0,e=new n.SpreadJSFilterHeaderCellType(i,this.getCalcSheetName(),this.listViewStyleTemplate)):e=new n.SpreadJSColumnHeaderCellType(this.listViewStyleTemplate),this._sheet.setCellType(f,t,e,GC.Spread.Sheets.SheetArea.colHeader))},i.prototype.onSelectionChanged=function(n){if(n===void 0&&(n=!0),!this._rangeChangedManager.rangeChangedInfo){if(n)this.onCurrentRowChanged(this.getMappedEditorSelectedRowIndex());this.operationTypeWhenValueChanged===0&&(this.getAlwaysReservedSelections()&&this.cacheManager.save(this.getAllSelectedRowsOfView()),this.triggerSelectedRowsChangedEvent())}},i.prototype.triggerSelectedRowsChangedEvent=function(){var t=this.getAllSelectedRowsOfData();this.isSelectedRowsEqual(this._selectedRows,t)||(this._selectedRows=t,this.delayTriggerEvent(n.ListViewEvents.SelectedRowsChanged,{}))},i.prototype.delayTriggerEvent=function(t,i){var r=this;n.DelayRefresh.Push(r,function(){r.hasDestroyed()||r.trigger(t,i)},t+r.getCalcSheetName())},i.prototype.getSelectedRowsDataByAPI=function(){var t=this,i=t.getMergedColumnInfos(),r=i.length,u=t.getSelectedRowsData(),f=u.map(function(u){var e,f,s,o;if(n.Common.IsEmpty(u)||n.Common.IsEmpty(u.values))return null;for(e=[],f=0;f<r;f++)s=i[f].DesignerColumnIndex-t.getRangeInfo().Column,o=u.values[s],e.push(n.Common.IsEmpty(o)?null:o);return{RowIndex:u.index,Query:__assign({},u.query),Values:e}});return f.filter(function(n){return!!n})},i.prototype.getSelectedRowsData=function(){var t=this,n=[];return n=this.getAlwaysReservedSelections()?this.cacheManager.getCachedRows():this.getAllSelectedRowsOfData().map(function(n){return t.getCachedRowData(n)}),n?n:[]},i.prototype.clearSelectedRowByQuery=function(t){var i=this,r=this;this.getAlwaysReservedSelections()?this.cacheManager.clearByQuery(t,function(){if(i.listviewData.getSelectionMode()===1&&i.getAllSelectedRowsOfData().length<=1){var t=i.mappedRowIndexFromData(i._listData.getSelectIndex());i.cacheManager.reset();i.listviewData.getDisableAutoSelectRow()||i.cacheManager.save([t])}n.DelayRefresh.Push(r,function(){r.hasDestroyed()||(r.selectInEditorFromCache(),r.delayTriggerEvent(n.ListViewEvents.SelectedRowsChanged,{}))},"selectInEditorFromCache"+r.getCalcSheetName())}):this.getAllSelectedRowsOfData().forEach(function(r){n.Common.isQueryEqual(i._listData.getRowQuery(r),t)&&i.clearSelectedRow(r)})},i.prototype.selectRowsByValue=function(n,t){var r=this,i=n.map(function(n){return r.getRowIndexByValue(n,t)});this.getAlwaysReservedSelections()?this.selectRowsByValueInReservedMode(i,n,t):this.setSelectedRows(i)},i.prototype.getRowIndexByValue=function(n,t){for(var r,i=0;i<this._listData.getRowCount();i++)if(r=this._listData.getValue(i,t),r==n)return i;return-1},i.prototype.selectRowsByValueInReservedMode=function(t,i,r){var e=this,u=[],f;if(t.forEach(function(n,t){n===-1&&u.push(i[t])}),f=this.getBindingInfo(r),n.Common.IsEmpty(f)||u.length===0){this.selectRowsWithCache(t,i,r,null);return}n.ListViewHelper.RequestHelper.queryListviewDatasByQuery(this,f,u,function(n){return e.selectRowsWithCache(t,i,r,n)})},i.prototype.selectRowsWithCache=function(t,i,r,u){var f=this,e;this.cacheManager.clearAll();e=t.map(function(n,t){if(n===-1){var e=f.getListRowDataFromServerData(i[t],r,u);return e?f.getCachedRowDataFromListRowData(e):null}else return f.getCachedRowData(n)}).filter(function(n){return n});this.cacheManager.saveSelectionDatas(e);this.setSelectedRows(t);this.delayTriggerEvent(n.ListViewEvents.SelectedRowsChanged,{})},i.prototype.getListRowDataFromServerData=function(n,t,i){var u,f,r,e;if(!i)return null;for(r=0;r<i.length;r++)if(e=(f=(u=i[r])===null||u===void 0?void 0:u.data[t])===null||f===void 0?void 0:f.bindingValue,e==n)return i[r];return null},i.prototype.getCachedRowDataFromListRowData=function(t){for(var e,i,r,u,o=t.rowInfo,h=(i=o)===null||i===void 0?void 0:i.query,c=(r=o)===null||r===void 0?void 0:r.rowVersion,s=[],f=0;f<t.data.length;f++)e=(u=t.data[f])===null||u===void 0?void 0:u.bindingValue,s.push(e===undefined?null:e);return new n.CachedRowData(h,c,s,-1)},i.prototype.getBindingInfo=function(n){var t=this.listviewData.columnDataInfos[n].bindingInfoIndex;return t===-1?null:this.listviewData.columnBindingInfos[t]},i.prototype.beforeRefeshUIWhenQueryDataFromServer=function(){if(this.getAlwaysReservedSelections()){if(this.cacheManager.reset(),this.listviewData.getSelectionMode()===1)if(this.listviewData.getDisableAutoSelectRow())this._sheet.clearSelection();else{var n=this._listData.getSelectIndex();n>=0&&this.cacheManager.save([n])}}else this.clearSelectionIfDisableAutoSelectRow()},i.prototype.clearSelectionIfDisableAutoSelectRow=function(){this.listviewData.getSelectionMode()===1&&this.listviewData.getDisableAutoSelectRow()&&this._sheet.clearSelection()},i.prototype.deleteCachedRowDataByRowIndex=function(n){this.getAlwaysReservedSelections()&&this.cacheManager.delete(this.mappedRowIndexFromData(n))},i.prototype.updateCachedRowAfterDeleteRow=function(t){this.getAlwaysReservedSelections()&&(this.cacheManager.save(this.getAllSelectedRowsOfView()),this.delayTriggerEvent(n.ListViewEvents.SelectedRowsChanged,{}))},i.prototype.updateSelectedRowsCache=function(){this.getAlwaysReservedSelections()&&this.cacheManager.update(this.getAllSelectedRowsOfView())},i.prototype.selectInEditorFromCache=function(){var t,i;for(this._sheet.suspendPaint(),t=0;t<this._listData.getRowCount();t++)i=this.mappedRowIndexFromData(t),this.cacheManager.exists(this.getCachedRowData(t))?n.ListViewHelper.SelectionHelper.addSelectedRow(this,i):n.ListViewHelper.SelectionHelper.clearSelectedRow(this,i);this._sheet.resumePaint();this.onSelectionChanged()},i.prototype.getCachedRowData=function(t){var i=this._listData.getRowInfo(t),r=i?i.query:null,u=i?i.rowVersion:null,f=this._listData.getRowValue(t);return new n.CachedRowData(r,u,f,r?-1:t)},i.prototype.isSelectedRowsEqual=function(n,t){if(n.length!=t.length)return!1;for(var i=0;i<n.length;i++)if(n[i]!==t[i])return!1;return!0},i.prototype.isSelectMultipleRows=function(n){return n.some(function(n){return n.colCount>1||n.rowCount>1||n.row===-1})},i.prototype.bindSpreadEvent=function(){var i=this,t=this;t.listviewData.isDoubleClickCommandsExists()&&!t.listviewData.canEdit()&&t._sheet.bind(GC.Spread.Sheets.Events.CellDoubleClick,function(r,u){var e=u.row!==undefined&&u.row>=i.firstDataRowIndexInView&&u.row<=i.lastDataRowIndexInView,o=u.sheetArea===GC.Spread.Sheets.SheetArea.rowHeader,s=u.sheetArea===GC.Spread.Sheets.SheetArea.viewport,f;e&&(o||s)&&(f=t.listviewData.getDoubleClickCommands(),n.ForguncyData.commandExcutor.excuteCommand(f,t.runTimePageName,t,t.getListviewName(),n.Events.Click))});t._sheet.bind(GC.Spread.Sheets.Events.SelectionChanging,function(n,i){if(t._isSelecting=!0,t._sheet.selectionPolicy()===GC.Spread.Sheets.SelectionPolicy.single){var r=t.isSelectMultipleRows(i.newSelections);r&&i.oldSelections.forEach(function(n){t._sheet.setSelection(n.row,n.col,n.rowCount,n.colCount)})}});t._sheet.bind(GC.Spread.Sheets.Events.SelectionChanged,function(n,i){try{t.onSelectionChanged()}finally{t._isSelecting=!1}});t._sheet.bind(GC.Spread.Sheets.Events.EnterCell,function(n,i){t._rangeChangedManager.clearRangeChangedInfo();t.canEditInListview()&&t.getAlwaysInEditMode()&&t._sheet.startEdit(!0)});t._sheet.bind(GC.Spread.Sheets.Events.LeaveCell,function(n,i){t._rangeChangedManager.clearRangeChangedInfo()});t._sheet.bind(GC.Spread.Sheets.Events.ValueChanged,function(n,i){t.onValueChanged(i.row,i.col)});t._sheet.bind(GC.Spread.Sheets.Events.TopRowChanged,function(n,i){t.onTopRowChanged(i)});t._sheet.bind(GC.Spread.Sheets.Events.RowHeightChanged,function(n,i){t.onRowHeightOrRowCountChanged()});t._sheet.bind(GC.Spread.Sheets.Events.ColumnWidthChanged,function(n,i){t.onColumnWidthOrColumnCountChanged()});t._sheet.bind(GC.Spread.Sheets.Events.CellClick,function(i,r){if(r.sheetArea===GC.Spread.Sheets.SheetArea.viewport){n.ListViewHelper.SelectionHelper.isSelectAllRows(t._sheet)&&t._sheet.repaint();t.onCellClick(r.row,r.col);t.getAlwaysInEditMode()&&t._sheet.startEdit()}});t._spread.bind(GC.Spread.Sheets.Events.ButtonClicked,function(n,i){t.onCellTypeClicked(i)});t._sheet.bind(GC.Spread.Sheets.Events.EditStarting,function(n,i){t.listviewData.canEdit()&&t.canCellEnterEditMode(i.row,i.col)||(i.cancel=!0)});t._sheet.bind(GC.Spread.Sheets.Events.EditEnding,function(i,r){if(!t._cancelInput){var u=t._sheet.getCellType(-1,r.col);t.isNewLineRow(r.row)&&n.Common.IsEmpty(r.editingText)||u.validate&&!u.validate(r.editor)&&(r.cancel=!0)}});t._sheet.bind(GC.Spread.Sheets.Events.RangeChanged,function(n,i){t._rangeChangedManager.onRangeChanged(i)});t._sheet.bind(GC.Spread.Sheets.Events.ClipboardPasting,function(i,r){if(!t.listviewData.canEdit()){r.cancel=!0;return}if(!t.isValidPasteRange(r)){alert(n.RS.InvalidCopyPasteSize);r.cancel=!0;return}if(t.isRangeContainsTotalRow(r.cellRange.row,r.cellRange.row+1)){alert(n.RS.RangeOperationCannotInvolveTotalRow);r.cancel=!0;return}t.clearTotalRowCellTypeAndStyle();t._rangeChangedManager.onRangeChangeOperationBegin(GC.Spread.Sheets.RangeChangedAction.paste)});t._sheet.bind(GC.Spread.Sheets.Events.ClipboardPasted,function(n,i){var u,r;if(i.cellRange.colCount===-1)for(u=[],r=0;r<i.cellRange.rowCount;r++)u.push(i.cellRange.row+r);t._rangeChangedManager.onRangeChangeOperationCompleted(GC.Spread.Sheets.RangeChangedAction.paste,i.pasteOption!==GC.Spread.Sheets.ClipboardPasteOptions.values,i.cellRange.row===-1||i.cellRange.rowCount===-1,u)});t._sheet.bind(GC.Spread.Sheets.Events.DragDropBlock,function(i,r){if(t.isRangeContainsTotalRow(r.fromRow,r.fromRow+r.rowCount)||t.isRangeContainsTotalRow(r.toRow,r.toRow+r.rowCount)){alert(n.RS.RangeOperationCannotInvolveTotalRow);r.cancel=!0;return}t._rangeChangedManager.onRangeChangeOperationBegin(GC.Spread.Sheets.RangeChangedAction.dragDrop)});t._sheet.bind(GC.Spread.Sheets.Events.DragDropBlockCompleted,function(n,i){var u,r;if(i.colCount===-1)for(u=[],r=0;r<i.rowCount;r++)u.push(i.toRow+r);t._rangeChangedManager.onRangeChangeOperationCompleted(GC.Spread.Sheets.RangeChangedAction.dragDrop,!0,i.fromRow===-1||i.toRow===-1||i.rowCount===-1,u)});t._sheet.bind(GC.Spread.Sheets.Events.DragFillBlock,function(i,r){if(t.isRangeContainsTotalRow(r.fillRange.row,r.fillRange.row+r.fillRange.rowCount)){alert(n.RS.RangeOperationCannotInvolveTotalRow);r.cancel=!0;return}t._rangeChangedManager.onRangeChangeOperationBegin(GC.Spread.Sheets.RangeChangedAction.dragFill)})},i.prototype.onCellTypeClicked=function(t){if(!this.isProtected()){var i=this._sheet.getCellType(t.row,t.col,t.sheetArea);if(t.sheetArea===GC.Spread.Sheets.SheetArea.viewport){this.onCellClick(t.row,t.col);this.triggerCommand(t.row,t.col)}else t.sheetArea===GC.Spread.Sheets.SheetArea.colHeader?i instanceof n.SpreadJSFilterHeaderCellType?this.tryCommitEdit()&&n.ColumnFilterHelper.showContextMenu(this,t):this.sortByColumn(t.col):t.sheetArea===GC.Spread.Sheets.SheetArea.rowHeader&&i instanceof n.CheckBoxRowHeader?this.changeSelectedRowsInRowHeader(t.row,t.col):t.sheetArea===GC.Spread.Sheets.SheetArea.corner&&i instanceof GC.Spread.Sheets.CellTypes.Corner&&this.selectAllByCornerCell()}},i.prototype.isValidPasteRange=function(n){return n.sheet.getColumnCount()<n.cellRange.col+n.cellRange.colCount?!1:!this.allowAddRow()&&n.cellRange.row+n.cellRange.rowCount>this.lastDataRowIndexInView+1?!1:!0},i.prototype.isRangeContainsTotalRow=function(n,t){if(this.allowShowTotalRow()){var i=this.totalRowIndex;if(i>=n&&i<t)return!0}return!1},i.prototype.onValueChanged=function(t,i){var e,o,s;if(this.canCellBeEdited(t,i)){var u=this.mappedRowIndexFrowView(t),f=this._listData.getRowCount(),r=this._sheet.getValue(t,i);if(this._sheet.getCellType(t,i)instanceof n.SpreadJSViewUploadImageCellType&&(r=n.ImageHelper.convertPathToFileName(r)),this._rangeChangedManager.rangeChangedInfo){if(u>=f){if(!this.allowAddRow())return;if(n.Common.IsEmpty(r))return;for(e=f;e<=u;e++)this.addNewRow([],!0)}if(o=this.listviewData.getColIndexByVisibleColIndex(i),o===-1)return;if(this._rangeChangedManager.rangeChangedInfo.addChangedCell(t,i,this._listData.getValue(u,o)),this._rangeChangedManager.rangeChangedInfo.needParseValue){if(r instanceof Date&&(r=n.Convertor.fromDateToOADate(r)),s=n.ListivewEditorHelper.getCell(this.listviewData.visibleColumns[i].getTemplateCell(),this.runTimePageName),!s)return;r=s.cellType.getValueFromListviewText(r);this._sheet.setValue(t,i,r)}}else if(u===f){this.onValueChangedInNewRow(t,i,!0);return}this._onCellValueChanged(u,i,r,!0)}},i.prototype.canCellEnterEditMode=function(n,t){var r=this.mappedRowIndexFrowView(n),i;if(!(this.listviewData.visibleColumns[t].canEnterEditMode&&this._commitingRows.indexOf(r)===-1))return!1;if(this.listviewData.allowShowTotalRow())if(this.listviewData.getIsTotalRowAtFirstRow()){if(n===0)return!1}else if(n===this._sheet.getRowCount()-1)return!1;return(i=this._sheet.getSpans(new GC.Spread.Sheets.Range(n,t,1,1)),i&&i.length>0)?!1:!0},i.prototype.canCellBeEdited=function(n,t){return this.listviewData.visibleColumns[t].canEditInForguncy&&this._commitingRows.indexOf(this.mappedRowIndexFrowView(n))===-1},i.prototype.onValueChangedInNewRow=function(t,i,r){var u=this._sheet.getValue(t,i),f,e;(this._sheet.getCellType(t,i)instanceof n.SpreadJSViewUploadImageCellType&&(u=n.ImageHelper.convertPathToFileName(u)),n.Common.IsEmpty(u))||(f=this.listviewData.getColIndexByVisibleColIndex(i),f!==-1)&&(e=[],e[f]=u,this.addNewRow(e,r))},i.prototype.hideSelection=function(n){if(arguments.length===0)return this._spread.options.hideSelection;this._spread.options.hideSelection=!!n},i.prototype.refresh=function(){this._spread.refresh()},i.prototype.getAllSelectedRowsOfData=function(){var n=this.getAllSelectedRowsOfView(),t;return this.allowShowTotalRow&&(t=this.getListDataCount(),n=this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?n.map(function(n){return n-1}).filter(function(n){return n>=0&&n<t}):n.filter(function(n){return n>=0&&n<t})),n},i.prototype.getAllSelectedRowsOfView=function(){for(var n,l,t,r,u,s={},h=this._sheet.getSelections(),i=[],f=this.firstDataRowIndexInView,e=this.lastDataRowIndexInView,c=!1,o=0;o<h.length;o++)if(n=h[o],n.col===-1||n.colCount===-1){if(n.row===-1||n.rowCount===-1){c=!0;break}for(l=n.row+n.rowCount,t=n.row;t<l;t++)if(t<f||t>e)continue;else s[t]!==!0&&(i.push(t),s[t]=!0)}if(c)for(i=[],r=f;r<=e;r++)i.push(r);else i.length!==0||this.listviewData.isRowHeaderCheckBoxVisible()||this.listviewData.getDisableAutoSelectRow()||(u=this.mappedRowIndexFromData(this.getSelectedRowIndex()),u>=f&&u<=e&&i.push(u));return i},i.prototype.changeSelectedRowsInRowHeader=function(t,i){this.listviewData.isRowHeaderCheckBoxVisible()&&this.commitCurrentEdit()&&(n.Common.IsEmpty(t)||n.Common.IsEmpty(i)||(n.ListViewHelper.SelectionHelper.isRowSelected(this._sheet,t)?n.ListViewHelper.SelectionHelper.clearSelectedRow(this,t):n.ListViewHelper.SelectionHelper.addSelectedRow(this,t),this.onSelectionChanged()))},i.prototype.selectAllByCornerCell=function(){this.listviewData.isRowHeaderCheckBoxVisible()&&this._sheet.getRowCount()!==0&&(n.ListViewHelper.SelectionHelper.isSelectAllRows(this._sheet)?n.ListViewHelper.SelectionHelper.clearAllSelectedRows(this):n.ListViewHelper.SelectionHelper.selectAllRows(this),this.onSelectionChanged())},i.prototype.onTopRowChanged=function(n){(this.hideDeleteButton(),this._loadedOnDemandCriticalRowIndex!==-1)&&n.newTopRow>=this._loadedOnDemandCriticalRowIndex&&this.loadOnDemand()},i.prototype.onRowHeightOrRowCountChanged=function(){this.updateLoadedOnDemandCriticalRowIndex();this.updateScrollbarVisibility()},i.prototype.updateLoadedOnDemandCriticalRowIndex=function(){var t,i,n;for(this._loadedOnDemandCriticalRowIndex=-1,t=this.viewportHeight,i=this._sheet.getRowCount(),n=i-1;n>=0;n--)if(t-=this._sheet.getRowHeight(n),t<0){this._loadedOnDemandCriticalRowIndex=n;break}},i.prototype.onColumnWidthOrColumnCountChanged=function(){this.updateScrollbarVisibility()},i.prototype.updateScrollbarVisibility=function(){var t;t=this.canStretch?this._stretchHelper.getCurrntScrollbarVisibility():n.ListViewHelper.SpreadJSStyleHelper.needShowScrollbar(this._sheet,this.viewportWidth,this.viewportHeight);this.changeHorizontalBarVisible(t.showHScrollBar);this.changeVerticalBarVisible(t.showVScrollbar)},i.prototype.changeHorizontalBarVisible=function(n){this._spread.options.showHorizontalScrollbar=this.forceHideHorizontalScrollBar?!1:n},i.prototype.changeVerticalBarVisible=function(n){this._spread.options.showVerticalScrollbar=this.forceHideVerticalScrollBar?!1:n},Object.defineProperty(i.prototype,"viewportWidth",{get:function(){return $(this._divContainer).width()-this._rowHeaderWidth-this._rowHeaderCheckBoxWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewportHeight",{get:function(){return this.canVerticallyStretch?$(this._divContainer).parent().height()-this._colHeaderHeight:this._spreadHeight-this._colHeaderHeight},enumerable:!0,configurable:!0}),i.prototype._onValueChangedInDataModel=function(t){var r,i,u,f;if(this.operationTypeWhenValueChanged!==1&&(t.actionType===2&&n.Common.remove(this._waitValidateRows,t.deleteRow),this.triggerAPIValueChangedEvent([__assign({},t.cellRange)],t.newRowCount,t.oldRowCount),this.operationTypeWhenValueChanged!==2)&&(this.updateSelectedRowsCache(),r=this,n.DelayRefresh.NeedDelayRun===!0?n.DelayRefresh.setTimeout(function(){r.hasDestroyed()||r.refreshUI()},200):r.refreshUI(),i=t.cellRange,t.uiAction&&i))for(u=i.Row;u<i.Row+i.RowCount;u++)for(f=i.Column;f<i.Column+i.ColumnCount;f++)this.updateValuesWhenItemQueryWithColumnCell(u,f)},i.prototype.updateValuesWhenItemQueryWithColumnCell=function(n,t){for(var r,u,f,i=0;i<this.listviewData.visibleColumns.length;i++)r=this.listviewData.visibleColumns[i],u=r.dependenceColumnsIndex,u&&u.indexOf(t)!==-1&&(f=r.getColumnIndex(),this._listData.setValue(n,f,null,5,!0))},i.prototype.onDependenceCellValueChanged=function(){if(!this.commitCurrentEdit()){var n=this._sheet.getCellType(this._sheet.getActiveRowIndex(),this._sheet.getActiveColumnIndex());n&&n.hideValidationTooltip&&n.hideValidationTooltip()}t.prototype.onDependenceCellValueChanged.call(this)},i.prototype.refreshUI=function(t,i){var r=this;t===void 0&&(t=-1);i===void 0&&(i=-1);n.DelayRefresh.Push(this,function(){r.hasDestroyed()||(r.setDataToSpreadJSNow(t,i),r.selectInEditor(r._listData.getSelectIndex(),undefined,function(){r.clearSelectionIfDisableAutoSelectRow()}),r.getAlwaysReservedSelections()&&r.selectInEditorFromCache(),r.triggerSelectedRowsChangedEvent())},"setDataToSpreadJs"+this.getCalcSheetName())},i.prototype.autoFit=function(){this.listviewData.getAutoFitColumnWidth()&&this.autoFitColumnWidth();this.listviewData.getAutoFitRowHeight()&&this.autoFitRowHeight()},i.prototype.refreshTotalRowIndexInListViewStyleTemplate=function(){this.listviewData.allowShowTotalRow()&&this.listViewStyleTemplate&&this.listviewData.getIsTotalRowAtFirstRow()&&(this.listViewStyleTemplate.ShowTotalRowAtFirstRow=!0)},i.prototype.setTotalRowCellTypeAndStyle=function(){var t=this,i=this.totalRowIndex;i>=0&&this.listviewData.visibleColumns.forEach(function(r,u){var f=new n.SpreadJSViewTotalRowCellType(t.runTimePageName,t.listViewStyleTemplate),o=t.getTotalRowStyleMetaData(r),e=n.ListViewHelper.SpreadJSStyleHelper.generateStlyeObject(o);t.handleTotalRowCellTypeStyle(f,e);t._sheet.setStyle(t.totalRowIndex,u,e,GC.Spread.Sheets.SheetArea.viewport);t._sheet.setCellType(i,u,f,GC.Spread.Sheets.SheetArea.viewport);t._sheet.setDataValidator(i,u,null,GC.Spread.Sheets.SheetArea.viewport)})},i.prototype.getTotalRowStyleMetaData=function(t){var f,e=t.totalRowSetting,i={HorizontalAlignment:n.CellHorizontalAlignment.General,VerticalAlignment:n.CellVerticalAlignment.Center,Formatter:null,WordWrap:!1,FontFamily:n.LocaleFonts.default,TextIndent:1},r=(f=e)===null||f===void 0?void 0:f.StyleMetaData,u;if(r)for(u in r)r[u]!==undefined&&(i[u]=r[u]);return(n.Common.IsEmpty(i.FontSize)||i.FontSize<=0)&&(i.FontSize=n.StaticValues.DefaultFontSizeInPx),i},i.prototype.handleTotalRowCellTypeStyle=function(t,i){t.forceBackColor=i.backColor||n.ColorHelper.Convert(this.listViewStyleTemplate&&this.listViewStyleTemplate.TotalRowBack)||"transparent";i.backColor=undefined;i.foreColor=i.foreColor||n.ColorHelper.Convert(this.listViewStyleTemplate&&this.listViewStyleTemplate.TotalRowFore)||"#000000"},i.prototype.clearTotalRowCellTypeAndStyle=function(){var t=this,n=this.totalRowIndex;n>=0&&this.listviewData.visibleColumns.forEach(function(i,r){t._sheet.setStyle(n,r,null,GC.Spread.Sheets.SheetArea.viewport);t._sheet.setCellType(n,r,undefined,GC.Spread.Sheets.SheetArea.viewport)})},i.prototype.setDataToSpreadJSNow=function(n,t){if(n===void 0&&(n=-1),t===void 0&&(t=-1),this._sheet){this._sheet.suspendPaint();this.clearTotalRowCellTypeAndStyle();var i=this.getBindingDataSource();this._sheet.setDataSource(i);this.setTotalRowCellTypeAndStyle();this.refreshTotalRowIndexInListViewStyleTemplate();this.listviewData.isRowHeaderVisible()&&this.initRowHeader(this.firstDataRowIndexInView,this._listData.getRowCount());this._newRowIndex!==-1&&this.processNoneEditCellTypeInNewRow(!1);this.allowAddRow()?(this._newRowIndex=this.lastDataRowIndexInView+1,this.processNoneEditCellTypeInNewRow(!0),this._sheet.setValue(this._newRowIndex,0,"",GC.Spread.Sheets.SheetArea.rowHeader)):this._newRowIndex=-1;this.refreshConditionFormat();this.refreshAutoMerge(n,t);this.autoFit();this._sheet.resumePaint();this.onRowHeightOrRowCountChanged();this.repaintConditionFormatDepenceListview()}},i.prototype.repaintConditionFormatDepenceListview=function(){var t=this;n.ForguncyData.pageInfo.pageElementManager.listviewCollection.listviews.filter(function(n){return n._conditionFormatDependenceListviews&&n._conditionFormatDependenceListviews.indexOf(t.getCalcSheetName())>=0}).forEach(function(n){return n.repaint()})},i.prototype.initConditionFormatCalc=function(){n.ForguncyData.pageInfo.formulaManager.addCalcSource(new n.ConditionFormatCalcSource(n.ForguncyData.pageInfo.formulaManager.getCalcService(),this.getConditionFormatCalcSourceName(),this.getListDataModel(),this));this.setCalcService(n.ForguncyData.pageInfo.formulaManager.getCalcService())},i.prototype.initConditionFormatFormula=function(){for(var t,i,r,u=this,e=new n.ConditionFormatFormulaHelper(u.runTimePageName),f=0;f<u.listviewData.visibleColumns.length;f++)if((t=u.listviewData.visibleColumns[f].getTemplateCell(),t&&t.ConditionalFormattingMetadata)&&(i=t.ConditionalFormattingMetadata.Rules,i))for(r=0;r<i.length;r++)e.HandleFormulaInConditionFormat(i[r]);this.addDependenceHandler(e)},i.prototype.addDependenceHandler=function(t){var i=this,r=t.getDependences();r&&r.length>0&&n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(r,function(){i.repaint()},i.runTimePageName);i._conditionFormatDependenceListviews=t.dependenceListviews.filter(function(n){return n!==i.getCalcSheetName()})},i.prototype.getConditionFormatCalcSourceName=function(){return this.getCalcSheetName()+"c"},i.prototype.getSheetRowCount=function(){return this._sheet.getRowCount()},i.prototype.refreshConditionFormat=function(){var s=this.firstDataRowIndexInView,f=this._listData.getRowCount(),t,i,r,u,e,o;if(this._sheet.conditionalFormats.clearRule(),!(f<=0))for(t=0;t<this.listviewData.visibleColumns.length;t++)if((i=this.listviewData.visibleColumns[t].getTemplateCell(),i&&i.ConditionalFormattingMetadata)&&(r=i.ConditionalFormattingMetadata.Rules,r))for(u=r.length-1;u>=0;u--)e=new n.ConditionFormatRuleHelper,o=e.ConvertConditionRuleToSpreadJS(i.StyleInfo,r[u],t,f,s),this._sheet.conditionalFormats.addRule(o)},i.prototype.refreshAutoMerge=function(t,i){for(var u,f,e,o=[],r=0;r<this.listviewData.visibleColumns.length;r++)this.listviewData.visibleColumns[r].columnInfo.AllowAutoMerge&&o.push(r);u=this.allowShowTotalRow();f=0;u&&this.listviewData.getIsTotalRowAtFirstRow()&&(f=1);e=this._sheet.getRowCount();u&&this.listviewData.getIsTotalRowAtLastRow()&&(e-=1);n.ListViewHelper.AutoMergeHelper.autoMerge(this._sheet,o,t,i,f,e)},i.prototype.setCalcService=function(n){this._sheet.setCalc(n,null)},i.prototype.repaint=function(){this._sheet.repaint()},i.prototype.processNoneEditCellTypeInNewRow=function(t){var u,i,r,f;if(!(this._sheet.getRowCount()<=this._newRowIndex)&&this.listviewData.visibleColumns)for(u=this.listviewData.visibleColumns.length,i=0;i<u;i++)r=this.listviewData.visibleColumns[i],f=r.cellType,f.shouldDisplayInListviewNewRow()||this._sheet.setCellType(this._newRowIndex,i,t?new n.SpreadJSViewTextCellType(r.getTemplateCell(),this.oddRowBackcolor,this.evenRowBackcolor,this.runTimePageName,this.listViewStyleTemplate):undefined)},i.prototype.getBindingDataSource=function(){var n=[],t=this._listData.getRowCount();return this.fillDataSource(n,0,t),this.allowAddRow()&&n.push({}),this.allowShowTotalRow()&&(this.listviewData.getIsTotalRowAtFirstRow()?n.unshift(this.getTotalRowDataSource()):n.push(this.getTotalRowDataSource())),n},i.prototype.fillDataSource=function(n,t,r){for(var o,h,u,s,e,c=this.listviewData.visibleColumns.length,f=t;f<t+r;f++){for(o={},h=this._listData.getRowValue(f),u=0;u<c;u++)s=this.listviewData.visibleColumns[u],e=h[s.getColumnIndex()],e=this.adjustValue(e,s),o[i.ColumnPrefix+u]=e;n[f]=o}},i.prototype.adjustValue=function(t,i){var u=i.cellType.constructor,r,f;if(u===n.ImageCellType||u===n.UploadImageCellType)return r=i.getTemplateCell(),r.Value=t,n.ImageHelper.getImageSrcFromCellContentElement(r,!1,!1);else if(i.cellType.constructor===n.PasswordCellType)return f=n.ListivewEditorHelper.getCell(i.getTemplateCell(),this.runTimePageName),f.cellType.getListviewNoneEditModeText(t);return t===undefined?null:t},i.prototype.getTotalRowDataSource=function(){var n={};return this.listviewData.visibleColumns.forEach(function(t,r){var u=t.columnInfo.TotalRowCell;u&&u.FormulaType===0&&u.StaticText?n[i.ColumnPrefix+r]=u.StaticText:u&&u.FormulaType!==0&&(n[i.ColumnPrefix+r]=u.Value)}),n},i.prototype.initRowHeaderStyle=function(){var t=i.createStyleByCell(this.listviewData.rowHeaderColumnInfo.columnInfo.TemplateCell);this.listViewStyleTemplate&&(t=t||new GC.Spread.Sheets.Style,t.backColor=="#E1E1E1"&&(t.backColor=n.ColorHelper.Convert(this.listViewStyleTemplate.ColumnHeaderBack)),t.foreColor=="#262626"&&(t.foreColor=n.ColorHelper.Convert(this.listViewStyleTemplate.ColumnHeaderFore)));t&&this._sheet.setStyle(-1,0,t,GC.Spread.Sheets.SheetArea.rowHeader)},i.prototype.initRowHeader=function(n,t){for(var u,i,r=0;r<t;r++)i=n+r,u=this._listData.getValue(r,0),u===undefined||u===null?this._sheet.setValue(i,0,r+1,GC.Spread.Sheets.SheetArea.rowHeader):this._sheet.setValue(i,0,u,GC.Spread.Sheets.SheetArea.rowHeader);this.allowShowTotalRow()&&(this.listviewData.getIsTotalRowAtFirstRow()?(i=0,this._sheet.setValue(i,0,"\u2211",GC.Spread.Sheets.SheetArea.rowHeader)):(i=this._sheet.getRowCount()-1,this._sheet.setValue(i,0,"\u2211",GC.Spread.Sheets.SheetArea.rowHeader)))},i.prototype.getBindingColumnInfos=function(){for(var t=this.listviewData.visibleColumns,r=[],u=t.length,n=0;n<u;n++)r.push({name:i.ColumnPrefix+n,size:t[n].columnInfo.Width});return r},i.prototype.selectInEditor=function(n,t,i){var u,r=this.mappedRowIndexFromData(n);r>=0&&r<this._sheet.getRowCount()&&r!==this._sheet.getActiveRowIndex()&&(t===undefined&&(t=this._sheet.getActiveColumnIndex()),this._sheet.setActiveCell(r,t),this._sheet.showCell(r,t,GC.Spread.Sheets.VerticalPosition.nearest,GC.Spread.Sheets.HorizontalPosition.nearest),(u=i)===null||u===void 0?void 0:u())},i.prototype.cancelInput=function(){GC.Spread.Sheets.Commands.cancelInput.execute(this._spread,{sheetName:this._sheet.name()},!1)},i.prototype.editAndValidateCell=function(t,i,r){var u,e,f;if(this._waitValidateRows.indexOf(t)>=0)n.Common.remove(this._waitValidateRows,t);else return;if(u=this.mappedRowIndexFromData(t),(this._sheet.getActiveRowIndex()!==u||this._sheet.getActiveColumnIndex()!==i)&&(this._sheet.isEditing()&&this.getAlwaysInEditMode()&&this.cancelInput(),this._sheet.setActiveCell(u,i),this.onSelectionChanged()),!this._sheet.isEditing()){if(e=this.getGlobalActiveSheet(),!n.Common.IsEmpty(e)&&e!==this._sheet)return;this._sheet.showCell(u,i,GC.Spread.Sheets.VerticalPosition.nearest,GC.Spread.Sheets.HorizontalPosition.nearest);this._sheet.startEdit();f=this._sheet.getCell(u,i).cellType();f&&f.validate&&f.validate(undefined,r)}},i.prototype.getGlobalActiveSheet=function(){var n=window.Yl||window._gcGlobal;return n?n.activeElement:null},i.prototype.getSelectedRowCenterY=function(){var r=this._sheet.getViewportTopRow(1),f=this._sheet.getViewportBottomRow(1),t=this.mappedRowIndexFromData(this._listData.getSelectIndex()),n,i,u;if(t<r||t>f)return-1;for(n=0,i=r;i<t;i++)n+=this._sheet.getRowHeight(i);return n+=this._sheet.getRowHeight(t)/2,this._sheet.options.colHeaderVisible&&(n+=this._colHeaderHeight),this.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()&&(n+=this._sheet.getRowHeight(0)),u=parseFloat($(this._divContainer).parent().css("top")),n+u},i.prototype._covertDeleteButtonTopToPercent=function(n,t){if(this._divContainer){var i=n-parseFloat($(this._divContainer).parent().css("top")),r=100*(this.bounds.top-this.ResponsiveInfo.ExtendHeight)/t;return"calc("+r+"% + "+i+"px)"}return""},i.prototype.getMappedEditorSelectedRowIndex=function(){var i=this.getEditorRowCount(),t;return this._sheet&&i>0&&(t=this._sheet.getActiveRowIndex(),!n.Common.IsEmpty(t))?this.mappedRowIndexFrowView(t):undefined},i.prototype.commitCurrentEdit=function(n){n===void 0&&(n=!1);var t=!!this._sheet.endEdit();return t===!1&&n&&this.scrollToView(),t},i.prototype.getListviewControl=function(){return this._spread},i.prototype.getNewRowIndex=function(){return this._newRowIndex},i.prototype.protectListview=function(n){t.prototype.protectListview.call(this,n);this._sheet.options.isProtected=n},i.prototype.getSelectedColIndex=function(){return this.listviewData.visibleColumns[this._sheet.getActiveColumnIndex()].columnInfo.Index},i.prototype.showHorizontalScrollBar=function(n){if(n===undefined)return this._spread.options.showHorizontalScrollbar;this._spread.options.showHorizontalScrollbar=n},i.prototype.showVerticalScrollBar=function(n){if(n===undefined)return this._spread.options.showVerticalScrollbar;this._spread.options.showVerticalScrollbar=n},i.prototype.isEditing=function(){return this._sheet.isEditing()},i.prototype.getEditingValue=function(){return this._sheet.getCellType(-1,this._sheet.getActiveColumnIndex()).getEditorValue(null)},i.prototype._destroy=function(){this._onNormalCellValueChangedEventHandler&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel.unbind(n.Events.ValueChanged,this._onNormalCellValueChangedEventHandler);var t=n.ForguncyData.pageInfo.formulaManager.getCalcSource(this.getConditionFormatCalcSourceName());t&&n.ForguncyData.pageInfo.formulaManager.removeCalcSource(this.getConditionFormatCalcSourceName());this.removeSheetSource();this.setCalcService(new GC.Spread.CalcEngine.CalcService);this.destroySpread();this._stretchHelper&&this._stretchHelper.destroy()},i.prototype.removeSheetSource=function(){var i=n.ForguncyData.pageInfo.formulaManager.getCalcService(),r=i.getAllSourceModels(),u,t;for(u in r)if(t=r[u].getSource(),t.getSheet&&t.getSheet()===this._sheet){i.removeSource(t);break}},i.prototype.destroySpread=function(){var r,t,i;if(this._sheet){for(r=this._sheet.getColumnCount(),t=0;t<r;t++)i=this._sheet.getCellType(-1,t),i instanceof n.SpreadJSEditCellType&&i.destroy();this._sheet.unbindAll();this._sheet=null}this._spread&&(this._spread.unbindAll(),this._spread.focus(!1),this._spread.destroy(),this._spread=null)},i.prototype.getCoverBounds=function(){return this.listviewData.getColumnOperation()===0?this.bounds:{left:this.bounds.left,top:this.bounds.top+this._colHeaderHeight,width:this.bounds.width,height:this.bounds.height-this._colHeaderHeight}},i.prototype.getControl=function(){return this._spread},i.prototype.clearSelectionOutOfCurrentRow=function(){var t=this;n.DelayRefresh.Push(this,function(){var n,i;t.hasDestroyed()||(n=t.getSelectedRowIndex(),n!==-1&&t._listData.getRowCount()>0&&(i=t.mappedRowIndexFromData(n),t._sheet.setActiveCell(i,t._sheet.getActiveColumnIndex()),t.clearSelectionIfDisableAutoSelectRow()))},"clearSelectionOutOfCurrentRow"+this.getCalcSheetName())},i.prototype.addSelectedRow=function(t){t=this.mappedRowIndexFromData(t);n.ListViewHelper.SelectionHelper.addSelectedRow(this,t);this.onSelectionChanged()},i.prototype.setSelectedRows=function(t){var i=this,r=t.filter(function(n){return n!==-1}).map(function(n){return i.mappedRowIndexFromData(n)});n.ListViewHelper.SelectionHelper.setSelectedRows(this,r);this.onSelectionChanged()},i.prototype.clearSelectedRow=function(t){t=this.mappedRowIndexFromData(t);n.ListViewHelper.SelectionHelper.clearSelectedRow(this,t);this.onSelectionChanged()},i.prototype.selectAllRows=function(){n.ListViewHelper.SelectionHelper.selectAllRows(this);this.onSelectionChanged()},i.prototype.clearAllSelectedRows=function(){n.ListViewHelper.SelectionHelper.clearAllSelectedRows(this);this.onSelectionChanged()},i.prototype.isSelectedRow=function(t){return t=this.mappedRowIndexFromData(t),n.ListViewHelper.SelectionHelper.isRowSelected(this._sheet,t)},i.getCanvas=function(t){var i=n.ListviewBase.getListviewByCalcSheetName(t);return i?i.getContainerDiv().find("canvas")[0]:null},i.getCanvasPosition=function(n){var t=$(i.getCanvas(n)).position();return t||(t={top:0,left:0}),t},i.getBounds=function(t){var r=n.ListviewBase.getListviewByCalcSheetName(t);return r instanceof i?new GC.Spread.Sheets.Rect(0,0,r._spreadWidth,r._spreadHeight):new GC.Spread.Sheets.Rect(0,0,0,0)},i.getWorkBookByHost=function(n){return n.data("workbook")},i.prototype.setSelectionWithEvent=function(n,t,i,r){n=this.mappedRowIndexFromData(n);this._sheet.setSelection(n,t,i,r);this.onSelectionChanged()},i.prototype.isRowHeaderVisible=function(){return this.listviewData.isRowHeaderVisible()},i.prototype.isRowHeaderCheckBoxVisible=function(){return this.listviewData.isRowHeaderCheckBoxVisible()},i.prototype.getText=function(i,r){var u,f,e,o;return(i=this.mappedRowIndexFromData(i),i<0||i>=this._sheet.getRowCount())?"":(u=this.listviewData.rowHeaderColumnInfo,u&&u.getColumnIndex()===r)?this._sheet.getText(i,0,GC.Spread.Sheets.SheetArea.rowHeader):(f=this.listviewData.getColumnMetaData(r),f&&f.Width===0)?t.prototype.getText.call(this,i,r):(e=this.getVisibleColumnIndexInListViewByDataIndex(r),e===-1)?"":(o=this._sheet.getText(i,e),o===n.ImageHelper.emptyUploadImageUrl)?"":o},i.prototype.focus=function(n){this._spread.focus(n)},i.prototype.getActualStyle=function(t,i){if(t=this.mappedRowIndexFromData(t),t<0||t>=this._sheet.getRowCount()||i<0||i>=this._sheet.getColumnCount())return null;var r=this._sheet.getActualStyle(t,i,GC.Spread.Sheets.SheetArea.viewport),u=new GC.Spread.Sheets.Style(r.backColor,r.foreColor);return n.CommandCellTypeHelper.setAlternativeRowColor(t,this.oddRowBackcolor,this.evenRowBackcolor,u,this.listViewStyleTemplate),u},i.prototype.getExportColmnMetadatas=function(){return this.listviewData.visibleColumns.map(function(n){return n.columnInfo})},i.prototype.getColumnWidth=function(n){return this._sheet.getColumnWidth(n)},i.ColumnPrefix="c",i.OriginalSpreadJSMethod={},i}(n.ListviewBase);n.SpreadJSView=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var r,t=function(){function t(){}return t.getColumnCellType=function(n,i,r){for(var f=t.columnCellTypeInfos,u=0;u<f.length;u++)if(f[u].shouldUse(n,i,r))return f[u].createInstance(n,i,r);return l.createInstance(n,i,r)},t.register=function(n,i){t.columnCellTypeInfos.push({shouldUse:n,createInstance:i})},t.executeEditCommand=function(n,t,i,r,u){var f={cmd:"editCell",sheetName:n.name(),row:t,col:i,newValue:r,autoFormat:!0};n.getParent().commandManager().execute(f)},t.renderTextDecoration=function(n,t,i,r,u,f,e){n.strokeStyle=n.fillStyle;var o=0,h=0,s=.5,c;c=f<=12?12:f;h=Math.floor((c-12)/21+1);n.lineWidth=h;(h&1)==0&&(s=0);n.textAlign==="center"?i=i-u/2:n.textAlign==="right"&&(i=i-u);n.beginPath();(t&GC.Spread.Sheets.TextDecorationType.overline)===GC.Spread.Sheets.TextDecorationType.overline&&(o=Math.ceil(r+e-f-1)-s,n.moveTo(i,o),n.lineTo(i+u,o));(t&GC.Spread.Sheets.TextDecorationType.lineThrough)===GC.Spread.Sheets.TextDecorationType.lineThrough&&(o=Math.ceil(r+e-f/2)-s,n.moveTo(i,o),n.lineTo(i+u,o));(t&GC.Spread.Sheets.TextDecorationType.underline)===GC.Spread.Sheets.TextDecorationType.underline&&(o=Math.ceil(r+e-1)-s,n.moveTo(i,o),n.lineTo(i+u,o));n.stroke()},t.getStringWidthByCanvas=function(n,t,i){var r=new GC.Spread.Sheets.Style,u;return r.font=t,u={sheet:i,row:0,col:0,sheetArea:GC.Spread.Sheets.SheetArea.viewport},GC.Spread.Sheets.CellTypes.Base.prototype.getAutoFitWidth(n,n,r,1,u)},t.getTextHeight=function(n,t){var i=new GC.Spread.Sheets.Style,r;return i.font=n,r={sheet:t,row:0,col:0,sheetArea:GC.Spread.Sheets.SheetArea.viewport},GC.Spread.Sheets.CellTypes.Base.prototype.getAutoFitHeight("text","text",i,1,r)},t.getVisualStateName=function(n){for(var t in GC.Spread.Sheets.VisualState)if(GC.Spread.Sheets.VisualState[t]===n)return t.toLowerCase();return null},t.getCustomStyle=function(t,i,r,u){var f=t||new GC.Spread.Sheets.Style,e={};return r&&(u===GC.Spread.Sheets.VisualState.normal?e[GC.Spread.Sheets.VisualState.normal]={backColor:r.ColumnHeaderBack,foreColor:r.ColumnHeaderFore,borderColor:r.ColumnHeaderBorder}:u===GC.Spread.Sheets.VisualState.selected?e[GC.Spread.Sheets.VisualState.selected]={backColor:r.ColumnHeaderSelectBack,foreColor:r.ColumnHeaderSelectFore,borderColor:r.ColumnHeaderBorder}:u===GC.Spread.Sheets.VisualState.hover?e[GC.Spread.Sheets.VisualState.hover]={backColor:r.ColumnHeaderHoverBack,foreColor:r.ColumnHeaderHoverFore,borderColor:r.ColumnHeaderBorder}:u===GC.Spread.Sheets.VisualState.highlight&&(e[GC.Spread.Sheets.VisualState.highlight]={backColor:r.ColumnHeaderHighlightBack,foreColor:r.ColumnHeaderHighlightFore,borderColor:r.ColumnHeaderBorder})),u===GC.Spread.Sheets.VisualState.normal?(f.backColor||(f.backColor=r?n.ColorHelper.Convert(e[u].backColor):i.backgroundColor),n.Common.IsEmpty(f.foreColor)&&(f.foreColor=r?n.ColorHelper.Convert(e[u].foreColor):i.color)):(r&&e[u].backColor&&(f.backColor=n.ColorHelper.Convert(e[u].backColor)),r&&e[u].foreColor&&(f.foreColor=n.ColorHelper.Convert(e[u].foreColor))),f.borderLeft=f.borderLeft||new GC.Spread.Sheets.LineBorder("#B7B7B7",GC.Spread.Sheets.LineStyle.thin),(f.borderLeft.color==i.borderLeftColor||f.borderLeft.color==="#B7B7B7")&&(f.borderLeft.color=r?n.ColorHelper.Convert(e[u].borderColor)||i.borderLeftColor:i.borderLeftColor),f.borderRight=f.borderRight||new GC.Spread.Sheets.LineBorder("#B7B7B7",GC.Spread.Sheets.LineStyle.thin),(f.borderRight.color==i.borderRightColor||f.borderRight.color==="#B7B7B7")&&(f.borderRight.color=r?n.ColorHelper.Convert(e[u].borderColor)||i.borderRightColor:i.borderRightColor),f.borderTop=f.borderTop||new GC.Spread.Sheets.LineBorder("#B7B7B7",GC.Spread.Sheets.LineStyle.thin),(f.borderTop.color==i.borderTopColor||f.borderTop.color==="#B7B7B7")&&(f.borderTop.color=r?n.ColorHelper.Convert(e[u].borderColor)||i.borderTopColor:i.borderTopColor),f.borderBottom=f.borderBottom||new GC.Spread.Sheets.LineBorder("#B7B7B7",GC.Spread.Sheets.LineStyle.thin),(f.borderBottom.color==i.borderBottomColor||f.borderBottom.color==="#B7B7B7")&&(f.borderBottom.color=r?n.ColorHelper.Convert(e[u].borderColor)||i.borderBottomColor:i.borderBottomColor),f.backColor||(f.backColor=i.backgroundColor),f.foreColor||(f.foreColor=i.color),f},t.columnCellTypeInfos=[],t}(),i,c,f,nt,l,ut,e,a,o,v,y,p,s,h,tt,ft,u,it,w,et,ot,b,rt,st,k,d,g;n.SpreadJSCellTypeHelper=t;i=function(){function t(){}return t.processMouseMove=function(t){var i,u,r;t&&(i=t.sheet,i)&&(i.isEditing()&&i.getActiveRowIndex()===t.row&&i.getActiveColumnIndex()===t.col||(u=i.getParent(),r=n.SpreadJSView.getCanvas(u.name),r&&(r.style.cursor="pointer")))},t.processMouseLeave=function(t){var r=t.sheet,u,i;r&&(u=r.getParent(),i=n.SpreadJSView.getCanvas(u.name),i&&(i.style.cursor="default"))},t.shouldUsePointerCursor=function(n){return n&&n.length>0},t.setAlternativeRowColor=function(t,i,r,u,f,e){var o,s;return e===void 0&&(e=!1),u=u||new GC.Spread.Sheets.Style,o=t,f&&f.ShowTotalRowAtFirstRow&&(o-=1),e||u.backColor||(s=void 0,s=o%2==0?r:i,s&&s!=="transparent"?u.backColor=n.ColorHelper.Convert(s):this.setStyleTemplateBackColor(u,f,o)),u.foreColor||this.setStyleTemplateForeColor(u,f,o),u},t.setStyleTemplateBackColor=function(t,i,r){if(i){var u=r%2==0?i.EvenRowBack:i.OddRowBack;u&&(t.backColor=n.ColorHelper.Convert(u))}},t.setStyleTemplateForeColor=function(t,i,r){if(i){var u=r%2==0?i.EvenRowFore:i.OddRowFore;u&&(t.foreColor=n.ColorHelper.Convert(u))}},t.getHitInfo=function(n,t,i,r,u,f){var e,o;return f?(e=f.sheetArea,(e===null||e===undefined||e===u)&&r)?(o={x:n,y:t,row:f.row,col:f.col,cellRect:r,sheetArea:e,sheet:f.sheet},r.x<=n&&n<r.x+r.width&&r.y<=t&&t<r.y+r.height&&(o.isReservedLocation=!0),o):null:null},t.processMouseDown=function(n,t){if(!t)return!1;var i=t.sheet;return i&&t.isReservedLocation&&!n._isMouseDownReservedLocation?(n._isMouseDownReservedLocation=!0,!0):!1},t.processMouseUp=function(n,i,r,u,f,e){if(!i)return!1;var s=this,o=i.sheet;return n._isMouseDownReservedLocation&&o&&i.isReservedLocation&&(n._isMouseDownReservedLocation=!1,t.triggerButtonClicked(o,r,u,i.sheetArea,f,i),e&&e.apply(n,[i])),!1},t.triggerButtonClicked=function(t,i,r,u,f,e){var o,s;if(u===f&&i!==undefined&&r!==undefined&&(o=t.getParent(),o)&&(s=n.ListviewBase.getListviewByCalcSheetName(o.name),s))s.onCellTypeClicked({row:i,col:r,sheetArea:u,x:e&&e.x,y:e&&e.y})},t}();n.CommandCellTypeHelper=i;c=function(t){function r(n,i,r,u){var f=t.call(this)||this;return f._cellMetaData=n,f._oddRowBackcolor=i,f._evenRowBackcolor=r,f._listViewStyleTemplate=u,f.typeName="SpreadJSViewButtonCellType",f._cellMetaData.StyleInfo.Background&&f.buttonBackColor(f._cellMetaData.StyleInfo.Background),f}return __extends(r,t),r.shouldUse=function(t,i,r){return i.cellType.constructor===n.ButtonCellType},r.createInstance=function(n,t,i){return new r(i,n.oddRowBackcolor,n.evenRowBackcolor,n.listViewStyleTemplate)},r.prototype.paint=function(n,r,u,f,e,o,s,h){s=i.setAlternativeRowColor(h.row,this._oddRowBackcolor,this._evenRowBackcolor,s,this._listViewStyleTemplate,!0);t.prototype.paint.call(this,n,r,u,f,e,o,s,h)},r.prototype.getButtonState=function(n,t,i){return n.getActiveRowIndex()!==t||n.getActiveColumnIndex()!==i?f.Normal:this.buttonState()},r.prototype.paintValue=function(t,i,r,u,e,o,s,h){var d,w,y,b,p,k;if(t&&h.sheet){var c=r+this.marginLeft(),l=u+this.marginTop(),a=e-this.marginLeft()-this.marginRight(),v=o-this.marginTop()-this.marginBottom(),g=c+a>r&&c<r+e&&l+v>u&&l<u+o;a-2>0&&v-2>0&&g&&(t.save(),(c<r||c+a>r+e||l<u||l+v>u+o)&&(t.rect(r,u,e,o),t.clip()),t.beginPath(),d=this.getButtonState(h.sheet,h.row,h.col),w=n.ColorHelper.Convert(s.backColor),w?(y=d===f.Pressed,t.strokeStyle="#646464",t.strokeRect(c+.5,l+.5,a-1,v-1),t.beginPath(),t.strokeStyle=y?"#ffffff":"#696969",t.moveTo(c+1.5,l+v-1.5),t.lineTo(c+a-1.5,l+v-1.5),t.stroke(),t.beginPath(),t.strokeStyle=y?"#ffffff":"#696969",t.moveTo(c+a-1.5,l+1.5),t.lineTo(c+a-1.5,l+v-1.5),t.stroke(),t.beginPath(),t.strokeStyle=y?"#696969":"#ffffff",t.moveTo(c+1.5,l+1.5),t.lineTo(c+a-1.5,l+1.5),t.stroke(),t.beginPath(),t.strokeStyle=y?"#696969":"#ffffff",t.moveTo(c+1.5,l+1.5),t.lineTo(c+1.5,l+v-1.5),t.stroke(),t.beginPath(),t.strokeStyle=y?"#f0f0f0":"#a0a0a0",t.moveTo(c+2.5,l+v-2.5),t.lineTo(c+a-2.5,l+v-2.5),t.stroke(),t.beginPath(),t.strokeStyle=y?"#f0f0f0":"#a0a0a0",t.moveTo(c+a-2.5,l+2.5),t.lineTo(c+a-2.5,l+v-2.5),t.stroke(),t.beginPath(),t.strokeStyle=y?"#a0a0a0":"#f0f0f0",t.moveTo(c+2.5,l+2.5),t.lineTo(c+a-2.5,l+2.5),t.stroke(),t.beginPath(),t.strokeStyle=y?"#a0a0a0":"#f0f0f0",t.moveTo(c+2.5,l+2.5),t.lineTo(c+2.5,l+v-2.5),t.stroke(),t.fillStyle!==w&&(t.fillStyle=w),t.fillRect(c+3,l+3,a-6,v-6)):(b="#707070",b&&t.strokeStyle!==b&&(t.strokeStyle=b),t.strokeRect(c+.5,l+.5,a-1,v-1),p=void 0,d===f.Pressed?p="#34B4E3":(k=t.createLinearGradient(r+e/2,u,r+e/2,u+o),k.addColorStop(0,"#ECECEC"),k.addColorStop(1,"#D5D5D5"),p=k),t.fillStyle!==p&&(t.fillStyle=p),t.fillRect(c+1,l+1,a-2,v-2)),t.restore(),GC.Spread.Sheets.CellTypes.Text.prototype.paintValue.call(this,t,i,c,l,a,v,s,h))}},r.prototype.getAutoFitWidth=function(n,i,r,u,f){return this.text(i),t.prototype.getAutoFitWidth.call(this,n,i,r,u,f)},r.prototype.getAutoFitHeight=function(n,i,r,u,f){return this.text(i),t.prototype.getAutoFitHeight.call(this,n,i,r,u,f)},r.prototype.processMouseMove=function(n){var r=this._cellMetaData.CellType;return r&&r.CommandList&&i.shouldUsePointerCursor(r.CommandList)&&i.processMouseMove(n),t.prototype.processMouseMove.call(this,n)},r.prototype.processMouseLeave=function(n){var r=this._cellMetaData.CellType;return r&&r.CommandList&&i.shouldUsePointerCursor(r.CommandList)&&i.processMouseLeave(n),t.prototype.processMouseLeave.call(this,n)},r}(GC.Spread.Sheets.CellTypes.Button);n.SpreadJSViewButtonCellType=c;t.register(c.shouldUse,c.createInstance),function(n){n[n.Normal=0]="Normal";n[n.Hover=1]="Hover";n[n.Pressed=2]="Pressed"}(f||(f={}));nt=function(n){function t(t,i,r){var u=n.call(this)||this;return u._oddRowBackcolor=t,u._evenRowBackcolor=i,u._listViewStyleTemplate=r,u}return __extends(t,n),t.prototype.paint=function(t,r,u,f,e,o,s,h){s=i.setAlternativeRowColor(h.row,this._oddRowBackcolor,this._evenRowBackcolor,s,this._listViewStyleTemplate);n.prototype.paint.call(this,t,r,u,f,e,o,s,h)},t}(GC.Spread.Sheets.CellTypes.Base);n.SpreadJSViewCellTypeBase=nt;l=function(n){function t(t,i,r,u,f){var e=n.call(this)||this;return e._cellMetaData=t,e._oddRowBackcolor=i,e._evenRowBackcolor=r,e.runTimePageName=u,e._listViewStyleTemplate=f,e._textCache={},e.typeName="SpreadJSViewTextCellType",e}return __extends(t,n),t.createInstance=function(n,i,r){return new t(r,n.oddRowBackcolor,n.evenRowBackcolor,n.runTimePageName,n.listViewStyleTemplate)},t.prototype.paint=function(t,r,u,f,e,o,s,h){s=i.setAlternativeRowColor(h.row,this._oddRowBackcolor,this._evenRowBackcolor,s,this._listViewStyleTemplate);n.prototype.paint.call(this,t,r,u,f,e,o,s,h)},t.prototype.format=function(t,i,r,f){var e,o;if(!this._cellMetaData)return n.prototype.format.call(this,t,i,r);try{return o=u.getDisplayText(t,this._cellMetaData,this.runTimePageName,i,r),this._textCache[t+""]=o,o}catch(s){return e=this._textCache[t+""],e!==null&&e!==void 0?e:t+""}},t}(GC.Spread.Sheets.CellTypes.Text);n.SpreadJSViewTextCellType=l;ut=function(n){function t(t,i){var r=n.call(this,null,null,null,t,i)||this;return r.typeName="SpreadJSViewTotalRowCellType",r}return __extends(t,n),t.prototype.paint=function(t,i,r,u,f,e,o,s){this.forceBackColor&&(o.backColor=this.forceBackColor);n.prototype.paint.call(this,t,i,r,u,f,e,o,s)},t}(l);n.SpreadJSViewTotalRowCellType=ut;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getHitInfo=function(n,t,r,u,f){return this.allowTriggerCommand(f.sheet,f.row,f.col)?i.getHitInfo(n,t,r,u,GC.Spread.Sheets.SheetArea.viewport,f):null},t.prototype.activateEditor=function(t,r,u,f){n.prototype.activateEditor.call(this,t,r,u,f);var e=t&&f&&f.sheet;if(e)$(t).on("click",function(){i.triggerButtonClicked(e,e.getActiveRowIndex(),e.getActiveColumnIndex(),f.sheetArea,GC.Spread.Sheets.SheetArea.viewport)})},t.prototype.processMouseDown=function(n){return i.processMouseDown(this,n)},t.prototype.processMouseUp=function(n){if(!n)return!1;var t=n.sheet;return i.processMouseUp(this,n,t.getActiveRowIndex(),t.getActiveColumnIndex(),GC.Spread.Sheets.SheetArea.viewport,this.onClick)},t.prototype.onClick=function(n){},t.prototype.processMouseMove=function(n){if(n){var t=n.sheet;t&&n.isReservedLocation&&this.allowTriggerCommand(t,n.row,n.col)&&i.processMouseMove(n)}},t.prototype.processMouseLeave=function(n){if(n){var t=n.sheet;t&&n.isReservedLocation&&(this._isMouseDownReservedLocation=!1,this.allowTriggerCommand(t,n.row,n.col)&&i.processMouseLeave(n))}},t.prototype.allowTriggerCommand=function(n,t,i){return!0},t}(GC.Spread.Sheets.CellTypes.Base);n.SpreadJSCommandCellTypeBase=e;a=function(t){function r(n,i,r){var u=t.call(this)||this;return u._oddRowBackcolor=n,u._evenRowBackcolor=i,u._listViewStyleTemplate=r,u.typeName="SpreadJSViewHyperLinkCellType",u}return __extends(r,t),r.shouldUse=function(t,i,r){return i.cellType.constructor===n.HyperlinkCellType},r.createInstance=function(n,t,i){return new r(n.oddRowBackcolor,n.evenRowBackcolor,n.listViewStyleTemplate)},r.prototype.paint=function(n,r,u,f,e,o,s,h){s=i.setAlternativeRowColor(h.row,this._oddRowBackcolor,this._evenRowBackcolor,s,this._listViewStyleTemplate);t.prototype.paint.call(this,n,r,u,f,e,o,s,h)},r.prototype.allowTriggerCommand=function(t,i,r){var u=t.getText(i,r);return!n.Common.IsEmpty(u)},r}(e);n.SpreadJSViewHyperLinkCellType=a;t.register(a.shouldUse,a.createInstance);o=function(t){function r(n,i,r,u,f){var e=t.call(this)||this;return e._cellMetaData=n,e._oddRowBackcolor=i,e._evenRowBackcolor=r,e._listViewStyleTemplate=u,e._autofitWidth=f,e.typeName="SpreadJSViewImageCellType",e._cellTypeMetaData=e._cellMetaData.CellType,e._cellTypeMetaData.ImageSizeMode===undefined&&(e._cellTypeMetaData.ImageSizeMode=0),e._cellTypeMetaData.HorizontalAlignment===undefined&&(e._cellTypeMetaData.HorizontalAlignment=1),e._cellTypeMetaData.VerticalAlignment===undefined&&(e._cellTypeMetaData.VerticalAlignment=1),e}return __extends(r,t),r.prototype.getAutoFitWidth=function(n,t,i,r,u){return this._autofitWidth},r.shouldUse=function(t,i,r){return i.cellType.constructor===n.ImageCellType},r.createInstance=function(n,t,i){return new r(i,n.oddRowBackcolor,n.evenRowBackcolor,n.listViewStyleTemplate,t.columnInfo.Width)},r.prototype.paint=function(r,u,f,e,o,s,h,c){h=i.setAlternativeRowColor(c.row,this._oddRowBackcolor,this._evenRowBackcolor,h,this._listViewStyleTemplate);u=n.ImageHelper.encodeImageUrlAndUpdateQuery(u,o,s);this.paintBackground(r,u,f,e,o,s,h.backColor,c);h.backColor=undefined;t.prototype.paint.call(this,r,this._cellTypeMetaData.Text,f,e,o,s,h,c)},r.prototype.paintBackground=function(t,i,r,u,f,e,o,s){var g,b,h,w,nt;if(t){var y=i,p=GC.Spread.Sheets.ImageLayout.none,c=r,l=u,a=f,v=e,k=0,d=0;n.ImageDataHelper.IsBuiltInSvg(y)&&this._cellMetaData&&this._cellMetaData.CellType&&this._cellMetaData.CellType.Color&&(g=this._cellMetaData.CellType.Color,b=n.ImageDataHelper.GetColoredSvgRectInfo(y,g),b&&(y=b.value,k=b.width,d=b.height),a>10&&(a-=6,c+=3),v>10&&(v-=6,l+=3));switch(this._cellTypeMetaData.ImageSizeMode){case 2:p=GC.Spread.Sheets.ImageLayout.stretch;break;case 1:if(p=GC.Spread.Sheets.ImageLayout.zoom,h=this.getImageSize(y,s),h===null)break;if(e>0&&h.height>0&&f/e>h.width/h.height){if(this._cellTypeMetaData.HorizontalAlignment===n.CellHorizontalAlignment.Center)break;a=h.width/h.height*e;this._cellTypeMetaData.HorizontalAlignment===n.CellHorizontalAlignment.Right&&(c=c+f-a)}else if(f>0&&h.width>0&&e/f>h.height/h.width){if(this._cellTypeMetaData.VerticalAlignment===n.CellVerticalAlignment.Center)break;v=h.height/h.width*f;this._cellTypeMetaData.VerticalAlignment===n.CellVerticalAlignment.Bottom&&(l=l+e-v)}break;case 0:if(this._cellTypeMetaData.HorizontalAlignment===n.CellHorizontalAlignment.Left&&this._cellTypeMetaData.VerticalAlignment==n.CellVerticalAlignment.Top)p=GC.Spread.Sheets.ImageLayout.none;else if(this._cellTypeMetaData.HorizontalAlignment===n.CellHorizontalAlignment.Center&&this._cellTypeMetaData.VerticalAlignment===n.CellVerticalAlignment.Center)p=GC.Spread.Sheets.ImageLayout.center;else{if(p=GC.Spread.Sheets.ImageLayout.none,w=this.getImageSize(y,s),w===null)break;w.width<f&&(a=w.width,this._cellTypeMetaData.HorizontalAlignment===n.CellHorizontalAlignment.Center?c=c+f/2-a/2:this._cellTypeMetaData.HorizontalAlignment==n.CellHorizontalAlignment.Right&&(c=c+f-a));w.height<e&&(v=w.height,this._cellTypeMetaData.VerticalAlignment===n.CellVerticalAlignment.Center?l=l+e/2-v/2:this._cellTypeMetaData.VerticalAlignment===n.CellVerticalAlignment.Bottom&&(l=l+e-v))}break}nt={x:c,y:l,width:a,height:v};n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,r,u,f,e,o,y,p,s.imageLoader,k,d,nt)}},r.prototype.getImageSize=function(t,i){var r=null,u={drawImage:function(n){r=n}};return n.SpreadJSHelpMethods.CellTypeContext.paintBackgroundImage(u,0,0,0,0,t,1,i.imageLoader),r===null?null:{width:r.width,height:r.height}},r.prototype.allowTriggerCommand=function(n,t,r){var u=this._cellMetaData.CellType;return u&&u.CommandList?i.shouldUsePointerCursor(u.CommandList):!1},r}(e);n.SpreadJSViewImageCellType=o;t.register(o.shouldUse,o.createInstance);v=function(i){function r(t,r,u,f,e,o){var s=i.call(this,r,u,f,e,o)||this,h=!t.canEditInForguncy;return s._isReadOnly=n.Common.IsEmpty(h)===!0?!1:h,s._canEdit=t.canEditInForguncy,s._defaultImagePath=n.ImageHelper.getImageSrcFromCellContentElement(r),s._uploadImageLimit=r.CellType.UploadImageLimit,s}return __extends(r,i),r.shouldUse=function(t,i,r){return i.cellType.constructor===n.UploadImageCellType},r.createInstance=function(n,t,i){return new r(t,i,n.oddRowBackcolor,n.evenRowBackcolor,n.listViewStyleTemplate,t.columnInfo.Width)},r.prototype.paint=function(t,r,u,f,e,o,s,h){n.Common.IsEmpty(r)&&(r=this._defaultImagePath);i.prototype.paint.call(this,t,r,u,f,e,o,s,h)},r.prototype.paintValue=function(n,t,i,r,u,f,e,o){},r.prototype._canUpLoadImage=function(){return this._canEdit&&!this._isReadOnly&&!n.Platform.isMobile()},r.prototype.onClick=function(i){n.Common.uploadImage(this._uploadImageLimit,n.UploadImageCellType.allowDragFileType,function(r){var u=n.ForguncyData.ForguncyRoot+"Upload/"+r;t.executeEditCommand(i.sheet,i.row,i.col,u,!1)},function(t,i){var r,u;t&&(u=((r=i)===null||r===void 0?void 0:r.status)==401?n.RS.UnauthorizedUpload:t,alert(u))},null,!0)},r.prototype.allowTriggerCommand=function(n,t,i){return this._canUpLoadImage()?!0:!1},r}(o);n.SpreadJSViewUploadImageCellType=v;t.register(v.shouldUse,v.createInstance);y=function(r){function u(t,i,u,f,e){var h,o=r.call(this)||this,s,c,l;return o.oddRowBackcolor=u,o.evenRowBackcolor=f,o._listViewStyleTemplate=e,o._startX=10,o._fileVerticalSpace=5,o._addFileButtonPadding=1,o._addFileButtonWidth=20,s=o,c=!t.canEditInForguncy,s._isReadOnly=n.Common.IsEmpty(c)===!0?!1:c,s._canEdit=t.canEditInForguncy,l=i.StyleInfo,s._font=n.ListViewHelper.SpreadJSStyleHelper.generateFontText(l),s._fileLimit=i.CellType.UploadLimit,s._fileLimitId=(h=i.ServerPropertiesId)===null||h===void 0?void 0:h.UploadLimit,o}return __extends(u,r),u.prototype._canModifyFile=function(){return this._canEdit&&!this._isReadOnly&&!n.Platform.isMobile()},u.shouldUse=function(t,i,r){return i.cellType.constructor===n.AttachmentCellType},u.createInstance=function(n,t,i){return new u(t,i,n.oddRowBackcolor,n.evenRowBackcolor,n.listViewStyleTemplate)},u.prototype.paint=function(t,r,u,f,e,o,s,h){t&&(s=i.setAlternativeRowColor(h.row,this.oddRowBackcolor,this.evenRowBackcolor,s,this._listViewStyleTemplate),h&&h.parentBackColor&&h.parentBackColor===s.backColor||n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,u,f,e,o,s.backColor,s.backgroundImage,s.backgroundImageLayout,h.imageLoader),this.paintValue(t,r,u,f,e,o,s,h))},u.prototype.paintValue=function(n,t,i,r,u,f,e,o){var h,c,k,l,a,p,v,s,y;if(n)try{if(n.save(),n.rect(i,r,u,f),n.clip(),n.beginPath(),h=this,c=o.sheet,c){var w=h._getFileNames(t),d=h._startX+i,b=r;for(n.font=e.font,n.textAlign="left",n.fillStyle=e.foreColor,k=h._getActualFileCount(t),l=0;l<k;l++)a=h._getTextWidth(w[l],c),h._canModifyFile()&&(p=u-h._addFileButtonWidth-h._addFileButtonPadding*2-h._startX,a>p&&(a=p)),h.paintText(n,t,d,b,a+5,h._getTextHeight(c)+3,e,o,w[l],{value:null}),b+=h._getTextHeight(c)+h._fileVerticalSpace;this._canModifyFile()&&(v=new GC.Spread.Sheets.Rect(i,r,u,f),s=this._getAddFileButtonRect(v),s.x+=v.x,s.y+=v.y,y=n.createLinearGradient(s.x+s.width/2,s.y,s.x+s.width/2,s.y+s.height),y.addColorStop(0,"#ECECEC"),y.addColorStop(1,"#D5D5D5"),n.shadowBlur=2,n.shadowColor="black",n.fillStyle=y,n.fillRect(s.x,s.y,s.width,s.height),h._paintUploadIcon(n,s))}}finally{n.restore()}},u.prototype._paintUploadIcon=function(n,t){try{n.save();var i=5,c=10,e=5,l=4,s=2,h=3,a=16,o=2,f=a,v=i+e+s+o,r=t.y+(t.height-v)/2,u=t.x+(t.width-f)/2;n.fillStyle="#4F4F4F";n.shadowBlur=0;n.fillRect(u,r+i+e+s,a,o);n.fillRect(u,r+i+e+s-h,o,h);n.fillRect(u+f-o,r+i+e+s-h,o,h);n.fillRect(u+(f-l)/2,r+i,l,e);n.moveTo(u+f/2,r);n.lineTo(u+(f-c)/2,r+i);n.lineTo(u+(f-c)/2+c,r+i);n.fill()}finally{n.restore()}},u.prototype.onClick=function(t){var i=t.sheet.getValue(t.row,t.col,t.sheetArea),r=n.Common.IsEmpty(i)?"":i.toString();this._doFileCommand(r,this._getFileCommand(r,t),t)},u.prototype._getFileCommand=function(n,t){var r=this._getFileNames(n),e=t.x-t.cellRect.x,u=t.y-t.cellRect.y,f=this._getAddFileButtonRect(t.cellRect),i;return e>=f.x&&e<=f.x+f.width&&u>=f.y&&u<=f.y+f.height?{command:0}:r.length===0||!this._isHitFileRange(r,e,u,t.sheet)?{command:2}:(i=Math.ceil(u/this._getFileItemHeight(r,t.sheet)),u>=this._getFileItemHeight(r,t.sheet)*i-this._fileVerticalSpace&&u<=this._getFileItemHeight(r,t.sheet)*i)?{command:2}:i>this._getActualFileCount(n)?{command:2}:(--i,e>=this._startX&&e<=this._startX+this._getTextWidth(r[i],t.sheet)?{command:1,fileIndex:i}:{command:2})},u.prototype._isHitFileRange=function(n,t,i,r){var u=this._getFileNameMaxWidth(n,r),f=this._getFileItemHeight(n,r)*n.length;return t>=this._startX&&t<=this._startX+u&&i>=0&&i<=f?!0:!1},u.prototype._doFileCommand=function(n,t,i){switch(t.command){case 0:this._addAttachment(n,i);return;case 1:this._downloadAttachment(this._getFileFullNames(n)[t.fileIndex]);return;case 2:default:return}},u.prototype._addAttachment=function(i,r){var f,u;if(this._canModifyFile()){if(this._isOverMaxUploadCount(i)){alert(n.RS.uploadFileBiggerThanMaxFileCount);return}this._fileLimit&&(f=this._fileLimit.ExtensionFilter);u=this;n.Common.updateFile(f,!0,function(f){var e=r.sheet,o=r.row,s=r.col,h=e.getValue(o,s),c;if(i=n.Common.IsEmpty(h)?"":h.toString(),u._isOverMaxUploadCount(i)){alert(n.RS.uploadFileBiggerThanMaxFileCount);return}c=u._getFileNames(i).length===0?f+"|":i+f+"|";t.executeEditCommand(e,o,s,c,!1)},function(n){n&&alert(n)},this._fileLimit,this._fileLimitId,null,!0)}},u.prototype._downloadAttachment=function(t){var i=n.DomUtilities.createJqueryDomElement("a");i.append(n.DomUtilities.createJqueryDomElement("p"));i.attr("href",n.ForguncyData.ForguncyRoot+"FileDownloadUpload/Download?file="+encodeURIComponent(t));i.children("p").trigger("click");i=null},u.prototype.getAutoFitWidth=function(n,t,i,u,f){if(f){var e=this;return e._canModifyFile()?e._startX+e._getFileNameMaxWidth(e._getFileNames(n),f.sheet)+e._addFileButtonPadding*2+e._addFileButtonWidth:e._startX+e._getFileNameMaxWidth(e._getFileNames(n),f.sheet)}else return r.prototype.getAutoFitWidth.call(this,n,t,i,u,f)},u.prototype.getAutoFitHeight=function(n,t,i,u,f){if(f){var e=this,o=e._getFileNames(n);return e._getFileItemHeight(o,f.sheet)*o.length}else return r.prototype.getAutoFitHeight.call(this,n,t,i,u,f)},u.prototype._isOverMaxUploadCount=function(n){var t=this,i=t._getFileNames(n);if(t._fileLimit&&t._fileLimit.MaxUploadFileCount){if(i.length>=t._fileLimit.MaxUploadFileCount)return!0}else return!1},u.prototype._getActualFileCount=function(n){var t=this,i=t._getFileNames(n);return t._isOverMaxUploadCount(n)?t._fileLimit.MaxUploadFileCount:i.length},u.prototype._getAddFileButtonRect=function(n){var t=this,i=n.width-t._addFileButtonWidth-t._addFileButtonPadding,r=t._addFileButtonPadding,u=t._addFileButtonWidth,f=n.height-t._addFileButtonPadding*2;return new GC.Spread.Sheets.Rect(i,r,u,f)},u.prototype._getFileFullNames=function(t){if(n.Common.IsEmpty(t)||typeof t!="string")return[];return t.split("|").filter(function(t){return!n.Common.IsEmpty(t)&&t.length>37&&t.charAt(36)==="_"&&n.Common.isForguncyFile(t)&&t.indexOf("<")<0})},u.prototype._getFileNames=function(n){return this._getFileFullNames(n).map(function(n){return n.substring(37)})},u.prototype._getFileNameMaxWidth=function(n,t){var i=this;return Math.max.apply(i,n.map(function(n){return i._getTextWidth(n,t)}))},u.prototype._getFileItemHeight=function(n,t){if(n.length===0)return 0;var i=this;return i._getTextHeight(t)+i._fileVerticalSpace},u.prototype._getTextWidth=function(n,i){return t.getStringWidthByCanvas(n,this._font,i)},u.prototype._getTextHeight=function(n){return t.getTextHeight(this._font,n)},u.prototype.getFileItemPosition=function(t,i,r,u){var f=this,h=u.getValue(t,i),o=u.getCellRect(t,i),e,c,s;if(n.Common.IsEmpty(h))throw new Error("There are no files to select");if(e=f._getFileNames(h.toString()),r<0||r>=e.length)throw new Error("Invalid file index");c=o.x+f._startX;s=o.y;r>0&&(s+=f._getFileItemHeight(e,u)*r);var l=f._getTextWidth(e[r],u),a=o.width-f._addFileButtonWidth-f._addFileButtonPadding*2-f._startX,v=l>a?a:l,y=f._getTextHeight(u);return{x:c,y:s,width:v,height:y}},u.prototype.getAddFileButtonPosition=function(n,t,i){var f=this,u,r;if(!f._canModifyFile())throw Error("There is no Button to add file");return u=i.getCellRect(n,t),r=f._getAddFileButtonRect(u),r.x+=u.x,r.y+=u.y,{x:r.x,y:r.y,width:r.width,height:r.height}},u.prototype.allowTriggerCommand=function(n,t,i){return this._canModifyFile()||n.getValue(t,i)?!0:!1},u}(e);n.SpreadJSViewAttachmentCellType=y;t.register(y.shouldUse,y.createInstance);p=function(t){function r(n,i,r,u){var f=t.call(this)||this;return f._cellMetaData=n,f._oddRowBackcolor=i,f._evenRowBackcolor=r,f._listViewStyleTemplate=u,f.typeName="SpreadJSViewBarcodeCellType",f._cellTypeMetaData=f._cellMetaData.CellType,f}return __extends(r,t),r.shouldUse=function(t,i,r){return i.cellType.constructor===n.BarcodeCellType},r.createInstance=function(n,t,i){return new r(i,n.oddRowBackcolor,n.evenRowBackcolor,n.listViewStyleTemplate)},r.prototype.paint=function(n,r,u,f,e,o,s,h){s=i.setAlternativeRowColor(h.row,this._oddRowBackcolor,this._evenRowBackcolor,s,this._listViewStyleTemplate);this.paintBackground(n,r,u,f,e,o,s.backColor,s.foreColor,h);s.backColor=undefined;t.prototype.paint.call(this,n,null,u,f,e,o,s,h)},r.prototype.paintBackground=function(t,i,r,u,f,e,o,s,h){if(t){var c=GC.Spread.Sheets.ImageLayout.zoom,l=n.BarcodeCellType.GetRequestParam(i,this._cellTypeMetaData,f,e,o,s,this),a=n.ForguncyData.ForguncyRoot+"Barcode/GetBarcodeImage?data="+encodeURIComponent(JSON.stringify(l));n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,r,u,f,e,o,a,c,h.imageLoader)}},r}(GC.Spread.Sheets.CellTypes.Base);n.SpreadJSViewBarcodeCellType=p;t.register(p.shouldUse,p.createInstance);s=function(t){function i(n,i,r,u,f,e,o,s){var h=t.call(this,r,u,s)||this;return h._columnInfo=n,h._spreadJSTopLocation=i,h._calcSheetName=f,h._locatedPageID=e,h.runTimePageName=o,h._haveAddValidationRule=!1,h._isEditorVisible=!1,h._textCache={},h.typeName="SpreadJSEditCellType",h}return __extends(i,t),i.shouldUse=function(n,t,i){return t.canEnterEditMode?h.shouldUse(n,t,i)?!1:!0:!1},i.createInstance=function(n,t,r){return new i(t,n.bounds.top,n.oddRowBackcolor,n.evenRowBackcolor,n.getCalcSheetName(),n.locatedPageID,n.runTimePageName,n.listViewStyleTemplate)},i.prototype.format=function(n,i,r,f){var e,o;if(!this._columnInfo||!this._columnInfo.getTemplateCell())return t.prototype.format.call(this,n,i,r);try{return o=u.getDisplayText(n,this._columnInfo.getTemplateCell(),this.runTimePageName,i,r),this._textCache[n+""]=o,o}catch(s){return e=this._textCache[n+""],e!==null&&e!==void 0?e:n+""}},i.prototype.createEditorElement=function(t,i){var e,o,f,s,r;this.destroy();this._isEditorVisible=!1;this._cellType=u.getCell(this._columnInfo.getTemplateCell(),this.runTimePageName).cellType;e=this._columnInfo.columnInfo.BindingColumnDataType;o=[n.ColumnDataType.Other,n.ColumnDataType.String,n.ColumnDataType.User,n.ColumnDataType.Image,n.ColumnDataType.Attachment];o.indexOf(e)>=0&&this._cellType.constructor===n.TextBoxCellType&&(f=this._cellType.getFormatString(),(n.Common.IsEmpty(f)||f.toLowerCase()==="general")&&this._cellType.setFormatString("@"));s=this._cellType.createContent();r=this._cellType;this._haveAddValidationRule=!1;var h=document.createElement("div"),c=this.getHost(),l=n.SpreadJSHelpMethods.util.getPreferredZIndex(c)+1e3,a=n.Common.getIdStr(t.row,t.col,this._columnInfo.idSuffix);return $(h).attr(n.StaticValues.InnerID,a).css("position","absolute").css("z-index",l).attr("gcuielement","gcEditingInput").append(s),n.Platform.isIE()&&!n.Platform.isOldEdge()&&r instanceof n.InputManCellTypeBase&&r.bindInputManEvent(n.InputManEvent.keydown,function(n){t&&t.sheet&&!t.sheet.isEditing()&&(n.Cancel=!0)}),$(i).attr("id",r.ID+"_div"),$(i).css("overflow",""),n.ValidationTooltipHelper.setTooltipAttr($(i)),h},i.prototype.getHost=function(n){if(!n||!n.sheet)return null;var t=n.sheet.getParent();return t?t.getHost():null},i.prototype.destroy=function(){this._cellType&&(u.destroyEditor(this._cellType),this._cellType=null,this._haveAddValidationRule=!1)},i.prototype.deactivateEditor=function(i,r){this._isEditorVisible=!1;i&&n.ValidationTooltipHelper.destroyTooltip($(i));t.prototype.deactivateEditor.call(this,i,r)},i.prototype.getEditorValue=function(t,i){if(this._cellType){var r=this._cellType;return r instanceof n.InputManCellTypeBase&&r.canInput()&&$("#"+this._cellType.ID).blur(),u.getEditorValue(this._cellType.ID,this._cellType,this._columnInfo.columnInfo.BindingColumnDataType)}},i.prototype.setEditorValue=function(t,i,r){var u,o;if(this._cellType&&(!this._isEditorVisible||!n.Platform.isIpad())){var s=n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName),f=s.mappedRowIndexFrowView(r.row),e=this.getListDataModel();i=e?e.getValue(f,this._columnInfo.getColumnIndex()):null;this.shouldUseDefaultValue(i,r)&&(u=this.getDefaultValue(f),n.Common.IsEmpty(u)||(i=u));this._cellType.canInputChars()&&(o=(!GC.Spread.Sheets.util.browser.msie||parseFloat(GC.Spread.Sheets.util.browser.version)<11)&&(r&&r.sheet&&this.isStartEditByKeydown(r)?!0:!1),o&&(i=null));this._cellType.setValueToElement($(t).find("#"+this._cellType.ID),i)}},i.prototype.isStartEditByKeydown=function(t){var i={value:null};return GC.Spread.Sheets.CellTypes.Text.prototype.setEditorValue(i,"text",t),n.Common.IsEmpty(i.value)},i.prototype.shouldUseDefaultValue=function(t,i){var r;if(!n.Common.IsEmpty(t)||!n.ForguncyData.pageInfo.dataModel||!i||!this._calcSheetName||(r=this.getListDataModel(),!r))return!1;var u=n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName),f=u.mappedRowIndexFrowView(i.row),e=r.getRowInfo(f);return n.Common.IsEmpty(e)?!0:!1},i.prototype.getListDataModel=function(){return n.Common.IsEmpty(this._calcSheetName)?null:n.ForguncyData.pageInfo.dataModel.getListDataByCalcSheetName(this._calcSheetName)},i.prototype.selectAll=function(n,t){this._cellType&&this._cellType.selectAll()},i.prototype.focus=function(t,i){var r;if(this._cellType&&t){if(n.Platform.isIpad()&&!this._isEditorVisible&&t&&i&&i.sheet){if(r=i.sheet.getValue(i.row,i.col),this.shouldUseDefaultValue(r,i)){var f=n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName),e=f.mappedRowIndexFrowView(i.row),u=this.getDefaultValue(e);n.Common.IsEmpty(u)||(r=u)}this._cellType.setValueToElement($(t).find("#"+this._cellType.ID),r)}this._cellType.focus();this._cellType.setCaretAtLast()}},i.prototype.getDefaultValue=function(n){var t=this.getListDataModel();return t?this._columnInfo.getDefaultValue(t.name,this.runTimePageName,n):null},i.prototype.activateEditor=function(t,i,r,u){if(this._cellType){this._isEditorVisible=!0;var f=t&&u&&u.sheet;f&&(this._editorRect=new GC.Spread.Sheets.Rect(null,null,null,null),this.updateEditorRect(t,r,u),this.upadateEditorStyle(t,i,f),this.attachAttrToDropDown(),n.ValidationTooltipHelper.changeTooltipPlacement(n.ValidationTooltipHelper.getToolTipElement($(t)),r.y+this._spreadJSTopLocation))}},i.prototype.upadateEditorStyle=function(t,i,r){var u,f,e,o,s,h;t&&i&&(u=!1,f=!1,i.font&&typeof i.font=="string"&&(e=i.font.toLowerCase(),u=e.indexOf("italic")!==-1,f=e.indexOf("bold")!==-1),o=!1,s=!1,i.textDecoration&&(o=(i.textDecoration&GC.Spread.Sheets.TextDecorationType.lineThrough)===GC.Spread.Sheets.TextDecorationType.lineThrough,s=(i.textDecoration&GC.Spread.Sheets.TextDecorationType.underline)===GC.Spread.Sheets.TextDecorationType.underline),h=i.backColor?i.backColor:"white",$(t).css("background-color",n.ColorHelper.Convert(h)),this._cellType.setStyle(i.backColor,i.foreColor,this._columnInfo.getTemplateCell().StyleInfo.FontSize,u,f,s,o))},i.prototype.attachAttrToDropDown=function(){var n=this._cellType.getDropDownObj();n&&$(n).attr("gcuielement","fgcDropDownWindow")},i.prototype.updateEditor=function(t,i,r,u){if(this._cellType){var f=this.updateEditorRect(t,r,u);f&&n.ValidationTooltipHelper.destroyTooltip($(t))}},i.prototype.updateEditorRect=function(t,i,r){var f=!1,s=t&&r&&r.sheet,u,o;if(s&&!this.isRectInvalid(i)){var h=s.getParent(),c=n.SpreadJSView.getBounds(h.name),e=void 0;e=r.canvasOffset?r.canvasOffset:n.SpreadJSView.getCanvasPosition(h.name);u=new GC.Spread.Sheets.Rect(e.left+c.x+i.x,e.top+c.y+i.y,i.width-1,i.height-1);o=$(t);(this._editorRect.x!==u.x||this._editorRect.y!==u.y)&&(f=!0);this._editorRect.width!==u.width&&(o.width(u.width),f=!0);this._editorRect.height!==u.height&&(o.height(u.height),f=!0);this._editorRect=u}return f},i.prototype.isRectInvalid=function(n){return!n||n.x===undefined||n.y===undefined||n.width===undefined||n.height===undefined},i.prototype.updateImeMode=function(n,i,r){t.prototype.updateImeMode.call(this,n,i,r)},i.prototype.isReservedKey=function(n,t){var r=n.srcElement||n.target,i;return r&&t&&t.isEditing&&(i=this._columnInfo.cellType.getIgnoreKeysInListview(),i&&i.indexOf(n.keyCode)>=0||n.keyCode===GC.Spread.Commands.Key.z&&n.ctrlKey&&!n.altKey||n.keyCode===GC.Spread.Commands.Key.y&&n.ctrlKey&&!n.altKey||n.keyCode===GC.Spread.Commands.Key.c&&n.ctrlKey&&!n.altKey||n.keyCode===GC.Spread.Commands.Key.x&&n.ctrlKey&&!n.altKey||n.keyCode===GC.Spread.Commands.Key.v&&n.ctrlKey&&!n.altKey)?!0:!1},i.prototype.isEditingValueChanged=function(n,t,i){return!u.equals(n,t)},i.prototype.isImeAware=function(n){return!0},i.prototype.validate=function(t,i){if(!this._cellType)return!0;if(i)return n.ValidationTooltipHelper.showTooltip(this._cellType.getContainer()[0],i.message),!1;var r=n.ValidationMananger.validateCell(this._cellType);return r===0?!0:(this._cellType instanceof n.InputManCellTypeBase&&this._cellType.canInput()&&this._cellType.focus(),!1)},i.prototype.hideValidationTooltip=function(){var t,i;this._cellType&&(t=n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName),t)&&(i=t.getContainerDiv().find("[name='"+this._cellType.ID+"']"),i.length>0&&n.ValidationTooltipHelper.destroyTooltip(i))},i.prototype.toJSON=function(){return null},i}(nt);n.SpreadJSEditCellType=s;t.register(s.shouldUse,s.createInstance);h=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.shouldUse=function(t,i,r){return i.canEnterEditMode?i.cellType.constructor===n.ComboBoxCellType_InputMan||i.cellType.constructor===n.UserSelectorCellType_InputMan||i.cellType.constructor===n.TimeCellType_InputMan:!1},i.createInstance=function(n,t,r){return new i(t,n.bounds.top,n.oddRowBackcolor,n.evenRowBackcolor,n.getCalcSheetName(),n.locatedPageID,n.runTimePageName,n.listViewStyleTemplate)},i.prototype.createEditorElement=function(i,r){var e=t.prototype.createEditorElement.call(this,i,r),u=this.getGcCombobox(),f;return u&&(f=this,this._onDropDownOpenedCallBack=function(n,t){f.onDropDownOpen()},u.addEventListener(GC.InputMan.GcComboBoxEvent.DropDownOpened,this._onDropDownOpenedCallBack),this._onDropDownClosedCallBack=function(t,r){n.DelayRefresh.setTimeout(function(){f.onDropDownClose(i.sheet)})},u.addEventListener(GC.InputMan.GcComboBoxEvent.DropDownClosed,this._onDropDownClosedCallBack)),e},i.prototype.onDropDownOpen=function(){var n=this.getGcCombobox();this._cachedSelectedIndex=n?n.getSelectedIndex():-1},i.prototype.onDropDownClose=function(n){var t,i;n.isEditing()&&this._isEditorVisible&&(t=this.getGcCombobox(),t)&&(i=t.getSelectedIndex(),i!==-1&&i!==this._cachedSelectedIndex)&&n.endEdit()},Object.defineProperty(i.prototype,"_gcComboBox",{get:function(){return this._cellType?this._cellType.getControl():null},enumerable:!0,configurable:!0}),i.prototype.getGcCombobox=function(){return this._cellType?this._cellType.getControl():null},i.prototype.activateEditor=function(n,i,r,u){var e,f;if(t.prototype.activateEditor.call(this,n,i,r,u),this._cachedSelectedIndex=-1,e=n&&u&&u.sheet,e){if(f=this.getGcCombobox(),!f)return;this._cachedSelectedIndex=f.getSelectedIndex()}},i.prototype.isReservedKey=function(n,i){return t.prototype.isReservedKey.call(this,n,i)?!0:this._gcComboBox&&(n.srcElement||n.target)&&i&&i.isEditing&&this._cellType.isDropDownOpened()&&n.keyCode===GC.Spread.Commands.Key.enter?!0:!1},i.prototype.getAutoFitHeight=function(n,i,r,u,f){return t.prototype.getAutoFitHeight.call(this,i,i,r,u,f)},i.prototype.destroy=function(){var n=this.getGcCombobox();n&&(this._onDropDownOpenedCallBack&&n.removeEventListener(GC.InputMan.GcComboBoxEvent.DropDownOpened,this._onDropDownOpenedCallBack),this._onDropDownClosedCallBack&&n.removeEventListener(GC.InputMan.GcComboBoxEvent.DropDownClosed,this._onDropDownClosedCallBack));t.prototype.destroy.call(this)},i}(s);n.ComboboxEditorCellType=h;t.register(h.shouldUse,h.createInstance);tt=function(){function n(){}return n}();n.SpreadJSCellTypeContextArg=tt;ft=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(tt);n.IsReservedKeyContextArg=ft;u=function(){function t(){}return t.equals=function(n,t){return n===0&&t===""||n===""&&t===0?!1:n===null&&t===""||n===""&&t===null?!0:n==t?!0:n instanceof Date&&t instanceof Date&&n.valueOf()===t.valueOf()?!0:!1},t.getEditorValue=function(t,i,r){var u=[n.ColumnDataType.Other,n.ColumnDataType.String,n.ColumnDataType.User,n.ColumnDataType.Image,n.ColumnDataType.Attachment];return i.getValue(u.indexOf(r)>=0)},t.getEditorID=function(){return t.editorIDPrefix+n.Common.getUniqueNumber().toString()},t.getCell=function(i,r){if(!i)return null;var f=t.getEditorID(),u=n.Common.clone(i);return u.Value=null,new n.NormalCell(u,1,f,r)},t.destroyEditor=function(n){n&&n.destroy()},t.getDisplayText=function(i,r,u,f,e){var o=t.getCell(r,u).cellType,h=o.getFormatString(),s;return s=typeof f=="string"?f:f instanceof GC.Spread.Formatter.GeneralFormatter?!n.Common.IsEmpty(h)&&f.isAuto?null:f.formatString():null,o.getListviewNoneEditModeText(i,e,s)},t.editorIDPrefix="a",t}();n.ListivewEditorHelper=u;it=function(i){function r(n){var t=i.call(this)||this;return t._listViewStyleTemplate=n,t.typeName="SpreadJSRowHeaderCellType",t}return __extends(r,i),r.prototype.paint=function(n,u,f,e,o,s,h,c){var a=this.getThemeStyle(c.visualState,"gc-rowHeader-"+t.getVisualStateName(c.visualState)),l;h=t.getCustomStyle(h,a,this._listViewStyleTemplate,c.visualState);l=c.visualState;c.visualState=GC.Spread.Sheets.VisualState.normal;i.prototype.paint.call(this,n,u,f,e,o,s,h,c);c.visualState=l;r.paintGridline(n,f,e,o,s,h)},r.paintGridline=function(t,i,r,u,f,e){!e.borderTop||!e.borderBottom||n.Common.IsEmpty(e.borderTop.color)||n.Common.IsEmpty(e.borderBottom.color)||(t.beginPath(),t.strokeStyle=t.createLinearGradient(i,r,i+u-2,r),t.strokeStyle.addColorStop(0,e.borderTop.color),t.strokeStyle.addColorStop(1,e.borderBottom.color),t.moveTo(i,r+.5),t.lineTo(i+u,r+.5),t.moveTo(i,r+f-.5),t.lineTo(i+u,r+f-.5),t.stroke());!e.borderRight||n.Common.IsEmpty(e.borderRight.color)||(t.beginPath(),t.strokeStyle=e.borderRight.color,t.moveTo(i+u-.5,r+1),t.lineTo(i+u-.5,r+f),t.stroke());!e.borderLeft||n.Common.IsEmpty(e.borderLeft.color)||(t.beginPath(),t.strokeStyle=e.borderRight.color,t.moveTo(i+.5,r+1),t.lineTo(i+.5,r+f),t.stroke())},r.prototype._getForeColor=function(n,i){if(i.visualState!==GC.Spread.Sheets.VisualState.hover)return n.foreColor;var r=this.getThemeStyle(i.visualState,"gc-rowHeader-"+t.getVisualStateName(GC.Spread.Sheets.VisualState.hover));return r.color},r}(GC.Spread.Sheets.CellTypes.RowHeader);n.SpreadJSRowHeaderCellType=it;w=function(i){function r(n){var t=i.call(this)||this;return t._listViewStyleTemplate=n,t.typeName="SpreadJSColumnHeaderCellType",t}return __extends(r,i),r.prototype.paint=function(n,r,u,f,e,o,s,h){var l=this.getThemeStyle(this._getVisualState(h),"gc-columnHeader-"+t.getVisualStateName(h.visualState)),c;s=t.getCustomStyle(s,l,this._listViewStyleTemplate,h.visualState);c=h.visualState;h.visualState=GC.Spread.Sheets.VisualState.normal;i.prototype.paint.call(this,n,r,u,f,e,o,s,h);h.visualState=c;this.paintGridline(n,u,f,e,o,s)},r.prototype.paintGridline=function(t,i,r,u,f,e){!e.borderLeft||!e.borderRight||n.Common.IsEmpty(e.borderLeft.color)||n.Common.IsEmpty(e.borderRight.color)||(t.beginPath(),t.strokeStyle=t.createLinearGradient(i,r+1,i,r+f-2),t.strokeStyle.addColorStop(0,e.borderLeft.color),t.strokeStyle.addColorStop(1,e.borderRight.color),t.moveTo(i+.5,r),t.lineTo(i+.5,r+f),t.moveTo(i+u-.5,r),t.lineTo(i+u-.5,r+f),t.stroke());!e.borderBottom||n.Common.IsEmpty(e.borderBottom.color)||(t.beginPath(),t.strokeStyle=e.borderBottom.color,t.moveTo(i+1,r+f-.5),t.lineTo(i+u,r+f-.5),t.stroke())},r.prototype._getForeColor=function(n,i){var r=this._getVisualState(i),u;return r===GC.Spread.Sheets.VisualState.normal&&n.foreColor?n.foreColor:(u=this.getThemeStyle(i.visualState,"gc-columnHeader-"+t.getVisualStateName(r)),u.color)},r.prototype._getVisualState=function(n){var t=n.visualState===undefined?GC.Spread.Sheets.VisualState.normal:n.visualState;return t!==GC.Spread.Sheets.VisualState.normal&&this._isActiveColumn(n.sheet,n.col)&&(t=this._isSelectedColumn(n.sheet,n.col)?GC.Spread.Sheets.VisualState.selected:GC.Spread.Sheets.VisualState.highlight),t},r.prototype._isActiveColumn=function(n,t){for(var i,u=n.getSelections(),r=0;r<u.length;r++)if((i=u[r],i.col===-1||i.colCount===-1)||i.col<=t&&i.col+i.colCount>t)return!0;return!1},r.prototype._isSelectedColumn=function(n,t){for(var i,u=n.getSelections(),r=0;r<u.length;r++)if((i=u[r],i.row===-1||i.rowCount===-1)&&i.col<=t&&i.col+i.colCount>t)return!0;return!1},r}(GC.Spread.Sheets.CellTypes.ColumnHeader);n.SpreadJSColumnHeaderCellType=w;et=function(t){function r(n,i,r){var u=t.call(this,r)||this;return u._columnInfo=n,u._calcSheetName=i,u.WIDTH=10,u.HEIGHT=8,u.SPACE=5,u.typeName="SpreadJSSortHeaderCellType",u}return __extends(r,t),r.prototype.paint=function(n,i,r,u,f,e,o,s){t.prototype.paint.call(this,n,i,r,u,f,e,o,s);this._paintSortIcon(n,r,u,f,e,o,s)},r.prototype._paintSortIcon=function(n,t,i,r,u,f,e){if(this.isSortIconShow()){var o=this._columnInfo.sortInfo;n.save();n.beginPath();o===0?this._paintASCIcon(n,t,i,r,u):this._paintDESCIcon(n,t,i,r,u);n.fillStyle!==f.foreColor&&(n.fillStyle=f.foreColor);n.fill();n.restore()}},r.prototype._paintASCIcon=function(n,t,i,r,u){var f=t+r-this.SPACE-this.WIDTH/2,e=i+u/2-this.HEIGHT/2;n.moveTo(f,e);n.lineTo(f-this.WIDTH/2,e+this.HEIGHT);n.lineTo(f+this.WIDTH/2,e+this.HEIGHT);n.lineTo(f,e)},r.prototype._paintDESCIcon=function(n,t,i,r,u){var f=t+r-this.SPACE-this.WIDTH,e=i+u/2-this.HEIGHT/2;n.moveTo(f,e);n.lineTo(f+this.WIDTH/2,e+this.HEIGHT);n.lineTo(f+this.WIDTH,e);n.lineTo(f,e)},r.prototype.getAutoFitWidth=function(n,i,r,u,f){var e=t.prototype.getAutoFitWidth.call(this,n,i,r,u,f);return e+this.WIDTH+this.SPACE*2},r.prototype.isSortIconShow=function(){return n.PrintCommand.IsPrinting?!1:this._columnInfo.sortInfo===0||this._columnInfo.sortInfo===1},r.prototype.paintContent=function(n,i,r,u,f,e,o,s){f=this._adjustTextAreaWidth(f);t.prototype.paintContent.call(this,n,i,r,u,f,e,o,s)},r.prototype._adjustTextAreaWidth=function(n){return this.isSortIconShow()&&(n=n-this.WIDTH-this.SPACE*2),n},r.prototype.getHitInfo=function(n,t,r,u,f){return i.getHitInfo(n,t,r,u,GC.Spread.Sheets.SheetArea.colHeader,f)},r.prototype.processMouseDown=function(n){return i.processMouseDown(this,n)},r.prototype.processMouseUp=function(n){return i.processMouseUp(this,n,n.row,n.col,GC.Spread.Sheets.SheetArea.colHeader)},r}(w);n.SpreadJSSortHeaderCellType=et;ot=function(t){function u(n,i,r){var u=t.call(this,r)||this;return u._columnInfo=n,u._calcSheetName=i,u.imageSize=16,u.spaceWidth=1,u.typeName="SpreadJSFilterHeaderCellType",u}return __extends(u,t),Object.defineProperty(u,"supportedTypes",{get:function(){return[n.ColumnDataType.Bool,n.ColumnDataType.Number,n.ColumnDataType.Date,n.ColumnDataType.Time,n.ColumnDataType.String,n.ColumnDataType.User]},enumerable:!0,configurable:!0}),u.createImage=function(n){var t=new Image;return t.src=n,t},u.prototype.paint=function(n,i,r,u,f,e,o,s){t.prototype.paint.call(this,n,i,r,u,f,e,o,s);this.paintFilterIcon(n,r,u,f,e,o,s)},u.prototype.paintContent=function(n,i,r,u,f,e,o,s){var h=f-this.imageSize;t.prototype.paintContent.call(this,n,i,r,u,h,e,o,s)},u.prototype.getAutoFitWidth=function(n,i,r,u,f){var e=t.prototype.getAutoFitWidth.call(this,n,i,r,u,f);return e+this.imageSize+this.spaceWidth*2},u.prototype.getHitInfo=function(n,r,u,f,e){var o=i.getHitInfo(n,r,u,f,GC.Spread.Sheets.SheetArea.colHeader,e);return o&&this.destRect.contains(o.x,o.y)?o:t.prototype.getHitInfo.call(this,n,r,u,f,e)},u.prototype.processMouseDown=function(n){return n&&this.destRect.contains(n.x,n.y)?i.processMouseDown(this,n):t.prototype.processMouseDown.call(this,n)},u.prototype.processMouseUp=function(n){return n&&this.destRect.contains(n.x,n.y)?i.processMouseUp(this,n,n.row,n.col,GC.Spread.Sheets.SheetArea.colHeader):t.prototype.processMouseUp.call(this,n)},u.prototype.processMouseMove=function(n){return n&&this.destRect.contains(n.x,n.y)?i.processMouseMove(n):i.processMouseLeave(n)},u.prototype.processMouseLeave=function(n){return i.processMouseLeave(n)},u.prototype.paintFilterIcon=function(t,i,r,f,e,o,s){var l=this.imageSize,a=-2,h=l,c=l;f<l-a&&(h=f+a);this.destRect=new GC.Spread.Sheets.Rect(i+f-h+a,r+e/2-c/2,h,c);var v=u.iconsCache,y=n.Common.IsEmpty(this._columnInfo.sortInfo)?"null":this._columnInfo.sortInfo.toString(),p=n.Common.IsEmpty(this._columnInfo.filterValues)&&n.Common.IsEmpty(this._columnInfo.filterConditions)?"null":"filter",w=v[y+p];h<=0||c<=0||Math.floor(this.destRect.width)<=0||Math.floor(this.destRect.height)<=0||t.drawImage(w,0,0,h,c,Math.floor(this.destRect.x),Math.floor(this.destRect.y),Math.floor(this.destRect.width),Math.floor(this.destRect.height))},u.iconsCache=(r={},r.nullnull=u.createImage("data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EFilter icon1%3C/title%3E%3Cg fill='%23666' fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='white'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z' fill-rule='nonzero'/%3E%3Cpath d='M8 10L5 7h6z'/%3E%3C/g%3E%3C/svg%3E"),r.nullfilter=u.createImage("data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EFilter icon2%3C/title%3E%3Cg fill='%23666' fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='white'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z' fill-rule='nonzero'/%3E%3Cpath d='M5 13l-2-2h4z'/%3E%3Cpath fill-rule='nonzero' d='M9.429 7.408L6 3h8l-3.429 4.408v2.449L9.429 11V7.408z'/%3E%3C/g%3E%3C/svg%3E"),r[0..toString()+"null"]=u.createImage("data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EFilter icon3%3C/title%3E%3Cg fill='%23666' fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='white'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z' fill-rule='nonzero'/%3E%3Cpath d='M5 13l-2-2h4zM10.5 3L13 6H8zM10 6h1v7h-1z'/%3E%3C/g%3E%3C/svg%3E"),r[1..toString()+"null"]=u.createImage("data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EFilter icon4%3C/title%3E%3Cg fill='%23666' fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='white'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z' fill-rule='nonzero'/%3E%3Cpath d='M5 13l-2-2h4zM10.5 13L8 10h5zM10 3h1v7h-1z'/%3E%3C/g%3E%3C/svg%3E"),r[0..toString()+"filter"]=u.createImage("data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EFilter icon5%3C/title%3E%3Cg fill='%23666' fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='white'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z' fill-rule='nonzero'/%3E%3Cpath fill-rule='nonzero' d='M9.429 7.408L6 3h8l-3.429 4.408v2.449L9.429 11V7.408z'/%3E%3Cpath d='M4.5 5L7 8H2zM4 8h1v5H4z'/%3E%3C/g%3E%3C/svg%3E"),r[1..toString()+"filter"]=u.createImage("data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EFilter icon6%3C/title%3E%3Cg fill='%23666' fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='white'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z' fill-rule='nonzero'/%3E%3Cpath fill-rule='nonzero' d='M9.429 7.408L6 3h8l-3.429 4.408v2.449L9.429 11V7.408z'/%3E%3Cpath d='M4.5 13L2 10h5zM4 5h1v5H4z'/%3E%3C/g%3E%3C/svg%3E"),r),u}(w);n.SpreadJSFilterHeaderCellType=ot;b=function(t){function r(i,r,u,f,e,o){var s=t.call(this)||this,h,c;return s._oddRowBackcolor=u,s._evenRowBackcolor=f,s._calcSheetName=e,s._listViewStyleTemplate=o,h=r.CellType.Caption,c=r.CellType.ReadOnly,s._isReadOnly=n.Common.IsEmpty(c)===!0?!1:c,s._canEdit=i.canEditInForguncy,n.Common.IsEmpty(h)||s.caption(h),s}return __extends(r,t),r.shouldUse=function(t,i,r){return i.cellType.constructor===n.CheckBoxCellType&&!i.cellType.cellTypeData.canEnterEditModeInListview()},r.createInstance=function(n,t,i){return new r(t,i,n.oddRowBackcolor,n.evenRowBackcolor,n.getCalcSheetName(),n.listViewStyleTemplate)},r.prototype.getHitInfo=function(n,i,r,u,f){return!f||!this.allowChecked(f.row)?null:t.prototype.getHitInfo.call(this,n,i,r,u,f)},r.prototype.paint=function(n,r,u,f,e,o,s,h){s=i.setAlternativeRowColor(h.row,this._oddRowBackcolor,this._evenRowBackcolor,s,this._listViewStyleTemplate);t.prototype.paint.call(this,n,r,u,f,e,o,s,h)},r.prototype.allowChecked=function(t){return this._canEdit&&!this._isReadOnly&&!n.Platform.isMobile()&&!this.getListview().isCommiting(t)},r.prototype.getListview=function(){return n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName)},r.prototype.processMouseDown=function(n){return n&&n.isReservedLocation&&(this._isMouseDownReservedLocation=!0),t.prototype.processMouseDown.call(this,n)},r.prototype.processMouseUp=function(n){if(!n)return!1;var r=this,i=n.sheet,u=this.getListview(),f=u.mappedRowIndexFrowView(n.row);return r._isMouseDownReservedLocation&&i&&n.isReservedLocation&&(i.getActiveRowIndex()!==n.row||i.getActiveColumnIndex()!==n.col||u.getSelectedRowIndex()!==f)?(r._isMouseDownReservedLocation=!1,!1):this.allowChecked(f)?t.prototype.processMouseUp.call(this,n):!1},r.prototype.processMouseLeave=function(n){return n&&(this._isMouseDownReservedLocation=!1),t.prototype.processMouseLeave.call(this,n)},r.convertValue=function(n){return!!n==!0?1:0},r}(GC.Spread.Sheets.CellTypes.CheckBox);n.CheckBoxCellTypeListView=b;t.register(b.shouldUse,b.createInstance);rt=function(r){function u(n){var t=r.call(this)||this;return t._listViewStyleTemplate=n,t.typeName="CheckBoxRowHeader",t}return __extends(u,r),u.prototype.paint=function(n,i,u,f,e,o,s,h){var c=this.getThemeStyle(h.visualState,"gc-rowHeader-"+t.getVisualStateName(h.visualState));s=t.getCustomStyle(s,c,this._listViewStyleTemplate,h.visualState);r.prototype.paint.call(this,n,i,u,f,e,o,s,h);it.paintGridline(n,u,f,e,o,s)},u.prototype.paintValue=function(t,i,u,f,e,o,s,h){i=!1;var c=h.sheet,l=h.row;n.ListViewHelper.SelectionHelper.isRowSelected(c,l)&&(i=!0);r.prototype.paintValue.call(this,t,i,u,f,e,o,s,h)},u.prototype.getHitInfo=function(n,t,r,u,f){return i.getHitInfo(n,t,r,u,GC.Spread.Sheets.SheetArea.rowHeader,f)},u.prototype.processMouseDown=function(n){return i.processMouseDown(this,n)},u.prototype.processMouseUp=function(n){return i.processMouseUp(this,n,n.row,n.col,GC.Spread.Sheets.SheetArea.rowHeader)},u}(GC.Spread.Sheets.CellTypes.CheckBox);n.CheckBoxRowHeader=rt;st=function(r){function u(){var n=r!==null&&r.apply(this,arguments)||this;return n._isRowHeaderVisible=null,n._isRowHeaderCheckBoxVisible=null,n}return __extends(u,r),u.prototype.getCheckBoxColumnWidth=function(n){var t=n.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)===1?0:1;return n.getColumnWidth(t,GC.Spread.Sheets.SheetArea.rowHeader)-2},u.prototype.getCornerColumnWidth=function(n){return n.getColumnWidth(0,GC.Spread.Sheets.SheetArea.rowHeader)},u.prototype.getHitInfo=function(n,t,u,f,e){var o=e.sheet,s=this._getIsRowHeaderCheckBoxVisible(o);return s?(f.x=0,f.y=0,f.width=this.getCornerColumnWidth(o)+this.getCheckBoxColumnWidth(o),f.height=this._getColHeaderHeight(o),i.getHitInfo(n,t,u,f,GC.Spread.Sheets.SheetArea.corner,e)):r.prototype.getHitInfo.call(this,n,t,u,f,e)},u.prototype.processMouseDown=function(n){var u=this._getIsRowHeaderCheckBoxVisible(n.sheet),t;if(!u)return r.prototype.processMouseDown.call(this,n);t=i.processMouseDown(this,n);t||n.isReservedLocation&&(t=!0)},u.prototype.processMouseUp=function(n){var f=this._getIsRowHeaderCheckBoxVisible(n.sheet),u,t;if(!f)return r.prototype.processMouseUp.call(this,n);u=n.sheet;t=new GC.Spread.Sheets.Rect(0,0,0,0);t.x=0;u.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)===2&&(t.x+=u.getColumnWidth(0,GC.Spread.Sheets.SheetArea.rowHeader));t.y=0;t.width=this.getCheckBoxColumnWidth(u);t.height=this._getColHeaderHeight(u);t.x<=n.x&&n.x<t.x+t.width&&t.y<=n.y&&n.y<t.y+t.height&&(n.isReservedLocation=!0,i.triggerButtonClicked(u,n.row,n.col,GC.Spread.Sheets.SheetArea.corner,GC.Spread.Sheets.SheetArea.corner))},u.prototype._getColHeaderHeight=function(n){for(var i=GC.Spread.Sheets.SheetArea.colHeader,u=n.getRowCount(i),r=0,t=0;t<u;t++)r+=n.getRowHeight(t,i);return r},u.prototype._getIsRowHeaderVisible=function(n){return this._isRowHeaderVisible===null&&(this._isRowHeaderVisible=n.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)===1?!this._getIsRowHeaderCheckBoxVisible(n):!0),this._isRowHeaderVisible},u.prototype._getIsRowHeaderCheckBoxVisible=function(n){return this._isRowHeaderCheckBoxVisible===null&&(this._isRowHeaderCheckBoxVisible=n.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)===1?n.getCellType(0,0,GC.Spread.Sheets.SheetArea.rowHeader)instanceof rt:!0),this._isRowHeaderCheckBoxVisible},u.prototype.paint=function(i,r,f,e,o,s,h,c){var wt,y=c.sheet,ci=y.tag(),ii,bt,et,dt,it,ni,at,fi,ti,ei,si,d,yt;if(this._listViewStyleTemplate=(wt=ci)===null||wt===void 0?void 0:wt.ListViewStyleTemplate,ii=this._getIsRowHeaderVisible(y),bt=this._getIsRowHeaderCheckBoxVisible(y),n.ListViewHelper.SelectionHelper.isSelectAllRows(y)&&(r=!0),h.hAlign=GC.Spread.Sheets.HorizontalAlign.center,h.vAlign=GC.Spread.Sheets.VerticalAlign.center,et=bt?this.getCheckBoxColumnWidth(y)-1:0,i){i.save();i.rect(f,e,o,s);i.clip();i.beginPath();var b=this._listViewStyleTemplate?n.ColorHelper.Convert(this._listViewStyleTemplate.ColumnHeaderBorder):null,w=GC.Spread.Sheets.VisualState.normal,ot={};if(c.visualState!==undefined&&(w=c.visualState,ot=this.getThemeStyle(GC.Spread.Sheets.VisualState.hover,"gc-corner-triangle-"+t.getVisualStateName(w))),ii){if(typeof w!==undefined){try{var ri=this.getThemeStyle(c.visualState,"gc-corner-"+t.getVisualStateName(w)),k=t.getCustomStyle(null,ri,this._listViewStyleTemplate,GC.Spread.Sheets.VisualState.normal),ct=k&&k.backColor,kt=k&&k.backgroundImage;ct?(i.fillStyle=ct,i.fillRect(f,e,o,s)):kt&&kt!=="none"&&(dt=new Image,it=kt,it=it.replace('url("',""),it=it.replace('")',""),dt.src=it,i.drawImage(dt,f,e,o,s))}catch(li){}var st=this.getThemeStyle(GC.Spread.Sheets.VisualState.hover,"gc-corner-triangle-"+t.getVisualStateName(w)),lt=t.getCustomStyle(null,st,this._listViewStyleTemplate,w),gt=lt&&lt.backgroundImage,ui=lt&&lt.backColor,ht=i.createLinearGradient(f+o/2,e,f+o/2,e+s);if(gt&&gt.indexOf("linear-gradient")!==-1){for(ni=n.SpreadJSHelpMethods.util.getLinearGradientColors(gt),at=0,fi=ni.length;at<fi;at++)ti=ni[at],ht.addColorStop(ti.point,ti.color);i.fillStyle=ht}else ui&&(ei="#f6fafb",ht.addColorStop(.125,ei),ht.addColorStop(1,ui),i.fillStyle=ht);this.paintRightBottomBorder(i,f,e,o,s,b||st.borderLeftColor,b||st.borderRightColor,b||st.borderTopColor,b||st.borderBottomColor,et)}i.restore()}else{if(typeof w!==undefined)try{var ri=this.getThemeStyle(c.visualState,"gc-corner-"+t.getVisualStateName(w)),k=t.getCustomStyle(h,ri,this._listViewStyleTemplate,w),ct=k&&k.backColor,gt=k&&k.backgroundImage;ct&&(i.fillStyle=ct,i.fillRect(f,e,o,s))}catch(li){}this.paintRightBottomBorder(i,f,e,o,s,b||ot.borderLeftColor,b||ot.borderRightColor,b||ot.borderTopColor,b||ot.borderBottomColor,et);i.restore()}if(bt&&y.selectionPolicy()!==GC.Spread.Sheets.SelectionPolicy.single&&i){i.save();i.rect(f,e,o,s);i.clip();i.beginPath();var oi=this,tt="",rt=0,p=0;y&&(rt=t.getStringWidthByCanvas(tt,h.font,y),p=t.getTextHeight(h.font,y),tt&&(si=tt.split(/\r\n|\r|\n/),p*=si.length));d=new GC.Spread.Sheets.CellTypes.CheckBox;f=f+o-et;o=et;var l=u._checkboxSize/2,hi=new GC.Spread.Sheets.Rect(++f,++e,--o,--s),a=parseInt((e+oi._getCheckBoxTop(d,h,hi,p,y.zoom())).toString()),v=parseInt((f+oi._getCheckBoxLeft(d,h,hi,rt,y.zoom())).toString()),vt="left",ut=v+1;h.hAlign===GC.Spread.Sheets.HorizontalAlign.center?(vt="center",ut+=l):h.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(vt="right",ut+=l*2);yt=h.font;yt&&i.font!==yt&&(i.font=yt);h.foreColor&&(i.fillStyle=h.foreColor);var g=h.textDecoration,ft=c.fontInfo.fontSize,pt=ft>8?Math.floor((ft-8)/5+2):1,nt=p/2-ft/2+pt-1;i.textBaseline!=="alphabetic"&&(i.textBaseline="alphabetic");d.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.left?(i.textAlign="right",i.fillText(tt,v+1-2,a+l+p/2-nt),g&&t.renderTextDecoration(i,g,v+1-2,a+l+p/2-nt,rt,ft,pt)):d.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.top&&(i.textAlign=vt,i.fillText(tt,ut,a-2-nt),g&&t.renderTextDecoration(i,g,ut,a-2-nt,rt,p));i.save();i.strokeStyle="black";v-=2;i.strokeRect(v+.5,a+.5,l*2+.05,l*2+.05);i.fillStyle="white";i.fillRect(v+1,a+1,l*2-1,l*2-1);d.isThreeState()&&(r===null||r===undefined)?(i.beginPath(),i.fillStyle="green",i.rect(v+3,a+3,(l-2.5)*2,(l-2.5)*2),i.fill()):!!r==!0&&(i.beginPath(),i.lineWidth=2.5,i.moveTo(v+3,a+l),i.lineTo(v+l,a+l*2-3.5),i.lineTo(v+l*2-1.5,a+3),i.stroke());i.restore();h.foreColor&&(i.fillStyle=h.foreColor);d.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.right?(i.textAlign="left",i.fillText(tt,v+1+l*2+2,a+l+p/2-nt),g&&t.renderTextDecoration(i,g,v+1+l*2+2,a+l+p/2-nt,rt,ft,pt)):d.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.bottom&&(i.textAlign=vt,i.fillText(tt,ut,a+l*2+2+p-nt),g&&t.renderTextDecoration(i,g,ut,a+l*2+2+p-nt,rt,ft,pt));i.restore()}}},u.prototype._getCheckBoxLeft=function(n,t,i,r,f){var e=i.x-1,s=i.width+1,h=0,o=0,c=5*f;return n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.top||n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.bottom?(o=e+c,t.hAlign===GC.Spread.Sheets.HorizontalAlign.center?o=e+s/2-u._checkboxSize/2:t.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(o=e+s-c-u._checkboxSize)):n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.left?(h=u._checkboxSize+r,o=e+c+r,t.hAlign===GC.Spread.Sheets.HorizontalAlign.center?o=e+s/2-h/2+r:t.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(o=e+s-c-h+r)):(h=u._checkboxSize+r,o=e+c,t.hAlign===GC.Spread.Sheets.HorizontalAlign.center?o=e+s/2-h/2:t.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(o=e+s-c-h)),o-e},u.prototype._getCheckBoxTop=function(n,t,i,r,f){var e=i.y-1,s=i.height+1,h=0,o=0,c=5*f;return n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.top?(h=u._checkboxSize+r,o=e+c+r,t.vAlign===GC.Spread.Sheets.VerticalAlign.center?o=e+s/2-h/2+r:t.vAlign===GC.Spread.Sheets.VerticalAlign.bottom&&(o=e+s-c-h+r)):n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.bottom?(h=u._checkboxSize+r,o=e+c,t.vAlign===GC.Spread.Sheets.VerticalAlign.center?o=e+s/2-h/2:t.vAlign===GC.Spread.Sheets.VerticalAlign.bottom&&(o=e+s-c-h)):(o=e+c,t.vAlign===GC.Spread.Sheets.VerticalAlign.center?o=e+s/2-u._checkboxSize/2:t.vAlign===GC.Spread.Sheets.VerticalAlign.bottom&&(o=e+s-c-u._checkboxSize)),o-e},u.prototype.paintRightBottomBorder=function(n,t,i,r,u,f,e,o,s,h){var y=n.createLinearGradient(t+r,i+1,t+r,i+u-2),l,c,a,v;y.addColorStop(0,f);y.addColorStop(1,e);n.beginPath();n.strokeStyle=y;n.moveTo(t+r-.5,i);n.lineTo(t+r-.5,i+u);n.stroke();l=n.createLinearGradient(t,i,t+r-2,i);l.addColorStop(0,o);l.addColorStop(1,s);n.beginPath();n.strokeStyle=l;n.moveTo(t,i+u-.5);n.lineTo(t+r,i+u-.5);n.stroke();n.beginPath();c=3;a=u;r-h<u&&(a=r-h);v=h;n.moveTo(t+r-a+c-v,i+u-c);n.lineTo(t+r-c-v,i+u-c);n.lineTo(t+r-c-v,i+u-a+c);n.fill()},u._checkboxSize=12,u}(GC.Spread.Sheets.CellTypes.Corner);n.MutiCheckCornerCellType=st;k=function(r){function u(n,t,i,u,f,e,o){var s=r.call(this)||this;return s.oddRowBackcolor=i,s.evenRowBackcolor=u,s._calcSheetName=e,s._listViewStyleTemplate=o,s._currentZoomFactor=f.zoom(),s._cellMetaData=t,s._cellType=t.CellType,s._initItemsGroupInfo(n),s._tryInitItemsInfo(f,s._cellType),s._nodes=[],s}return __extends(u,r),u.prototype._tryInitItemsInfo=function(n,t){!t.hasInitItemsInfo&&this._cellType.haveLoadItems&&(this._initItemsInfo(n),t.hasInitItemsInfo=!0,t.initItemsInfoCallback&&t.initItemsInfoCallback())},u.prototype._initItemsGroupInfo=function(t){var i=this,r;i._itemsGroupStyle=n.SpreadJSView.createStyleByCell(t.columnInfo.TemplateCell);i._canEdit=t.canEditInForguncy;r=i._cellType.ReadOnly;i._isReadOnly=n.Common.IsEmpty(r)===!0?!1:r},u.prototype._initItemsInfo=function(i){var r=this,f,u,e,o,s,h,l,c,a;for(r.itemsMargin=n.Common.IsEmpty(r._cellType.ItemSpace)===!0?5:r._cellType.ItemSpace,r.itemsDisplayText=[],r.itemsValueText=[],r.itemsTextWidth=[],r.totalTextWidth=0,r.itemsTextHeight=[],r.itemsTextFormatFontColor=[],f=r._cellType.ItemsInfo.Items,r.itemsCount=f.length,u=0;u<r.itemsCount;u++)e=void 0,e=f[u].DisplayValue===undefined||f[u].DisplayValue===null?r._cellType.AddNullItemWhenBinding?r._cellType.AddOtherItem:"":f[u].DisplayValue.toString(),o=r._cellMetaData.StyleInfo,o.Formatter&&(s=n.FormatHelper.format(o.Formatter,e),e=s.text,r.itemsTextFormatFontColor[u]=s.color),r.itemsDisplayText[u]=e,r.itemsValueText[u]=n.Common.IsEmpty(f[u].Value)?"":f[u].Value.toString(),h=n.ListViewHelper.SpreadJSStyleHelper.generateFontText(o),r.itemsTextWidth[u]=t.getStringWidthByCanvas(r.itemsDisplayText[u],h,i),r.totalTextWidth+=r.itemsTextWidth[u],r.itemsTextHeight[u]=t.getTextHeight(h,i),r.itemsDisplayText[u]&&(l=r.itemsDisplayText[u].split(/\r\n|\r|\n/),r.itemsTextHeight[u]*=l.length);c=this.getListview();a=c.listviewData.getAutoFitColumnWidth();a&&n.DelayRefresh.setTimeout(function(){c.autoFitColumnWidth()})},u.prototype.getItemLeftPosition=function(n,t,i,r,f){for(var l=t.width,s=0,o=0,e=this,a=e._getItemsGroupMargin(r),h=0,c=0;c<f;c++)h+=i[c];return h+=e.itemsMargin*f,s=e.itemsCount*(u.itemsSize+e.itemsMargin)+e.totalTextWidth,n.hAlign===GC.Spread.Sheets.HorizontalAlign.left?o=a:n.hAlign===GC.Spread.Sheets.HorizontalAlign.center?o=l/2-s/2:n.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(o=l-a-s),o+u.itemsSize*f+h},u.prototype.getItemTopPosition=function(n,t,i){var f=t.height,o=this,e=o._getItemsGroupMargin(i),r=e;return n.vAlign===GC.Spread.Sheets.VerticalAlign.center?r=f/2-u.itemsSize/2:n.vAlign===GC.Spread.Sheets.VerticalAlign.bottom&&(r=f-e-u.itemsSize),r},u.prototype._getItemsGroupMargin=function(n){return 5*n},u.prototype._isHitCurrentItem=function(n,t){var i=this,o=parseInt(i.getItemLeftPosition(i._itemsGroupStyle,n.cellRect,i.itemsTextWidth,n.sheet.zoom(),t).toString()),s=parseInt(i.getItemTopPosition(i._itemsGroupStyle,n.cellRect,n.sheet.zoom()).toString()),r=o+n.cellRect.x+u.itemsSize/2,f=s+n.cellRect.y+u.itemsSize/2,h=u.itemsSize/2,c=u.itemsSize/2+i.itemsTextWidth[t],e=i.itemsTextHeight[t]/2;if(r-h<=n.x&&n.x<=r+c&&f-e<=n.y&&n.y<=f+e)return!0},u.prototype.updateItemsGroupValue=function(n,t){var e=this,i=n.toString().split(","),o=i.indexOf(this.itemsValueText[t]),r,u,s,f;if(o===-1){for(i.push(this.itemsValueText[t]),r=[],u=0;u<i.length;u++)s=e.itemsValueText.indexOf(i[u]),s!==-1&&r.push(e.itemsValueText.indexOf(i[u]));for(r.sort(),i=[],f=0;f<r.length;f++)i[f]=e.itemsValueText[r[f]]}else i.splice(o,1);return i.join(",")},u.prototype._allowChecked=function(t){return this._canEdit&&!this._isReadOnly&&!n.Platform.isMobile()&&!this.getListview().isCommiting(t)},u.prototype.getListview=function(){return n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName)},u.prototype.getHitInfo=function(n,t,i,r,u){if(u&&this._allowChecked(u.row)){var f=u.sheetArea;if(f===null||f===undefined||f===GC.Spread.Sheets.SheetArea.viewport)return{x:n,y:t,row:u.row,col:u.col,cellRect:r,sheetArea:f,isReservedLocation:!0,sheet:u.sheet}}return null},u.prototype.processMouseDown=function(n){if(!n)return!1;n.isReservedLocation&&(this._isMouseDownReservedLocation=!0)},u.prototype.getNode=function(t){return n.Common.IsEmpty(this._nodes[t])&&(this._nodes[t]={}),this._nodes[t]},u.prototype.deleteNode=function(n){delete this._nodes[n]},u.prototype.processMouseUp=function(i){var u=this,f,h,o;if(u._allowChecked(i.row)){if(f=i.sheet,u._isMouseDownReservedLocation&&f&&i.isReservedLocation){u._isMouseDownReservedLocation=!1;var e=i.row,c=i.col,s=i.sheetArea,r=u.getNode(e);if(r.isFirstMouseUp)delete r.isFirstMouseUp,r.mouseupToken&&(window.clearTimeout(r.mouseupToken),delete r.mouseupToken),u.deleteNode(e);else{if(s===null||s===undefined||s===GC.Spread.Sheets.SheetArea.viewport){h=f.getValue(e,c,s);n.Common.IsEmpty(h)&&(h="");var l="",a=u.getListview(),v=a.mappedRowIndexFrowView(e);for(o=0;o<u.itemsCount;o++)if(u._isHitCurrentItem(i,o)){f.getActiveRowIndex()===e&&f.getActiveColumnIndex()===c&&a.getSelectedRowIndex()===v&&(l=u.updateItemsGroupValue(h.toString(),o),t.executeEditCommand(f,e,c,l,!0));break}}return r.isFirstMouseUp=!0,r.mouseupToken=window.setTimeout(function(){delete r.isFirstMouseUp;r.mouseupToken&&(window.clearTimeout(r.mouseupToken),delete r.mouseupToken)},250),!0}}return!1}},u.prototype.paint=function(t,r,u,f,e,o,s,h){t&&(this._currentZoomFactor=h.sheet.zoom(),this._tryInitItemsInfo(h.sheet,this._cellType),s=i.setAlternativeRowColor(h.row,this.oddRowBackcolor,this.evenRowBackcolor,s,this._listViewStyleTemplate),h&&h.parentBackColor&&h.parentBackColor===s.backColor||n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,u,f,e,o,s.backColor,s.backgroundImage,s.backgroundImageLayout,h.imageLoader),this.paintValue(t,r,u,f,e,o,s,h))},u.prototype.paintValue=function(i,r,f,e,o,s,h,c){var l,y,v,w,a;if(i)try{if(i.save(),i.rect(f,e,o,s),i.clip(),i.beginPath(),l=this,y=c.sheet,y)for(v=u.itemsSize/2,w=new GC.Spread.Sheets.Rect(++f,++e,--o,--s),a=0;a<l.itemsCount;a++){var b=parseInt((f+l.getItemLeftPosition(h,w,l.itemsTextWidth,y.zoom(),a)).toString()),k=parseInt((e+l.getItemTopPosition(h,w,y.zoom())).toString()),d=h.font;d&&i.font!==d&&(i.font=d);h.foreColor&&(i.fillStyle=h.foreColor);var g=h.textDecoration,p=c.fontInfo.fontSize,nt=p>8?Math.floor((p-8)/5+2):1,tt=l.itemsTextHeight[a]/2-p/2+nt-1;i.textBaseline!=="alphabetic"&&(i.textBaseline="alphabetic");l.paintIcon(i,r,b,k,v,a);n.Common.IsEmpty(l.itemsTextFormatFontColor[a])?h.foreColor&&(i.fillStyle=h.foreColor):i.fillStyle=l.itemsTextFormatFontColor[a];i.textAlign="left";i.fillText(l.itemsDisplayText[a],b+1+v*2+2,k+v+l.itemsTextHeight[a]/2-tt);g&&t.renderTextDecoration(i,g,b+1+v*2+2,k+v+l.itemsTextHeight[a]/2-tt,l.itemsTextWidth[a],p,nt)}}finally{i.restore()}},u.prototype.paintIcon=function(n,t,i,r,u,f){},u.prototype.getAutoFitWidth=function(n,t,i,r,f){var e=this;return e.itemsCount*(u.itemsSize+e.itemsMargin)+e.totalTextWidth},u.prototype.getAutoFitHeight=function(n,t,i,r,f){var e=this,o=0;return e.itemsTextHeight&&e.itemsTextHeight.length>0&&e.itemsTextHeight.forEach(function(n){n>o&&(o=n)}),Math.max(u.itemsSize,o)},u.prototype.getCurrentItemInfo=function(n,t){if(t<0||t>=this.itemsCount)return null;var i={},r="width",f="height",e="startX",o="startY",s="displayText";return i[r]=this.itemsTextWidth[t]+u.itemsSize,i[f]=this.itemsTextHeight[t],i[e]=this.getItemLeftPosition(this._itemsGroupStyle,n,this.itemsTextWidth,this._currentZoomFactor,t),i[o]=this.getItemTopPosition(this._itemsGroupStyle,n,this._currentZoomFactor),i[s]=this.itemsDisplayText[t],i},u.itemsSize=12,u}(GC.Spread.Sheets.CellTypes.Base);n.SpreadJSItemsGroupCellType=k;d=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.shouldUse=function(t,i,r){return i.cellType.constructor===n.CheckBoxGroupCellType&&!i.cellType.cellTypeData.canEnterEditModeInListview()},i.createInstance=function(n,t,r){return new i(t,r,n.oddRowBackcolor,n.evenRowBackcolor,n._sheet,n.getCalcSheetName(),n.listViewStyleTemplate)},i.prototype.paintIcon=function(n,t,i,r,u,f){try{if(n.save(),n.strokeStyle="Black",n.strokeRect(i+.5,r+.5,u*2+.05,u*2+.05),n.fillStyle="White",n.fillRect(i+1,r+1,u*2-1,u*2-1),t!==undefined){t===null&&(t="");var e=t.toString().split(",");e.indexOf(this.itemsValueText[f])!=-1&&(n.beginPath(),n.strokeStyle="Black",n.lineWidth=2.5,n.moveTo(i+3,r+u),n.lineTo(i+u,r+u*2-3.5),n.lineTo(i+u*2-1.5,r+3),n.stroke())}}finally{n.restore()}},i}(k);n.SpreadJSCheckBoxGroupCellType=d;t.register(d.shouldUse,d.createInstance);g=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.shouldUse=function(t,i,r){return i.cellType.constructor===n.RadioGroupCellType&&!i.cellType.cellTypeData.canEnterEditModeInListview()},i.createInstance=function(n,t,r){return new i(t,r,n.oddRowBackcolor,n.evenRowBackcolor,n._sheet,n.getCalcSheetName(),n.listViewStyleTemplate)},i.prototype.paintIcon=function(n,t,i,r,u,f){try{if(n.save(),n.beginPath(),n.arc(i+u,r+u,u,0,2*Math.PI),n.closePath(),n.strokeStyle="Black",n.stroke(),n.beginPath(),n.arc(i+u,r+u,u-.5,0,2*Math.PI),n.closePath(),n.fillStyle="White",n.fill(),t!==undefined){t===null&&(t="");var e=t.toString();e===this.itemsValueText[f]&&(n.beginPath(),n.arc(i+u,r+u,u-2.8,0,2*Math.PI),n.closePath(),n.fillStyle="Black",n.fill())}}finally{n.restore()}},i.prototype.updateItemsGroupValue=function(n,t){return n!==this.itemsValueText[t]?this.itemsValueText[t]:n},i}(k);n.SpreadJSRadioGroupCellType=g;t.register(g.shouldUse,g.createInstance)}(Forguncy||(Forguncy={}));__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var t={SortAsc:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><title>Incremental descending order1<\/title><g fill="none" fill-rule="evenodd"><path d="M7 7H5.906L5.47 5.864H3.48L3.067 7H2l1.94-5h1.065L7 7zM5.148 5.022L4.46 3.166l-.673 1.856h1.36z" fill="#418FCF"/><path fill="#C74444" d="M2 14v-.91l3.233-3.244H2.365V9H6.87v.784l-3.371 3.374H7V14z"/><g fill="#666"><path d="M11.5 13L9 10h5zM11 3h1v7h-1z"/><\/g><\/g><\/svg>',SortDesc:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><title>Incremental descending order2<\/title><g fill="none" fill-rule="evenodd"><path d="M7 14H5.906l-.436-1.136H3.48L3.067 14H2l1.94-5h1.065L7 14zm-1.852-1.978l-.687-1.856-.673 1.856h1.36z" fill="#418FCF"/><path fill="#C74444" d="M2 7v-.91l3.233-3.244H2.365V2H6.87v.784L3.499 6.158H7V7z"/><g fill="#666"><path d="M11.5 13L9 10h5zM11 3h1v7h-1z"/><\/g><\/g><\/svg>',SortAsc_Checked:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><title>Incremental descending order-Selected1<\/title><g fill="none" fill-rule="evenodd"><path d="M7 7H5.906L5.47 5.864H3.48L3.067 7H2l1.94-5h1.065L7 7zM5.148 5.022L4.46 3.166l-.673 1.856h1.36z" fill="#418FCF"/><path fill="#C74444" d="M2 14v-.91l3.233-3.244H2.365V9H6.87v.784l-3.371 3.374H7V14z"/><g fill="#666"><path d="M11.5 13L9 10h5zM11 3h1v7h-1z"/><\/g><path stroke="#EA7044" d="M.5.5h15v15H.5z"/><\/g><\/svg>',SortDesc_Checked:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><title>Incremental descending order-Selected2<\/title><g fill="none" fill-rule="evenodd"><path d="M7 14H5.906l-.436-1.136H3.48L3.067 14H2l1.94-5h1.065L7 14zm-1.852-1.978l-.687-1.856-.673 1.856h1.36z" fill="#418FCF"/><path fill="#C74444" d="M2 7v-.91l3.233-3.244H2.365V2H6.87v.784L3.499 6.158H7V7z"/><g fill="#666"><path d="M11.5 13L9 10h5zM11 3h1v7h-1z"/><\/g><path stroke="#EA7044" d="M.5.5h15v15H.5z"/><\/g><\/svg>',FilterClear:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Empty filter<\/title><defs><path id="a" d="M0 0h12v12H0z"/><\/defs><g fill="none" fill-rule="evenodd"><path d="M7.302 6.528c0-.026-.005-.054-.001-.079-.004.025 0 .053 0 .08M7.329 6.684c.01.033.027.066.044.102a1.047 1.047 0 0 1-.044-.102M7.361 6.305c.01-.013.012-.03.022-.042-.01.012-.013.03-.022.042" fill="#419AE5"/><path d="M15.7 13.868c-.45-1.072-1.792-2.812-3.062-4.322 1.632-1.426 2.98-2.34 2.98-2.34s1.135-.887-.562-.323c-.75.25-1.92 1.008-3.099 1.863a63.838 63.838 0 0 0-1.567-1.749c-1.398-1.675-4.92-1.127-1.93.8.82.497 1.627 1.117 2.388 1.775a65.873 65.873 0 0 0-2.575 2.084c-1.672 1.278-1.834 5.243.336 2.251.891-1.293 2.026-2.506 3.123-3.538a37.099 37.099 0 0 1 3.776 4.2s.964 1.133.192-.7" fill="#D65836"/><g transform="translate(0 1)"><mask id="b" fill="#fff"><use xlink:href="#a"/><\/mask><path d="M6.857 10.286v-3.53a2.587 2.587 0 0 1-.38-.527 1.473 1.473 0 0 1-.164-.922c0-.008 0-.013.002-.02.01-.056.015-.11.03-.167.207-.7.902-1.12 1.858-1.12.193 0 .409.021.638.062L12 0H0l5.143 6.612V12l1.714-1.714z" fill="#666" mask="url(#b)"/><\/g><\/g><\/svg>'},r=function(){function t(){}return t.setColumnFilterCache=function(t,i){n.ForguncyData.columnFilterQueryCache[t]=i},t.clearColumnFilterCache=function(t){n.ForguncyData.columnFilterQueryCache[t]=undefined},t.showContextMenu=function(t,r){var f=r.col,u=(new n.UI.ContextMenu).identify("fgc-columnfilter-contextmenu"),s=i.createSortMenuItems(t,f,u),h=i.createClearFilterMenuItem(t,f,u),c=i.createAdvancedFilterMenuItem(t,f,u),l=i.createBasicFilterMenuItem(t,f,u),o,e;u.add.apply(u,__spreadArrays(s,[new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter),h,new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter),c,l]));n.ForguncyData.pageInfo.appendExtralPopup(u);n.PageBuilder.pagesContainer.append(u.createUI().container);o=$(n.SpreadJSView.getCanvas(t.getCalcSheetName()));e=o.offset();u.location=new n.Numerics.Vector2(e.left+r.x||0,e.top+r.y||0);u.show()},t}(),i;n.ColumnFilterHelper=r;i=function(){function i(){}return i.createSortMenuItems=function(i,r,u){var s=i.listviewData.visibleColumns[r],f=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_SortAscending,t.SortAsc_Checked,t.SortAsc).on("Clicked",function(){i.sortByColumn(r,0);u.dispose()}).identify("fgc-columnfilter-sortasc"),e=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_SortDesending,t.SortDesc_Checked,t.SortDesc).on("Clicked",function(){i.sortByColumn(r,1);u.dispose()}).identify("fgc-columnfilter-sortdesc"),o=s.sortInfo;return f.isChecked=o===0,e.isChecked=o===1,[f,e].map(function(t){return new n.UI.ContextMenuItem(t)})},i.createClearFilterMenuItem=function(i,u,f){var e=i.listviewData.visibleColumns[u],o=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_ClearFilter,t.FilterClear,t.FilterClear).on("Clicked",function(){e.clearColumnFilter();r.clearColumnFilterCache(i.getLocationString());i.resetToFirstPage();i.fillData();f.dispose()}).identify("fgc-columnfilter-clear");return o.enabled=e.isColumnFilterValid,new n.UI.ContextMenuItem(o)},i.createAdvancedFilterMenuItem=function(t,i,r){var e=t.listviewData.visibleColumns[i],s=e.getFilterColumnDataType(),h=this.convertFilterDataType(s),o=n.AdvancedFilterFactory.create(h),u,f;if(o&&(u=new n.UI.ContextMenuButton(o.title),u.isChecked=!n.Common.IsEmpty(e.filterConditions)),u){f=new n.UI.ContextMenuItem(u).identify("fgc-columnfilter-advanced");f.child=o.createContextMenu(t,e);f.child.on("Dispose",function(){r.dispose()})}return f},i.createBasicFilterMenuItem=function(t,i,r){var u=t.listviewData.visibleColumns[i],f=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_Filter).on("Clicked",function(){r.dispose();var i=new n.BasicFilterDialog(t,u);n.ForguncyData.pageInfo.appendExtralPopup(i);n.PageBuilder.pagesContainer.append(i.createUI().container);i.show()}).identify("fgc-columnfilter-basic");return f.isChecked=n.Common.IsEmpty(u.filterConditions)&&!n.Common.IsEmpty(u.filterValues),f.enabled=!u.getIsFilterStatisticColumn(),new n.UI.ContextMenuItem(f)},i.convertFilterDataType=function(t){switch(t){case n.ColumnDataType.String:case n.ColumnDataType.User:return 1;case n.ColumnDataType.Number:return 0;case n.ColumnDataType.Date:return 2;case n.ColumnDataType.Time:return 3;default:return null}},i}()}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var r='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><title>Admonition<\/title><g fill="none" fill-rule="evenodd"><path d="M8.933 1.557l6.878 11.5c.344.574.205 1.35-.31 1.733-.185.137-.401.21-.623.21H1.122C.502 15 0 14.44 0 13.75c0-.247.066-.488.188-.694l6.879-11.5C7.41.983 8.107.828 8.622 1.21c.123.092.23.21.311.347z" fill="#F8BB59"/><path d="M7 5h2l-.37 6H7.37L7 5zm.994 7c.283 0 .529.093.722.278.18.186.284.424.284.715 0 .292-.103.543-.284.729a1.032 1.032 0 0 1-.722.278.94.94 0 0 1-.697-.291C7.09 13.523 7 13.285 7 12.993c0-.291.09-.53.297-.715A.93.93 0 0 1 7.994 12z" fill="#666"/><\/g><\/svg>',u=function(i){function u(u,f){var e=i.call(this)||this;return e.id="fgc-basicfilter-dialog",e.title=n.RS.ColumnFilter_Dialog_Title,e.defaultUI=t,e.treeView=(new n.UI.TreeView).identify("fgc-basicfilter-treeview"),e.textBlock=new n.UI.IconText(n.RS.ColumnFilter_TreeView_TooManyItems,r).identify("fgc-basicfilter-overflow"),e.isShowAllItems=!0,e.listview=u,e.visibleColumn=f,e.textBlock.visibility=!1,e.initializeEvents(),e.initializeData(),e}return __extends(u,i),u.prototype.initializeEvents=function(){var t=this;this.on("Confirm",function(){var i,r,u;t.visibleColumn.clearColumnFilterConditions();t.treeView.nodes[0].isChecked&&!t.treeView.nodes[0].indeterminate?t.visibleColumn.clearColumnFilterValues():(i=t.treeView.nodes[0].leafs,r=i.filter(function(n){return n.isChecked}),r.length<i.length/2||!t.isShowAllItems?(t.visibleColumn.isNotInMode=!1,t.visibleColumn.filterValues=r.map(function(n){return n.userData})):(u=i.filter(function(n){return!n.isChecked}),t.visibleColumn.isNotInMode=!0,t.visibleColumn.filterValues=u.map(function(n){return n.userData})));n.ColumnFilterHelper.setColumnFilterCache(t.listview.getLocationString(),t.listview.getColumnFilterQueries());t.listview.resetToFirstPage();t.listview.fillData()})},u.prototype.initializeData=function(){var t=this,i=this.visibleColumn.getFilterBindingInfo(),r=this.visibleColumn.getFilterDisplayBindingInfo(),u=[i,r].filter(function(t){return!n.Common.IsEmpty(t)});this.queryRows(this.listview,u,function(i,r){var e=i||[],h=r||__spreadArrays(e),o=e.map(function(n,t){return{Value:e[t],DisplayValue:h[t]}}),f=o.filter(function(n){return n.Value!==null}),s,u;f.length<o.length&&f.push({Value:null,DisplayValue:n.RS.ColumnFilter_TreeView_Blanks});s=t.visibleColumn.columnInfo.BindingColumnDataType===n.ColumnDataType.Date?t.generateDateNodes(f,t.visibleColumn):t.generateNormalNodes(f,t.visibleColumn,t.listview);u=new n.UI.TreeViewNode(n.RS.ColumnFilter_TreeView_SelectAll,!0);u.addChildren(s);t.initRootCheckedState(t.visibleColumn,u);u.refreshAll();t.treeView.add(u);t.isShowAllItems=u.leafs.length<500;t.textBlock.visibility=!t.isShowAllItems;t.footerButtonGroup.items[0].enabled=u.isChecked||u.indeterminate;u.on("PropertyChanged",function(n,i){(i==="isChecked"||i==="indeterminate")&&(t.footerButtonGroup.items[0].enabled=u.isChecked||u.indeterminate)})})},u.prototype.initRootCheckedState=function(t,i){var u=t.isNotInMode,r=t.filterValues;if(!n.Common.IsEmpty(t.filterConditions))switch(t.filterCompareType){case 1:u=!1;r=[t.filterConditions[0].Value];break;case 2:u=!0;r=[t.filterConditions[0].Value];break;case 15:u=!1;r=t.filterConditions[0].Value.split(",").map(function(n){return n.trim()});break;case 16:u=!0;r=t.filterConditions[0].Value.split(",").map(function(n){return n.trim()});break;default:i.leafs.forEach(function(n){return n.isChecked=!1});return}r?i.leafs.forEach(function(n){n.isChecked=u!==r.some(function(t){return t===n.userData})}):i.leafs.forEach(function(n){return n.isChecked=!0})},u.prototype.queryRows=function(t,i,r){var u=n.ForguncyData.pageInfo.sortInfoCache[t.getLocationString()],f={columnBindingInfos:i,rowInfo:t.getRowInfo(),queryData:n.ForguncyData.pageInfo.commandQuerys[t.getDataTableName()],sortCommandID:null,sortInfo:u?u.sortInfo:null,columnFilterQueries:t.getColumnFilterQueries(i)};n.HomeController.GetRowsDataForColumnFilter(f,function(n){n&&n.errorMessage&&alert(n.errorMessage);n.rows&&r(n.rows,n.displayRows)},t.getCalcSheetName())},u.prototype.generateNormalNodes=function(t,i,r){return t.map(function(t){var u,f;if(n.Common.IsEmpty(t.Value))u=t.DisplayValue;else{var o=i.columnInfo.TemplateCell.Element,s=r.runTimePageName,e=n.ListivewEditorHelper.getCell(o,s).cellType,h=e?e.getFormatString():"";u=n.FormatHelper.formatValue(t.DisplayValue,h)}return f=new n.UI.TreeViewNode(u),f.userData=t.Value,f})},u.prototype.generateDateNodes=function(t,i){var r=this,u=[];return t.forEach(function(t){var e=t.Value,f,i;if(n.Common.IsEmpty(e))i=new n.UI.TreeViewNode(t.DisplayValue).identify("fgc-columnfilter-blank-datetime"),i.userData=e,u.push(i);else if(f=n.ConvertOADateToDate(e),f)if(isNaN(f.getTime()))i=new n.UI.TreeViewNode(e),i.userData=e,u.push(i);else{var c=f.getFullYear(),l=f.getMonth(),a=f.getDate(),o=f.getHours(),s=f.getMinutes(),h=f.getSeconds(),i=void 0;i=r.createChild(null,u,c,c+n.RS.ColumnFilter_YearName);i=r.createChild(i,i.children,l,n.RS.MonthNames[l]);i=r.createChild(i,i.children,a,a+n.RS.ColumnFilter_DayName);(o!==0||s!==0||h!==0)&&(i=r.createChild(i,i.children,o,o),i=r.createChild(i,i.children,s,":"+s),i=r.createChild(i,i.children,h,":"+h));i.userData=e}}),u},u.prototype.createChild=function(t,i,r,u){return i[r]||(i[r]=new n.UI.TreeViewNode(u.toString()),i[r].parent=t),i[r]},u}(n.UI.Dialog),t,i;n.BasicFilterDialog=u;t=function(t){function r(){var i=t!==null&&t.apply(this,arguments)||this;return i.setTimeout=n.DelayRefresh.setTimeout,i}return __extends(r,t),Object.defineProperty(r.prototype,"content",{get:function(){return new i(this.target)},enumerable:!0,configurable:!0}),r}(n.UI.DialogUI);i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.treeView.createUI());this.addChild(this.target.textBlock.createUI())},t}(n.UI.DialogContentUI)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t,i,s=(t={},Object.defineProperty(t,1,{get:function(){return n.RS.ContextMenu_CompareType_Equals},enumerable:!0,configurable:!0}),Object.defineProperty(t,2,{get:function(){return n.RS.ContextMenu_CompareType_DoesNotEqual},enumerable:!0,configurable:!0}),Object.defineProperty(t,3,{get:function(){return n.RS.ContextMenu_CompareType_BeginsWith},enumerable:!0,configurable:!0}),Object.defineProperty(t,4,{get:function(){return n.RS.ContextMenu_CompareType_DoesNotBeginWith},enumerable:!0,configurable:!0}),Object.defineProperty(t,5,{get:function(){return n.RS.ContextMenu_CompareType_EndsWith},enumerable:!0,configurable:!0}),Object.defineProperty(t,6,{get:function(){return n.RS.ContextMenu_CompareType_DoesNotEndWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t,7,{get:function(){return n.RS.ContextMenu_CompareType_Contains},enumerable:!0,configurable:!0}),Object.defineProperty(t,8,{get:function(){return n.RS.ContextMenu_CompareType_DoesNotContain},enumerable:!0,configurable:!0}),Object.defineProperty(t,9,{get:function(){return n.RS.ContextMenu_CompareType_IsGreaterThan},enumerable:!0,configurable:!0}),Object.defineProperty(t,10,{get:function(){return n.RS.ContextMenu_CompareType_IsGreaterThanOrEqualTo},enumerable:!0,configurable:!0}),Object.defineProperty(t,11,{get:function(){return n.RS.ContextMenu_CompareType_IsLessThan},enumerable:!0,configurable:!0}),Object.defineProperty(t,12,{get:function(){return n.RS.ContextMenu_CompareType_IsLessThanOrEqualTo},enumerable:!0,configurable:!0}),Object.defineProperty(t,13,{get:function(){return n.RS.ContextMenu_CompareType_IsBetween},enumerable:!0,configurable:!0}),Object.defineProperty(t,14,{get:function(){return n.RS.ContextMenu_CompareType_IsNotBetween},enumerable:!0,configurable:!0}),Object.defineProperty(t,15,{get:function(){return n.RS.ContextMenu_CompareType_In},enumerable:!0,configurable:!0}),Object.defineProperty(t,16,{get:function(){return n.RS.ContextMenu_CompareType_NotIn},enumerable:!0,configurable:!0}),t),h=(i={},Object.defineProperty(i,1,{get:function(){return n.RS.ComboBox_CompareType_Equals},enumerable:!0,configurable:!0}),Object.defineProperty(i,2,{get:function(){return n.RS.ComboBox_CompareType_DoesNotEqual},enumerable:!0,configurable:!0}),Object.defineProperty(i,3,{get:function(){return n.RS.ComboBox_CompareType_BeginsWith},enumerable:!0,configurable:!0}),Object.defineProperty(i,4,{get:function(){return n.RS.ComboBox_CompareType_DoesNotBeginWith},enumerable:!0,configurable:!0}),Object.defineProperty(i,5,{get:function(){return n.RS.ComboBox_CompareType_EndsWith},enumerable:!0,configurable:!0}),Object.defineProperty(i,6,{get:function(){return n.RS.ComboBox_CompareType_DoesNotEndWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i,7,{get:function(){return n.RS.ComboBox_CompareType_Contains},enumerable:!0,configurable:!0}),Object.defineProperty(i,8,{get:function(){return n.RS.ComboBox_CompareType_DoesNotContain},enumerable:!0,configurable:!0}),Object.defineProperty(i,9,{get:function(){return n.RS.ComboBox_CompareType_IsGreaterThan},enumerable:!0,configurable:!0}),Object.defineProperty(i,10,{get:function(){return n.RS.ComboBox_CompareType_IsGreaterThanOrEqualTo},enumerable:!0,configurable:!0}),Object.defineProperty(i,11,{get:function(){return n.RS.ComboBox_CompareType_IsLessThan},enumerable:!0,configurable:!0}),Object.defineProperty(i,12,{get:function(){return n.RS.ComboBox_CompareType_IsLessThanOrEqualTo},enumerable:!0,configurable:!0}),Object.defineProperty(i,13,{get:function(){return n.RS.ComboBox_CompareType_IsBetween},enumerable:!0,configurable:!0}),Object.defineProperty(i,14,{get:function(){return n.RS.ComboBox_CompareType_IsNotBetween},enumerable:!0,configurable:!0}),Object.defineProperty(i,15,{get:function(){return n.RS.ComboBox_CompareType_In},enumerable:!0,configurable:!0}),Object.defineProperty(i,16,{get:function(){return n.RS.ComboBox_CompareType_NotIn},enumerable:!0,configurable:!0}),i),c=function(){function t(){}return t.prototype.createContextMenu=function(t,i){var e=this,u,r=[],f;return this.contextMenuCompareTypes.forEach(function(f,o){f.forEach(function(f){var o=new n.UI.ContextMenuButton(s[f]+"...").on("Clicked",function(){u.dispose();e.openCustomFilterDialog(t,i,f)});o.isChecked=!n.Common.IsEmpty(i.filterConditions)&&f===i.filterCompareType;r.push(new n.UI.ContextMenuItem(o))});r.push(new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter))}),f=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_CustomFilter+"...").on("Clicked",function(){u.dispose();e.openCustomFilterDialog(t,i,i.actualCompareType)}),f.isChecked=this.getCustomFilterIsChecked(i),r.push(new n.UI.ContextMenuItem(f)),u=new n.UI.ContextMenu(r)},t.prototype.openCustomFilterDialog=function(t,i,e){var s=this,o;e===void 0&&(e=this.supportedCompareTypes[0]);o=new u;o.targetName=i.getName()||"";e===null||e===undefined||e===0?o.selectModel=new r(this.supportedCompareTypes[0]):(o.selectModel=new r(e),i.filterConditions&&e===i.actualCompareType&&(n.Common.IsEmpty(i.filterConditions[0])||(o.value1=this.convertConditionToString(i.filterConditions[0])),n.Common.IsEmpty(i.filterConditions[1])||(o.value2=this.convertConditionToString(i.filterConditions[1]))));o.prefabModels=this.supportedCompareTypes.map(function(n){return new r(n)});o.on("Confirm",function(r,u){i.clearColumnFilterValues();var f;try{f=s.generate(o.selectModel.type,[o.value1,o.value2])}catch(e){alert(n.RS.ColumnFilter_Alert_IncorrectValue);u.cancel=!0;return}i.filterCompareType=o.selectModel.type;i.IsOrMode=o.selectModel.type===14;i.filterConditions=f;n.ColumnFilterHelper.setColumnFilterCache(t.getLocationString(),t.getColumnFilterQueries());t.resetToFirstPage();t.fillData()});this.updateExampleText(o);o.on("PropertyChanged",function(n,t){t==="selectModel"&&s.updateExampleText(o)});n.ForguncyData.pageInfo.appendExtralPopup(o);n.PageBuilder.pagesContainer.append(o.createUI(f).container);o.show()},t.prototype.convertConditionToString=function(t){return t.Value===n.KeyWords.Null?"":t.Value},t.prototype.convertValueToReal=function(t){return t.trim()===""?n.KeyWords.Null:t},t.prototype.getCustomFilterIsChecked=function(t){if(!n.Common.IsEmpty(t.filterConditions)){var i=this.contextMenuCompareTypes.reduce(function(n,t){return n.concat(t)});return i.indexOf(t.filterCompareType)<0}return!1},t.prototype.updateExampleText=function(t){var i=this.getExampleText(t.selectModel.type);n.Common.IsEmpty(i)?t.exampleTextBlock.visibility=!1:(t.exampleTextBlock.visibility=!0,t.exampleTextBlock.text=i)},t}(),e,r,u,f,o;n.AdvancedFilter=c;e=function(){function t(){}return t.create=function(t){switch(t){case 0:return new n.NumberFilter;case 1:return new n.TextFilter;case 2:return new n.DateFilter;case 3:return new n.TimeFilter;default:return null}},t}();n.AdvancedFilterFactory=e;r=function(){function n(n){this.type=n}return Object.defineProperty(n.prototype,"title",{get:function(){return h[this.type]},enumerable:!0,configurable:!0}),n}();u=function(t){function i(){var i=t.call(this)||this;i.value1="";i.value2="";i.titleTextBlock=new n.UI.TextBlock(i.whereTitle);i.targetNameTextBlock=new n.UI.TextBlock("").identify("fgc-advancedfilter-targetname");i.comboBox=(new n.UI.ComboBox).identify("fgc-advancedfilter-combobox");i.textBox1=(new n.UI.TextBox).identify("fgc-advancedfilter-leftinput");i.textBox2=(new n.UI.TextBox).identify("fgc-advancedfilter-rightinput");i.modeTextBlock=new n.UI.TextBlock(n.RS.ColumnFilter_TextBlock_And);i.exampleTextBlock=(new n.UI.TextBlock).identify("fgc-advancedfilter-example");i.outerFlex=new n.UI.FlexLayout(1).identify("fgc-advancedfilter-outerflex");i.innerFlex1=new n.UI.FlexLayout(0).identify("fgc-advancedfilter-titleflex");i.innerFlex2=new n.UI.FlexLayout(0).identify("fgc-advancedfilter-contentflex");i.id="fgc-advancedfilter-dialog";i.bindProperty(i.targetNameTextBlock,"text","targetName");i.bindProperty(i.comboBox,"value","selectModel");i.bindProperty(i.comboBox,"items","prefabModels");i.bindProperty(i.textBox1,"text","value1");i.bindProperty(i.textBox2,"text","value2");i.on("PropertyChanged",function(t,r){r==="selectModel"&&(i.selectModel.type===13||i.selectModel.type===14?(i.textBox2.show(),i.modeTextBlock.show()):(i.textBox2.hide(),i.modeTextBlock.hide()),n.DelayRefresh.setTimeout(function(){i.textBox1.focus()}))});i.textBox1.on("Confirm",function(){i.confirm()});i.textBox2.on("Confirm",function(){i.confirm()});return i.comboBox.displayName="title",i.initializeFlexLayout(),i}return __extends(i,t),Object.defineProperty(i.prototype,"title",{get:function(){return n.RS.ColumnFilter_ContextMenu_CustomFilter},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"whereTitle",{get:function(){return n.RS.ColumnFilter_TextBlock_Where},enumerable:!0,configurable:!0}),i.prototype.initializeFlexLayout=function(){this.outerFlex.add(this.innerFlex1);this.outerFlex.add(this.innerFlex2);this.outerFlex.add(this.exampleTextBlock);this.innerFlex1.add(this.titleTextBlock);this.innerFlex1.add(this.targetNameTextBlock);n.RS.Culture==="JA"?(this.innerFlex2.add(this.textBox1),this.innerFlex2.add(this.modeTextBlock),this.innerFlex2.add(this.textBox2),this.innerFlex2.add(this.comboBox)):(this.innerFlex2.add(this.comboBox),this.innerFlex2.add(this.textBox1),this.innerFlex2.add(this.modeTextBlock),this.innerFlex2.add(this.textBox2))},i}(n.UI.Dialog);n.AdvancedFilterDialog=u;f=function(t){function i(){var i=t!==null&&t.apply(this,arguments)||this;return i.setTimeout=n.DelayRefresh.setTimeout,i}return __extends(i,t),Object.defineProperty(i.prototype,"content",{get:function(){return new o(this.target)},enumerable:!0,configurable:!0}),i}(n.UI.DialogUI);n.AdvancedFilterDialogUI=f;o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.outerFlex.createUI())},t}(n.UI.DialogContentUI)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.contextMenuCompareTypes=[[1,2],[3,5,],[7,8,]],n.supportedCompareTypes=[1,2,3,4,5,6,7,8,15,16],n}return __extends(i,t),Object.defineProperty(i.prototype,"title",{get:function(){return n.RS.ColumnFilter_ContextMenu_TextFilter},enumerable:!0,configurable:!0}),i.prototype.getExampleText=function(t){return t===15||t===16?n.RS.ColumnFilter_TextBlock_TextExample_In:""},i.prototype.generate=function(n,t){var i=this.convertValueToReal(t[0]);switch(n){case 1:return[{ConditionType:1,CompareType:0,Value:i}];case 2:return[{ConditionType:1,CompareType:1,Value:i}];case 3:return[{ConditionType:1,CompareType:2,Value:i}];case 4:return[{ConditionType:1,CompareType:3,Value:i}];case 5:return[{ConditionType:1,CompareType:4,Value:i}];case 6:return[{ConditionType:1,CompareType:5,Value:i}];case 7:return[{ConditionType:1,CompareType:6,Value:i}];case 8:return[{ConditionType:1,CompareType:7,Value:i}];case 15:return[{ConditionType:1,CompareType:8,Value:i}];case 16:return[{ConditionType:1,CompareType:9,Value:i}];default:return[]}},i}(n.AdvancedFilter);n.TextFilter=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.contextMenuCompareTypes=[[1,2],[9,11,13]],n.supportedCompareTypes=[1,2,9,10,11,12,13,14,],n}return __extends(i,t),Object.defineProperty(i.prototype,"title",{get:function(){return n.RS.ColumnFilter_ContextMenu_NumberFilter},enumerable:!0,configurable:!0}),i.prototype.getExampleText=function(n){return""},i.prototype.generate=function(n,t){var i=this.convertValueToReal(t[0]),r;switch(n){case 1:return[{ConditionType:0,CompareType:0,Value:i}];case 2:return[{ConditionType:0,CompareType:1,Value:i}];case 9:return[{ConditionType:0,CompareType:2,Value:i}];case 10:return[{ConditionType:0,CompareType:3,Value:i}];case 11:return[{ConditionType:0,CompareType:4,Value:i}];case 12:return[{ConditionType:0,CompareType:5,Value:i}];case 13:return r=this.convertValueToReal(t[1]),[{ConditionType:0,CompareType:3,Value:i},{ConditionType:0,CompareType:5,Value:r}];case 14:return r=this.convertValueToReal(t[1]),[{ConditionType:0,CompareType:4,Value:i},{ConditionType:0,CompareType:2,Value:r}];default:return[]}},i.prototype.convertValueToReal=function(t){if(typeof t=="number")return t;if(typeof t=="string"&&t.trim()==="")return n.KeyWords.Null;var i=Number(t);if(isNaN(i))throw new Error;else return i},i}(n.AdvancedFilter);n.NumberFilter=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getExampleText=function(t){return t===13||t===14?n.RS.ColumnFilter_TextBlock_TimeExample_Between:n.RS.ColumnFilter_TextBlock_TimeExample},i.prototype.convertValueToReal=function(t){var i,r;if(typeof t=="number")return t;if(t.trim()==="")return n.KeyWords.Null;if(i=n.FormatHelper.getValueFromText(t),i instanceof Date)return n.ConvertDateToOADate(i);if(r=Number(i),isNaN(r))throw new Error;else return r},i.prototype.convertConditionToString=function(t){return t.Value===n.KeyWords.Null?"":n.FormatHelper.formatValue(t.Value,"hh:mm:ss")},i}(n.NumberFilter);n.TimeFilter=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var t,i,u=(t={},Object.defineProperty(t,100,{get:function(){return n.RS.DateCompareType_Tomorrow},enumerable:!0,configurable:!0}),Object.defineProperty(t,101,{get:function(){return n.RS.DateCompareType_Today},enumerable:!0,configurable:!0}),Object.defineProperty(t,102,{get:function(){return n.RS.DateCompareType_Yesterday},enumerable:!0,configurable:!0}),Object.defineProperty(t,103,{get:function(){return n.RS.DateCompareType_NextWeek},enumerable:!0,configurable:!0}),Object.defineProperty(t,104,{get:function(){return n.RS.DateCompareType_ThisWeek},enumerable:!0,configurable:!0}),Object.defineProperty(t,105,{get:function(){return n.RS.DateCompareType_LastWeek},enumerable:!0,configurable:!0}),Object.defineProperty(t,106,{get:function(){return n.RS.DateCompareType_NextMonth},enumerable:!0,configurable:!0}),Object.defineProperty(t,107,{get:function(){return n.RS.DateCompareType_ThisMonth},enumerable:!0,configurable:!0}),Object.defineProperty(t,108,{get:function(){return n.RS.DateCompareType_LastMonth},enumerable:!0,configurable:!0}),Object.defineProperty(t,109,{get:function(){return n.RS.DateCompareType_NextYear},enumerable:!0,configurable:!0}),Object.defineProperty(t,110,{get:function(){return n.RS.DateCompareType_ThisYear},enumerable:!0,configurable:!0}),Object.defineProperty(t,111,{get:function(){return n.RS.DateCompareType_LastYear},enumerable:!0,configurable:!0}),t),r=(i={},Object.defineProperty(i,11,{get:function(){return n.RS.ContextMenu_CompareType_IsLessThan_Date},enumerable:!0,configurable:!0}),Object.defineProperty(i,9,{get:function(){return n.RS.ContextMenu_CompareType_IsGreaterThan_Date},enumerable:!0,configurable:!0}),i),f=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.contextMenuCompareTypes=[[1,],[11,9,13]],n.contextMenuDateCompareTypes=[[100,101,102,],[103,104,105,],[106,107,108,],[109,110,111]],n}return __extends(i,t),Object.defineProperty(i.prototype,"title",{get:function(){return n.RS.ColumnFilter_ContextMenu_DateFilter},enumerable:!0,configurable:!0}),i.prototype.getExampleText=function(t){return t===13||t===14?n.RS.ColumnFilter_TextBlock_DateExample_Between:n.RS.ColumnFilter_TextBlock_DateExample},i.prototype.createContextMenu=function(i,f){var s=this,e=t.prototype.createContextMenu.call(this,i,f),o=[];return o.push(new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter)),this.contextMenuDateCompareTypes.forEach(function(t,r){t.forEach(function(t){var r=new n.UI.ContextMenuButton(u[t]).on("Clicked",function(){e.dispose();f.clearColumnFilterValues();f.filterCompareType=t;f.filterConditions=s.generateByDateCompareType(t);n.ColumnFilterHelper.setColumnFilterCache(i.getLocationString(),i.getColumnFilterQueries());i.resetToFirstPage();i.fillData()});r.isChecked=!n.Common.IsEmpty(f.filterConditions)&&t===f.filterCompareType;o.push(new n.UI.ContextMenuItem(r))});o.push(new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter))}),e.items[2].inner.text=r[11]+"...",e.items[3].inner.text=r[9]+"...",e.items=__spreadArrays(e.items.slice(0,e.items.length-2),o,e.items.slice(-1)),e},i.prototype.convertValueToReal=function(t){var i,r;if(typeof t=="number")return t;if(t.trim()==="")return n.KeyWords.Null;if(i=n.FormatHelper.getValueFromText(t),i instanceof Date)return n.ConvertDateToOADate(i);if(r=Number(i),isNaN(r))throw new Error;else return r},i.prototype.convertConditionToString=function(t){return t.Value===n.KeyWords.Null?"":n.FormatHelper.getTextFromValue(n.ConvertOADateToDate(t.Value))},i.prototype.getCustomFilterIsChecked=function(t){if(!n.Common.IsEmpty(t.filterConditions)){var i=this.contextMenuCompareTypes.reduce(function(n,t){return n.concat(t)}),r=this.contextMenuDateCompareTypes.reduce(function(n,t){return n.concat(t)});return i.indexOf(t.filterCompareType)<0&&r.indexOf(t.filterCompareType)<0}return!1},i.prototype.generateByDateCompareType=function(t){var i=new Date,r,u,f,e;switch(t){case 100:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()+1);u=new Date(i.getFullYear(),i.getMonth(),i.getDate()+2);break;case 101:r=new Date(i.getFullYear(),i.getMonth(),i.getDate());u=new Date(i.getFullYear(),i.getMonth(),i.getDate()+1);break;case 102:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()-1);u=new Date(i.getFullYear(),i.getMonth(),i.getDate());break;case 103:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()+(7-i.getDay()));u=new Date(i.getFullYear(),i.getMonth(),i.getDate()+(7-i.getDay())+7);break;case 104:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()-i.getDay());u=new Date(i.getFullYear(),i.getMonth(),i.getDate()+(7-i.getDay()));break;case 105:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()-i.getDay()-7);u=new Date(i.getFullYear(),i.getMonth(),i.getDate()-i.getDay());break;case 106:r=new Date(i.getFullYear(),i.getMonth()+1);u=new Date(i.getFullYear(),i.getMonth()+2);break;case 107:r=new Date(i.getFullYear(),i.getMonth());u=new Date(i.getFullYear(),i.getMonth()+1);break;case 108:r=new Date(i.getFullYear(),i.getMonth()-1);u=new Date(i.getFullYear(),i.getMonth());break;case 109:r=new Date(i.getFullYear()+1,0);u=new Date(i.getFullYear()+2,0);break;case 110:r=new Date(i.getFullYear(),0);u=new Date(i.getFullYear()+1,0);break;case 111:r=new Date(i.getFullYear()-1,0);u=new Date(i.getFullYear(),0);break;default:return null}return f=n.ConvertDateToOADate(r),e=n.ConvertDateToOADate(u),[{ConditionType:0,CompareType:3,Value:f},{ConditionType:0,CompareType:4,Value:e}]},i}(n.NumberFilter);n.DateFilter=f}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(i){var r=t.call(this)||this,u;return r.id="fgc-rowheader-contextmenu",r.insertButton=(new n.UI.ContextMenuButton).identify("fgc-rowheader-insert"),r.deleteButton=(new n.UI.ContextMenuButton).identify("fgc-rowheader-delete"),r.duplicateButton=(new n.UI.ContextMenuButton).identify("fgc-rowheader-duplicate"),u=i.listviewData.getRowHeaderContextMenuData(),u.ContextMenuItems.forEach(function(t){if(t&&t.Visible)if(t.OperationType===n.ContextMenuOperationType.Insert){r.insertButton.text=t.Text;r.insertButton.enabled=i.allowInsertRow();r.insertButton.on("Clicked",function(){i.insertRow(!0);r.dispose()});r.items.push(new n.UI.ContextMenuItem(r.insertButton))}else if(t.OperationType===n.ContextMenuOperationType.Delete){r.deleteButton.text=t.Text;r.deleteButton.on("Clicked",function(){i.deleteOnUIClick();r.dispose()});r.items.push(new n.UI.ContextMenuItem(r.deleteButton))}else if(t.OperationType===n.ContextMenuOperationType.Duplicate){r.duplicateButton.text=t.Text;r.duplicateButton.enabled=i.allowDuplicateRow();r.duplicateButton.on("Clicked",function(){i.duplicateRow(!0);r.dispose()});r.items.push(new n.UI.ContextMenuItem(r.duplicateButton))}}),r}return __extends(i,t),i}(n.UI.ContextMenu),i=function(i){function r(n,t){var r=i.call(this)||this;r.listview=n;r.canvas=t;$(t).on("contextmenu",function(n){n.preventDefault()});return r}return __extends(r,i),r.prototype.onOpenMenu=function(i,r,u,f){var e,o;if(u.worksheetHitInfo.hitTestType===GC.Spread.Sheets.SheetArea.rowHeader){if(!this.listview.tryCommitEdit())return!0;if(this.listview.allowShowTotalRow())if(this.listview.listviewData.getIsTotalRowAtFirstRow()){if(u.worksheetHitInfo.row===0)return!0}else if(u.worksheetHitInfo.row===this.listview.getSheet().getRowCount()-1)return!0;e=new t(this.listview);n.ForguncyData.pageInfo.appendExtralPopup(e);n.PageBuilder.pagesContainer.append(e.createUI().container);o=$(this.canvas).offset();e.location=new n.Numerics.Vector2(o.left+u.x||0,o.top+u.y||0);e.show()}return!0},r}(GC.Spread.Sheets.ContextMenu.ContextMenu);n.SpreadContextMenu=i}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var o=function(t){function r(){var r=t.call(this)||this,u=r;return r.normalCellDataModel=new i,r.normalCellDataModel.bind(n.Events.ValueChanged,function(t,i){u.trigger(n.Events.ValueChanged,{arg:i})}),r._listDatas=[],r}return __extends(r,t),r.prototype.addListData=function(t,i,r,f){var o=this,e=new u(i,r,f,t);return this._listDatas.push(e),e.bind(n.Events.ValueChanged,function(t,r){o.trigger(n.Events.ValueChanged,{calcName:i,arg:r})}),e},r.prototype.removeListData=function(n){var t=this._listDatas.indexOf(n);t!==-1&&(n.unbindAll(),this._listDatas.splice(t,1))},r.prototype.getListDataList=function(n){return this._listDatas.filter(function(t){return n.indexOf(t.runTimePageName)>=0})},r.prototype.getListDataByListviewName=function(n,t){var i=this._listDatas.filter(function(i){return i.listviewName===n&&i.runTimePageName===t});return i.length>=0?i[0]:null},r.prototype.getListDataByCalcSheetName=function(n){var t=this._listDatas.filter(function(t){return t.name===n});return t.length>=0?t[0]:null},r}(n.EventClassBase),i,r,t,f,e,u;n.DataModel=o;i=function(t){function i(){var n=t.call(this)||this;return n._data={},n}return __extends(i,t),i.prototype.setValue=function(t,i,r,u){var f,s,e,o;(u===void 0&&(u=!1),i?(f=i.newValue,s=i.uiAction):f=i,e=this.getValue(t),o={value:f,valueType:r,bindingValue:r===2?f:this.getBindingValue(t)},u&&(o.ignoreExport=!0),this._data[t]=o,e!==f)&&this.trigger(n.Events.ValueChanged,{id:t,oldValue:e,newValue:f,uiAction:s,valueType:r})},i.prototype.hasValue=function(n){return typeof this._data[n]!="undefined"},i.prototype.getValue=function(n){var t=this._data[n];return typeof t=="undefined"||typeof t.value=="undefined"?null:t.value},i.prototype.getValueType=function(n){var t=this._data[n];return typeof t=="undefined"||typeof t.valueType=="undefined"?0:t.valueType},i.prototype.getBindingValue=function(n){var t=this._data[n];return typeof t=="undefined"||typeof t.bindingValue=="undefined"?null:t.bindingValue},i.prototype.getAllExportDatas=function(){var t={};for(var n in this._data)this._data[n].ignoreExport||(t[n]=this.getValue(n));return t},i.prototype.clearValue=function(n){delete this._data[n]},i}(n.EventClassBase);n.NormalCellDataModel=i;r=function(){function n(){}return n}();n.ListDataValue=r;t=function(){function n(){}return n}();n.ListRowInfo=t;f=function(){function n(){}return n}();n.ListRowData=f;e=function(){function n(){}return n}();n.ListDataModelValueChangedEventArg=e;u=function(i){function u(n,t,r,u){var f=i.call(this)||this;return f.name=n,f._columnCount=t,f.runTimePageName=r,f.listviewName=u,f._data=[],f}return __extends(u,i),u.prototype.resetColumnCount=function(n){this._columnCount=n;this._data=[]},u.prototype.getSelectIndex=function(){return this._selectedRowIndex},u.prototype.select=function(t){t!=this._selectedRowIndex&&(this._selectedRowIndex=t,this.trigger(n.Events.SelectionChanged,t))},u.prototype.getRowData=function(n){return this._isRowIndexValid(n)?this._data[n]:null},u.prototype.getData=function(){return n.Common.clone(this._data)},u.prototype.setData=function(t,i){var u=this.getRowCount(),r,f;(this._data=[],t&&t.length&&(this._data=t),r=this.getRowCount(),r!==0||u!==0)&&(f={cellRange:{Row:-1,Column:-1,RowCount:-1,ColumnCount:-1},oldRowCount:u,newRowCount:r,uiAction:!!i,actionType:0,valueType:2},this.trigger(n.Events.ValueChanged,f))},u.prototype.insertData=function(t,i,r,u,f){var o,e,s;!i||i.length<=0||(e=this.getRowCount(),t<0||t>e)||((o=this._data).splice.apply(o,__spreadArrays([t,0],i)),f||this.select(this._selectedRowIndex+i.length),s={cellRange:{Row:t,Column:-1,RowCount:i.length,ColumnCount:-1},oldRowCount:e,newRowCount:this.getRowCount(),uiAction:!!u,actionType:4,valueType:r},this.trigger(n.Events.ValueChanged,s))},u.prototype.addData=function(t,i,r){var u,f,e;!t||t.length<=0||(u=this.getRowCount(),f=u,this._data=this._data.concat(t),e={cellRange:{Row:f,Column:-1,RowCount:t.length,ColumnCount:-1},oldRowCount:u,newRowCount:this.getRowCount(),uiAction:!!r,actionType:1,valueType:i},this.trigger(n.Events.ValueChanged,e))},u.prototype.setValue=function(t,i,u,f,e){var h,o,s,c;this._isRowIndexValid(t)&&this._isColumnIndexValid(i)&&(h=this.getValue(t,i),o=new r,o.value=u,o.valueType=f,o.bindingValue=f===2?u:this.getBindingValue(t,i),this._data[t].data[i]=o,h!==u)&&(s=this.getRowCount(),c={cellRange:{Row:t,Column:i,RowCount:1,ColumnCount:1},oldRowCount:s,newRowCount:s,uiAction:!!e,actionType:3,valueType:f},this.trigger(n.Events.ValueChanged,c))},u.prototype.getBindingValue=function(n,t){if(!this._isRowIndexValid(n)||!this._isColumnIndexValid(t))return null;var i=this._data[n].data[t];return typeof i=="undefined"||typeof i.bindingValue=="undefined"?null:i.bindingValue},u.prototype.getValueType=function(n,t){if(!this._isRowIndexValid(n)||!this._isColumnIndexValid(t))return 0;var i=this._data[n].data[t];return typeof i=="undefined"||typeof i.valueType=="undefined"?0:i.valueType},u.prototype.getValue=function(n,t){var i,r;return!this._isRowIndexValid(n)||!this._isColumnIndexValid(t)?null:(i=this._data[n].data[t],typeof i=="undefined")?null:(r=i.valueType===2?i.bindingValue:i.value,typeof r=="undefined"?null:r)},u.prototype.getRowValue=function(n){var i,r,t;if(!this._isRowIndexValid(n))return null;for(i=[],r=this.getColumnCount(),t=0;t<r;t++)i.push(this.getValue(n,t));return i},u.prototype.getRowInfo=function(n){return this._isRowIndexValid(n)?this._data[n].rowInfo:null},u.prototype.getRowQuery=function(n){var t=this.getRowInfo(n);return t?t.query:null},u.prototype.getRowVersion=function(n){var t=this.getRowInfo(n);return t?t.rowVersion:null},u.prototype.setRowQuery=function(n,i){if(this._isRowIndexValid(n)){var r=this._data[n];r.rowInfo||(r.rowInfo=new t);r.rowInfo.query=i}},u.prototype.setRowVersion=function(n,i){if(this._isRowIndexValid(n)){var r=this._data[n];r.rowInfo||(r.rowInfo=new t);r.rowInfo.rowVersion=i}},u.prototype.clear=function(){this.setData([])},u.prototype.getRowIndexByQuery=function(t){var u,i,r;if(!t)return-1;for(u=this._data.length,i=0;i<u;i++)if(r=this._data[i].rowInfo,r&&n.Common.isQueryEqual(r.query,t))return i;return-1},u.prototype._isRowIndexValid=function(n){return n!==null&&n>=0&&n<this._data.length},u.prototype._isColumnIndexValid=function(n){return n!==null&&n>=0&&n<this._columnCount},u.prototype.getRowCount=function(){return this._data.length},u.prototype.getColumnCount=function(){return this._columnCount},u.prototype.deleteRow=function(t,i){var r,u;this._isRowIndexValid(t)&&(r=this.getRowCount(),this._data.splice(t,1),u={cellRange:{Row:-1,Column:-1,RowCount:-1,ColumnCount:-1},oldRowCount:r,newRowCount:this.getRowCount(),uiAction:!!i,actionType:2,valueType:5,deleteRow:t},this.trigger(n.Events.ValueChanged,u))},u.prototype.isDirty=function(n,t){return n===-1&&t===-1?this._isDirtySheet():t===-1?this._isDirtyRow(n):!this._isRowIndexValid(n)||!this._isColumnIndexValid(t)?!1:this._isDirtyValue(this._data[n].data[t])},u.prototype._isDirtyValue=function(n){if(typeof n=="undefined")return!1;if(n.valueType===2||n.valueType===1)return!1;else{var t=typeof n.bindingValue=="undefined"?null:n.bindingValue,i=typeof n.value=="undefined"?null:n.value;return t!==i}},u.prototype._isDirtyRow=function(n){var t,r,i;if(!this._isRowIndexValid(n))return!1;if(t=this._data[n],typeof t.rowInfo=="undefined")return!0;for(r=t.data.length,i=0;i<r;i++)if(this._isDirtyValue(t.data[i]))return!0;return!1},u.prototype._isDirtySheet=function(){for(var t=this.getRowCount(),n=0;n<t;n++)if(this._isDirtyRow(n))return!0;return!1},u}(n.EventClassBase);n.ListDataModel=u}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(){function n(){}return n.prototype.setCurrentPageIndex=function(n){isNaN(n)||(this.currentPageIndex=Math.max(1,n))},n.prototype.getCurrentPageIndex=function(){return this.currentPageIndex},n.prototype.getPageCount=function(){return this.limit>0?Math.max(1,Math.ceil(this.rowCount/this.limit)):1},n}(),i;n.PageingInfoItem=t;i=function(i){function r(){var n=i!==null&&i.apply(this,arguments)||this;return n._list={},n}return __extends(r,i),r.prototype.IsPageing=function(n){var t=this.GetInfo(n);return t.limit>0},r.prototype.Init=function(i,r){if(r===void 0&&(r=0),n.Common.IsEmpty(this._list)&&(this._list={}),n.Common.IsEmpty(this._list[i])){var u=new t;u.setCurrentPageIndex(1);u.limit=r;u.rowCount=-1;this._list[i]=u}},r.prototype.RefeshRowCount=function(n){this.Init(n);var t=this.GetInfo(n);(t.getCurrentPageIndex()!==1||t.limit!==0)&&this.GetRowCount(n)},r.prototype.GetPageIndex=function(n){var t=this.GetInfo(n);return t.getCurrentPageIndex()},r.prototype.SetPageingInfo=function(n,t,i){this.Init(n);var r=this._list[n];(r.getCurrentPageIndex()!==t||r.limit!==i)&&(r.setCurrentPageIndex(t),r.limit=i,this.triggerPageingInfoChanged(n))},r.prototype.ResetPageIndexToFirstPage=function(n){this.Init(n);this._list[n].setCurrentPageIndex(1)},r.prototype.triggerPageingInfoChanged=function(t){var i={listviewLocation:t,pagingInfo:this.GetInfo(t)};this.trigger(n.Events.PageingInfoChanged,i)},r.prototype.triggerPageingRowcountChanged=function(t){var i={listviewLocation:t,pagingInfo:this.GetInfo(t)};this.trigger(n.Events.PageingRowcountChanged,i)},r.prototype.triggerPageingUIInvalide=function(t){var i={listviewLocation:t,pagingInfo:this.GetInfo(t)};this.trigger(n.Events.PageingUIInvalide,i)},r.prototype.GetLimit=function(n){var t=this.GetInfo(n);return t.limit},r.prototype.GetRowCount=function(n){var t=this.GetInfo(n);return this.GetRowCountFromServer(n),t=this.GetInfo(n),t.rowCount},r.prototype.SetRowCount=function(n,t){this.Init(n);this._list[n].rowCount=t},r.prototype.SetInfo=function(t,i){this.Init(t);var r=this._list[t];(n.Common.IsEmpty(r)||r.getCurrentPageIndex()!==i.getCurrentPageIndex()||r.limit!==i.limit||r.rowCount!==i.rowCount)&&(this._list[t]=i)},r.prototype.GetInfo=function(n){this.Init(n);var r=this._list[n],i=new t;return i.setCurrentPageIndex(r.getCurrentPageIndex()),i.limit=r.limit,i.rowCount=r.rowCount,i},r.prototype.GetRowCountFromServer=function(t){var i=this,u=n.ListviewBase.getAllListviews().filter(function(n){return n.getLocationString()===t}),r;if(u.length<=0||(r=u[0],r.isGroupMode()))return 0;var f=r.getRowInfo(),e=n.ForguncyData.pageInfo.commandQuerys[f.currentTable],o=r.getColumnFilterQueries();n.HomeController.GetRowCount({queryCommandInfo:e,currentRowInfo:f,columnFilterQueries:o},function(r){var u,o,f,e;if(n.Common.IsEmpty(r))return 0;u=Number(r);o=i._list[t].rowCount;o!==u?(f=i.GetPageIndex(t),e=i.GetLimit(t),f=e!==0&&u!==0?Math.min(f,Math.ceil(u/e)):1,i.SetRowCount(t,u),i._list[t].setCurrentPageIndex(f),i.triggerPageingRowcountChanged(t)):i.triggerPageingUIInvalide(t)})},r}(n.EventClassBase);n.PageingInfoList=i}(Forguncy||(Forguncy={})),function(n){var i=function(){function t(){}return t.validateCell=function(i){var r=t.validateRules(i);switch(r.result){case 0:n.ValidationTooltipHelper.destroyTooltip(i.getContainer());break;case 1:n.ValidationTooltipHelper.showTooltip(i.getContainer()[0],r.message);break;case 2:n.DelayOperateHelper.Push(null,function(){t.validateCell(i)},1)}return r.result},t.validateRules=function(n){var r=n.getValidationRules();if(!r)return{result:0};var f=n.getValue(!1),e=n.getValue(!0),u=null,i=0;return r.every(function(r){var o=t.getValidator(r);i=o.validate(f,e,n.ID,n.runTimePageName);switch(i){case 0:return!0;case 1:return u=o.getErrorMessage(),!1;case 2:return!1}}),{result:i,message:u}},t.getValidator=function(t){switch(t.Type){case 0:return new n.DataValidator(t.Param);case 1:return new n.UniqueValidator(t.Param)}},t.validateAllCells=function(i,r){if(i===void 0&&(i=!0),r===void 0&&(r=null),!n.ForguncyData.pageInfo.pageElementManager)return 0;var u=null,f=!1;return n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(r).map(function(n){return n.cellType}).filter(function(n){return!!n}).forEach(function(n){switch(t.validateCell(n)){case 0:break;case 1:u||(u=n);break;case 2:f=!0;break}}),f?2:u?(i&&t.showAndFocusCell(u),1):0},t.showAndFocusCell=function(t){n.Common.scrollToElement(t.getContainer(),t.runTimePageName);n.DelayRefresh.setTimeout(function(){t.setFocus()},400)},t.clearCache=function(t){delete n.UniqueValidator.cache[t]},t.validateDataValidation=function(t,i,r,u){if(u===void 0&&(u=null),!t||!t.DataValidation)return null;var f=new n.DataValidator({dataValidationInfo:t.DataValidation},u);return f.validate(i,i,null,r)===0?null:f.getErrorMessage()},t.validateRepeaterCells=function(i,r){var f=n.ForguncyData.pageInfo.pageElementManager.getRepeaterCellOfListview(i),u=[];return f.forEach(function(n){return u=u.concat(n.getAllRunTimePageNames())}),u.length>0?t.validateAllCells(r,u):0},t}(),t;n.ValidationMananger=i;t=function(){function n(){}return n.createValidationRules=function(t,i){var r=[n.getUniqueRule(t,i),n.getDataValidationRule(t)].filter(function(n){return!!n});return r.length===0?null:r},n.getUniqueRule=function(n,t){var r,u,f,i;if(t||(r=n&&n.CellType&&n.CellType.Validators,!r))return null;for(u=0;u<r.length;u++)if((f=r[u],f.$type.indexOf("UniqueValidadator")!==-1)&&(i=n.BindingInfo,typeof i!="undefined"&&typeof i.TableName!="undefined"&&typeof i.ColumnName!="undefined"&&typeof i.RelationBinding=="undefined"))return{Type:1,Param:{table:i.TableName,column:i.ColumnName}};return null},n.getDataValidationRule=function(n){return!n||!n.DataValidation?null:{Type:0,Param:{dataValidationInfo:n.DataValidation}}},n}();n.ValidateRuleCreator=t}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(n){this._param=n}return t.prototype.validate=function(i,r,u,f){var e,o;return n.Common.IsEmpty(r)?0:n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getBindingValue(u)===r?0:(e=t.cache[u],e&&e.value===r)?e.unique:(t.cache[u]={value:r,unique:2},o={table:this._param.table,column:this._param.column,value:r},n.Common.forguncyPost("Home/CheckDatabase",o,function(n){t.cache[u]&&(t.cache[u].unique=n?0:1)},u+" CheckDatabase"),2)},t.prototype.getErrorMessage=function(){return n.RS.unique},t.cache={},t}();n.UniqueValidator=t}(Forguncy||(Forguncy={})),function(n){var i=function(){function i(n,t){t===void 0&&(t=null);this._param=n;this._listInfo=t}return i.prototype.validate=function(n,i,r,u){return t.IsValidValue(this._param.dataValidationInfo,n,u,this._listInfo)?0:1},i.prototype.getErrorMessage=function(){var i=this._param.dataValidationInfo,t;if(!n.Common.IsEmpty(i.ErrorMessage))return i.ErrorMessage;n.Common.IsEmpty(i.NumberType)&&(i.NumberType=0);switch(i.NumberType){case 0:t=n.RS.DataValidation_Required;break;case 1:t=n.RS.DataValidation_WholeNumberDefaultErrorMessage;break;case 2:t=n.RS.DataValidation_DecimalDefaultErrorMessage;break;case 4:t=n.RS.DataValidation_DateDefaultErrorMessage;break;case 5:t=n.RS.DataValidation_TimeDefaultErrorMessage;break;case 6:t=n.RS.DataValidation_TextLenghtDefaultErrorMessage;break;case 7:t=n.RS.DataValidation_CustomDefaultErrorMessage;break;case 8:t=n.Common.IsEmpty(i.SelectedDefaultRegularExpression)?n.RS.DataValidation_RegularUserInputDefaultErrorMessage:n.Common.format(n.RS.DataValidation_RegularDefaultErrorMessage,i.SelectedDefaultRegularExpression);break}return t},i.isValid=function(t,r,u){return u===void 0&&(u=n.StaticValues.RunTimeNormalPage),new i({dataValidationInfo:t}).validate(r,r,null,u)===0},i}(),t;n.DataValidator=i;t=function(){function t(){}return t.IsValidValueByDataValidationInfo=function(t,i){if(!this.IsValidDataValidationInfo(t))return!0;if(t.NumberType===undefined&&(t.NumberType=0),this.EnsureDatavalidationValue(t),n.Common.IsEmpty(i))if(t.IgnoreBlank===!0)return!0;else if(t.NumberType!==7&&t.NumberType!==8&&t.NumberType!==6)return!1;switch(t.NumberType){case 0:return this.AnyValueValidator(t,i);case 1:return this.WholeNumberValidator(t,i);case 2:return this.DecimalValidator(t,i);case 3:return this.ListValidator(t,i);case 4:return this.DateValidator(t,i);case 5:return this.TimeValidator(t,i);case 6:return this.TextLengthValidator(t,i);case 7:return this.CustomValidator(t,i);case 8:return this.RegularValidator(t,i);default:return!0}},t.IsValidValue=function(n,t,i,r){return r===void 0&&(r=null),this.runTimePageName=i,this.listInfo=r,this.IsValidValueByDataValidationInfo(n,t)},t.GetResultOfCompareValues=function(t,i,r,u){if((r===null||r==="")&&this.isValue1FromFormual||(u===null||u==="")&&this.isValue2FromFormual)return!0;t===undefined&&(t=0);i=+i;r=n.Common.IsEmpty(i)?null:+r;u=n.Common.IsEmpty(i)?null:+u;switch(t){case 0:if(i>=r&&i<=u)return!0;break;case 1:if(i<r||i>u)return!0;break;case 2:if(i===r)return!0;break;case 3:if(i!==r)return!0;break;case 4:if(i>r)return!0;break;case 6:if(i>=r)return!0;break;case 5:if(i<r)return!0;break;case 7:if(i<=r)return!0;break}return!1},t.AnyValueValidator=function(n,t){return!0},t.WholeNumberValidator=function(n,t){return $.isNumeric(t)?t%1!=0?!1:this.GetResultOfCompareValues(n.CompareParamType,t,this.value1,this.value2):!1},t.DecimalValidator=function(n,t){return $.isNumeric(t)?this.GetResultOfCompareValues(n.CompareParamType,t,this.value1,this.value2):!1},t.ListValidator=function(n,t){return this.value1.indexOf(t)===-1?!1:!0},t.DateValidator=function(t,i){var e=null;if(typeof i=="number"&&(i=n.Convertor.fromOADateToDate(i)),!this.isValideDateTime(i))return!1;var f=new Date(i),r=this.value1,u=this.value2;return n.Common.IsEmpty(this.value1)||(r=!isNaN(this.value1)&&(this.isValue1FromFormual||!(this.value1 instanceof Date))?n.Convertor.fromOADateToDate(this.value1):new Date(this.value1)),n.Common.IsEmpty(this.value2)||(u=!isNaN(this.value2)&&(this.isValue2FromFormual||!(this.value2 instanceof Date))?n.Convertor.fromOADateToDate(this.value2):new Date(this.value2)),this.GetResultOfCompareValues(t.CompareParamType,f,r,u)},t.TimeValidator=function(t,i){if(typeof i=="number"&&(i>1&&(i=i-1),i=n.Convertor.fromOADateToDate(i)),!this.isValideDateTime(n.FormatHelper.getValueFromText(i)))return!1;var f=n.FormatHelper.getValueFromText(i),r=this.value1,u=this.value2;return n.Common.IsEmpty(this.value1)||(r=!isNaN(this.value1)&&(this.isValue1FromFormual||!(this.value1 instanceof Date))?n.Convertor.fromOADateToDate(this.value1):n.FormatHelper.getValueFromText(this.value1)),n.Common.IsEmpty(this.value2)||(u=!isNaN(this.value2)&&(this.isValue2FromFormual||!(this.value2 instanceof Date))?n.Convertor.fromOADateToDate(this.value2):n.FormatHelper.getValueFromText(this.value2)),this.GetResultOfCompareValues(t.CompareParamType,f,r,u)},t.RegularValidator=function(t,i){n.Common.IsEmpty(i)&&(i="");var r=RegExp(this.value1);return r.test(i)},t.IsValidDataValidationInfo=function(n){return n===null||n===undefined?!1:!0},t.isValideDateTime=function(n){var t=new Date(n);return!this.isInvalidDate(t)},t.isInvalidDate=function(n){return isNaN(n)},t.CustomValidator=function(t,i){var r=this.isValue1FromFormual?this.value1:n.ForguncyData.pageInfo.formulaManager.evaluateFormula(this.value1,{runTimePageName:this.runTimePageName,supportReferToListview:!0,nullAsException:!1,listInfo:this.listInfo,rowOffset:0,columnOffset:0});return r===0||r==="0"||r===!1||r==="false"?!1:!0},t.TextLengthValidator=function(t,i){return n.Common.IsEmpty(i)&&(i=""),this.GetResultOfCompareValues(t.CompareParamType,i.toString().length,this.value1,this.value2)},t.EnsureDatavalidationValue=function(t){this.value1=t.FirstParamValue;this.value2=t.SecondParamValue;n.Common.IsEmpty(this.value1)||this.isFormula(this.value1)&&(this.value1=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(this.value1,{runTimePageName:this.runTimePageName,supportReferToListview:!0,nullAsException:!1,listInfo:this.listInfo,rowOffset:0,columnOffset:0}),this.value1=this.value1===null?this.value1:this.value1.toString(),this.isValue1FromFormual=!0);n.Common.IsEmpty(this.value2)||this.isFormula(this.value2)&&(this.value2=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(this.value2,{runTimePageName:this.runTimePageName,supportReferToListview:!0,nullAsException:!1,listInfo:this.listInfo,rowOffset:0,columnOffset:0}),this.value2=this.value2===null?this.value2:this.value2.toString(),this.isValue2FromFormual=!0)},t.isFormula=function(n){return n&&n[0]==="="},t.runTimePageName=n.StaticValues.RunTimeNormalPage,t}()}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i=function(){function n(){}return n}(),t;n.CurrentRowInfo=i;t=function(t){function i(n){var i=t.call(this)||this;return i._normalCellBindingManager=n,i.list=[],i}return __extends(i,t),i.prototype.getCurrentRowInfo=function(t){if(this.list)for(var i=0;i<this.list.length;i++)if(this.list[i].currentTable===t)return n.Common.clone(this.list[i]);return null},i.prototype.setCurrentRowInfo=function(t,i){var u,e,r,f;if(t&&t.currentTable&&t.query){for(u=!0,e=!0,r=0;r<this.list.length;r++)if(this.list[r].currentTable===t.currentTable){n.Common.isQueryEqual(this.list[r].query,t.query)&&(u=!1);this.list[r]=t;e=!1;break}f={rowInfo:t,isQueryChanged:u};e?(this.list.push(t),f.change=0):f.change=1;this.trigger(n.Events.CurrentRowInfoChanged,f);i&&u&&this._normalCellBindingManager.getBindingValuesFromServer(t.currentTable,t.query)}},i.prototype.removeCurrentRowInfo=function(t){var r,i,u;if(t!==undefined)for(r=this.list.length,i=0;i<r;i++)if(this.list[i].currentTable===t){u=this.list.splice(i,1);this._normalCellBindingManager.clearBindingValues(t);this.trigger(n.Events.CurrentRowInfoChanged,{rowInfo:u[0],change:2,isQueryChanged:!0});break}},i.prototype.setCurrentRowInfoByAPI=function(t){var r,f,e;if(t){var o=this,u=function(t){var u,r,i;if(!n.Common.IsEmpty(t)){if(n.Common.IsEmpty(t.query)){t.table&&n.ErrorHelper.printErrorStr(n.Common.format(n.RS.SetCurrentRow_Error_NoRecord,t.table));return}for(u=n.ListviewBase.getAllListviews().filter(function(n){return n.getDataTableName()===t.table}),r=0;r<u.length;r++)if(u[r].selectRowByQuery(t.query)===!0)return;i=new n.CurrentRowInfo;i.currentTable=t.table;i.query=t.query;i.selectedRowIndex=0;i.recordID=0;o.setCurrentRowInfo(i,!0)}},i=t;if(i.TableName&&i.PrimaryKey){n.HomeController.GetQueryInfo(i.TableName,i.PrimaryKey,u);return}if(r=t,r.QueryCondition){f=n.Common.getRunTimePageNameFromFormulaCalcContext(r.FormulaCalcContext);e=n.ConditionHelper.getComputedSqlConditionFormula(r.QueryCondition,f,n.QueryNullPolicy.QueryAllItemsWhenValueIsNull);n.HomeController.GetQueryInfoByCondition(e,u);return}}},i}(n.EventClassBase);n.CurrentRowInfoCollection=t}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(){}return t.prototype.getRelatedCellIdsByTable=function(n){for(var r=[],i=this._getCells(),t=0;t<i.length;t++)i[t].bindingInfo&&i[t].bindingInfo.TableName===n&&r.push(i[t].id);return r},t.prototype.getRelatedCellIdsByBindingInfo=function(t,i){for(var f=[],u=this._getCells(i),r=0;r<u.length;r++)n.Common.isBindingInfoEquals(u[r].bindingInfo,t)&&f.push(u[r].id);return f},t.prototype.getBindingInfos=function(){for(var i,f,r,t=[],e=this._getCells(),u=0;u<e.length;u++)if(i=e[u].bindingInfo,i){for(f=!1,r=0;r<t.length;r++)if(n.Common.isBindingInfoEquals(i,t[r])){f=!0;break}f||t.push(i)}return t},t.prototype._getCells=function(t){return n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.pageElementManager?n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(t):[]},t}(),i=function(){function i(n){this._dataModel=n;this.bindingValueVersions={};this._cellBindingRef=new t}return i.prototype.getBindingValuesFromServer=function(t,i){if(this._dataModel&&t&&i){var r=this,u=r.getBindingInfos(t),f={columnBindingInfos:u,query:i,table:t};n.HomeController.GetTableRowData(f,function(n){r.isQueryInfoValid(t,i)&&n&&r.updateBindingValues(n,t,u)})}},i.prototype.isQueryInfoValid=function(t,i){if(!n.ForguncyData.pageInfo.currentRowInfoCollection)return!1;var r=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(t);return r&&n.Common.isQueryEqual(i,r.query)},i.prototype.updateBindingValues=function(n,t,i){for(var u,c=this._cellBindingRef.getBindingInfos(),e=n.Values.length,r=0;r<e;r++){var o=i[r],s=n.Values[r],f=this._cellBindingRef.getRelatedCellIdsByBindingInfo(o),h=f.length;for(u=0;u<h;u++)this._dataModel.setValue(f[u],{newValue:s},2)}n.RowVersionInfo?this.bindingValueVersions[n.RowVersionInfo.TableName]=n.RowVersionInfo.RowVersion:this.bindingValueVersions[t]=null},i.prototype.setValueToBindingCell=function(n,t,i){for(var u=this._cellBindingRef.getRelatedCellIdsByBindingInfo(n,i),r=0;r<u.length;r++)this._dataModel.setValue(u[r],{newValue:t},5)},i.prototype.clearBindingValues=function(n){var i,r,t;if(this._dataModel)for(i=this._cellBindingRef.getRelatedCellIdsByTable(n),r=i.length,t=0;t<r;t++)this._dataModel.setValue(i[t],{newValue:null},2)},i.prototype.getEditedBindingValues=function(t){for(var u,f={},r=this._cellBindingRef.getBindingInfos(),o=r.length,i=0;i<o;i++)if(r[i].TableName===t&&!r[i].RelationBinding&&!r[i].AttachType){var s=n.Common.getBindingInfoColumnName(r[i]),e=this._cellBindingRef.getRelatedCellIdsByBindingInfo(r[i]),h=e.length;for(u=0;u<h;u++)f[s]=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(e[u])}return f},i.prototype.getBindingValue=function(t){var i=this._cellBindingRef.getRelatedCellIdsByBindingInfo(t),r=i.length;return r===0?null:n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(i[r-1])},i.prototype.getBindingInfos=function(n){return this._cellBindingRef.getBindingInfos().filter(function(t){return t.TableName===n})},i.reloadData=function(t,r){var o,f,u;if(t&&(t=t.toLowerCase()),r){for(o=n.ListviewBase.getAllListviews(),u=0;u<o.length;u++){var e=o[u],s=e.getDataTableName(),h=e.getMasterDataTableName();(n.Common.IsEmpty(t)||s&&s.toLowerCase()===t||h&&h.toLowerCase()===t)&&e.fillData(null,n.Common.IsEmpty(t));n.Common.IsEmpty(t)&&e.needQueryData()||e.reloadItemsEditor(t)}for(f=n.ForguncyData.pageInfo.currentRowInfoCollection.list,u=0;u<f.length;u++)(n.Common.IsEmpty(t)||f[u].currentTable&&f[u].currentTable.toLowerCase()===t)&&n.ForguncyData.pageInfo.normalCellBindingManager.getBindingValuesFromServer(f[u].currentTable,f[u].query)}i.updateTableDataCacheForCombo(t,r);n.clearGetTableDataByConditionCache();i.reloadItemsCellType(t,!0,r);n.CustomFunction.ODataFunction.clearCache(t)},i.updateTableDataCacheForCombo=function(t,i){i&&n.TableColumnsCacheManager.updateCache(t)},i.reloadItemsCellType=function(t,r,u){var e,c,o,s,h,f;for(t&&(t=t.toLowerCase()),e=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(),c=e.length,f=0;f<c;f++)if(e[f].cellType){if(o=e[f].cellType,s=o.getBindingTables(),!s)continue;i.needReloadCellType(t,s)&&o.reload(u)}if(u&&!r)for(h=n.ListviewBase.getAllListviews(),f=0;f<h.length;f++)h[f].reloadItemsEditor(t)},i.needReloadCellType=function(t,i){if(n.Common.IsEmpty(t))return!0;for(var r=0;r<i.length;r++)if(!n.Common.IsEmpty(i[r])&&i[r].toLowerCase()===t)return!0;return!1},i}();n.NormalCellBindingManager=i}(Forguncy||(Forguncy={})),function(n){var t=GC.Spread.Sheets.ConditionalFormatting,f=function(){function t(r,u){this._currentRowInfoCollection=r;this.restoring=!1;this._cellsNeedExcuteCommandWhenValueChanged=[];this._dataModel=u.normalCellDataModel;this.cells=new i(this._dataModel);this._dataModel.bind(n.Events.ValueChanged,this,t._onValueChangedInDataModel);this.chartCollection=new n.ChartCollection(u);this.listviewCollection=new n.ListviewCollection;this._currentRowInfoCollection.bind(n.Events.CurrentRowInfoChanged,this,t._onCurrentRowInfoChanged)}return t._onValueChangedInDataModel=function(t,i){var r=t.data,u=r.cells.getCell(i.id),o,f,e;for(u!==null&&(o=r._dataModel.getValue(u.id),u.setValue(o),u.bindingInfo&&!u.bindingInfo.RelationBinding&&r._dataModel.getValueType(i.id)!==2&&r._changeMasterValueOfDetailTable(u.bindingInfo,i.newValue)),f=0;f<r._cellsNeedExcuteCommandWhenValueChanged.length;f++)(e=r._cellsNeedExcuteCommandWhenValueChanged[f],e.id===i.id)&&function(t){n.ForguncyData.commandExcutor.excuteCommand(t.commands,t.runTimePageName,t.cellType,t.id,n.Events.ValueChanged,function(){t.cellType.initValueWhenTriggerValueChangedCommand()})}(e)},t.prototype.addValueChangedCommandCell=function(n){n.cellType.initValueWhenTriggerValueChangedCommand();this._cellsNeedExcuteCommandWhenValueChanged.push(n)},t.prototype._changeMasterValueOfDetailTable=function(t,i){for(var f=n.ListviewBase.getAllListviews(),s=f.length,r=0;r<s;r++){var u=f[r],e=u.getMasterDataTableName(),o=u.getColumnOfMasterTable();e&&o&&e===t.TableName&&o===t.ColumnName&&u.masterValueChanged(i)}},t._onCurrentRowInfoChanged=function(n,t){var u=n.data,r,f,i;for(u.saveContext(),r=u.cells.getAllCells(),f=r.length,i=0;i<f;i++)r[i].onCurrentRowInfoChanged(t.rowInfo.currentTable)},t.prototype.setPrePageContext=function(t){var y=this.getStoredContext(),r,e,i,o,u,s,h,f,c,l,a,v;if(t=this.mergeStoredContextToPageContext(t,y),t){if(t.currentRowInfoList!=null)for(r=0;r<t.currentRowInfoList.length;r++){if(e=t.currentRowInfoList[r],i=t.loadBindingDataOption===1,t.loadBindingDataOption===undefined||t.loadBindingDataOption===0)for(i=!0,o=this.cells.getAllCells(),u=0;u<o.length;u++)if(s=o[u],s.commands){for(h=n.Common.enumAllCommandsMetaData(s.commands),f=0;f<h.length;f++)if(c=h[f],c.$type==="Forguncy.Model.UpdateDataTableCommand, Forguncy"&&(l=c,l.UpdateType==="add"&&l.TableName===e.currentTable)){i=!1;break}if(!i)break}i&&n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfo(e,!0)}if(t.querys)for(a in t.querys)n.ForguncyData.pageInfo.commandQuerys[a]=t.querys[a];if(t.sortInfoCache)for(v in t.sortInfoCache)n.ForguncyData.pageInfo.sortInfoCache[v]=t.sortInfoCache[v]}},t.prototype.initPassedValues=function(t){var e,r,i,u,s,f,o;if(t)for(e=0;e<t.length;e++)if(r=t[e],i=this.getTargetCellSiteOfPassValue(r),i)if(u=n.Common.getLocatedListview(i.runTimePageName,i.Row,i.Column),u){var h=u.getListDataModel(),a=r.TargetCell.Column-u.getRangeInfo().Column,v=h.getRowCount(),c=r.Source,l=0;for(f=0;f<v;f++)if(o=h.getValue(f,a),o!=null&&c!=null&&o.toString()===c.toString()){l=f;break}u.selectRow(l)}else try{s=n.Common.getIdStr(i.Row,i.Column,i.runTimePageName);this._dataModel.setValue(s,{newValue:r.Source},3)}catch(y){}},t.prototype.getTargetCellSiteOfPassValue=function(t){var r,i;return t.TargetCell.Row>=0&&t.TargetCell.Column>=0?{Row:t.TargetCell.Row,Column:t.TargetCell.Column,runTimePageName:n.Common.IsEmpty(t.TargetRunTimePageName)?n.StaticValues.RunTimeNormalPage:t.TargetRunTimePageName}:t.TargetCell.Name?(r=this.cells.getCellByName(t.TargetCell.Name,!0),!r)?null:(i=n.Common.parseIDStr(r.id),{Row:i.row,Column:i.col,runTimePageName:i.suffix}):null},t.prototype.saveContext=function(){this.restoring||this.saveContextInternal(this.getCurrentPageContext())},t.prototype.getCurrentPageContext=function(){var t={};return t.currentRowInfoList=n.ForguncyData.pageInfo.currentRowInfoCollection.list,t.pageName=n.ForguncyData.pageInfo.pageName,t.querys=n.ForguncyData.pageInfo.commandQuerys,t.sortInfoCache=n.ForguncyData.pageInfo.sortInfoCache,t},t.prototype.saveContextInternal=function(t){n.ForguncyData.PageContext||(n.ForguncyData.PageContext={});n.ForguncyData.PageContext[t.pageName]=t},t.prototype.getStoredContext=function(t){this.restoring=!0;try{return(t||(t=n.ForguncyData.pageInfo.pageName),n.ForguncyData.PageContext)?n.ForguncyData.PageContext[t]:null}catch(i){return null}finally{this.restoring=!1}},t.prototype.mergeStoredContextToPageContext=function(n,t){var i,f,r,u;if(!t)return n;if(n||(n={}),n.currentRowInfoList){if(t.currentRowInfoList)for(i=0;i<t.currentRowInfoList.length;i++)f=t.currentRowInfoList[i],this.containsTable(f.currentTable,n.currentRowInfoList)||n.currentRowInfoList.push(f)}else n.currentRowInfoList=t.currentRowInfoList;if(t.querys){n.querys||(n.querys={});for(r in t.querys)n.querys[r]||(n.querys[r]=t.querys[r])}if(t.sortInfoCache){n.sortInfoCache||(n.sortInfoCache={});for(u in t.sortInfoCache)n.sortInfoCache[u]||(n.sortInfoCache[u]=t.sortInfoCache[u])}return n},t.prototype.containsTable=function(n,t){for(var r,i=0;i<t.length;i++)if(r=t[i],r.currentTable===n)return!0;return!1},t.prototype.cleanQuaryCookie=function(t){if(t===n.ForguncyData.pageInfo.pageName)n.ForguncyData.pageInfo.commandQuerys={},n.ForguncyData.pageInfo.sortInfoCache={},this.saveContext();else{var i=this.getStoredContext(t);i&&(i.querys={},i.sortInfoCache={},this.saveContextInternal(i))}},t.prototype.initCellDefaultValue=function(t){for(var f,u,r=this.cells.getAllCells(t),i=0;i<r.length;i++)if(r[i]){if(f=undefined,r[i].cellType&&(u=r[i].cellType.getDefaultValue(),n.Common.IsEmpty(u)||typeof u.Value=="undefined"||typeof u.Value=="string"&&u.Value.length>0&&u.Value[0]==="="||(f=u.Value)),f===undefined){if(this._dataModel.hasValue(r[i].id))continue;if(f=r[i].getDefaultValue(),f===null)continue}this._dataModel.setValue(r[i].id,{newValue:f},1)}},t.prototype.onDefaultDataSetted=function(n){var t=this;t.chartCollection.initChart(n);t.cells.getAllCells(n).forEach(function(n){if(n.repaint(),n.cellType&&n.cellType.CellElement&&n.cellType.CellElement.CellType){var i=n.cellType.CellElement.CellType;i&&i.CommandList&&i.CommandExcuteKind===1&&t.addValueChangedCommandCell(n)}});t.listviewCollection.onDefaultDataSetted(n)},t.prototype.destoryRunTimePage=function(n){this.chartCollection.destoryRunTimePage(n);this._cellsNeedExcuteCommandWhenValueChanged=this._cellsNeedExcuteCommandWhenValueChanged.filter(function(t){return n.indexOf(t.runTimePageName)===-1});this.cells.destoryRunTimePage(n);this.listviewCollection.destroy(n)},t.prototype.destroy=function(){this.cells.destroy();this.chartCollection.destroy();this.listviewCollection.destroy()},t.prototype.resizePageElements=function(n){this.cells.getAllCells(n).forEach(function(n){return n.cellType&&n.cellType.onWindowResized()});this.listviewCollection.getListviews(n).forEach(function(n){return n.onWindowResized()});this.chartCollection.onSizeChanged(n)},t.prototype.getRepeaterCellOfListview=function(t){return this.cells.getAllContainerCells().filter(function(t){return t.cellType instanceof n.RepeaterCellType}).map(function(n){return n.cellType})},t}(),u,i,r;n.PageElementManager=f;u=function(){function t(t,i,r,u){var e,f;if(this.id=r,this.runTimePageName=u,e=this,this.row=t.Row,this.column=t.Column,this._defaultFormula=t.DefaultFormula,this._defaultValue=t.Value,this.styleInfo={styleInfo:n.Common.clone(t.StyleInfo),isDisabled:!1,isInvisible:!1,isReadOnly:!1},this.conditionalFormattingInfo=t.ConditionalFormattingMetadata,i===0&&this.conditionalFormattingInfo&&this.conditionalFormattingInfo.DependenceCells&&this.conditionalFormattingInfo.DependenceCells.length>0&&n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(this.conditionalFormattingInfo.DependenceCells,function(){e.repaint()},this.runTimePageName),t.Name&&t.Name.length>0)for(this.name=t.Name,this.lowerCaseName=[],f=0;f<this.name.length;f++)this.lowerCaseName.push(this.name[f].toLowerCase());else this.name=null,this.lowerCaseName=null;this.bindingInfo=t.BindingInfo;this.formatString=t.StyleInfo.Formatter;this.templateCellSource=t.TemplateCellSource;t.CellType&&(this.commands=t.CellType.CommandList);t.CellType&&t.CellType.ForguncyAttribute&&(this.forguncyattr=t.CellType.ForguncyAttribute);this.cellType=n.CellTypeHelper.getCellType(t,i,this.id,this.runTimePageName)}return t.prototype.getDefaultFormula=function(){if(this.cellType){var t=this.cellType.getDefaultValue();if(!n.Common.IsEmpty(t)&&typeof t.Value=="string"&&t.Value.length>0&&t.Value[0]==="=")return t.Value}return this._defaultFormula},t.prototype.getDefaultValue=function(){return n.Common.convertMetaDataDefaultValue(this._defaultValue,this.runTimePageName)},t.prototype.setValue=function(t){if(this.cellType){var i=this;i.updateActualStyleInfo();n.DelayRefresh.Push(i,function(){i.cellType.setValue(t);i.repaint()},"setCellValue"+i.id)}},t.prototype.onCurrentRowInfoChanged=function(n){if(this.cellType)this.cellType.onCurrentRowInfoChanged(n)},t.prototype.repaint=function(){this.cellType&&(this.cellType.applyTemplateStyle(),this.updateActualStyleInfo(),this.cellType.setBackColor(this.actualStyleInfo.styleInfo.Background),this.cellType.setFontStyle(this.actualStyleInfo.styleInfo),this.cellType.setFormatString(this.actualStyleInfo.styleInfo.Formatter),this.actualStyleInfo.isDisabled?this.cellType.disable():this.cellType.enable(),this.cellType.setVisible(!this.actualStyleInfo.isInvisible),this.cellType.setReadOnly(this.actualStyleInfo.isReadOnly))},t.prototype.updateActualStyleInfo=function(){this.actualStyleInfo=r.getActualStyleInfo(this.id,this.conditionalFormattingInfo?this.conditionalFormattingInfo.Rules:null,this.styleInfo)},t.prototype.setBackColor=function(n){this.styleInfo.styleInfo.Background!==n&&(this.styleInfo.styleInfo.Background=n,this.repaint())},t.prototype.setForeColor=function(t){t=n.ColorHelper.Convert(t);this.styleInfo.styleInfo.Foreground!==t&&(this.styleInfo.styleInfo.Foreground=t,this.repaint())},t.prototype.setVisible=function(n){n&&(n+"").toLowerCase()==="false"&&(n=!1);this.styleInfo.isInvisible!==!n&&(this.styleInfo.isInvisible=!n,this.repaint())},t.prototype.enable=function(){this.styleInfo.isDisabled!==!1&&(this.styleInfo.isDisabled=!1,this.repaint())},t.prototype.disable=function(){this.styleInfo.isDisabled!==!0&&(this.styleInfo.isDisabled=!0,this.repaint())},t.prototype.setReadOnly=function(n){n=!!n;!!this.styleInfo.isReadOnly!==n&&(this.styleInfo.isReadOnly=n,this.repaint())},t.prototype.create=function(n){this.cellType&&(this.cellType.create(n),this.styleInfo.isDisabled=!this.cellType.isEnabled,this.styleInfo.isInvisible=!this.cellType.isVisible(),this.styleInfo.isReadOnly=this.cellType.isReadOnly())},t.prototype.onLoad=function(){var t=this,i;t.cellType&&(t.cellType.onLoad(),t.cellType.CellElement)&&(i=t.cellType.CellElement.CellType,i&&i.CommandList&&i.CommandExcuteKind!==1&&t.cellType.bind(n.Events.Click,t.id,function(t,i){var r=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(t.data);r._updateRepeaterCurrentRow();n.ForguncyData.commandExcutor.excuteCommand(r.commands,r.runTimePageName,r.cellType,r.id,n.Events.Click)}))},t.prototype._updateRepeaterCurrentRow=function(){var i=n.PageManager.getContainerCell(this.runTimePageName),t,r;i&&(t=i.cellType,t instanceof n.RepeaterCellType)&&(r=t.getTabIndex(this.runTimePageName),t.updateCurrentRowIndex(r))},t.prototype.destroy=function(){var t=this;t.cellType&&(t.cellType.unbindAll(),t.cellType.destroy());n.ValidationMananger.clearCache(t.id);n.ForguncyData.pageInfo.dataModel.normalCellDataModel.clearValue(t.id)},t}();n.NormalCell=u;i=function(){function t(n){this._dataModel=n;this._cells=[]}return t.prototype.addCell=function(t){var i=this;this._cells.push(t);t.cellType&&t.cellType.bind(n.Events.ValueChanged,{collection:i,cell:t},function(n,r){i._dataModel.setValue(t.id,r,5)})},t.prototype.getCell=function(n){var i,t;if(n)for(i=this._cells.length,t=0;t<i;t++)if(this._cells[t].id===n)return this._cells[t];return null},t.prototype.getCellByName=function(n,t,i){var r=this.getCellsByName(n,t,i);return r.length>0?r[0]:null},t.prototype.getCellsByName=function(t,i,r){return t?(i&&(t=n.Common.getLowerCaseString(t)),this.getAllCells(r).filter(function(n){var r=i?n.lowerCaseName:n.name;return r&&r.indexOf(t)!==-1})):null},t.prototype.getAllCells=function(n){return n?this._cells.filter(function(t){return n.indexOf(t.runTimePageName)>=0}):this._cells},t.prototype.getAllContainerCells=function(){return this.getAllCells().filter(function(t){return t.cellType instanceof n.ContainerCellTypeBase})},t.prototype.getForguncyattrCell=function(n){for(var i=this._cells.length,t=0;t<i;t++)if(this._cells[t].forguncyattr===n)return this._cells[t];return null},t.prototype.getValueOfForguncyattrCell=function(n){var t=this.getForguncyattrCell(n);return t?this._dataModel.getValue(t.id):null},t.prototype.setValueToForguncyattrCell=function(n,t){var i=this.getForguncyattrCell(n);if(i)return this._dataModel.setValue(i.id,{newValue:t},2)},t.prototype.destroy=function(){this._cells.forEach(function(t){return n.ValidationMananger.clearCache(t.id)});this._cells.forEach(function(n){return n.cellType&&n.cellType.destroy()})},t.prototype.destoryRunTimePage=function(n){this.getAllCells(n).forEach(function(n){return n.destroy()});this._cells=this._cells.filter(function(t){return n.indexOf(t.runTimePageName)===-1})},t}();n.NormalCellCollection=i;r=function(){function i(){}return i.getActualStyleInfo=function(n,t,r){var f,u;if(!t)return r;for(f=null,u=0;u<t.length;u++)if(i.useConditionRule(n,t[u])&&(f=i.mergeCondtionalFullStyleInfo(f,t[u].StyleInfo,t[u].IsDisabled,t[u].IsInvisible,t[u].IsReadOnly),t[u].StopIfTrue))break;return i.mergeActualFullStyleInfo(f,r)},i.useConditionRule=function(n,t){switch(t.RuleType){case 1:return i.useCellValueRule(n,t.Params);case 2:return i.useSpecificTextRule(n,t.Params);case 3:return i.useDateOccurringRule(n,t.Params);case 10:return i.useFormulaRule(n,t.Params);default:return!1}},i.useCellValueRule=function(r,u){var f=i.evaluateFormula(r,u.Value1),e=i.evaluateFormula(r,u.Value2),o=i.getCellValue(r),s=new t.NormalConditionRule(t.RuleType.cellValueRule,[],null,n.ConditionFormatRuleHelper.ConvertComparisonOperator(u.Operator),f,e),h=s.createCondition();return!!h.evaluate(null,0,0,o)},i.useSpecificTextRule=function(n,r){var u=i.evaluateFormula(n,r.Value),f=i.getCellValue(n),e=new t.NormalConditionRule(t.RuleType.specificTextRule,[],null,r.Operator,null,null,u),o=e.createCondition();return!!o.evaluate(null,0,0,f)},i.useDateOccurringRule=function(n,t){var r=i.getCellValue(n),u=new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(GC.Spread.Sheets.ConditionalFormatting.RuleType.dateOccurringRule,[],null,null,null,null,null,null,t.Operator),f=u.createCondition();return!!f.evaluate(null,0,0,r)},i.useFormulaRule=function(n,t){var r=i.evaluateFormula(n,t.Formula);return r instanceof GC.Spread.CalcEngine.CalcError?!1:!!r},i.evaluateFormula=function(t,i){var f;if(n.Common.IsEmpty(i))return i;if(!n.FormulaManager.isReady())return null;var u=n.Common.parseIDStr(t),r=u.suffix,e={runTimePageName:r,supportReferToListview:!1,nullAsException:!1,listInfo:null,rowOffset:u.row,columnOffset:u.col,isTranslatedFormula:!0};return n.FormulaManager.isFormula(i)&&(f=n.ListviewBase.getAllListviews([r]),i="="+new n.CellFormulaTranslater(r,r,f).translate(i)),n.ForguncyData.pageInfo.formulaManager.evaluateFormula(i,e)},i.getCellValue=function(t){return n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(t)},i.mergeCondtionalFullStyleInfo=function(t,r,u,f,e){var s={styleInfo:r,isDisabled:u,isInvisible:f,isReadOnly:e},o;return t?(o=n.Common.clone(t),n.Common.IsEmpty(o.isDisabled)&&(o.isDisabled=s.isDisabled),n.Common.IsEmpty(o.isInvisible)&&(o.isInvisible=s.isInvisible),n.Common.IsEmpty(o.isReadOnly)&&(o.isReadOnly=s.isReadOnly),o.styleInfo=i.mergeCondtionalStyleInfo(t.styleInfo,s.styleInfo),o):s},i.mergeCondtionalStyleInfo=function(t,i){if(!i)return t;if(!t)return i;var r=n.Common.clone(t);return n.Common.IsEmpty(r.Formatter)&&(r.Formatter=i.Formatter),r.FontStyle&&r.FontStyle!==n.StaticValues.Font_Normal||(r.FontStyle=i.FontStyle),r.FontWeight&&r.FontWeight!==n.StaticValues.Font_Normal||(r.FontWeight=i.FontWeight),n.Common.IsEmpty(r.Underline)&&(r.Underline=i.Underline),n.Common.IsEmpty(r.Strikethrough)&&(r.Strikethrough=i.Strikethrough),n.Common.IsEmpty(r.Foreground)&&(r.Foreground=n.ColorHelper.Convert(i.Foreground)),n.Common.IsEmpty(r.Background)&&(r.Background=n.ColorHelper.Convert(i.Background)),r},i.mergeActualFullStyleInfo=function(t,r){if(!t)return r;r||(r={});var u=n.Common.clone(r);return n.Common.IsEmpty(t.isDisabled)||(u.isDisabled=t.isDisabled),n.Common.IsEmpty(t.isInvisible)||(u.isInvisible=t.isInvisible),n.Common.IsEmpty(t.isReadOnly)||(u.isReadOnly=t.isReadOnly),u.styleInfo=i.mergeActualStyleInfo(t.styleInfo,r.styleInfo),u},i.mergeActualStyleInfo=function(t,r){var u,f,e;return t?r?(u=n.Common.clone(r),n.Common.IsEmpty(t.Formatter)||(u.Formatter=t.Formatter),f=i.getFontStyleInCondtionalStyleInfo(t),n.Common.IsEmpty(f)||(u.FontStyle=f),e=i.getFontWeightInCondtionalStyleInfo(t),n.Common.IsEmpty(e)||(u.FontWeight=e),n.Common.IsEmpty(t.Underline)||(u.Underline=t.Underline),n.Common.IsEmpty(t.Strikethrough)||(u.Strikethrough=t.Strikethrough),n.Common.IsEmpty(t.Foreground)||(u.Foreground=n.ColorHelper.Convert(t.Foreground)),n.Common.IsEmpty(t.Background)||(u.Background=n.ColorHelper.Convert(t.Background)),u):t:r},i.getFontStyleInCondtionalStyleInfo=function(t){return n.Common.IsEmpty(t.FontStyle)||t.FontStyle===n.StaticValues.Font_Normal?n.Common.IsEmpty(t.FontWeight)||t.FontWeight===n.StaticValues.Font_Normal?null:n.StaticValues.Font_Normal:t.FontStyle},i.getFontWeightInCondtionalStyleInfo=function(t){return n.Common.IsEmpty(t.FontWeight)||t.FontWeight===n.StaticValues.Font_Normal?n.Common.IsEmpty(t.FontStyle)||t.FontStyle===n.StaticValues.Font_Normal?null:n.StaticValues.Font_Normal:t.FontWeight},i}();n.CondtionalFormattingHelper=r}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i=function(){function n(n){this.metaData=n}return n.prototype.getEditorFormatString=function(){return null},n}(),t,r,u,f,e,o,s,h;n.CellTypeDataBase=i;t=function(t){function i(n){return t.call(this,n)||this}return __extends(i,t),i.prototype.getDefaultValue=function(){var t=this.metaData.DefaultValue;return n.Common.IsEmpty(t)&&(t=null),n.KeyWords.IsKeyWord(t)&&(t=n.KeyWords.GetKeyWordValue(t)),t},i.prototype.canEnterEditModeInListview=function(){return!0},i}(i);n.InputCellTypeData=t;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getDefaultValue=function(){var i=t.prototype.getDefaultValue.call(this);return n.Common.IsEmpty(i)?null:this._getDefaultDate(i)},i.prototype._getDefaultDate=function(t){var i=n.FormatHelper.getValueFromText(t);return n.DateHelper.isValidDateValue(i)?typeof i=="number"&&(i=n.Convertor.fromOADateToDate(i)):i=null,i},i.prototype.getEditorFormatString=function(){var t=this.metaData;return n.Common.IsEmpty(t.DisplayFormat)?n.Common.IsEmpty(t.DateFormat)?null:t.DateFormat:t.DisplayFormat},i}(t);n.DateCellTypeData=r;u=function(t){function i(n){return t.call(this,n)||this}return __extends(i,t),i.prototype.getDefaultValue=function(){var i=t.prototype.getDefaultValue.call(this);return n.Common.IsEmpty(i)?null:(i=n.FormatHelper.getValueFromText(i),!n.DateHelper.isValidDateValue(i))?null:(i instanceof Date&&(i=n.Convertor.fromDateToOADate(i)),typeof i!="number")?null:i},i.prototype.getEditorFormatString=function(){return n.StaticFormatString.timeDefaultFormattingString},i}(t);n.TimeCellTypeData=u;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(t);n.NumberCellTypeData=f;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.canEnterEditModeInListview=function(){return this.metaData.ShowOnlyEdit},t}(t);n.GroupCellTypeData=e;o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.canEnterEditModeInListview=function(){return this.metaData.ShowOnlyEdit},t}(t);n.CheckBoxCellTypeData=o;s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.canEnterEditModeInListview=function(){return!1},t}(t);n.UploadImageCellTypeData=s;h=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.canEnterEditModeInListview=function(){return!1},t}(t);n.AttachmentCelltypeData=h}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var f=function(t){function i(i,r,u,f){var e=t.call(this)||this;return e.isEnabled=!0,e._isVisible=!0,e._isReadOnly=!1,e._pageID=n.ForguncyData.pageInfo.pageID,e.ID=u,e.CellElement=i,e.isInListview=r===1,e._isSettingValue=!1,e._isWaitingServerData=!1,e.allowSetValueByUser=!0,e.supportedEvents=[],e._dataValidationInfo=i.DataValidation,e.cellTypeData=e._getCellTypeData(e.CellElement.CellType),e.IsInMasterPage=n.PageManager.isMasterPageName(f),e.runTimePageName=f,e}return __extends(i,t),i.prototype._getCellTypeData=function(t){return new n.CellTypeDataBase(t)},i.prototype.create=function(t){var i,e,r,f;this._containerCache=t;i=this.CellElement;e=n.PageManager.getPageStretchInfo(this.runTimePageName);i.Value=n.KeyWords.GetKeyWordValue(i.Value,this.runTimePageName);r=i.CellType;f=this.createContent();r&&r.IsDisabled&&(this._disable(f),this.isEnabled=!1);n.ValidationTooltipHelper.setTooltipAttr(t,i.Top);i.IsUser||this._setOverflowHidden(t);f=u.adjustDomForOverflow(f,t,i,e,this.runTimePageName);this._setTabIndexToDom(r,f);this._setDataValidationToDom(f);f&&(t.append(f),(!i.Width||!i.Height||r&&r.IsInvisible)&&(this._setVisible(t,!1),this._isVisible=!1),r&&(r.ReadOnly||r.Readonly)&&this.setReadOnly(!0));this.applyTemplateStyle()},i.prototype.shouldSetPenetrable=function(){return!this.isVisible()},i.prototype.applyTemplateStyle=function(){var n=this.getStyleTemplateHelper();n!==null&&n.ApplyTemplateStyle(this.CellElement.StyleTemplate,this._containerCache)},i.prototype.checkAuthority=function(n){var t=this.getUIPermission(n);return t?this.checkRoleAuthority(t.AllowRoles):!0},i.prototype.checkRoleAuthority=function(t){var i,r,u;return t!=null&&(t.indexOf("FGC_Anonymous")!==-1||(i=n.Page.getUserInfo(),i!=null&&i.UserName!=null&&i.UserName!==""&&t.indexOf("FGC_LoginUser")!==-1)||(r=[],i!=null&&i.Role!=null&&(r=i.Role.split(",")),u=t.filter(function(n){return r.indexOf(n)!==-1}),u.length!==0))?!0:!1},i.prototype.getUIPermission=function(t){var s=n.ForguncyData.GlobalSettings.PageUIPermissions,h,r,f,e,l,o;if(!s||!s.PageUIPermissions)return null;if(h=n.PageManager.getDesignerPageName(this.runTimePageName,!this.IsInMasterPage),r=n.PageManager.getContainerCell(this.runTimePageName),r&&r.cellType instanceof n.RepeaterCellType&&(f=n.PageManager.getLocatedNormalPageNames(this.runTimePageName),f&&f.length>1)){var p=f[f.length-2],a=n.Common.getA1ReferenceString(r.row,r.column,!0,!0),v=this.getCellName(r.name,r.runTimePageName);n.Common.IsEmpty(v)||(a=v);h=p+"->"+a+"->"+i.UIPermission_TemplatePageKey}if(e=s.PageUIPermissions[h],!e||!e.CellUIPermissions)return null;var u=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(this.ID),c=n.Common.getA1ReferenceString(u.row,u.column,!0,!0),y=this.getCellName(u.name,u.runTimePageName);return(n.Common.IsEmpty(y)||(c=y),r&&r.cellType instanceof n.RepeaterCellType&&u.templateCellSource&&(c=u.templateCellSource),l=e.CellUIPermissions[c],!l)?null:(o=l.filter(function(n){return n.Scope===t}),o.length===0||!o[0].Enabled)?null:o[0]},i.prototype.getCellName=function(t,i){var r,u;if(t&&t.length>0)for(r=0;r<t.length;r++)if(u=t[r],n.ForguncyData.pageInfo.pageElementManager.cells.getCellsByName(u,!0,[i]).length===1)return u;return null},i.prototype.createContent=function(){return null},i.prototype.getStyleTemplateHelper=function(){return null},i.prototype.clearStyleTemplate=function(){var n=this.getStyleTemplateHelper();n!==null&&n.Clear();this.CellElement&&this.CellElement.StyleTemplate&&(this.CellElement.StyleTemplate=null)},i.prototype._setOverflowHidden=function(n){n.css("overflow","hidden")},i.prototype._setTabIndexToDom=function(t,i){if(i&&t&&t.TabIndex&&n.ForguncyData.pageInfo.enableTabIndex){var r=i[0].tagName;r&&r.toUpperCase()==="DIV"?$("button, input, a, textarea",i).attr("tabindex",t.TabIndex):i.attr("tabindex",t.TabIndex)}},i.prototype._setDataValidationToDom=function(t){var r,i;t&&(r=this,n.Common.IsEmpty(this._dataValidationInfo)||(t.attr("data-dataValidationInputTitle",this._dataValidationInfo.InputMessageTitle),t.attr("data-dataValidationInputMessage",this._dataValidationInfo.InputMessage),this._dataValidationInfo.ShowInputMessageWhenCellIsSelected!==!0||n.Common.IsEmpty(this._dataValidationInfo.InputMessage)||(i=null,t.focusin(function(){var t=$(this).attr("data-dataValidationInputTitle"),u=$(this).attr("data-dataValidationInputMessage"),f;n.Common.IsEmpty(t)&&n.Common.IsEmpty(u)||(n.DelayRefresh.NeedDelayRun===!0?$(".dataValidationInput").fadeToggle(function(){$(this).remove()}):$(".dataValidationInput").remove(),i=r.createInputMessageToolTip($(this),t,u),i.addClass("dataValidationInput"),f=$(this).parent(),$(f).after(i),i.fadeToggle())}),t.focusout(function(){i!==null&&(n.DelayRefresh.NeedDelayRun===!0?i.fadeToggle(function(){$(this).remove()}):$(i).remove())})),this.hideValidationTooltipWhenInputOrSelect(t)))},i.prototype.createInputMessageToolTip=function(t,i,r){var f=t.parent(),u=$("<div/>"),e,o;return u.addClass("fgc-input-tooltip"),u.css("top",f.position().top+f.height()),u.css("left",f.position().left+f.width()-90),e=$("<div/>"),e.addClass("fgc-input-tooltip__title"),n.Common.IsEmpty(i)||e.append(i),u.append(e),o=$("<div/>"),o.addClass("fgc-input-tooltip__message"),n.Common.IsEmpty(r)||o.append(r),u.append(o),u},i.prototype.hideValidationTooltipWhenInputOrSelect=function(t){var i=this;this._textCache=t.find("#"+this.ID).val();t.keyup(function(){var t=$("#"+i.ID);i._textCache!==t.val()&&n.ValidationTooltipHelper.destroyTooltip(t);i._textCache=t.val()})},i.prototype.getDefaultValue=function(){return null},i.prototype.executeCommand=function(t){!t||t.length<=0||n.ForguncyData.commandExcutor.excuteCommand(t,this.runTimePageName,this,this.ID,n.Events.Click)},i.prototype.onDependenceCellValueChanged=function(t){n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(this.CellElement.DependenceCells,t,this.runTimePageName)},i.prototype.hasFocus=function(){var n=$("#"+this.ID);return n.length>0&&document.activeElement===n[0]?!0:!1},i.prototype.setFocus=function(){var n=$("#"+this.ID);n.length>0&&n[0].focus()},i.prototype.setValue=function(n){if(!this._isSettingValue){var t=$("#"+this.ID);(t.length!==1&&(t=this.getContainer()),t.length===1)&&(this._setValue(t,n),this._textCache=$("#"+this.ID).val())}},i.prototype._setValue=function(n,t){this._isWaitingServerData||(this._isSettingValue=!0,this.setValueToElement(n,t),this._isSettingValue=!1)},i.prototype.setValueToElement=function(n,t){},i.prototype.getValue=function(n){return this.getValueFromElement(n)},i.prototype.getValueFromElement=function(n){return null},i.prototype.commitValue=function(){this._onValueChanged()},i.prototype._onValueChanged=function(){this._isSettingValue||this.trigger(n.Events.ValueChanged,{newValue:this.getValue(!1),uiAction:!0})},i.prototype.getFormatString=function(){var t=this.CellElement.StyleInfo.Formatter;return n.Common.IsEmpty(t)&&(t=this.cellTypeData.getEditorFormatString()),t},i.prototype.setFormatString=function(n){this.CellElement.StyleInfo.Formatter!==n&&(this.CellElement.StyleInfo.Formatter=n,this.onFormatterChanged())},i.prototype.onFormatterChanged=function(){},i.prototype.disable=function(){this.isEnabled&&(this._disable($("#"+this.ID+"_div").children()),this.isEnabled=!1)},i.prototype._disable=function(n){n&&n.data("DisableCallback")&&n.data("DisableCallback")()},i.prototype.enable=function(){this.isEnabled||this.checkAuthority(2)&&(this._enable($("#"+this.ID+"_div").children()),this.isEnabled=!0)},i.prototype._enable=function(n){n&&n.data("EnableCallback")&&n.data("EnableCallback")()},i.prototype.setBackColor=function(t){this.CellElement.StyleInfo.Background=t;var i=this._getPartsUseBackcolor();t?i.css("background",n.ColorHelper.Convert(t)):i.css("background","")},i.prototype._getPartsUseBackcolor=function(){return $("#"+this.ID+"_div")},i.prototype.adjustForeColor=function(t,i){var u=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID),r={value:null};return n.FormatHelper.formatValue(u,i,r),r.value&&(t=r.value),t?n.ColorHelper.Convert(t):""},i.prototype.setFontStyle=function(t){var i=this.CellElement.StyleInfo;i.FontFamily=t.FontFamily;i.FontStyle=t.FontStyle;i.FontSize=t.FontSize;i.FontWeight=t.FontWeight;i.Foreground=n.ColorHelper.Convert(t.Foreground);i.Strikethrough=t.Strikethrough;i.Underline=t.Underline;this._setFontStyle(t)},i.prototype._setFontStyle=function(t){var r=this._getPartsUseFontStyle(),i;r&&(i=n.Common.clone(t),i.Foreground=this.adjustForeColor(i.Foreground,this.getFormatString()),n.DomUtilities.setFontStyle(i,r))},i.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID)},i.prototype.isVisible=function(){return this.isWidthOrHeightEqualTo0()?!1:this._isVisible},i.prototype.isWidthOrHeightEqualTo0=function(){return!this.CellElement.Width||!this.CellElement.Height},i.prototype.setVisible=function(n){if(!this.isWidthOrHeightEqualTo0()&&(n=!!n,this._isVisible!==n)&&(!n||this.checkAuthority(1))){var i=this.ID+"_div",t=$("#"+i);this._setVisible(t,n);this._isVisible=n;this.updatePenetrable(t)}},i.prototype.updatePenetrable=function(n){this.shouldSetPenetrable()?n.addClass("penetrable"):n.removeClass("penetrable")},i.prototype._setVisible=function(t,i){var r=this._getVisibleParts(t),e,f,u;if(i)t.css("display",""),r&&(u=r.attr("olddisplay"),r.css("display",n.Common.IsEmpty(u)?"":u));else if(t.css("display","none"),r)for(e=0;e<r.length;e++)f=$(r[e]),f.attr("olddisplay")===undefined&&(u=f.css("display"),f.attr("olddisplay",u)),f.css("display","none")},i.prototype._getVisibleParts=function(n){return null},i.prototype.isReadOnly=function(){return this._isReadOnly},i.prototype.setReadOnly=function(n){n=!!n;this._isReadOnly!==n&&(this._isReadOnly=n,this.updateReadOnlyStatus())},i.prototype.updateReadOnlyStatus=function(){},i.prototype.enterPrintMode=function(){},i.prototype.quitPrintMode=function(){},i.prototype.trigger=function(i,r){this._pageID===n.ForguncyData.pageInfo.pageID&&this.isEnabled&&t.prototype.trigger.call(this,i,r)},i.prototype._startWaitingServerData=function(){this._isWaitingServerData=!0},i.prototype._endWaitingServerData=function(){this._isWaitingServerData=!1;var t=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID);this.setValue(t)},i.prototype.getContainer=function(){return this._containerCache?this._containerCache:$("#"+this.ID+"_div")},i.prototype.validate=function(){n.ForguncyData.GlobalSettings&&n.ForguncyData.GlobalSettings.TriggerTime===1||n.ValidationMananger.validateCell(this)},i.prototype.validateValue=function(t,i){return i===void 0&&(i=null),n.ValidationMananger.validateDataValidation(this.CellElement,t,this.runTimePageName,i)},i.prototype.getValidationRules=function(){return!this.needValidate()||!this.isEnabled||!this.isVisible()?null:(this._validationRules===undefined&&(this._validationRules=n.ValidateRuleCreator.createValidationRules(this.CellElement,this.isInListview)),this._validationRules)},i.prototype.needValidate=function(){return this.isReadOnly()?!1:!0},i.prototype.shouldCancelCommand=function(t,i){if(i===n.Events.ValueChanged){var r=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(t);if(r===this._valueOfTriggerValueChangedCommand)return!0;this._valueOfTriggerValueChangedCommand=r}return!this.checkAuthority(1)||!this.checkAuthority(2)?!0:!1},i.prototype.initValueWhenTriggerValueChangedCommand=function(){this._valueOfTriggerValueChangedCommand=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID)},i.prototype.allowFormatValue=function(){return!0},i.prototype.onLoad=function(){this.checkAuthority(1)||this.setVisible(!1);this.checkAuthority(2)||this.disable()},i.prototype.onCurrentRowInfoChanged=function(n){},i.prototype.destroy=function(){this.clearStyleTemplate();this._containerCache&&this._containerCache.empty();this._containerCache=null},i.prototype.getValueFromListviewText=function(t){var i=this.getFormatString();return n.Common.IsEmpty(i)?t:n.FormatHelper.getValueFromText(t,i)},i.prototype.getListviewNoneEditModeText=function(t,i,r){return r||(r=this.getFormatString()),n.FormatHelper.formatValue(t,r,i)},i.prototype.getControl=function(){return null},i.prototype.getBindingTables=function(){return null},i.prototype.reload=function(n){},i.prototype.evaluateFormula=function(t){return n.ForguncyData.pageInfo.formulaManager.evaluateFormula(t,this.getDefaultFormulaCalcInfo())},i.prototype.getDefaultFormulaCalcInfo=function(){return{runTimePageName:this.runTimePageName,supportReferToListview:!0,nullAsException:!1,listInfo:null,rowOffset:0,columnOffset:0}},i.prototype.getFormulaCalcContext=function(){return{IsInMasterPage:this.IsInMasterPage,PageID:this.runTimePageName}},i.prototype.shouldDisplayInListviewNewRow=function(){return!0},i.prototype.onWindowResized=function(){return null},i.prototype._getDomCreateInfo=function(){return{id:this.ID,isInListview:this.isInListview}},i.UIPermission_TemplatePageKey="0BD905CA-8A4D-4F75-BF5F-582F869D0E46",i}(n.EventClassBase),i,r,u,t,e;n.CellTypeBase=f;i=function(){function n(){}return n}();n.FormulaListRowInfo=i;r=function(){function t(){}return t.getCellType=function(i,r,u,f){var e=t.getRegistedCellTypeCreateFunction(i);return n.Common.IsEmpty(e)&&(e=n.GeneralCellType),new e(i,r,u,f)},t.registerCellType=function(i,r,u){typeof i!="string"||n.Common.IsEmpty(i)||typeof r=="function"&&(n.Common.IsEmpty(u)||typeof u=="function")&&(t._registedCellTypes[i]||(t._registedCellTypes[i]=[]),t._registedCellTypes[i].push({cellTypeCtor:r,match:u}))},t.getRegistedCellTypeCreateFunction=function(n){var i,r,u;if(!n||!n.CellType||(i=t._registedCellTypes[n.CellType.$type],!i||i.length<=0))return null;for(r=i.length-1;r>=0;r--)if(u=i[r],!u.match||u.match(n))return u.cellTypeCtor;return null},t._registedCellTypes={},t}();n.CellTypeHelper=r;u=function(){function i(){}return i.adjustDomForOverflow=function(n,t,r,u,f){if(i.InsureOverflowProperty(r),!i.needAdjustDom(n,r))return n;i.adjustCellContainerSize(r,t,u);var e=t.attr("full-overflow")==="true";return i.ajustCellContent(n,r,e,u,f)},i.InsureOverflowProperty=function(n){n.LeftOverflowSpace===undefined&&(n.LeftOverflowSpace=0);n.RightOverflowSpace===undefined&&(n.RightOverflowSpace=0)},i.needAdjustDom=function(t,i){return t?i.Width<=0||i.Height<=0?!1:i.IsUser||n.Common.typeContains(i.CellType,"CurrentUserCellType")?!1:i.RightOverflowSpace===0&&i.LeftOverflowSpace===0?!1:!0:!1},i.adjustCellContainerSize=function(i,r,u){var f=0,e=0,o=!0;switch(i.StyleInfo.HorizontalAlignment){case t.Right:f=i.Width+i.LeftOverflowSpace;e=i.Left-i.LeftOverflowSpace;break;case t.Center:f=i.Width+i.RightOverflowSpace+i.LeftOverflowSpace;e=i.Left-i.LeftOverflowSpace;break;default:f=i.Width+i.RightOverflowSpace;o=!1}r.css("width",f);o&&r.css("left",e);n.Stretch.Common.adjustCellContainer(r,u,f,e,o)},i.ajustCellContent=function(t,r,u,f,e){i.InsureOverflowProperty(r);var s=i.createBackcolorDiv(r,u,f,e),h=i.createCellContent(t,r,u,f),o=n.DomUtilities.createJqueryDomElement("div");return o.addClass("fgc-adjust-container"),o.append(s),o.append(h),o},i.createBackcolorDiv=function(i,r,u,f){var e=n.DomUtilities.createJqueryDomElement("div");return e.attr("id",n.Common.getIdStr(i.Row,i.Column,f)+"_backColor"),e.css("width",i.Width),e.css("height","100%"),i.StyleInfo.HorizontalAlignment===t.Right?e.addClass("fgc-float-right"):i.StyleInfo.HorizontalAlignment===t.Center&&(e.css("margin-left",i.LeftOverflowSpace),n.Stretch.Common.adjustBackColorDiv(e,i,u,r)),e},i.createCellContent=function(i,r,u,f){var e,s,h,o;return r.StyleInfo.HorizontalAlignment===t.Center&&(e=n.DomUtilities.createJqueryDomElement("div"),e.append(i),s=r.Width+500,h=r.LeftOverflowSpace-250,e.attr("align-overflow","center"),e.css("height",r.Height),e.css("width",s),e.css("left",h),n.Stretch.Common.adjustCellContent(e,r,f,s,h,u),i=e),i.addClass("fgc-adjust-container__content__inner"),o=n.DomUtilities.createJqueryDomElement("div"),o.addClass("fgc-adjust-container__content"),o.append(i),o},i}(),function(n){n[n.Left=0]="Left";n[n.Center=1]="Center";n[n.Right=2]="Right";n[n.General=3]="General"}(t=n.CellHorizontalAlignment||(n.CellHorizontalAlignment={})),function(n){n[n.Top=0]="Top";n[n.Center=1]="Center";n[n.Bottom=2]="Bottom"}(e=n.CellVerticalAlignment||(n.CellVerticalAlignment={}))}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(i,r,u,f){var e=t.call(this,i,r,u,f)||this;return e.supportedEvents=[n.Events.Click,n.Events.MouseEnter,n.Events.MouseLeave],e}return __extends(i,t),i.prototype.bind=function(i,r,u){var f=this,e;if(f.supportedEvents.indexOf(i)!==-1&&!f.isEventHasBeenBinding(i)&&(e=f._getClickableDomId(),!n.Common.IsEmpty(e)))$("#"+e).on(i,function(){return f.trigger(i,null),!1});t.prototype.bind.call(this,i,r,u)},i.prototype.unbind=function(i,r){t.prototype.unbind.call(this,i,r);var u=this,f=u._getClickableDomId();n.Common.IsEmpty(f)||u.supportedEvents.indexOf(i)!==-1&&(u.isEventHasBeenBinding(i)||$("#"+f).off(i))},i.prototype.unbindAll=function(){var r=this,u=r._getClickableDomId(),f,i;if(!n.Common.IsEmpty(u))for(f=$("#"+u),i=0;i<r.supportedEvents.length;i++)f.off(r.supportedEvents[i]);t.prototype.unbindAll.call(this)},i.prototype._getClickableDomId=function(){throw"No implement.";},i.prototype.hasFocus=function(){var n=$("#"+this.ID+"_btn");return n.length>0&&document.activeElement===n[0]?!0:!1},i.prototype.setFocus=function(){var n=$("#"+this.ID+"_btn");n.length>0&&n[0].focus()},i}(n.CellTypeBase),i;n.ClickableCellTypeBase=t;i=function(t){function i(i,r,u,f){var e=t.call(this,i,r,u,f)||this;return e.CellElement.Value===n.KeyWords.CurrentUserStr&&n.Common.IsEmpty(e.CellElement.BindingInfo)&&(e.CellElement.IsUser=!0,e.allowSetValueByUser=!1),e}return __extends(i,t),i.prototype.needValidate=function(){return!1},i.prototype.createContent=function(){var n=this.CellElement,r=this.isInListview,t=i.createLabelElement(n,this._getDomCreateInfo());return n.IsUser&&!r&&(t=this.updateGeneralCellToUserCell(t,n)),t},i.createLabelElement=function(t,i){var r=n.DomUtilities.createJqueryDomElement("label"),u=n.CellDomCreateHelper.createTextElement(t,r,i);return r.css("-webkit-user-select","initial"),i.isInListview&&r.css("pointer-events","none"),u},i.prototype.shouldSetPenetrable=function(){return!0},i.prototype.setValueToElement=function(n,t){this._updateText(n,t)},i.prototype._updateText=function(t,r){if(!this.CellElement.IsUser){var u={value:null},f=n.FormatHelper.formatValue(r,this.getFormatString(),u);i.setValueToLabel(t,f,u.value,this.CellElement)}},i.prototype.getValueFromElement=function(n){return null},i.prototype.onFormatterChanged=function(){var t=$("#"+this.ID),i;t.length===1&&(i=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID),this._updateText(t,i))},i.setValueToLabel=function(t,i,r,u){if(n.Common.IsEmpty(i))i="";else{if(r)t.css("color",n.ColorHelper.Convert(r)),t.data(n.StaticValues.conditionalForeColor,t.css("color"));else{var f=t.data(n.StaticValues.conditionalForeColor);f&&(t.removeData(n.StaticValues.conditionalForeColor),t.css("color")===f&&t.css("color",u.StyleInfo.Foreground===undefined?"black":n.ColorHelper.Convert(u.StyleInfo.Foreground)))}i=n.Common.dealWithMultiLineText(i)}t.text(i)},i.prototype.updateGeneralCellToUserCell=function(t,i){var u,r;return n.ForguncyData.userInfo.UserName&&n.ForguncyData.AllowLogout===!0?(u=t.find("label"),$(t.children()[0]).css("white-space","nowrap"),r=$("<span class='caret'><\/span>"),r.attr("currentUserDropDownButton","show"),r.css("height",4),u.css("display","inline-block"),u.after(r),t=n.DomUtilities.createDropDownListForFormUser(i,t,this)):n.ForguncyData.AuthenticationType===3&&(i.Value=n.RS.login,t=n.HyperlinkCellType.createHyperlinkControl(i,this._getDomCreateInfo()),n.DomUtilities.createNavigateCommand(t,n.BuiltInPageManager.builtInPages[n.BuiltInPageType.Login],this.ID,this),t.css("cursor",""),i.Value=null),t},i.prototype._getClickableDomId=function(){return this.ID+"_div"},i.prototype._setDropDownButtonVisible=function(n){var i=$("#"+this.ID+"_dropdown"),t;i.length>0&&(t=i.find("span[currentUserDropDownButton = show]"),t.length>0&&(n?t.css("display",""):t.css("display","none")))},i.prototype.enterPrintMode=function(){this._setDropDownButtonVisible(!1)},i.prototype.quitPrintMode=function(){this._setDropDownButtonVisible(!0)},i.prototype._disable=function(t){n.CurrentUserCellType.disableCurrentUserCell(t,this.ID)},i.prototype._enable=function(){n.CurrentUserCellType.enableCurrentUserCell(this.ID)},i.prototype._getVisibleParts=function(n){return n.find("a")},i.prototype._getPartsUseBackcolor=function(){var n=$("#"+this.ID+"_backColor");return n.length===0?t.prototype._getPartsUseBackcolor.call(this):n},i}(t);n.GeneralCellType=i}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(n,i,r,u){return t.call(this,n,i,r,u)||this}return __extends(i,t),i.prototype.canInputChars=function(){return!1},i.prototype.selectAll=function(){},i.prototype.setCaretAtLast=function(){},i.prototype.focus=function(){var n=$("#"+this.ID);n.length>0&&n.focus()},i.prototype.getDropDownObj=function(){return null},i.prototype.getIgnoreKeysInListview=function(){return[]},i.prototype.setStyle=function(t,i,r,u,f,e,o){var s={Row:this.CellElement.Row,Column:this.CellElement.Column,StyleInfo:{WordWrap:this.CellElement.StyleInfo.WordWrap,Background:t,Foreground:i,FontFamily:this.CellElement.StyleInfo.FontFamily,FontSize:r,FontStyle:u?n.StaticValues.FontStyle_Italic:n.StaticValues.Font_Normal,FontWeight:f?n.StaticValues.FontWeight_Bold:n.StaticValues.Font_Normal,Underline:e,Strikethrough:o,HorizontalAlignment:this.CellElement.StyleInfo.HorizontalAlignment}};this.setStlyeInternal(s)},i.prototype.setStlyeInternal=function(n){},i}(n.CellTypeBase),i;n.ListviewEditModeCellType=t;i=function(t){function i(n,i,r,u){return t.call(this,n,i,r,u)||this}return __extends(i,t),i.prototype.onFormatterChanged=function(){this.changeFormatElement()},i.prototype._getPartsUseFontStyle=function(){return this.$formatElement},i.prototype.createContent=function(){var i=this,n=this.createCellContent(),t,r;return this.shouldHandleFormat()?(t=n.find("#"+this.ID),t.addClass("formatInput"),r=this.appendFormatLabelPart(n),this.updateWhenShowFormatElement(),this.initHandlingFormatLabelEvent(t,function(){i.onFocusIn()},function(){i.onFocusOut()}),r):n},i.prototype.appendFormatLabelPart=function(t){var r=t.children(),i=n.DomUtilities.createJqueryDomElement("div");return i.css("width","100%"),i.css("height","100%"),i.css("position","relative"),i.css("top","-100%"),i.append(r),t.append(this.getFormatPart()),t.append(i),t},Object.defineProperty(i.prototype,"$formatElement",{get:function(){return this._$formatElement||this.getFormatPart(),this._$formatElement},enumerable:!0,configurable:!0}),i.prototype.getFormatPart=function(){return this._formatPart||(this._formatPart=this.createFormatElement(),this._$formatElement=this._formatPart.find("[format-label]")),this._formatPart},i.prototype.initHandlingFormatLabelEvent=function(n,t,i){n.focusin(function(){t()});n.focusout(function(){i()})},i.prototype.onFocusIn=function(){this.hideCover()},i.prototype.onFocusOut=function(){this.updateWhenShowFormatElement()},i.prototype.shouldHandleFormat=function(){return this.isInListview?!1:n.FormatHelper.isFormatSetted(this.CellElement.StyleInfo.Formatter)||this.CellElement.ConditionalFormattingMetadata?!0:!1},i.prototype.hideCover=function(){this.$formatElement.hide();var n=this.getContainer();n.removeClass("showFormatCover")},i.prototype.updateWhenShowFormatElement=function(){this.shouldHandleFormat()&&(this.$formatElement.show(),this.changeFormatElement())},i.prototype.getCellActualStyleInfo=function(){var t=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(this.ID);return t&&t.actualStyleInfo?t.actualStyleInfo.styleInfo:null},i.prototype.changeFormatElement=function(){var i,t,u,f,r;this.shouldHandleFormat()&&(i="",t=this.getCellActualStyleInfo(),t&&t.Formatter&&(u=this.getValueToFormat(),f=n.FormatHelper.format(t.Formatter,u),i=f.text),this.$formatElement.text(i),this.isCoverShow()&&(r=this.getContainer(),n.Common.IsEmpty(this.$formatElement.text())?r.removeClass("showFormatCover"):r.addClass("showFormatCover")))},i.prototype.createFormatElement=function(){var t=JSON.parse(JSON.stringify(this.CellElement)),i=n.DomUtilities.createJqueryDomElement("label"),r=this._getDomCreateInfo(),u;return r.id=null,t.BindingInfo=null,t.StyleInfo||(t.StyleInfo={}),t.StyleInfo.TextIndent=1,t.StyleInfo.HorizontalAlignment=this.getHorizontalAlignment(),t.StyleInfo.VerticalAlignment=n.CellVerticalAlignment.Center,u=n.CellDomCreateHelper.createTextElement(t,i,r),i.attr("format-label","true"),i.css("overflow","hidden"),i.css("white-space","pre"),i.css("padding","0px 2px"),this.shouldReserveRightSpace()&&i.css("margin-right",this.getReserveRightSpaceWidth()+"px"),u},i.prototype.getHorizontalAlignment=function(){return this.CellElement.StyleInfo.HorizontalAlignment},i.prototype.shouldReserveRightSpace=function(){return!1},i.prototype.getReserveRightSpaceWidth=function(){return 18},i.prototype.isCoverShow=function(){return this.$formatElement&&this.$formatElement.css("display")==="block"},i.prototype.setValueToElement=function(n,t){this.changeFormatElement()},i}(t);n.SupportFormatCellType=i}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(){}return t.prototype.ApplyTemplateStyle=function(t,i){var u,f,r;if(t&&i){for(u=t.Key,f=this.MapPartsNameToDom(i),r=0;r<this.TemplateNameParts.length;r++){var e=this.TemplateNameParts[r],o=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(this.CellTypeString,u,e),s=f[e];s.addClass(o)}this.OnTemplateStyleApplied(t,i)}},t.prototype.MapPartsNameToDom=function(n){return null},t.prototype.OnTemplateStyleApplied=function(n,t){},t.prototype.Clear=function(){},t}();n.CellTypeStyleTemplateHelperBase=t}(Forguncy||(Forguncy={}));__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var t=function(){function t(){}return t.FormatTemplateStyleClassName=function(n,t,i){return n.replace(/\./g,"")+"-"+t+"-"+i},t.PrepareTemplateStyles=function(n){t.ParseAndAppendTemplateStyles(n);t.InitEvents()},t.InitEvents=function(){var n="data-styleTempalte-bodyHasMouseUp",i=$("body").attr(n);if(!i){$("body").attr(n,!0);$("body").on("mouseup",function(){var n=t.EventTarget;n&&n.removeClass("active")})}},t.ParseAndAppendTemplateStyles=function(n){var o,r,u,f,e,s,i,h;for(o in n){r=n[o];for(u in r)if(r.hasOwnProperty(u)){f=r[u].Styles;for(e in f)if(f.hasOwnProperty(e)){if(s=f[e],i=t.FormatTemplateStyleClassName(o,u,e),t.CellTypeTemplateStyleCache[i])continue;t.PrePageCellTypeTemplateStyleCache[i]&&(h=document.getElementById(i),h.remove(),t.PrePageCellTypeTemplateStyleCache[i]=undefined);t.ParseAndAppendPartStyle(s,i);t.CellTypeTemplateStyleCache[i]=!0}}}},t.ParseAndAppendPartStyle=function(i,r){var u=[],s=["box-sizing:border-box;",],a;n.ForguncyData.IsAutoTest&&(i.Transition="0s");i.Transition&&s.push("transition:"+i.Transition+";");var h=t.ConvertStyleString.apply(t,__spreadArrays([i.NormalStyle],s)),c=t.ConvertStyleString(i.HoverStyle),f=t.ConvertStyleString(i.FocusStyle),e=t.ConvertStyleString(i.ActiveStyle),l=t.ConvertStyleString(i.SelectedStyle),o=t.ConvertStyleString(i.DisableStyle);h&&u.push("."+r,h);f&&u.push("."+r+":not([disabled]):focus",f,"."+r+"-focus:not([disabled])",f);c&&n.Platform.isMobile()===!1&&n.Platform.isIpad()===!1&&u.push("."+r+":not([disabled]):hover",c);e&&(u.push("."+r+":not([disabled]):active",e),u.push("."+r+":not([disabled]).active",e));l&&u.push("."+r+":not([disabled]).selected",l);o&&(u.push("."+r+":disabled",o),u.push("."+r+"-disabled",o));u.push("."+r+" input, ."+r+" textarea, ."+r+" select","{color:inherit;font:inherit;}");u.push("."+r+" input:disabled, ."+r+" textarea:disabled, ."+r+" select:disabled","{color:inherit;}");a=u.join("");t.AddCSSTextToDocument(a,r)},t.AddCSSTextToDocument=function(n,t){var i=document.createElement("style"),r=document.body||document.getElementsByTagName("body")[0],u=document.createTextNode(n);i.type="text/css";i.id=t;i.appendChild(u);r.appendChild(i)},t.ConvertStyleString=function(t){for(var s,h=[],u=1;u<arguments.length;u++)h[u-1]=arguments[u];if(n.Common.IsEmpty(t))return null;var c=t.FontColor,l=t.Background,a=t.BorderString,v=t.BorderTopString,y=t.BorderRightString,p=t.BorderBottomString,w=t.BorderLeftString,f=t.PaddingLeft,e=t.PaddingRight,r=t.PaddingBottom,o=t.PaddingTop,b=t.Opacity,g=t.Bold,nt=t.Italic,tt=t.CellHorizontalAlignment,k=t.BorderRadiusString,d=t.BoxShadowString,i=[];return c&&i.push("color: "+n.ColorHelper.Convert(c)+";"),l&&i.push("background: "+n.ColorHelper.Convert(l)+" border-box;"),k&&i.push("border-radius: "+n.ColorHelper.Convert(k)+";"),a?i.push("border: "+n.ColorHelper.ConvertBorder(a)+";"):(v&&i.push("border-top: "+n.ColorHelper.ConvertBorder(v)+";"),y&&i.push("border-right: "+n.ColorHelper.ConvertBorder(y)+";"),p&&i.push("border-bottom: "+n.ColorHelper.ConvertBorder(p)+";"),w&&i.push("border-left: "+n.ColorHelper.ConvertBorder(w)+";")),r&&r===e&&r===o&&r===f?i.push("padding: "+r+"px!important;"):(o&&i.push("padding-top: "+o+"px!important;"),e&&i.push("padding-right: "+e+"px!important;"),r&&i.push("padding-bottom: "+r+"px!important;"),f&&i.push("padding-left: "+f+"px!important;")),n.Common.IsEmpty(b)||i.push("opacity: "+b+";"),d&&i.push("box-shadow: "+n.ColorHelper.ConvertShadow(d)+";"),g&&i.push("font-weight: bold;"),nt&&i.push("font-style: italic;"),i.push.apply(i,h),s=i.join(""),s?"{"+s+"}":null},t.ApplyCellTypeStyleTemplates=function(n,t){return t?(n.addClass(t),!0):!1},t.GetStyleTemplateByKey=function(n,t,i){return i&&i[n]?i[n][t]:null},t.IsTransparentColor=function(t){if(n.Common.IsEmpty(t)||t.indexOf("rgba")===-1)return!1;var r=t.split(","),i=parseFloat(r[r.length-1]);return isNaN(i)?!1:i===255||i===0?!1:!0},t.AddFocusStyleToContainer=function(n,t){var i="data-focus-within",r=t.attr(i);!r&&n&&(t.focusin(function(){t.addClass(n+"-focus")}),t.focusout(function(){t.removeClass(n+"-focus")}),t.attr(i,!0))},t.AddDiableCallbackToContainer=function(n,t){var r="data-disabled-event",i=t.attr(r);t.attr("disabled")&&t.addClass(n+"-disabled");!i&&n&&(t.data("DisableCallback",function(){t.addClass(n+"-disabled");t.attr("disabled",!0)}),t.data("EnableCallback",function(){t.removeClass(n+"-disabled");t.removeAttr("disabled")}),t.attr(i,!0))},t.AddActiveStyleToContainer=function(i,r){if(n.Platform.isIE()!==!1){var u="data-active-within",f=r.attr(u);if(!f&&i){r.on("mousedown",function(n){r.addClass("active");t.EventTarget=r});r.attr(u,"true")}}},t.ForceInnerEditorFontSizeToInherit=function(n,t){n&&(t.find("input").css({fontSize:"inherit"}),t.find("textarea").css({fontSize:"inherit"}))},t.CellTypeTemplateStyleCache={},t.PrePageCellTypeTemplateStyleCache={},t}();n.CellTypeStyleTemplateUtils=t}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(){}return t.initItems=function(i,r,u,f,e){var a,h,s,c,o,l;if(!n.FormulaManager.isReady()&&u.ItemsQuery){n.DelayRefresh.setTimeout(function(){t.initItems(i,r,u,f,e)},0);return}if(a=n.Common.typeContains(u,"UserCellType"),h=i,u.haveLoadItems)t.setItemsCellTypeItems(i,r,u,f,u.ItemsInfo,e);else{if(s=void 0,c=void 0,a){if(o=u,(n.Common.IsEmpty(o.Columns)||o.Columns===0)&&(n.Common.IsEmpty(o.CustomColumns)||o.CustomColumns.length<=0))return;s="Account/GetUsers";c={role:typeof o.Role=="undefined"?"":o.Role,displayColumnName:o.DisplayColumnName===undefined?"":o.DisplayColumnName,columns:o.Columns,customColumns:o.CustomColumns===undefined?"":o.CustomColumns.join(",")}}else{if(u.ValueColumnBindingInfo&&!u.DisplayColumnBindingInfo?u.DisplayColumnBindingInfo=u.ValueColumnBindingInfo:!u.ValueColumnBindingInfo&&u.DisplayColumnBindingInfo&&(u.ValueColumnBindingInfo=u.DisplayColumnBindingInfo),typeof u.ValueColumnBindingInfo=="undefined"){t.setItemsCellTypeItems(i,r,u,f,{Items:[]},e);return}s="Home/GetComboBindingOptions";c=t.getRequestDataInfo(u,h)}l=!e.isInListview&&(!n.Common.typeContains(u,"DropDownListCellType")||i instanceof n.ComboBoxCellType_Mobile);l&&h._startWaitingServerData();n.Common.forguncyPost(s,c,function(o,s){var c=null;c=n.Common.IsEmpty(o)?null:typeof o=="string"?JSON.parse(o):o;c||(c={Items:[]});u.ItemsInfo=c;t.setItemsCellTypeItems(i,r,u,f,c,e);u.haveLoadItems=!0;l&&h._endWaitingServerData()},e.id+" "+s)}},t.initItemsQuery=function(i,r,u,f,e){if(!e.isInListview){var o=i;u.IsBounding&&n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(r.DependenceCells,function(){u.haveLoadItems=!1;t.initItems(i,r,u,f,e)},o.runTimePageName)}},t.getRequestDataInfo=function(t,i){var r=null,u=n.Common.getLocatedListview(i.runTimePageName,i.CellElement.Row,i.CellElement.Column);return u instanceof n.SpreadJSView&&(r=u.getFormulaListRowInfo()),{tableName:t.DataSource,valueColumnBindingInfo:t.ValueColumnBindingInfo,displayColumnBindingInfo:t.DisplayColumnBindingInfo,dropDownSubItems:t.DropDownSubItems,itemQuery:n.ConditionHelper.getComputedSqlConditionFormula(t.ItemsQuery,i.runTimePageName,n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull,0,0,r),itemSort:t.ItemsSort}},t.setItemsCellTypeItems=function(i,r,u,f,e,o){n.Common.typeContains(u,"UserCellType")?i.setItems(r,f,e,o):(t.initItemsOfItemsCell(r,e,u),n.Common.typeContains(u,"DropDownListCellType")?i.setItems(r,f,e,o):(i.setItems(r,f,e.Items,o),n.DomUtilities.setPropertyToDom(r,f,o,[1])))},t.initItemsOfItemsCell=function(t,i,r){for(var e,o,c,s=r.IsBounding?r.AddNullItemWhenBinding:!1,h=s?r.NoneItemText:"",u=i.Items,f=u.length-1;f>=0;f--)n.Common.IsEmpty(u[f].Value)&&(u[f].Value=null,s=!1,n.Common.IsEmpty(u[f].DisplayValue)&&(u[f].DisplayValue=h)),n.Common.IsEmpty(u[f].DisplayValue)?u[f].DisplayValue="":t.StyleInfo.Formatter||(i.DisplayValueType===1?u[f].DisplayValue=n.FormatHelper.format("yyyy/M/d",u[f].DisplayValue).text:i.DisplayValueType===4&&(u[f].DisplayValue=n.FormatHelper.format("hh:mm",u[f].DisplayValue).text));if(s){if(e=null,n.Common.typeContains(r,"DropDownListCellType")&&(e={},r.DropDownSubItems))for(o=0;o<r.DropDownSubItems.length;o++)c=r.DropDownSubItems[o],c&&(e[c.GUID]=h);u.unshift({DisplayValue:h,Value:null,DropDownSubItemsList:e})}},t}();n.ItemsCellTypeHelper=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var t=function(t){function i(n,i,r,u){var e=t.call(this,n,i,r,u)||this,f;return e.toggles=[],f=n.CellType,f.haveLoadItems===undefined&&(f.haveLoadItems=!f.IsBounding),e}return __extends(i,t),i.prototype.create=function(n){this._divContainer=n;t.prototype.create.call(this,n)},i.prototype.createContent=function(){var o=this._divContainer,i=this.CellElement,s=this.isInListview,h=i.CellType,f=this._getDomCreateInfo(),t=n.DomUtilities.createJqueryDomElement("div"),c,l,r,u,e;return n.ItemsCellTypeHelper.initItems(this,i,h,t,f),t.attr("id",this.ID),c=[5],n.DomUtilities.setPropertyToDom(i,t,f,c),l=n.Platform.getBrowserScrollbarWidth(),this._scrollbarWidth=l,r=n.DomUtilities.createAlignmentContainer(t,i.StyleInfo.HorizontalAlignment,i.StyleInfo.VerticalAlignment,i.Height),o&&o.css("overflow","auto"),this.CellElement.StyleInfo.WordWrap?t.css("white-space","pre-wrap"):t.css("white-space","nowrap"),t.css("font-size","0"),s&&(u=n.DomUtilities.createContainerDiv(),u.css("overflow","hidden"),u.append(r),r=u),e=this.cellTypeData.getDefaultValue(),s||n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.ID,{newValue:e},1),this._setValue(t,e),n.ItemsCellTypeHelper.initItemsQuery(this,i,h,t,f),r},i.prototype.setItems=function(t,i,r,u){var l=this,f=t.CellType,s=i,w,k,e,p;s.empty();var o=__spreadArrays(r),v=[],b=[],a={};f.AddOtherItem&&(a.DisplayValue=n.RS.groupCell_Other,o.push(a));var h=0,y=0,c=0;for(this.toggles=[],f.LayoutMode===1&&(w=n.DomUtilities.createGridContainer(f.ColumnCount),s.append(w),s=w),k=function(i){var g=o[i],nt=n.Common.IsEmpty(g.DisplayValue)?"":g.DisplayValue,tt,rt,d,r,k,ut,w,p,it;if(b.push(nt),tt=void 0,t.StyleInfo.Formatter&&(rt=n.FormatHelper.format(t.StyleInfo.Formatter,nt),tt=rt.color,nt=rt.text),d=e.createSingleItemToggle(nt,null),e.toggles.push(d),r=e.createSingleItemUI(d),k=r.container,u.isInListview&&(r.inputContainer.attr(n.StaticValues.isInListview,u.isInListview),r.inputContainer.css("outline","thin transparent")),r.inputContainer.attr("id",e.ID+"_input"+i),r.inputContainer.attr("name",e.ID),n.DomUtilities.setPropertyToDom(t,r.textContainer,e._getDomCreateInfo(),[0]),n.Common.IsEmpty(tt)||(ut=n.FormatColorClassManager.getClassName(tt),r.textContainer.attr("useFormatColor",ut),r.textContainer.addClass(ut)),f.LayoutMode===1?(w=e.getLabelSize(r.container),w.width>h&&(h=w.width),k=$("<div><\/div>").append(r.container),n.DomUtilities.setGridRowAndColumn(k,f.ColumnCount,i),f.ColumnCount===1&&i===o.length-1||k.css("margin-bottom",f.ItemSpace)):(i!=o.length-1&&(r.container.css("margin-right",f.ItemSpace),c+=f.ItemSpace),w=e.getLabelSize(r.container),f.IsSameWidth?(r.container.css("float","left"),w.width>h&&(h=w.width),w.height>y&&(y=w.height),c+=w.width):(r.container.css("float","none"),c+=w.width)),!u.isInListview)d.on("PropertyChanged",function(n,t){t==="isChecked"&&(l._onValueChanged(),l.validate())});if(s.append(k),g===a){p=$("<input type='text' otherText='otherText' dir='auto' aria-label='Other:'>");it=f.OtherItemTextBoxWidthSetting;e._otherTextBox=p;e._otherTextBoxWidth=it;p.attr("id",e.ID+"_input_other");p.css("width",it);f.LayoutMode===1&&(f.ColumnCount>=1?n.DomUtilities.setGridRowAndColumn(p,f.ColumnCount,o.length-1):r.container.css("display","inline-flex"));n.DomUtilities.setPropertyToDom(t,p,e._getDomCreateInfo(),[0]);c+=it+5;p.on("change keyup",function(){p.val()&&(d.isChecked=!0)});f.IsSameWidth===!0&&f.LayoutMode!==1&&(r.container.css("float","left"),p.css("float","left"));r.inputContainer.on("click",function(){p.focus()});if(!u.isInListview){p.on("change",function(){l._onValueChanged()});p.focusout(function(){l.isReadOnly()||l.validate()})}r.inputContainer.attr("othercheck","otherCheck");f.LayoutMode===1?k.append(p):s.append(p);v.push(function(){var t=p.val();return n.Common.IsEmpty(t)?null:t})}else v.push(g.Value)},e=this,p=0;p<o.length;p++)k(p);f.LayoutMode===1?c=h:f.IsSameWidth&&(c=(h+f.ItemSpace)*o.length);o[o.length-1]===a&&(c+=f.OtherItemTextBoxWidthSetting);this._widthBasis=Math.max(t.Width,c);f.LayoutMode!==1&&(o[o.length-1]===a?this.setMaxSizeToLabel(h,y,s,!0):this.setMaxSizeToLabel(h,y,s,!1));this.valueList=v;this.displayValueList=b;u.isInListview||n.PageManager.isPageIsLoading(this.runTimePageName)||this.ensureGroupCellTypeValueAfterItemsChanged(v,t,f.AddOtherItem);n.FocusMoveHelper.AllowMoveFocusByEnterKey(s.find("input"),this.isInListview,this.CellElement);this._setTabIndexToDom(f,s);this.isVisible()||this._setVisible(this.getContainer(),!1);this.isEnabled||this._disable(s);this.isReadOnly()&&this.updateReadOnlyStatus()},i.prototype.getEnsuredValueAfterItemsChanged=function(n,t,i){throw"need child class implement";},i.prototype.ensureGroupCellTypeValueAfterItemsChanged=function(t,i,r){var f=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID),u=this.getEnsuredValueAfterItemsChanged(t,f,r);n.Common.IsEmpty(u)&&(u=null);f!==u&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.ID,{newValue:u},5)},i.prototype.setMaxSizeToLabel=function(n,t,i,r){var f=i.children(".FUI-toggle"),e=f.length,u;for(r&&e--,u=0;u<e;u++)$(f[u]).css("width",n||""),$(f[u]).css("height",t||"")},i.prototype.hasFocus=function(){var t=$("#"+this.ID).find("[name='"+this.ID+"']"),n;if(t.length>0)for(n=0;n<t.length;n++)if(document.activeElement===t[n])return!0;return!1},i.prototype.setFocus=function(){var n=$("#"+this.ID).find("[name='"+this.ID+"']");n.length>0&&n[0].focus()},i.prototype.focus=function(){var n=$("#"+this.ID).find("input");n.length>0&&$(n[0]).focus()},i.prototype.setValueToElement=function(n,t){var r=n.find('[name="'+this.ID+'"]'),i=this.valueList;i&&(this.setValueToUIInternal(n,r,i,t),this.setOtherValue(n,i,t))},i.prototype.getValueFromElement=function(n){var i=$("#"+this.ID),r,t;return i.length===0?null:(r=i.find('[name="'+this.ID+'"]'),t=this.valueList,!t)?null:this.getValueInternal(r,t)},i.prototype.setValueToUIInternal=function(n,t,i,r){throw"need child class implement";},i.prototype.getValueInternal=function(n,t){throw"need child class implement";},i.prototype.getOtherValue=function(n,t){throw"need child class implement";},i.prototype.createSingleItemToggle=function(n,t){throw new Error("Need override");},i.prototype.createSingleItemUI=function(n){throw new Error("Need override");},i.prototype._getCellTypeData=function(t){return new n.GroupCellTypeData(t)},i.prototype._setOverflowHidden=function(n){return},i.prototype.adjustForeColor=function(n,i){return t.prototype.adjustForeColor.call(this,n,null)},i.prototype.onFormatterChanged=function(){for(var r,i=$("#"+this.ID+" .FUI-toggle-text"),t=0;t<i.length;t++){var f={value:null},e=n.FormatHelper.formatValue(this.displayValueList[t],this.getFormatString(),f),u="";f.value&&(u=n.FormatColorClassManager.getClassName(f.value));r=$(i[t]).attr("useFormatColor");n.Common.IsEmpty(r)&&(r="");r!==u&&(n.Common.IsEmpty(r)||$(i[t]).removeClass(r),n.Common.IsEmpty(u)||$(i[t]).addClass(u));$(i[t]).attr("useFormatColor",u);$(i[t]).text(e)}},i.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID+" .FUI-toggle-text,#"+this.ID+"_input_other")},i.prototype._disable=function(n){this.updateDisabledProperty(!1)},i.prototype._enable=function(){this.updateDisabledProperty(!0)},i.prototype.updateReadOnlyStatus=function(){this.updateDisabledProperty(this.isEnabled)},i.prototype.updateDisabledProperty=function(n){n=n&&!this.isReadOnly();var t=this.getContainer().find("input");this.toggles.forEach(function(t){t.enabled=n});n?t.removeAttr("disabled"):t.attr("disabled","disabled")},i.prototype.containsOtherItem=function(){var n=this.CellElement.CellType;return n.AddOtherItem?!0:!1},i.prototype.setOtherValue=function(n,t,i){if(this.containsOtherItem()){var u=this.getOtherValue(t,i),f=n.find("[otherText]"),r=n.find("[othercheck]");u===undefined||u===null?f.val()!==""&&r[0].checked===!0&&(f.val(""),r[0].checked=!1,$(r[0]).trigger("change")):(f.val(u+""),r[0].checked=!0,$(r[0]).trigger("change"))}},i.prototype.setStlyeInternal=function(t){var i=$("#"+this.ID).find("FUI-toggle-text");i.length<=0||n.DomUtilities.setPropertyToDom(t,i,this._getDomCreateInfo(),[0])},i.prototype.reload=function(t){if(t){var i=this.CellElement.CellType;i.IsBounding&&(i.haveLoadItems=!1,n.ItemsCellTypeHelper.initItems(this,this.CellElement,i,$("#"+this.ID),this._getDomCreateInfo()))}},i.prototype.getBindingTables=function(){var n=this.CellElement.CellType;return n.IsBounding?[n.DataSource]:null},i.prototype._getVisibleParts=function(n){return n.find("input")},i.prototype.onWindowResized=function(){this.resizeOtherTextBox()},i.prototype.getLabelSize=function(n){var t=n.clone(),i,r;return t.css("float","left"),$(window.document.body).append(t),i=t[0].clientWidth+1,r=t[0].clientHeight+1,t.remove(),{width:i,height:r}},i.prototype.resizeOtherTextBox=function(){if(this._otherTextBox&&this._widthBasis){var n=this.getContainerWidth(),t=n-this._widthBasis,i=Math.max(this._otherTextBoxWidth,this._otherTextBoxWidth+t-this._scrollbarWidth);this._otherTextBox.width(i)}},i.prototype.getContainerWidth=function(){var n=this.getContainer();return n?n.width():0},i.prototype.destroy=function(){this._otherTextBox=null;t.prototype.destroy.call(this)},i}(n.ListviewEditModeCellType);n.GroupCellTypeBase=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){function u(t){return n.Platform.isMobile()}var i=function(t){function i(n){var i=t.call(this)||this;return i._mainStr="MAIN",i.TemplateNameParts=[i._mainStr],i.CellTypeString=n,i}return __extends(i,t),i.prototype.MapPartsNameToDom=function(n){return{MAIN:n.find(">div")}},i.prototype.OnTemplateStyleApplied=function(t,i){var r,u;t&&i&&(i.css("overflow","visible"),r=this.MapPartsNameToDom(i)[this._mainStr],r.css({overflow:"hidden",position:"relative"}),u=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(this.CellTypeString,t.Key,this._mainStr),n.CellTypeStyleTemplateUtils.AddFocusStyleToContainer(u,r),n.CellTypeStyleTemplateUtils.AddDiableCallbackToContainer(u,r),n.CellTypeStyleTemplateUtils.AddActiveStyleToContainer(u,r))},i}(n.CellTypeStyleTemplateHelperBase),t,r,f,e,o,s;n.InputCellTypeStyleTemplateHelperBase=i;t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype._getCellTypeData=function(t){return new n.InputCellTypeData(t)},i.prototype._getPartsUseBackcolor=function(){return $("#"+this.ID+"_div > div")},i.prototype.createContent=function(){var i=this,r=t.prototype.createContent.call(this),f=this.CellElement.CellType,u;if(f.IsSelectAllOnFocus){u=r.find("#"+this.ID);u.on("focusin",function(){n.Platform.isChrome()&&!n.Platform.isWeChatOrQQBrowser()?i.selectAll():n.DelayRefresh.setTimeout(function(){i.selectAll()})})}return r},i.prototype.addClassInSimulator=function(t){n.MetadataLoader.IsInMobileSimulatorFrame()&&t.addClass("in-simulator")},i.prototype.onWindowResized=function(){var t=n.PageManager.getPageStretchInfo(this.runTimePageName);if(t){var i=t.StretchMode,r=t.MainPartWidth,u=n.Stretch.Common.canHorizontallyStretch(i);this._$input&&u&&r>0&&this._$input.css("width","100%")}},i.prototype.createCellContent=function(){var r=this.CellElement,t=n.DomUtilities.createJqueryDomElement(this.inputElementTagName()),i,f,u;return this._$input=t,i=n.CellDomCreateHelper.createControlContainer(),this._$container=i,i.append(t),n.CellDomCreateHelper.initalInputBox(r,t,this._getDomCreateInfo()),t.css("background-color","transparent"),t.css("text-align",n.DomUtilities.getHorizontalAlignmentText(r.StyleInfo.HorizontalAlignment)),this.initInputElement(t),f=r.CellType,this.isInListview||(this.bindValueChangedEvent(t),u=this,t.focusout(function(){u.isReadOnly()||u.validate()})),this.initDefaultValue(t,f),n.Platform.isMobile()||this.isInListview||n.FocusMoveHelper.AllowMoveFocusByEnterKey(t,this.isInListview,this.CellElement),i},i.prototype.bindValueChangedEvent=function(n){var t=this;n.change(function(){t.isReadOnly()||t._onValueChanged()})},i.prototype.inputElementTagName=function(){return"input"},i.prototype.initInputElement=function(n){},i.prototype.initDefaultValue=function(n,t){var i=this.cellTypeData.getDefaultValue();i!==null&&this._setValue(n,i)},i.prototype.setValueToElement=function(n,t){n.val(t);this.changeFormatElement()},i.prototype.getValueFromElement=function(t){if(this._$input){var i=this._$input.val();return n.Common.IsEmpty(i)?null:i}return null},i.prototype._disable=function(n){n.find("#"+this.ID).attr("disabled","disabled");this._$container.attr("disabled","disabled");t.prototype._disable.call(this,this._$container)},i.prototype._enable=function(){this._$input&&this._$input.removeAttr("disabled");this._$container.removeAttr("disabled");t.prototype._enable.call(this,this._$container)},i.prototype.updateReadOnlyStatus=function(){this._$input&&(this.isReadOnly()?this._$input.attr("readonly","readonly"):this._$input.prop("readonly",!1))},i.prototype._getPartsUseFontStyle=function(){var n=t.prototype._getPartsUseFontStyle.call(this);return this._$input?this._$input.add(n):n},i.prototype.getValueToFormat=function(){return this._$input.val()},i.prototype.destroy=function(){this._$input=null;t.prototype.destroy.call(this)},i.prototype.canInputChars=function(){return this.isEnabled&&!this.isReadOnly()},i.prototype.selectAll=function(){var n=$("#"+this.ID);n.length>0&&n.select()},i.prototype.setCaretAtLast=function(){var n=$("#"+this.ID),i=n.val(),t;i&&n.length>0&&(t=n[0],t.selectionStart=t.selectionEnd=i.length)},i.prototype.setStlyeInternal=function(t){var i=$("#"+this.ID);i.length<=0||(n.Common.IsEmpty(t.StyleInfo.Background)||i.css("background-color",n.ColorHelper.Convert(t.StyleInfo.Background)),n.DomUtilities.setPropertyToDom(t,i,this._getDomCreateInfo(),[0]))},i.prototype._getVisibleParts=function(n){return n.find("#"+this.ID)},i}(n.SupportFormatCellType);n.InputCellTypeBase=t;r=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.createContent=function(){var f=t.prototype.createContent.call(this),e=this.CellElement.CellType,o=e.IconSize,i=n.ImageDataHelper.CreateImage(e.Icon,o),r,u;return i?(r=n.DomUtilities.createGridContainerEx(null,[o+10+"px","1fr"]),r.css("height","100%"),r.css("width","100%"),f.css("position","relative"),i.css("justify-self","center"),i.css("align-self","center"),i.css("-ms-grid-row-align","center"),i.css("-ms-grid-column-align","center"),r.append(i),r.append(f),n.DomUtilities.setGridItemPos(i,1,1),n.DomUtilities.setGridItemPos(f,1,2),u=n.DomUtilities.createJqueryDomElement("div"),u.css("width","100%").css("height","100%"),u.append(r),this._$container=u,u):f},r.prototype.createCellContent=function(){var i=this,r=t.prototype.createCellContent.call(this);return this._$input.keydown(function(t){t.which!==13||n.ForguncyData.pageInfo.moveFocusByEnter||i._onValueChanged()}),r},r.prototype.initInputElement=function(t){t.attr("type","text");t.attr("autocomplete","off");t.css("ime-mode",n.Common.GetImeMode(this.CellElement.CellType))},r.prototype.setValueToElement=function(i,r){var u=n.FormatHelper.getTextFromValue(r);t.prototype.setValueToElement.call(this,i,u)},r.prototype.getValueFromElement=function(i){var r=t.prototype.getValueFromElement.call(this,i);return this.CellElement.StyleInfo.Formatter=="@"||i||(r=n.FormatHelper.getValueFromText(r)),n.Common.IsEmpty(r)&&(r=null),r},r.StyleTemplateHelper=new i("Forguncy.TextCellType"),r}(t);n.TextBoxCellType=r;f=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.inputElementTagName=function(){return"textarea"},r.prototype.initInputElement=function(t){var r=this,u,i;t.css("resize","none");u=this.CellElement.CellType;t.css("ime-mode",n.Common.GetImeMode(u));i=this;t.keydown(function(t){return!n.Platform.isMobile()&&!i.isInListview&&n.ForguncyData.pageInfo.moveFocusByEnter&&!t.altKey&&!t.ctrlKey&&t.keyCode===13?!1:t.altKey&&t.keyCode===13?(i.wrapMultilineText(t.target),!1):void 0});this.isInListview||t.focusout(function(){r.isReadOnly()||r._onValueChanged()})},r.prototype.shouldHandleFormat=function(){return!1},r.prototype.setValueToElement=function(i,r){var u=n.FormatHelper.getTextFromValue(r);t.prototype.setValueToElement.call(this,i,u)},r.prototype.enterPrintMode=function(){this._$input.css("overflow","hidden")},r.prototype.quitPrintMode=function(){this._$input.css("overflow","")},r.prototype.wrapMultilineText=function(n){var t=n.selectionStart,i=n.value,r=i.substr(0,t),u=i.substr(n.selectionEnd);$(n).val(r+"\n"+u);t=t+1;n.setSelectionRange(t,t)},r.StyleTemplateHelper=new i("Forguncy.MultilineTextBox"),r}(t);n.MultilineTextBoxCellType=f;e=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype._getCellTypeData=function(t){return new n.NumberCellTypeData(t)},r.prototype.initInputElement=function(n){n.attr("type","number");this.isInListview||n.focusout(function(){window.getSelection&&window.getSelection().empty&&window.getSelection().empty()})},r.StyleTemplateHelper=new i("Forguncy.NumberCellType"),r}(t);n.NumberCellType_Mobile=e;o=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype._getCellTypeData=function(t){return new n.DateCellTypeData(t)},r.prototype.initInputElement=function(n){n.attr("type","date");this.addClassInSimulator(n);var t=this;n.on("focus",function(n){t.isReadOnly()&&$(this).trigger("blur")})},r.prototype.bindValueChangedEvent=function(i){var r=this;n.Platform.isIOSDevice()?i.blur(function(){r.isReadOnly()||r._onValueChanged()}):t.prototype.bindValueChangedEvent.call(this,i)},r.prototype.initDefaultValue=function(t,i){var r=this.cellTypeData.getDefaultValue();this._setValue(t,r);n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.ID,{newValue:r},1)},r.prototype.getValueFromElement=function(t){var r,i;return this._$input?(r=this._$input.val(),n.Common.IsEmpty(r))?null:(i=new Date(r),isNaN(i.valueOf())?null:(i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),n.Convertor.fromDateToOADate(i))):null},r.prototype.setValueToElement=function(n,i){try{t.prototype.setValueToElement.call(this,n,this.getDateString(i))}catch(r){}},r.prototype.getDateString=function(t){var i;if(!n.DateHelper.isValidDateValue(t))return null;i=t;typeof t=="number"&&(i=n.Convertor.fromOADateToDate(t));var r=i.getMonth()+1,u=i.getDate(),f=(r<10?"0":"")+r,e=(u<10?"0":"")+u;return[i.getFullYear(),f,e].join("-")},r.prototype.shouldReserveRightSpace=function(){return!0},r.StyleTemplateHelper=new i("Forguncy.DateCellType"),r}(t);n.DateCellType_Mobile=o;s=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype._getCellTypeData=function(t){return new n.TimeCellTypeData(t)},r.prototype.initInputElement=function(n){n.attr("type","time");this.addClassInSimulator(n);var t=this;n.on("focus",function(n){t.isReadOnly()&&$(this).trigger("blur")})},r.prototype.bindValueChangedEvent=function(i){var r=this;n.Platform.isIOSDevice()?i.blur(function(){r.isReadOnly()||r._onValueChanged()}):t.prototype.bindValueChangedEvent.call(this,i)},r.prototype.initDefaultValue=function(t,i){var r=this.cellTypeData.getDefaultValue();this._setValue(t,r);n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.ID,{newValue:r},1)},r.prototype.getValueFromElement=function(t){var i,r;return this._$input?(i=this._$input.val(),n.Common.IsEmpty(i))?null:n.Common.isValidateTime(i)?(typeof i=="string"&&(i=(i+"").split(".")[0]),r=new Date(n.FormatHelper.getValueFromText(i)),n.Convertor.fromDateToOADate(r)%1):null:null},r.prototype.setValueToElement=function(i,r){try{var u=r;typeof r=="number"&&(u=n.Convertor.fromOADateToDate(r));t.prototype.setValueToElement.call(this,i,this.getTimeString(u))}catch(f){}},r.prototype.getTimeString=function(n){if(!(n instanceof Date))return null;var t=n.getHours(),i=n.getMinutes(),r=n.getSeconds(),u=(t<10?"0":"")+t,f=(i<10?"0":"")+i,e=(r<10?"0":"")+r;return[u,f,e].join(":")},r.prototype.shouldReserveRightSpace=function(){return!0},r.StyleTemplateHelper=new i("Forguncy.TimeCellType"),r}(t);n.TimeCellType_Mobile=s;n.CellTypeHelper.registerCellType("Forguncy.ReadingTextCellType, Forguncy",r,u);n.CellTypeHelper.registerCellType("Forguncy.TextCellType, Forguncy",r,function(t){return(n.Platform.isMobile()||!t.CellType.ReadingTextInfo)&&!t.CellType.ShowPassword});n.CellTypeHelper.registerCellType("Forguncy.MultilineTextBox, Forguncy",f,function(t){return n.Platform.isMobile()||!t.CellType.ReadingTextInfo});n.CellTypeHelper.registerCellType("Forguncy.NumberCellType, Forguncy",e,u);n.CellTypeHelper.registerCellType("Forguncy.DateCellType, Forguncy",o,u);n.CellTypeHelper.registerCellType("Forguncy.TimeCellType, Forguncy",s,u)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){function u(t){return n.Platform.isMobile()}var i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.OnTemplateStyleApplied=function(t,i){if(n.prototype.OnTemplateStyleApplied.call(this,t,i),t&&i){var r=i.find("select");r.length>0&&(r.css("outline","none"),r[0].style.color===""&&r.css("color","inherit"))}},t}(n.InputCellTypeStyleTemplateHelperBase),t,r;n.MobileComboBoxCellTypeStyleTemplateHelper=i;t=function(t){function r(i,r,u,f){var e=t.call(this,i,r,u,f)||this,o;return e._dataName="item",e._initingValues=!1,e.supportedEvents=[n.Events.SelectionChanged],o=i.CellType,o.haveLoadItems===undefined&&(o.haveLoadItems=!o.IsBounding),e}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype._getCellTypeData=function(t){return new n.InputCellTypeData(t)},r.prototype.createCellContent=function(){var r=this.CellElement,t=n.DomUtilities.createJqueryDomElement("select"),f,e,u,i;return this._$select=t,f=n.CellDomCreateHelper.createControlContainer(),f.append(t),n.CellDomCreateHelper.initalInputBox(r,t,this._getDomCreateInfo()),t.css("background-color","transparent"),e=r.CellType,n.ItemsCellTypeHelper.initItems(this,r,e,t,this._getDomCreateInfo()),u=this.cellTypeData.getDefaultValue(),n.Common.IsEmpty(u)||(n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.ID,{newValue:u},1),this._setValue(t,u)),n.ItemsCellTypeHelper.initItemsQuery(this,r,e,t,this._getDomCreateInfo()),this.isInListview||(i=this,t.change(function(){i._initingValues||i.isReadOnly()||(i._onValueChanged(),n.Page&&i.trigger(n.Events.SelectionChanged,{}))}),t.focusout(function(){i.isReadOnly()||i.validate()})),f},r.prototype.getValueToFormat=function(){var n=this.getSelectedItem();return n?n.DisplayValueBeforeFormat:null},r.prototype.setItems=function(t,i,r,u){var s=this.getItems(r,this.CellElement.StyleInfo.Formatter),h=i,c,o,f,e;this._initingValues=!0;try{for(h.empty(),c=s.length,o=0;o<c;o++)f=s[o],e=n.DomUtilities.createJqueryDomElement("option"),n.Common.IsEmpty(f.DisplayValue)&&(f.DisplayValue=""),e.append(n.Common.htmlEncode(f.DisplayValue)),n.Common.IsEmpty(f.Forecolor)?e.css("color","black"):e.css("color",n.ColorHelper.Convert(f.Forecolor)),e.data(this._dataName,f),h.append(e)}finally{this._initingValues=!1}this.updateValue(s)},r.prototype.getItems=function(t,i){return n.ComboBoxCellType_InputMan.getFormattedItems(t.Items,i)},r.prototype.updateValue=function(t){for(var r,u,f=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID),e=t.length,i=0;i<e;i++)if(n.Common.isEquals(f,t[i].Value))return;r=t.length===0?null:t[0].Value;u=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValueType(this.ID);n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.ID,{newValue:r},u)},r.prototype.setValueToElement=function(t,i){var r;if(t.length===0)return null;var u=t[0],f=u.options,o=f.length,e=-1;for(r=0;r<o;r++)if(n.ComboBoxCellType_InputMan.isComboBoxItemEqual(i,$(f[r]).data(this._dataName).Value)){e=r;break}u.selectedIndex=e;this.changeFormatElement()},r.prototype.getValueFromElement=function(n){var t=this.getSelectedItem();return t?t.Value:null},r.prototype.getSelectedItem=function(){var i=this._$select,n,t,r;return i?(n=i[0],t=n.selectedIndex,t<0)?null:(r=$(n.options[t]),r.data(this._dataName)):null},r.prototype.reload=function(t){if(t){var i=this.CellElement.CellType;i.IsBounding&&(i.haveLoadItems=!1,n.ItemsCellTypeHelper.initItems(this,this.CellElement,i,this._$select,this._getDomCreateInfo()))}},r.prototype.getBindingTables=function(){var n=this.CellElement.CellType;return n.IsBounding?[n.DataSource]:null},r.prototype._endWaitingServerData=function(){t.prototype._endWaitingServerData.call(this);this._$select&&this.changeFormatElement()},r.prototype.setForeColorToInput=function(t){var i=this._$select;i&&(t?i.css("color",n.ColorHelper.Convert(t)):i.css("color",""))},r.prototype._getPartsUseFontStyle=function(){var n=t.prototype._getPartsUseFontStyle.call(this);return this._$select?this._$select.add(n):n},r.prototype._disable=function(n){this.updateSelectDisabledProperty(!1);t.prototype._disable.call(this,n)},r.prototype._enable=function(n){this.updateSelectDisabledProperty(!0);t.prototype._enable.call(this,n)},r.prototype.updateReadOnlyStatus=function(){this.updateSelectDisabledProperty(this.isEnabled)},r.prototype.updateSelectDisabledProperty=function(n){this._$select&&(n=n&&!this.isReadOnly(),n?this._$select.removeAttr("disabled"):this._$select.attr("disabled","disabled"))},r.prototype.shouldReserveRightSpace=function(){return!0},r.prototype.getHorizontalAlignment=function(){return n.CellHorizontalAlignment.Left},r.prototype.destroy=function(){this._$select=null;t.prototype.destroy.call(this)},r.prototype.getListviewNoneEditModeText=function(i,r,u){var f=n.ComboBoxCellType_InputMan.getDisplayValue(this.CellElement.CellType,i,r,this.CellElement.StyleInfo.Formatter);return f!==null?f:t.prototype.getListviewNoneEditModeText.call(this,i,r,u)},r.prototype.onFormatterChanged=function(){t.prototype.onFormatterChanged.call(this);var i=$("#"+this.ID);i.length===1&&n.ItemsCellTypeHelper.initItems(this,this.CellElement,this.CellElement.CellType,i,this._getDomCreateInfo())},r.StyleTemplateHelper=new i("Forguncy.DropDownListCellType"),r}(n.SupportFormatCellType);n.ComboBoxCellType_Mobile=t;r=function(t){function r(n,i,r,u){var f=t.call(this,n,i,r,u)||this,e;return f.NAME="Name",f.FULLNAME="FullName",f.EMAIL="Email",e=n.CellType,e.haveLoadItems=!1,f}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.getItems=function(t,i){var u=[],e=this.CellElement.CellType,r,s,h,f,o,c;if(e.AddNullItemWhenBinding&&u.push({Value:null,DisplayValue:n.Common.IsEmpty(e.NoneItemText)?"":e.NoneItemText}),r=t.Properties.users,!r||r.length===0)return u;for(s=this.CellElement.CellType.MobileDisplayColumnName,h=r.length,f=0;f<h;f++)o=r[f],c=this.getUserInfoProperty(o,s),u.push({Value:o.UserName,DisplayValue:c});return u},r.prototype.getUserInfoProperty=function(t,i){if(n.Common.IsEmpty(i))return t.UserName;switch(i){case this.NAME:return t.UserName;case this.FULLNAME:return t.FullName;case this.EMAIL:return t.Email;default:return n.UserInfoHelper.getUserPropertyValue(t,i)}},r.prototype.reload=function(n){},r.prototype.getListviewNoneEditModeText=function(i,r,u){var f=n.UserSelectorCellType_InputMan.getDisplayValue(this.CellElement.CellType,i,r);return f!==null?f:t.prototype.getListviewNoneEditModeText.call(this,i,r,u)},r.StyleTemplateHelper=new i("Forguncy.UserCellType"),r}(t);n.UserSelectorCellType_Mobile=r;n.CellTypeHelper.registerCellType("Forguncy.DropDownListCellType, Forguncy",t,u);n.CellTypeHelper.registerCellType("Forguncy.UserCellType, Forguncy",r,u)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t,i,r,u;(function(n){n.focusOut="focusout";n.focusIn="focusin";n.keydown="keydown";n.SelectedDateChanged="SelectedDateChanged";n.ValueChanged="ValueChanged";n.IMEReadingStringOutput="IMEReadingStringOutput"})(t=n.InputManEvent||(n.InputManEvent={}));i=function(i){function r(){var n=i!==null&&i.apply(this,arguments)||this;return n._eventHandlers={},n._inputEventHandlers={},n}return __extends(r,i),r.prototype._getPartsUseBackcolor=function(){return $("#"+this.ID+"_div > div")},r.prototype._getCellTypeData=function(t){return new n.InputCellTypeData(t)},r.prototype.getDefaultValue=function(){return{Value:this.cellTypeData.getDefaultValue()}},r.prototype.create=function(n){i.prototype.create.call(this,n);n.css("overflow","")},r.prototype.createCellContent=function(){var i=this;return this._content=this._createInputManCellContent(),this.needValidate()&&!this.isInListview&&this.bindInputManEvent(t.focusOut,function(){i.validate()}),n.FocusMoveHelper.AllowMoveFocusByEnterKey(this.getInputElement(),this.isInListview,this.CellElement),n.ForguncyData.GlobalSettings&&n.ForguncyData.GlobalSettings.CellTypeSpinInfos&&(this._cellTypeSpinInfos=n.ForguncyData.GlobalSettings.CellTypeSpinInfos,this.setCellTypeAllowSpin()),this.getInputManControl().setShowContextMenu(!1),this.initInputElement(),this.checkInputManEvenBinding(),this._content},r.prototype.checkInputManEvenBinding=function(){for(var n in this._eventHandlers)this._inputEventHandlers[n]||this._bindEventOfControl(n)},r.prototype.bindInputManEvent=function(n,t){var i=this._eventHandlers[n];i?i.push(t):this._eventHandlers[n]=[t];this._bindEventOfControl(n)},r.prototype.unbindInputManEvent=function(n,t){var i=this._eventHandlers[n],r;i&&(r=i.indexOf(t),r!==-1&&i.splice(r,1))},r.prototype._bindEventOfControl=function(n){var r=this,u=this.getInputElement(),i,t;u&&(i=this.getInputManControl(),i)&&(t=this._inputEventHandlers[n],t||(t=function(t,i){r.onInputManEventOccur(n,i)},this.bindEventOfControl(n,t),this._inputEventHandlers[n]=t))},r.prototype.bindEventOfControl=function(n,i){var r=this.getInputElement();if(r)switch(n){case t.focusIn:r.bind(n,null,i);break}},r.prototype.unbindEventOfControl=function(n,i){var r=this.getInputElement();if(r)switch(n){case t.focusIn:r.unbind(n,i);break}},r.prototype.onInputManEventOccur=function(n,t){var i=this._eventHandlers[n];i&&i.forEach(function(n){return n.call(self,t)})},r.prototype.setCellTypeAllowSpin=function(){},r.prototype.getCellTypeFullName=function(){var n=this.cellTypeData.metaData.$type;return n?n.split(",")[0]:null},r.prototype.getSpinType=function(){for(var i=this.getCellTypeFullName(),t=0;t<this._cellTypeSpinInfos.length;t++)if(this._cellTypeSpinInfos[t].CellTypeFullName===i)return n.SpinType.SpinButton|this._cellTypeSpinInfos[t].SpinType;return n.SpinType.All},r.prototype.getDropDownObj=function(){if(this._content){var n=this._content.find(".gcim-dropdown");if(n.length>0)return n[0]}return null},r.prototype.isDropDownOpened=function(){var n=this.getDropDownObj();return n?!$(n).hasClass("gcim-dropdown_close"):!1},r.prototype.setValueToElement=function(n,t){try{this.getInputManControl()&&this.setValueToInputManControl(t)}catch(i){}finally{this.changeFormatElement()}},r.prototype.getValueFromElement=function(n){return this.getInputManControl()?this.getValueFromInputManControl(n):null},r.prototype._disable=function(n){this.setEnabled(!1);i.prototype._disable.call(this,this._getPartsUseBackcolor())},r.prototype._enable=function(n){this.setEnabled(!0);i.prototype._enable.call(this,this._getPartsUseBackcolor())},r.prototype.setEnabled=function(n){var t=this.getInputManControl();t&&t.setEnabled&&t.setEnabled(n)},r.prototype.updateReadOnlyStatus=function(){var n=this.getInputManControl();n&&n.setReadOnly&&n.setReadOnly(this.isReadOnly())},r.prototype.destroy=function(){for(var n in this._inputEventHandlers)this.unbindEventOfControl(n,this._inputEventHandlers[n]);this._inputEventHandlers={};this._eventHandlers={};this._content=null;i.prototype.destroy.call(this)},r.prototype.canInputChars=function(){return this.isEnabled&&!this.isReadOnly()},r.prototype.needValidate=function(){return this.isReadOnly()?!1:i.prototype.needValidate.call(this)},r.prototype.initInputElement=function(){var t=this.getInputElement(),i=n.Common.GetImeMode(this.CellElement.CellType);t.css("ime-mode",i);this.setStyleToInputmanControl(this.CellElement)},r.prototype.getInputElement=function(){return this._content?this._content.find(this._inputElementSelector):null},Object.defineProperty(r.prototype,"_inputElementSelector",{get:function(){return".gcim__input"},enumerable:!0,configurable:!0}),r.prototype.setStlyeInternal=function(n){this.setStyleToInputmanControl(n)},r.prototype._setFontStyle=function(n){n&&(this.setStyleToInputmanControl(this.CellElement),i.prototype._setFontStyle.call(this,n))},r.prototype.setStyleToInputmanControl=function(t){var i=this.getInputElement();n.CellDomCreateHelper.initalInputBox(t,i,this._getDomCreateInfo());i.css("background-color","transparent");i.css("text-align",n.DomUtilities.getHorizontalAlignmentText(this.CellElement.StyleInfo.HorizontalAlignment));this.isInListview&&this._content.css("background-color",n.ColorHelper.Convert(t.StyleInfo.Background))},r.prototype._getPartsUseFontStyle=function(){var n=i.prototype._getPartsUseFontStyle.call(this),t=this.getInputElement();return t?t.add(n):n},r.prototype.initHandlingFormatLabelEvent=function(n,i,r){this.bindInputManEvent(t.focusIn,function(){i()});this.bindInputManEvent(t.focusOut,function(){r()})},r.prototype.getControl=function(){return this.getInputManControl()},r.prototype._getVisibleParts=function(n){return this._content},r.prototype.canInput=function(){return!this.isReadOnly()},r.prototype.getIgnoreKeysInListview=function(){return[37,38,39,40]},r.prototype.getReserveRightSpaceWidth=function(){return 22},Object.defineProperty(r.prototype,"_originalInputID",{get:function(){return this.ID+"_o"},enumerable:!0,configurable:!0}),r.prototype.appendFormatLabelPart=function(n){if(n.find(".gcim-dropdown").length===0)return i.prototype.appendFormatLabelPart.call(this,n);var t=n.find(".gcim__input-wrapper");return t.before(this.getFormatPart()),t.css("position","relative"),t.css("top","-100%"),n},r}(n.SupportFormatCellType);n.InputManCellTypeBase=i;r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return __extends(r,i),r.prototype.getGcInputManBase=function(){return this.getInputManControl()},r.prototype.bindEventOfControl=function(n,r){var u=this.getGcInputManBase();switch(n){case t.focusOut:u.onFocusOut(r);break;case t.keydown:u.onKeyDown(r);break;default:i.prototype.bindEventOfControl.call(this,n,r);break}},r.prototype.unbindEventOfControl=function(n,r){var u=this.getGcInputManBase();switch(n){case t.focusOut:u.removeFocusOut(r);break;case t.keydown:u.removeKeyDown(r);break;default:i.prototype.unbindEventOfControl.call(this,n,r);break}},r.prototype.focus=function(){var n=this.getGcInputManBase();n&&n.setFocus()},r.prototype.selectAll=function(){var n=this.getGcInputManBase();n&&n.selectAll()},r.prototype.setCaretAtLast=function(){var t=this.getGcInputManBase();t&&n.DelayRefresh.setTimeout(function(){t.deselectAll()},10)},r.prototype.getValueToFormat=function(){var n=this.getGcInputManBase();return n?n.getValue():null},r}(i);n.GcInputManBase_InputMan=r;u=function(i){function r(){var n=i!==null&&i.apply(this,arguments)||this;return n._isSetValue=!1,n}return __extends(r,i),r.prototype.getGcComboBox=function(){return this.getInputManControl()},r.prototype.createCellContent=function(){var t=this,r=i.prototype.createCellContent.call(this);return n.DelayRefresh.Push(null,function(){t.getGcComboBox().getDropDownList().refresh()},"refreshDropDownList"+this.ID),r},r.prototype.bindEventOfControl=function(n,r){var u=this.getGcComboBox();switch(n){case t.focusOut:u.addEventListener(GC.InputMan.GcComboBoxEvent.FocusOut,r);break;case t.keydown:u.addEventListener(GC.InputMan.GcComboBoxEvent.KeyDown,r);break;default:i.prototype.bindEventOfControl.call(this,n,r);break}},r.prototype.unbindEventOfControl=function(n,r){var u=this.getGcComboBox();switch(n){case t.focusOut:u.removeEventListener(GC.InputMan.GcComboBoxEvent.FocusOut,r);break;case t.keydown:u.removeEventListener(GC.InputMan.GcComboBoxEvent.KeyDown,r);break;default:i.prototype.unbindEventOfControl.call(this,n,r);break}},r.prototype._getPartsUseBackcolor=function(){return $("#"+this.ID+"_div .gcim-layout>.gcim")},r.prototype.focus=function(){var n=this.getInputElement();n&&n.focus()},r.prototype.selectAll=function(){var n=this.getInputElement();n&&n.select()},r.prototype.setCaretAtLast=function(){var r=this.getGcComboBox(),t,u,i;r&&((t=this.getInputElement(),!t||t.length<=0)||(u=r.getDisplayText(),i=t[0],n.DelayRefresh.setTimeout(function(){i.selectionStart=i.selectionEnd=u.length},10)))},r.prototype.setValueToInputManControl=function(n){var t=this.getGcComboBox(),i;if(t){i=this.getSelectedItemByValue(n);try{this._isSetValue=!0;i===null?t.setDisplayText(this.getDisplayText(n)):t.getSelectedItem()!==i&&(this.allowAutoFilter()&&t.filter(null),t.setSelectedItem(i))}finally{this._isSetValue=!1}}},r.prototype.enterPrintMode=function(){i.prototype.enterPrintMode.call(this);this._isDropDownButtonVisible()&&this.getGcComboBox().setDropDownButtonVisible(!1)},r.prototype.quitPrintMode=function(){i.prototype.quitPrintMode.call(this);this._isDropDownButtonVisible()&&this.getGcComboBox().setDropDownButtonVisible(!0)},r.prototype._isDropDownButtonVisible=function(){return this.CellElement.CellType.ShowDropdownButtonWhenGetFocus!==1},r.prototype.destroy=function(){var n=this.getGcComboBox();for(var t in GC.InputMan.GcComboBoxEvent)n.removeEventListener(GC.InputMan.GcComboBoxEvent[t],null);i.prototype.destroy.call(this)},r.prototype.getDropDownItemRowHeight=function(){var t=this.CellElement.StyleInfo,i=n.MeasureHelper.getHeight(t.FontStyle,t.FontWeight,t.FontSize,t.FontFamily);return Math.ceil(i)+16},r.prototype.setStyleToInputmanControl=function(t){var r,f,u,e;i.prototype.setStyleToInputmanControl.call(this,t);r=this.getDropDownObj();r&&(f=this._getDomCreateInfo(),u=$(r).children(),n.DomUtilities.setPropertyToDom(t,u,f,[0]),u.css("white-space",""),u.css("line-height",this.getDropDownItemRowHeight()-4+"px"),e=$(r).find(".column-header .list-cell"),n.DomUtilities.setPropertyToDom(t,e,f,[0]),e.css("white-space",""))},r}(i);n.GcComboBoxBase_InputMan=u}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var u="auto",o=500,s=function(){function i(n){this._cellType=n}return Object.defineProperty(i.prototype,"cellTypeMetaData",{get:function(){return this._cellType.CellElement.CellType},enumerable:!0,configurable:!0}),i.prototype.getComboBoxConfig=function(){var i=this.getAutoFilterMode(this.cellTypeMetaData),t=this.getColumnsConfig(),r=this._cellType.getDropDownItemRowHeight();return{showDropDownButton:this.cellTypeMetaData.ShowDropdownButtonWhenGetFocus!==1,dropDownWidth:t?"auto":undefined,allowDropDownResize:!0,dropDownOverflow:n.Platform.isIpad()?GC.InputMan.ScrollBars.Both:GC.InputMan.ScrollBars.Vertical,isEditable:!this.cellTypeMetaData.SelectOnly,autoFilter:i,autoSelect:i!==GC.InputMan.AutoFilter.None||!!this.cellTypeMetaData.LoadOnDemand,minPrefixLength:1,matchingSource:GC.InputMan.MatchingSource.All,virtualMode:!0,valueMemberPath:this._cellType.valueColumnName,displayMemberPath:this._cellType.displayTextColumnName,columns:t,load:this.getLoadConfig(this.cellTypeMetaData),generatingItem:this.getGeneratingItemCallback(t),itemHeight:r,colHeaderHeight:r,highlightText:this.cellTypeMetaData.IsSelectAllOnFocus}},Object.defineProperty(i.prototype,"valueColumnName",{get:function(){return"Value"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayValueColumnName",{get:function(){return"DisplayValue"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayTextColumnName",{get:function(){return"DisplayText"},enumerable:!0,configurable:!0}),i.prototype.getGeneratingItemCallback=function(t){return t?undefined:function(t){var r=i.getOldClassName(t),u=n.FormatColorClassManager.getClassName(t.itemObject.color);r!==u&&(n.Common.IsEmpty(r)||t.item.classList.remove(r),n.Common.IsEmpty(u)||t.item.classList.add(u))}},i.getOldClassName=function(t){for(var r="",i=0;i<t.item.classList.length;i++)if(t.item.classList[i].indexOf(n.FormatColorClassManager.classPrefix)===0){r=t.item.classList[i];break}return r},i.prototype.getLoadConfig=function(n){var t=this;return!n.IsBounding||!n.LoadOnDemand?null:function(n){t._cellType.loadOnDemand(n)}},i.prototype.getAutoFilterMode=function(i){if(i.SelectOnly||i.LoadOnDemand)return GC.InputMan.AutoFilter.None;switch(i.AutoFilter){case t.None:return GC.InputMan.AutoFilter.None;case t.MatchStartWith:return n.RS.Culture==="JA"?GC.InputMan.AutoFilter.StartWith:GC.InputMan.AutoFilter.AmbiguousStartWith;case t.MatchAll:return n.RS.Culture==="JA"?GC.InputMan.AutoFilter.Contains:GC.InputMan.AutoFilter.AmbiguousContains;case t.AmbiguousMatchStartWith:return GC.InputMan.AutoFilter.AmbiguousStartWith;case t.AmbiguousMatchAll:return GC.InputMan.AutoFilter.AmbiguousContains;default:return GC.InputMan.AutoFilter.AmbiguousContains}},i.prototype.getColumnsConfig=function(){var r=this,t,i;return this.cellTypeMetaData.DropDownSubItems?(t=this.getDisplayColumnIndexFromSubColumns(this.cellTypeMetaData.DropDownSubItems,this.cellTypeMetaData.DisplayColumnBindingInfo),i=[],t===-1&&i.push({name:this._cellType.displayTextColumnName,label:this.getDisplayHeaderNameFromBindingInfo(this.cellTypeMetaData.DisplayColumnBindingInfo),visible:t===-1,width:u}),this.cellTypeMetaData.DropDownSubItems.forEach(function(f,e){i.push({name:e===t?r._cellType.displayTextColumnName:f.GUID,label:n.Common.IsEmpty(f.ColumnName)?" ":f.ColumnName,width:u,contentAlignment:r.getInputManAlignment(f)})}),i):null},i.prototype.getDisplayColumnIndexFromSubColumns=function(t,i){if(t&&t.length>0)for(var r=0;r<t.length;r++)if(t[r].BindingInfo&&i&&n.Common.isBindingInfoEquals(t[r].BindingInfo,i))return r;return-1},i.prototype.getDisplayHeaderNameFromBindingInfo=function(t){var i="",r;return i=t.RelationBinding!=null?this.getDisplayHeaderNameFromRelationBinding(t.RelationBinding):this.getDisplayHeaderName(t.ColumnName),r=this.getAttachTypeColumnHeader(t),n.Common.IsEmpty(r)||(i+="."+r),i},i.prototype.getAttachTypeColumnHeader=function(n){if(n.AttachType)if(n.AttachType.$type==="ForguncyDataAccess.DateColumnAttachObj, ForguncyDataAccess")return this.getDateColumnAttachTypeStr(n.AttachType.ColumnAttachType);else if(n.AttachType.$type==="ForguncyDataAccess.UserColumnAttachObj, ForguncyDataAccess")return this.getUserColumnAttachTypeStr(n.AttachType);return""},i.prototype.getDateColumnAttachTypeStr=function(t){switch(t){case 1:return n.RS.Year;case 4:return n.RS.Month;case 5:return n.RS.Day;case 3:return n.RS.Quarter;default:return""}},i.prototype.getUserColumnAttachTypeStr=function(t){switch(t.UserColumnAttachType){case 1:return n.RS.FullName;case 2:return n.RS.Email;case 3:return n.RS.Role;case 8:return n.RS.OrganizationSuperior;default:return t.AttachTypeTag}},i.prototype.getDisplayHeaderNameFromRelationBinding=function(n){while(n.NextRelationBinding)n=n.NextRelationBinding;return this.getDisplayHeaderName(n.DisplayColumn)},i.prototype.getDisplayHeaderName=function(t){switch(t){case n.GUIDColumnName.CreateBy:return n.RS.GUID_Creator;case n.GUIDColumnName.LastModifyBy:return n.RS.GUID_LastModifyBy;case n.GUIDColumnName.AssignTo:return n.RS.GUID_AssignTo;case n.GUIDColumnName.Status:return n.RS.GUID_Status;case n.GUIDColumnName.CreateDate:return n.RS.GUID_CreateDate;case n.GUIDColumnName.LastModifyDate:return n.RS.GUID_LastModifyDate;default:return t}},i.prototype.getInputManAlignment=function(n){var t=this.getAlignment(n);switch(t){case 2:return GC.InputMan.Alignment.MiddleCenter;case 1:return GC.InputMan.Alignment.MiddleLeft;case 3:return GC.InputMan.Alignment.MiddleRight}},i.prototype.getAlignment=function(t){return t.Alignment!==0?t.Alignment:t.BindingColumnDataType===n.ColumnDataType.Number||t.BindingColumnDataType===n.ColumnDataType.Date||t.BindingColumnDataType===n.ColumnDataType.Time?3:1},i}(),f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.MapPartsNameToDom=function(n){return{MAIN:n.find(".gcim-layout>.gcim")}},t}(n.InputCellTypeStyleTemplateHelperBase),r,h,e,t,i;n.DropDownInputManCellTypeStyleTemplateHelper=f;r=function(t){function r(i,r,u,f){var e=t.call(this,i,r,u,f)||this,o;return e._isFirstTimeToSetItems=!0,e._autoColumnWidth=!0,e.supportedEvents=[n.Events.SelectionChanged],o=i.CellType,o.haveLoadItems===undefined&&(o.haveLoadItems=!o.IsBounding),e._currentFormatter=i.StyleInfo.Formatter,e}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.getInputManControl=function(){return this._gcComboBox},r.prototype.getDefaultValue=function(){var f=t.prototype.getDefaultValue.call(this),e=f.Value,o=this.CellElement.CellType,i=!1,s,h,u;if(!n.Common.IsEmpty(e)&&r.needValidateItem(o))if(o.IsBounding)s=r.getIndexAndText(o,e,this.CellElement.StyleInfo.Formatter),s.index===-1&&(i=!0);else for(h=this._dataSource?this._dataSource.length:0,i=!0,u=0;u<h;u++)if(n.Common.isEquals(this._dataSource[u][this.valueColumnName],e)){i=!1;break}return i&&(f.Value=null),f},r.prototype.allowAutoFilter=function(){var n=this._config?this._config.autoFilter:this.comboBoxConfigCreater.getAutoFilterMode(this.CellElement.CellType);return n!==GC.InputMan.AutoFilter.None},Object.defineProperty(r.prototype,"valueColumnName",{get:function(){return this.comboBoxConfigCreater.valueColumnName},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"displayValueColumnName",{get:function(){return this.comboBoxConfigCreater.displayValueColumnName},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"displayTextColumnName",{get:function(){return this.comboBoxConfigCreater.displayTextColumnName},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"comboBoxConfigCreater",{get:function(){return new s(this)},enumerable:!0,configurable:!0}),r.prototype.loadOnDemand=function(n){if(n&&(this._loadOnDemandContext=n),this._loadOnDemandContext&&this.requestDataFinished){var t=this._loadOnDemandContext.pageNumber*o,i=this._dataSource?this._dataSource.slice(t,t+o):[];this._loadOnDemandContext.success(i);this._loadOnDemandContext=null}},r.prototype._createInputManCellContent=function(){var t=this,u=this,i=this.CellElement.CellType,o=n.DomUtilities.createJqueryDomElement("select"),e,f,s;return o.attr("id",this._originalInputID),e=n.CellDomCreateHelper.createControlContainer(),e.append(o),this._config=this.comboBoxConfigCreater.getComboBoxConfig(),f=new GC.InputMan.GcComboBox(o[0],this._config),this._gcComboBox=f,s=e.find(".gcim-dropdown"),s.attr("textcolumn_gui",this.displayTextColumnName),s.css("min-width","100%"),f.addEventListener(GC.InputMan.GcComboBoxEvent.SelectedChanged,function(){if(!t.isReadOnly())u.onSelectedIndexChangedCallBack(f)}),this.isInListview||(f.addEventListener(GC.InputMan.GcComboBoxEvent.TextChanged,function(){t.isReadOnly()||t._isSetValue||(u.validateCurrentValue()||u.setValueToInputManControl(null),u._onValueChanged())}),i.SelectOnly||(this.bindInputManEvent(n.InputManEvent.keydown,function(i){t.isReadOnly()||i.Event.which!==13||n.ForguncyData.pageInfo.moveFocusByEnter||u._onValueChanged()}),this.bindInputManEvent(n.InputManEvent.focusOut,function(){t.isReadOnly()||t._gcComboBox.getSelectedIndex()===-1&&n.Common.IsEmpty(t._gcComboBox.getDisplayText())&&t._onValueChanged()}))),i.IsBounding?this.bindInputManEvent(n.InputManEvent.focusIn,function(){t.requestComboItemsIfNecessary(i)}):n.ItemsCellTypeHelper.initItems(this,this.CellElement,i,f,u._getDomCreateInfo()),r.initItemsQuery(this,this.CellElement,i,this.isInListview),i.ShowDropdownButtonWhenGetFocus===2&&e.addClass("gc_inputman_showDropDownWhenFocus"),i.IsBounding&&this.setValueToInputManControl(null),e},r.prototype.hideValidationTooltipWhenInputOrSelect=function(i){var r=this;(t.prototype.hideValidationTooltipWhenInputOrSelect.call(this,i),this._gcComboBox)&&this._gcComboBox.addEventListener(GC.InputMan.GcComboBoxEvent.SelectedChanged,function(){n.ValidationTooltipHelper.destroyTooltip($("#"+r.ID))})},r.prototype._onValueChanged=function(){this._isSetValue||t.prototype._onValueChanged.call(this)},r.prototype.onSelectedIndexChangedCallBack=function(t){t.getSelectedIndex()!==-1&&this._onValueChanged();n.Page&&this.trigger(n.Events.SelectionChanged,{})},r.prototype.requestComboItemsIfNecessary=function(t){var r,i,u;t.IsBounding&&(r=n.ItemsCellTypeHelper.getRequestDataInfo(t,this),i=JSON.stringify(r),this.requestStr&&this.requestStr===i||(t.haveLoadItems=!1,this.requestStr=i));t.haveLoadItems&&this._currentFormatter===this.CellElement.StyleInfo.Formatter||(this.requestDataFinished=!1,t.LoadOnDemand&&(u=this._gcComboBox.getDropDownList(),u.filter([{name:"id",comparator:GC.InputMan.FilterComparator.Equal,filterString:(new Date).valueOf().toString()}])),n.ItemsCellTypeHelper.initItems(this,this.CellElement,t,null,this._getDomCreateInfo()))},r.initItemsQuery=function(t,i,r,u){if(!u){var f=t;r.IsBounding&&n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(i.DependenceCells,function(t){t&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(f.ID,{newValue:null,uiAction:!0},5)},f.runTimePageName)}},r.prototype.getValueToFormat=function(){var u,t,i,f;return this._gcComboBox?(u=this._gcComboBox.getSelectedItem(),u)?u[this.displayValueColumnName]:(t=null,n.ForguncyData&&n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.dataModel&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel&&(t=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID)),i=this.CellElement.CellType,i.IsBounding&&(f=r.getIndexAndText(i,t,this.CellElement.StyleInfo.Formatter),f.index!==-1))?f.beforeFormatValue:r.needValidateItem(i)?null:t:null},r.prototype.getItemSource=function(n){var t=this,u=this.CellElement.CellType,f=this.CellElement.StyleInfo.Formatter,e=r.getFormattedItems(n.Items,f),i=u.DropDownSubItems;return e.map(function(r){var u,f=(u={},u[t.valueColumnName]=r.Value,u[t.displayValueColumnName]=r.DisplayValueBeforeFormat,u[t.displayTextColumnName]=r.DisplayValue,u.color=r.Forecolor,u);return i&&i.forEach(function(i){var u=r.DropDownSubItemsList[i.GUID],e=n.SubItemsColumnTypeDic?n.SubItemsColumnTypeDic[i.GUID]:3,o=t.convertSubItemValue(u,i.Formatter,e);f[i.GUID]=o}),f})},r.prototype.useStaticColumnWidth=function(){var n,t,i;this._autoColumnWidth&&(this._autoColumnWidth=!1,n=this._config.columns,n)&&(this._isFirstTimeToSetItems&&(t=this._gcComboBox.getDropDownList(),n.forEach(function(n){t.updateColumnWidth(n.name,100)})),i=n.map(function(n){return{name:n.name,autofit:!1}}),this._gcComboBox.updateColumnAutoFit(i))},r.prototype.setItems=function(t,i,r,u){var e=this.CellElement.StyleInfo.Formatter,f;this._currentFormatter=e;f=t.CellType;this._dataSource=this.getItemSource(r);this.requestDataFinished=!0;f.LoadOnDemand?this.loadOnDemand(null):(this._dataSource.length>1e3&&this.useStaticColumnWidth(),this._gcComboBox.setItems(this._dataSource),this._isFirstTimeToSetItems=!1);u.isInListview||this.setValueToInputManControl(n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID))},r.prototype.convertSubItemValue=function(t,i,r){var u=null;return i?u=i:r===1?u="yyyy/M/d":r===4&&(u="hh:mm"),n.Common.IsEmpty(u)||(t=n.FormatHelper.format(u,t).text),t},r.getFormattedItems=function(t,i){for(var o,s=[],h=t.length,f=0;f<h;f++){var r=t[f],e=null,u=r.DisplayValue;i&&(o=n.FormatHelper.format(i,r.DisplayValue),e=o.color,u=o.text);typeof u=="string"&&(u=u.replace(/[\r\n]/g,""));s.push({Value:r.Value,DisplayValueBeforeFormat:r.DisplayValue,DisplayValue:u,Forecolor:e?e:null,DropDownSubItemsList:r.DropDownSubItemsList})}return s},r.prototype.getSelectedItemByValue=function(n){var i,t;if(this._dataSource)for(i=this._dataSource.length,t=0;t<i;t++)if(r.isComboBoxItemEqual(n,this._dataSource[t][this.valueColumnName]))return this._dataSource[t];return null},r.prototype.getDisplayText=function(t){var i=this.CellElement.CellType,u;return i.IsBounding&&(u=r.getIndexAndText(i,t,this.CellElement.StyleInfo.Formatter),u.index!==-1)?u.text:r.needValidateItem(i)?"":n.Common.IsEmpty(t)?"":t.toString()},r.getIndexAndText=function(t,i,u){var o=r.getTextsAndValues(t,u),e=-1,s="",h="",c,l,f;if(o)for(c=o.values,l=o.texts,f=0;f<c.length;f++)if(r.isComboBoxItemEqual(i,c[f].Value)){e=f;s=l[e].Value;h=l[e].FormatValue;break}return{index:e,beforeFormatValue:n.Common.IsEmpty(s)?"":s,text:n.Common.IsEmpty(h)?"":h}},r.getIndexAndValue=function(n,t,i){var f=r.getTextsAndValues(n,i),o=-1,s=null,h,e,u;if(f)for(h=f.values,e=f.texts,u=0;u<e.length;u++)if(r.isComboBoxItemEqual(t,e[u].FormatValue)){o=u;s=h[u].Value;break}return{index:o,value:s}},r.getTextsAndValues=function(t,i){var r=t.DataSource,e={ColumnBindingInfo:t.ValueColumnBindingInfo},o={ColumnBindingInfo:t.DisplayColumnBindingInfo,FormatString:i,AddNoneItem:t.AddNullItemWhenBinding,NoneItemText:t.NoneItemText},u=n.TableColumnsCacheManager.getTableData(r,e),f=n.TableColumnsCacheManager.getTableData(r,o);if(u||f)return{values:u,texts:f}},r.isComboBoxItemEqual=function(n,t){return(n===null||n===undefined)&&(n=""),(t===null||t===undefined)&&(t=""),n===""||t===""?n===t:n==t},r.prototype.validateCurrentValue=function(){var t=this.CellElement.CellType,n;return r.needValidateItem(t)?(n=this.getValueByText(),n===null?!1:!0):!0},r.prototype.getValueByText=function(){var i=this.CellElement.CellType,u=this._gcComboBox.getDisplayText(),n,t;if(this._dataSource)for(n=0;n<this._dataSource.length;n++)if(r.isComboBoxItemEqual(this._dataSource[n][this.displayTextColumnName],u))return{value:this._dataSource[n][this.valueColumnName]};return i.IsBounding&&(t=r.getIndexAndValue(i,u,this.CellElement.StyleInfo.Formatter),t.index!==-1)?{value:t.value}:null},r.prototype.getValueFromInputManControl=function(n){var f=this.CellElement.CellType,u=this._gcComboBox.getSelectedItem(),t,i;return u?u[this.valueColumnName]:(t=this.getValueByText(),t)?t.value:(i=this._gcComboBox.getDisplayText(),r.needValidateItem(f)?null:i===""?null:i)},r.prototype.getListviewNoneEditModeText=function(n,i,u){var f=r.getDisplayValue(this.CellElement.CellType,n,i,this.CellElement.StyleInfo.Formatter);return f!==null?t.prototype.getListviewNoneEditModeText.call(this,f,i,u):t.prototype.getListviewNoneEditModeText.call(this,n,i,u)},r.getDisplayValue=function(t,u,f,e){var s,o,h;if(u instanceof i)return u.toString();if(t.IsBounding)return h=r.getIndexAndText(t,u,e),h.index!==-1?h.beforeFormatValue:r.needValidateItem(t)?"":n.Common.IsEmpty(u)?"":u.toString();else if(t.haveLoadItems&&t.ItemsInfo&&t.ItemsInfo.Items)for(s=t.ItemsInfo.Items,o=0;o<s.length;o++)if(n.Common.isEquals(u,s[o].Value))return n.Common.IsEmpty(s[o].DisplayValue)?"":s[o].DisplayValue.toString();return null},r.prototype.getValueFromListviewText=function(t){var u=this.CellElement.CellType,e,f,o;if(u.IsBounding){if(o=r.getIndexAndValue(u,t,this.CellElement.StyleInfo.Formatter),o.index!==-1)return o.value}else if(u.haveLoadItems&&u.ItemsInfo&&u.ItemsInfo.Items)for(e=u.ItemsInfo.Items,f=0;f<e.length;f++)if(n.Common.isEquals(t,e[f].DisplayValue))return e[f].Value;return!n.Common.IsEmpty(t)&&r.needValidateItem(u)?new i(t):t},r.prototype.canInputChars=function(){return t.prototype.canInputChars.call(this)&&!this.CellElement.CellType.SelectOnly},r.prototype.validateValue=function(u,f){var e,o,h,s,c;if(f===void 0&&(f=null),e=this.CellElement.CellType,u instanceof i)return n.RS.ValueNotInList;if(!n.Common.IsEmpty(u)&&r.needValidateItem(e)){if(o=!1,e.IsBounding)c=r.getIndexAndText(e,u,this.CellElement.StyleInfo.Formatter),c.index!==-1&&(o=!0);else for(h=this.getItems(),s=0;s<h.length;s++)if(n.Common.isEquals(u,h[s].Value)){o=!0;break}if(!o)return n.RS.ValueNotInList}return t.prototype.validateValue.call(this,u,f)},r.needValidateItem=function(n){return!n.SelectOnly&&!n.ValidateItem?!1:!0},r.prototype.getItems=function(){var n=this.CellElement.CellType;return n.ItemsInfo&&n.ItemsInfo.Items?n.ItemsInfo.Items:[]},r.prototype.reload=function(t){var i=this.CellElement.CellType,r;i.IsBounding&&(i.haveLoadItems=!1,this._dataSource=null,t&&(r=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID),this.setValueToInputManControl(r)))},r.prototype.getBindingTables=function(){var n=this.CellElement.CellType;return n.IsBounding?[n.DataSource]:null},r.prototype._endWaitingServerData=function(){if(t.prototype._endWaitingServerData.call(this),this.shouldHandleFormat()){var n=this.getControl();n&&this.changeFormatElement()}},r.prototype.shouldReserveRightSpace=function(){var n=this.CellElement.CellType;return n.ShowDropdownButtonWhenGetFocus!==1&&n.ShowDropdownButtonWhenGetFocus!==2},r.prototype.canInput=function(){var n=this.CellElement.CellType;return!this.isReadOnly()&&!n.SelectOnly},r.prototype.setCellTypeAllowSpin=function(){this._gcComboBox&&this._gcComboBox.setAllowSpin(this.getSpinType())},r.StyleTemplateHelper=new f("Forguncy.DropDownListCellType"),r}(n.GcComboBoxBase_InputMan);n.ComboBoxCellType_InputMan=r;h=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"userCellMetaData",{get:function(){return this._cellType.CellElement.CellType},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"valueColumnName",{get:function(){return"Name"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayValueColumnName",{get:function(){var t=this.getDropDownColumns(this.userCellMetaData);return n.Common.IsEmpty(this.userCellMetaData.DisplayColumnName)||t.indexOf(this.userCellMetaData.DisplayColumnName)===-1?t.length===0?this.valueColumnName:t[0]:this.userCellMetaData.DisplayColumnName},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayTextColumnName",{get:function(){return this.displayValueColumnName},enumerable:!0,configurable:!0}),i.prototype.getColumnsConfig=function(){var t=this,n=this.getDropDownColumns(this.userCellMetaData);return n.length<=1?null:n.map(function(n){return{name:n,label:t.getDropDownColumnHeader(n),width:u}})},i.prototype.getDropDownColumnHeader=function(t){switch(t){case"Name":return n.RS.UserName;case"FullName":return n.RS.FullName;case"Email":return n.RS.Email;default:return t}},i.prototype.getDropDownColumns=function(n){var t=[];return n.Columns&1&&t.push("Name"),n.Columns&2&&t.push("FullName"),n.Columns&4&&t.push("Email"),n.CustomColumns&&n.CustomColumns.forEach(function(n){return t.push(n)}),t},i}(s);e=function(t){function r(n,i,r,u){var e=t.call(this,n,i,r,u)||this,f=n.CellType;return f.IsBounding=!1,f.ItemsQuery=undefined,f.haveLoadItems=!1,e}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},Object.defineProperty(r.prototype,"comboBoxConfigCreater",{get:function(){return new h(this)},enumerable:!0,configurable:!0}),r.prototype.getItemSource=function(t){var r=this.CellElement.CellType,i=t.Properties.users;return!i||i.length===0?[]:i.map(function(t){var i,u=(i={},i.Name=t.UserName?t.UserName:"",i.FullName=t.FullName?t.FullName:"",i.Email=t.Email?t.Email:"",i);return r.CustomColumns&&r.CustomColumns.forEach(function(i){var r=n.UserInfoHelper.getUserPropertyValue(t,i);u[i]=r?r:""}),u})},r.prototype.getValueFromInputManControl=function(t){var r=this._gcComboBox.getSelectedItem(),i;return r?r[this.valueColumnName]:(i=this._gcComboBox.getDisplayText(),n.Common.IsEmpty(i)?null:i)},r.prototype.getDisplayText=function(t){return n.Common.IsEmpty(t)?"":t.toString()},r.prototype.getItems=function(){var n=this.CellElement.CellType;return n.UserInfo?n.UserInfo:[]},r.prototype.getValueFromListviewText=function(n){return n},r.prototype.getListviewNoneEditModeText=function(n,i,u){var f=r.getDisplayValue(this.CellElement.CellType,n,i);return f!==null?f:t.prototype.getListviewNoneEditModeText.call(this,n,i,u)},r.getDisplayValue=function(t,r,u){var e,f;if(r instanceof i)return r.toString();if(t.UserInfo!=null&&t.UserInfo.length>0)for(e=t.UserInfo,f=0;f<e.length;f++)if(n.Common.isEquals(r,e[f].Value))return n.Common.IsEmpty(e[f].DisplayValue)?"":e[f].DisplayValue.toString();if(t.ItemsInfo&&t.ItemsInfo.Items)for(e=t.ItemsInfo.Items,f=0;f<e.length;f++)if(n.Common.isEquals(r,e[f].Value))return n.Common.IsEmpty(e[f].DisplayValue)?"":e[f].DisplayValue.toString();return null},r.prototype.reload=function(n){},r.prototype.needReloadItemsWhenOpenDropdown=function(n){return!1},r.prototype.setCellTypeAllowSpin=function(){this._gcComboBox&&this._gcComboBox.setAllowSpin(this.getSpinType())},r.StyleTemplateHelper=new f("Forguncy.UserCellType"),r}(r);n.UserSelectorCellType_InputMan=e,function(n){n[n.None=0]="None";n[n.MatchStartWith=1]="MatchStartWith";n[n.MatchAll=2]="MatchAll";n[n.AmbiguousMatchStartWith=3]="AmbiguousMatchStartWith";n[n.AmbiguousMatchAll=4]="AmbiguousMatchAll"}(t||(t={}));i=function(){function t(n){this.text=n}return t.prototype.toString=function(){return n.Common.IsEmpty(this.text)?"":this.text.toString()},t}();n.WrongParseResult=i;n.CellTypeHelper.registerCellType("Forguncy.DropDownListCellType, Forguncy",r,function(t){return!n.Platform.isMobile()});n.CellTypeHelper.registerCellType("Forguncy.UserCellType, Forguncy",e,function(t){return!n.Platform.isMobile()})}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var t=function(){function t(){}return t.getUniqueSubPageIndex=function(){return t._subPageIndex++},t.destroySubPage=function(t,r){if(!n.Common.IsEmpty(t)){n.ForguncyData.pageInfo.pageElementManager&&n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells().filter(function(n){return n.cellType instanceof i&&n.cellType.runTimePageName===t}).forEach(function(n){n.cellType.destroyAllPages()});var u=[t,r].filter(function(n){return!!n});n.DependenceCellValueChangeHelper.destoryRunTimePage(u);n.ForguncyData.pageInfo.formulaManager.destroyRunTimePage(u);n.ForguncyData.pageInfo.pageElementManager.destoryRunTimePage(u);u.forEach(function(t){return delete n.ForguncyData.pageInfo.pageStretchInfos[t]})}},t._subPageIndex=1,t}(),i,r,u,f,e;n.SubPageHelper=t;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype._getPartsUseFontStyle=function(){return null},t.prototype._getContainerOverflowValueStr=function(n){switch(n){case 0:return"visible";case 1:return"auto";default:return"hidden"}},t}(n.CellTypeBase);n.ContainerCellTypeBase=i;r=function(i){function r(t,r,u,f){var e=i.call(this,t,r,u,f)||this;return e.subPageInfos=[],e._delayTriggerEvent=n.PageBuilder.pageIsLoading,e.supportedEvents=[n.Events.SubPageChanged],e}return __extends(r,i),r.prototype.needValidate=function(){return!1},r.prototype._loadContent=function(t,i){var r=this,u;if(n.Common.IsEmpty(t)){r._emptyContent(i);return}if(r.isCircularReferencePage(t)){u=n.Common.format(n.RS.ContainerCellType_Error_CircularReference,t);alert(u);r._emptyContent(i);n.ErrorHelper.printErrorStr(u);return}n.MetadataLoader.GetMetadataRequest(t,function(u){if(!u){r._emptyContent(i);return}n.ForguncyData.pageInfo.pageID===r._pageID&&r._createSubPage(t,u,i)})},r.prototype._emptyContent=function(t){this.subPageInfos[t]=undefined;this.onPageIsReady(t);this._delayTriggerEvent||(this.trigger(n.Events.PageingInfoChanged,{tabIndex:t}),this.trigger(n.Events.Loaded,{tabIndex:t}),this.trigger(n.Events.PageDefaultDataLoaded,{tabIndex:t}))},r.prototype._createSubPage=function(i,r,u){var e=this,f=n.MetadataHelper.createPageMetadata(r,!1),h,c,a;if(n.PageBuilder.checkError(f)===!1){e._emptyContent(u);return}if(f.pageName!==i&&n.BuiltInPageManager.isBuiltInPage(f.pageName)){h=!1;n.Common.forguncyPostSync("Home/PageNameExisted",{PageName:i},function(n){h=n});h?e._navigateToNewPage(f,i):(e._emptyContent(u),alert(n.Common.format(n.RS.ContainerCellType_Error_NoExistedPage,i)));return}var l=t.getUniqueSubPageIndex(),o=n.StaticValues.RunTimeNormalPage+l,s=n.StaticValues.RunTimeMasterPage+l;e.subPageInfos[u]&&(c=[e.subPageInfos[u].runTimeNormalPageName,e.subPageInfos[u].runTimeMasterPageName].filter(function(n){return!!n}),c.length>0&&n.ForguncyData.pageInfo.formulaManager.preDestroyRunTimePage(c));e.subPageInfos[u]={runTimeNormalPageName:o,runTimeMasterPageName:s,designerPageName:f.PageSettings.Name,designerMasterPageName:f.MasterPage?f.MasterPage.PageSettings.Name:null,pageLoadedCommand:f.PageSettings.PageLoadedCommandList,isLoading:!0};e.trigger(n.Events.PageingInfoChanged,{tabIndex:u});a=new n.ForguncyDataSetter(f,n.ForguncyData.pageInfo,o,s,!0);a.setPageInfoByMetadata();var v=function(){e.onPageContentAppended(f,u)},y=n.PageBuilder.loadUserJavaScript(f,v),p=n.PageContentCreator.create(f,o,s,2),w=e.getSubPageContainerID(u);$("#"+w).append(p);n.PageBuilder.onLoad([o,s]);y&&v()},r.prototype._navigateToNewPage=function(t,i){n.Common.IsEmpty(t.ReturnUrl)||(t.ReturnUrl=n.ForguncyData.pageInfo.pageName,t.noPermissionPage=i);n.PageBuilder.pageCover.show();n.Common.initalTimeStamp();n.PageBuilder.createPage(t,null)},r.prototype.getSubPageContainerID=function(n){return null},r.prototype.containRunTimePage=function(n){return this.subPageInfos.some(function(t){return t&&(t.runTimeMasterPageName===n||t.runTimeNormalPageName===n)})},r.prototype.getDesignerPageName=function(n,t){for(var i,r=0;r<this.subPageInfos.length;r++)if(i=this.subPageInfos[r],i){if(i.runTimeNormalPageName===n)return i.designerPageName;if(i.runTimeMasterPageName===n)return t?i.designerPageName:i.designerMasterPageName}return null},r.prototype.getRunTimePageName=function(n){for(var t,i=0;i<this.subPageInfos.length;i++)if(t=this.subPageInfos[i],t){if(t.designerPageName===n)return t.runTimeNormalPageName;if(t.designerMasterPageName===n)return t.runTimeMasterPageName}return null},r.prototype.getTabIndex=function(n){for(var i,t=0;t<this.subPageInfos.length;t++)if(i=this.subPageInfos[t],i&&(i.runTimeNormalPageName===n||i.runTimeMasterPageName===n))return t;return-1},r.prototype.onPageContentAppended=function(t,i){var r=this.subPageInfos[i];(n.PageBuilder.initDefaultDataAndModels(t,r.runTimeNormalPageName,r.runTimeMasterPageName),this._delayTriggerEvent)||(this.trigger(n.Events.Loaded,{tabIndex:i}),this.initBindingDataAndExecutePageLoadedCommand(i))},r.prototype.initBindingDataAndExecutePageLoadedCommand=function(t){var i=this.subPageInfos[t],r=[i.runTimeNormalPageName,i.runTimeMasterPageName];n.ForguncyData.pageInfo.currentRowInfoCollection.list.forEach(function(t){n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(r).forEach(function(n){return n.onCurrentRowInfoChanged(t.currentTable)});n.ForguncyData.pageInfo.normalCellBindingManager.getBindingValuesFromServer(t.currentTable,t.query)});n.PageBuilder.fillAllListviewData(r);this.executeOneTabLoadedCommand(t)},r.prototype.executePageLoadedCommand=function(){var n=this;n._delayTriggerEvent=!1;n.subPageInfos.forEach(function(t,i){return n.executeOneTabLoadedCommand(i)})},r.prototype.executeOneTabLoadedCommand=function(t){var r=this,i=this.subPageInfos[t],u,f;if(!i){r.trigger(n.Events.PageDefaultDataLoaded,{tabIndex:t});return}u=[i.runTimeNormalPageName,i.runTimeMasterPageName];f=function(){n.DelayOperateHelper.Push(null,function(){n.DelayRefresh.Push(null,function(){n.ForguncyData.pageInfo.defaultFormulaManager.clearDefaultFormula(u)},"clearDefaultFormula"+i.runTimeNormalPageName);r.onPageIsReady(t);$(document).trigger("initPageData");r.trigger(n.Events.PageDefaultDataLoaded,{tabIndex:t});n.ForguncyData.pageInfo.pageElementManager.resizePageElements(u);i.isLoading=!1},1)};n.ForguncyData.commandExcutor&&i.pageLoadedCommand&&i.pageLoadedCommand.length>0?n.ForguncyData.commandExcutor.excuteCommand(i.pageLoadedCommand,i.runTimeNormalPageName,null,i.runTimeNormalPageName,n.Events.PageLoaded,f):f()},r.prototype.onPageIsReady=function(n){},r.prototype.triggerPageLoadedEvent=function(){var t=this;t.subPageInfos.forEach(function(i,r){t.trigger(n.Events.Loaded,{tabIndex:r})})},r.prototype.isLoading=function(){return this.subPageInfos.some(function(n){return n.isLoading})},r.prototype.isCircularReferencePage=function(t){var i=n.PageManager.getLocatedNormalPageNames(this.runTimePageName);return i.indexOf(t)>=0},r.prototype.destroyAllPages=function(){this.subPageInfos.forEach(function(n){n&&t.destroySubPage(n.runTimeNormalPageName,n.runTimeMasterPageName)})},r}(i);n.SubPageContainerCellTypeBase=r;u=function(i){function r(t,r,u,f){var e=i.call(this,t,r,u,f)||this;return e.supportedEvents=[n.Events.Loaded,n.Events.PageDefaultDataLoaded,n.Events.SubPageChanged],e}return __extends(r,i),r.prototype.getDefaultValue=function(){var t=this.CellElement.CellType.PageName;return{Value:n.Common.IsEmpty(t)?null:t}},r.prototype.create=function(t){i.prototype.create.call(this,t);n.DomUtilities.setContainerOverFlow(t,this._getContainerOverflowValueStr(this.CellElement.CellType.OverflowMode))},r.prototype.createContent=function(){var t,i,r;return this._subPageContainerID=this.createNewSubPageContainerID(),t=n.DomUtilities.createJqueryDomElement("div"),t.attr("id",this.ID),this.CellElement.ExtendWidth>0&&t.css("margin-left",0-this.CellElement.ExtendWidth),this.CellElement.ExtendHeight>0&&t.css("margin-top",0-this.CellElement.ExtendHeight),i=this.CellElement.ExtendHeight?this.CellElement.ExtendHeight:0,t.css("height","calc(100% + "+i+"px)"),this.createCover(t),this.createContentContainer(t),r=this.CellElement.CellType.PageName,this.loadSubPage(r),t},r.prototype.createContentContainer=function(t){var i=n.DomUtilities.createJqueryDomElement("div");i.css("height","100%");i.attr("id",this.getSubPageContainerID(0));t.append(i)},r.prototype.createCover=function(t){var i=n.DomUtilities.createJqueryDomElement("div");i.attr("id",this.getCoverID());i.css("position","absolute");i.css("width","100%");i.css("height","100%");i.css("z-index","999");i.css("top","0px");i.css("display","none");t.append(i)},r.prototype._isSamePage=function(t,i){return n.Common.IsEmpty(t)&&n.Common.IsEmpty(i)?!0:t===i},r.prototype.setValueToElement=function(n,t){if(!this._isSamePage(t,this._pageName)){$("#"+this.getCoverID()).css("display","");this._oldSubPageContainerID=this._subPageContainerID;this._oldSubPageInfo=this.subPageInfos[0];this._subPageContainerID=this.createNewSubPageContainerID();var i=$("#"+this.ID);this.createContentContainer(i);$("#"+this.getSubPageContainerID(0)).css("display","none");this.loadSubPage(t)}},r.prototype.loadSubPage=function(n){this._pageName=n;this._loadContent(this._pageName,0)},r.prototype.getCoverID=function(){return this.ID+"_cover"},r.prototype.getSubPageContainerID=function(n){return this._subPageContainerID},r.prototype.createNewSubPageContainerID=function(){return r._index++,this.ID+"_content"+r._index},r.prototype.onPageIsReady=function(){this.getContainer().scrollLeft(0).scrollTop(0);$("#"+this.getSubPageContainerID(0)).css("display","");this.destroyOldPage();this._oldSubPageContainerID=null;this._oldSubPageInfo=null;$("#"+this.getCoverID()).css("display","none")},r.prototype.destroyOldPage=function(){this._oldSubPageInfo&&t.destroySubPage(this._oldSubPageInfo.runTimeNormalPageName,this._oldSubPageInfo.runTimeMasterPageName);this._oldSubPageContainerID&&$("#"+this._oldSubPageContainerID).remove()},r._index=0,r}(r);n.ContentContainerCellType=u;f=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n._defaultActiveTabIndex=0,n._tabs=[],n._tabCount=0,n}return __extends(i,t),i.prototype.createContent=function(){var n=this,r=this.CellElement.CellType,t=r.Tabs,i;return!t||t.length<=0?null:(n._tabCount=t.length,n._defaultActiveTabIndex=r.ActiveTabIndex,n.initStyleInfo(),i=n.createContainer(t.length),this.needAddCSSRule()&&e.addCSSRule(n.ID,n.runTimePageName,i,n._colors),t.forEach(function(t,i){return n._loadContent(t,i)}),i)},i.prototype.getTabCount=function(){return this._tabCount},i.prototype.createContainer=function(t){var i=n.DomUtilities.createJqueryDomElement("div");return i.attr("id",this.ID),i.css("overflow","hidden"),i.css("box-sizing","border-box"),i.css("height","100%"),i.css("display","flex"),i.css("flex-direction","column"),i.css("border-bottom","1px solid "+n.ColorHelper.Convert(this._colors.BorderColor)),i.append(this.createHeaderPart(t)),i.append(this.createContentPart(t)),i},i.prototype.createHeaderPart=function(t){var i=n.DomUtilities.createJqueryDomElement("UL"),r;for(i.css("display","table"),i.css("margin-top",0),i.css("width","100%"),i.addClass("nav"),i.addClass("nav-tabs"),i.css("border-color",n.ColorHelper.Convert(this._colors.BorderColor)),r=0;r<t;r++)i.append(this.createHeaderLI(r));return i},i.prototype.createHeaderLI=function(t){var f=this,r=n.DomUtilities.createJqueryDomElement("li"),u;return r.attr(i._tabIndexStr,t),u=this.createHeaderText(this.getHeaderID(t),this.getSubPageContainerID(t)),function(n){u.click(function(){return f.showTab(n,this),!1})}(t),r.append(u),r},i.prototype.createHeaderText=function(t,i){var r=n.DomUtilities.createJqueryDomElement("a");return r.attr("data-toggle","_tab"),r.attr("href","#"+i),r.attr("id",t),r.css("padding","7px 10px"),n.DomUtilities.setPropertyToDom(this.CellElement,r,this._getDomCreateInfo(),[0]),r.css("color",""),r},i.prototype.createContentPart=function(t){var i=n.DomUtilities.createJqueryDomElement("div"),r;for(i.addClass("tab-content"),i.css("overflow","hidden"),i.css("box-sizing","border-box"),i.css("border-left","1px solid "+n.ColorHelper.Convert(this._colors.BorderColor)),i.css("border-right","1px solid "+n.ColorHelper.Convert(this._colors.BorderColor)),i.css("flex","1"),r=0;r<t;r++)i.append(this.createTabContent(r));return i},i.prototype.createTabContent=function(t){var i=n.DomUtilities.createJqueryDomElement("div");return i.attr("id",this.getSubPageContainerID(t)),i.addClass("tab-pane"),i.addClass("fade"),i.css("height","100%"),n.DomUtilities.setContainerOverFlow(i,this._getContainerOverflowValueStr(this.CellElement.CellType.OverflowMode)),i.css("margin","0px"),t===0&&(i.addClass("in"),i.addClass("active")),i},i.prototype.getSubPageContainerID=function(n){return this.ID+"tab"+n},i.prototype.getHeaderID=function(n){return this.ID+"header"+n},i.prototype.onPageContentAppended=function(n,i){var r=this.getHeaderID(i);$("#"+r).text(n.PageSettings.Title);t.prototype.onPageContentAppended.call(this,n,i)},i.prototype.needAddCSSRule=function(){for(var n in this._colors)if(this._colors[n]!==i._defaultColors[n])return!0;return!1},i.prototype.initStyleInfo=function(){var t=this.CellElement.CellType.Style;this._colors=t?__assign({},t):__assign({},i._defaultColors);this._colors.Color=this.CellElement.StyleInfo?n.ColorHelper.Convert(this.CellElement.StyleInfo.Foreground):i._defaultColors.Color},i.prototype.onLoad=function(){var t=n.PageManager.getPageStretchInfo(this.runTimePageName),i=$("#"+this.ID+"_div"),f=this.CellElement.Left,e=1,h,c,o,l,r,u,s,a;this.CellElement.ExtendWidth>0&&(f-=this.CellElement.ExtendWidth,e+=this.CellElement.ExtendWidth);h=t?n.Stretch.Common.canHorizontallyStretch(t.StretchMode):!1;c=t?n.Stretch.Common.canVerticallyStretch(t.StretchMode):!1;t&&h&&t.MainPartWidth>0?(o=100*f/t.MainPartWidth,l=100*(this.CellElement.Width+e)/t.MainPartWidth,i.css("left",o===0?0:o+"%"),i.css("width",l+"%")):(i.css("left",f),i.css("width",this.CellElement.Width+e));r=this.CellElement.Top;u=1;this.CellElement.ExtendHeight>0&&(r-=this.CellElement.ExtendHeight,u+=this.CellElement.ExtendHeight);t&&c&&t.MainPartHeight>0?(s=100*r/t.MainPartHeight,a=100*(this.CellElement.Height+u)/t.MainPartHeight,i.css("top",s===0?0:s+"%"),i.css("height",a+"%")):(i.css("top",r),i.css("height",this.CellElement.Height+u));this.showTab(this._defaultActiveTabIndex)},i.prototype.showTab=function(t,i){if(!(t<0)&&!(t>=this._tabCount)){if(!this._tabs[t]){if(i||(i=$("#"+this.getHeaderID(t))[0]),!i)return;this._tabs[t]=new n.Tab(i)}this._tabs[t].show();this.onTabVisible(t)}},i.prototype.onTabVisible=function(t){if(this.getActiveTabIndex()===t){var i=this;if($("#"+this.getSubPageContainerID(t)).css("display")==="none"){n.DelayRefresh.setTimeout(function(){i.onTabVisible(t)},50);return}this.resizeUIElement(t);this.reValidate(t)}},i.prototype.resizeUIElement=function(t){var i=n.PageManager.getAllRunTimePageNames(this.subPageInfos[t]);n.ForguncyData.pageInfo.pageElementManager.resizePageElements(i)},i.prototype.reValidate=function(t){var i,r;$("#"+this.getSubPageContainerID(t)).find(".tooltip-arrow").length<=0||(i=n.PageManager.getAllRunTimePageNames(this.subPageInfos[t]),n.ValidationMananger.validateAllCells(!1,i),r=n.ListviewBase.getAllListviews(i),r.forEach(function(n){n.commitCurrentEdit()}))},i.prototype.getActiveTabIndex=function(){var n=Number($("#"+this.ID).children("ul").find(".active").attr(i._tabIndexStr));return isNaN(n)?-1:n},i._defaultColors={BorderColor:"#A9A9A9",Color:"#337AB7",HoverColor:"#23527C",ActiveColor:"#555555"},i._tabIndexStr="tabid",i}(r);n.TabControlCellType=f;e=function(){function t(n,t){this._className=n;this._colors=t}return t.addCSSRule=function(n,i,r,u){var f=t.getClassName(i,n),e;r.addClass(f);t._classNameCache.indexOf(f)===-1&&(t._classNameCache.push(f),e=new t(f,u),e.addStyle())},t.getClassName=function(i,r){var f=n.Common.parseIDStr(r),e=n.PageManager.getDesignerPageName(i,!1),u=t._pageNameCache.indexOf(e);return u===-1&&(u=t._pageNameCache.length,t._pageNameCache.push(e)),"tabControlStyle"+u+"_"+f.row+"_"+f.col},t.prototype.addStyle=function(){var t=[this.getNormalStatusCssStr(),this.getHoverStatusCssStr(),this.getActiveStatusCssStr()];n.CSSHelper.addCSSRules(t)},t.prototype.getNormalStatusCssStr=function(){return"."+this._className+" > .nav-tabs > li > a { color: "+n.ColorHelper.Convert(this._colors.Color)+"; }"},t.prototype.getHoverStatusCssStr=function(){return"."+this._className+" > .nav-tabs > li > a:hover,."+this._className+" > .nav-tabs > li > a:focus { color: "+n.ColorHelper.Convert(this._colors.HoverColor)+"; border-bottom-color: "+n.ColorHelper.Convert(this._colors.BorderColor)+";}"},t.prototype.getActiveStatusCssStr=function(){return"."+this._className+" > .nav-tabs > li.active > a,."+this._className+" > .nav-tabs > li.active > a:hover,."+this._className+" > .nav-tabs > li.active > a:focus { color: "+n.ColorHelper.Convert(this._colors.ActiveColor)+"; border: 1px solid "+n.ColorHelper.Convert(this._colors.BorderColor)+"; border-bottom-color: transparent;}"},t._pageNameCache=[],t._classNameCache=[],t}();n.CellTypeHelper.registerCellType("Forguncy.ContentContainerCellType, Forguncy",u);n.CellTypeHelper.registerCellType("Forguncy.TabControlCellType, Forguncy",f)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var u=function(u){function e(t,i,r,f){var e=u.call(this,t,i,r,f)||this;return e._runTimePageNames=[],e._suspendLoadOnDemand=!0,e._isRefresh=!1,e._needUpdateWaitingBlockWhenScroll=!1,e.supportedEvents=[n.Events.SubPageChanged],e._needUpdateWaitingBlockWhenScroll=n.PageManager.getPageStretchInfo(e.runTimePageName).StretchMode===4,e}return __extends(e,u),e.prototype.create=function(t){u.prototype.create.call(this,t);n.DomUtilities.setContainerOverFlow(t,this._getContainerOverflowValueStr(this.CellElement.CellType.OverflowMode))},e.prototype.needLoadOnDemand=function(){if(this._suspendLoadOnDemand)return!1;var n=this.CellElement.CellType,u=n.DisplayMode===t.Vertical||n.DisplayMode===t.Flow&&n.FlowDirection===i.Row,r=0;return r=u?this._scrollElement.scrollTop()+this._scrollElement.height()-this.getItemsTotalLength():this._scrollElement.scrollLeft()+this._scrollElement.width()-this._scrollElement[0].scrollWidth,r>-5?!0:!1},e.prototype.getItemsTotalLength=function(){var n=this._container.find(".repeater-item"),r=n.length,u;if(r<=0)return 0;u=this.CellElement.CellType;switch(u.DisplayMode){case t.Vertical:return $(n[0]).outerHeight(!0)*r;case t.Horizontal:return $(n[0]).outerWidth(!0)*r;case t.Flow:if(u.FlowDirection===i.Column){var o=this.getContainer().height(),s=$(n[0]).outerHeight(!0),f=Math.max(1,Math.floor(o/s)),e=Math.round(r/f);return $(n[0]).outerWidth(!0)*e}else{var h=this.getContainer().width(),c=$(n[0]).outerWidth(!0),e=Math.max(1,Math.floor(h/c)),f=Math.round(r/e);return $(n[0]).outerHeight(!0)*f}default:return 0}},e.prototype.createContent=function(){var t=this,i=this.CellElement.CellType,r=i.TemplatePageName;return t._listviewName=i.ListviewName,n.Common.IsEmpty(r)||n.Common.IsEmpty(t._listviewName)||n.MetadataLoader.GetPageDataRequest(r,n.ForguncyData.ForguncyRoot,n.StaticData.MetaDataVersion).done(function(i){if(i){var r=n.MetadataHelper.createPageMetadata(i,!1);n.PageBuilder.checkError(r)!==!1&&n.ForguncyData.pageInfo.pageID===t._pageID&&(t.updatePageStretchMode(r),t._templatePage=r,t._refresh(!1))}}),t._container=this.createContainer(i),t._container},e.prototype.updatePageStretchMode=function(t){var r=n.PageManager.getPageStretchInfo(this.runTimePageName),i=t.PageSettings.PageResponsiveMode;r.StretchMode===0?i=1:i===0&&(i=n.Stretch.Helper.getPageResponsiveMode(r.StretchMode));t.PageSettings.PageResponsiveMode=i},e.prototype.createContainer=function(r){var u=n.DomUtilities.createJqueryDomElement("div");u.attr("id",this.ID);u.css("display","flex");u.addClass("repeater-container");switch(r.DisplayMode){case t.Vertical:u.css("flex-wrap","nowrap");u.css("flex-direction","column");this.CellElement.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Center?u.css("align-items","center"):this.CellElement.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Right&&u.css("align-items","flex-end");break;case t.Horizontal:u.css("flex-wrap","nowrap");break;case t.Flow:u.css("flex-wrap","wrap");u.css("align-content","flex-start");r.FlowDirection===i.Column?u.css("flex-direction","column"):u.css("flex-direction","row");break;default:break}return u.css("height","100%"),u.css("width","100%"),this._containerDisplayMode=u.css("display"),u},e.prototype.onLoad=function(){var t=this;if(!n.Common.IsEmpty(this.CellElement.CellType.TemplatePageName)&&!n.Common.IsEmpty(this._listviewName)){this._onValueChangedEventHandler=function(n,i){if(i.calcName)t.onListveiwValueChanged(i);else t.onNormalCellValueChanged(i.arg)};n.ForguncyData.pageInfo.dataModel.bind(n.Events.ValueChanged,this._onValueChangedEventHandler);this._currentRowHelper=new f(this.ID,this._container,this._pageID);this._currentRowHelper.bind(n.Events.RepeaterCurrentRowChanged,null,function(n,i){var r=t.getListview();r&&(i.oldCurrentRowIndex!==-1&&t.commitListviewRow(i.oldCurrentRowIndex),i.newCurrentRowIndex!==-1&&r.selectRow(i.newCurrentRowIndex))});this.onDependenceCellValueChanged(function(){t.updateNoItemText()});this._scrollElement=this.getContainer();this._itemsPart=this._container;this.createSimpleBar();this._scrollElement[0].addEventListener("scroll",function(){var n;t._needUpdateWaitingBlockWhenScroll&&(t._needUpdateWaitingBlockWhenScroll=!1,t.showOrHideWaitingBlock());t.needLoadOnDemand()&&(t._suspendLoadOnDemand=!0,(n=t.getListview())===null||n===void 0?void 0:n.loadOnDemand())})}},e.prototype.commitListviewRow=function(t){var i=this.getListview(),r=n.ValidationMananger.validateAllCells(!1,[this._runTimePageNames[t]]);r===0&&i.commitEditChange(!0)},e.prototype.onListveiwValueChanged=function(n){var t,i=n.arg.actionType===0;n.calcName===((t=this.getListview())===null||t===void 0?void 0:t.getCalcSheetName())&&this._refresh(i)},e.prototype.onNormalCellValueChanged=function(t){var i,r,u,f,e,o;this._isRefresh||(i=n.Common.parseIDStr(t.id),i)&&((r=this._runTimePageNames.indexOf(i.suffix),r<0)||(u=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(t.id),n.Common.IsEmpty(u.templateCellSource))||(f=this.getListview(),f)&&(e=f.getColIndexOfNamedColumn(u.templateCellSource,!1),e!==-1)&&(o=this._getListData(),o.setValue(r,e,t.newValue,5)))},e.prototype._refresh=function(t){var i=this;n.DelayRefresh.Push(null,function(){var r,u;if(i._templatePage&&(r=i._getListData(),r)){i._isRefresh=!0;try{i._suspendLoadOnDemand=!1;i.refreshElements(r.getRowCount());i.showHelpImagePart();i.refreshDataModel()}finally{i._isRefresh=!1;i.updateSimpleBar()}t&&(u=i.getScrollContentContainer(),u.scrollTop(0),u.scrollLeft(0));i.trigger(n.Events.SubPageChanged,null)}},this.ID+"_refreshRepeater")},e.prototype.refreshElements=function(n){var t=this._runTimePageNames.length;t!==n&&(this.addRows(n-t),this.deleteRows(n,t),this._runTimePageNames.length=n)},e.prototype.showHelpImagePart=function(){this.updateNoItemImage();this.showOrHideWaitingBlock()},e.prototype.updateNoItemImage=function(){this.needShowNoItemImage()?this.showNoItemImage():this.hideNoItemImage()},e.prototype.needShowNoItemImage=function(){var n=this.CellElement.CellType;return this._runTimePageNames.length<=0&&n.NoItemSetting&&(!!n.NoItemSetting.ImageForNoItem||!!n.NoItemSetting.TextForNoItem)},e.prototype.showNoItemImage=function(){var u=this.CellElement.CellType.NoItemSetting,t,e,f,i;this._noItemPart||(t=n.DomUtilities.createJqueryDomElement("label"),e=this.CellElement.Value,this.CellElement.Value=this.evaluateFormula(u.TextForNoItem),f=n.CellDomCreateHelper.createTextElement(this.CellElement,t,this._getDomCreateInfo()),this.CellElement.Value=e,t.attr("id",this.noItemTextID),t.attr("name",this.noItemTextID),t.css("-webkit-user-select","initial"),i=n.ImageDataHelper.CreateImage(u.ImageForNoItem,u.NoItemImageSize),i&&(i.insertBefore(t),i.css("display","inline-block"),t.css("display","inline-block"),u.Orientation===r.Vertical?($("<br/>").insertBefore(t),i.css("margin-bottom",5),i.css("margin-left",t.css("padding-left"))):(i.css("margin-right",5),t.css("vertical-align","middle"))),f.attr("id",this.ID+"_NoItem"),f.css("padding",20),this._noItemPart=f);this.getContainer().append(this._noItemPart);this._noItemPart.css("display","table");this._itemsPart.css("display","none")},e.prototype.hideNoItemImage=function(){this._noItemPart&&(this._noItemPart.css("display","none"),this._itemsPart.css("display",this._containerDisplayMode))},Object.defineProperty(e.prototype,"noItemTextID",{get:function(){return this.ID+"_noItemText"},enumerable:!0,configurable:!0}),e.prototype.updateNoItemText=function(){if(this._noItemPart){var n=this.CellElement.CellType.NoItemSetting;this._noItemPart.find("#"+this.noItemTextID).text(this.evaluateFormula(n.TextForNoItem))}},e.prototype.getScrollContentContainer=function(){return this._scrollContent||this.getContainer()},e.prototype.createSimpleBar=function(){var t=this.CellElement.CellType;t.OverflowMode===1&&(this._simpleBar||(this._simpleBar=n.DomUtilities.appleSimpleBar(this.getContainer()),this._simpleBar&&(this._scrollElement=$(this._simpleBar.getScrollElement()),this._scrollContent=$(this._simpleBar.getContentElement()),this._itemsPart=this.getContainer().find(".simplebar-wrapper"))))},e.prototype.updateSimpleBar=function(){this._simpleBar&&this._simpleBar.recalculate()},e.prototype.showOrHideWaitingBlock=function(){this._templatePage&&(this.needShowWaitingBlock()?this.showWaitingBlock():this.hideWaitingBlock())},e.prototype.needShowWaitingBlock=function(){var n,i=this.CellElement.CellType;if(i.OverflowMode!==1)return!1;switch(i.DisplayMode){case t.Flow:return!1;case t.Vertical:if(this.getContainer().height()>=this.getItemsTotalLength())return!1;break;case t.Horizontal:if(this.getContainer().width()>=this.getItemsTotalLength())return!1;break;default:return!1}return((n=this.getListview())===null||n===void 0?void 0:n.allowLoadOnDemand())?!0:!1},e.prototype.showWaitingBlock=function(){var r=this.CellElement.CellType,i;this._waitingBlock||(i=n.DomUtilities.createJqueryDomElement("div"),i.css("background-image",'url("'+n.ForguncyData.ForguncyRoot+'Resources/Images/SiteBuiltInImages/loading.gif")'),i.attr("id",this.ID+"wait"),i.css("background-repeat","no-repeat"),i.css("background-position-x","50%"),i.css("background-position-y","50%"),i.css("flex-shrink","0"),r.DisplayMode===t.Vertical?(i.css("width","100%"),i.css("height","30px")):i.css("width","30px"),this._waitingBlock=i);this._container.append(this._waitingBlock);this._waitingBlock.css("display","block")},e.prototype.hideWaitingBlock=function(){this._waitingBlock&&this._waitingBlock.css("display","none")},e.prototype.addRows=function(n){for(var t=0;t<n;t++)this.addOneRow()},e.prototype.addOneRow=function(){var u=n.SubPageHelper.getUniqueSubPageIndex(),t=n.StaticValues.RunTimeNormalPage+u,f=n.StaticValues.RunTimeMasterPage+u,r=n.Common.clone(this._templatePage),e=new n.ForguncyDataSetter(r,n.ForguncyData.pageInfo,t,f,!0),i;e.setPageInfoByMetadata();i=n.PageContentCreator.create(r,t,f,1);i.css("flex-shrink",0);i.addClass("repeater-item");i.css("background-color","");this.adjustSubPageDivForStretch(i,r.PageSettings.Width,r.PageSettings.Height,t);this._container.append(i);this._runTimePageNames.push(t);n.PageBuilder.onLoad([t]);n.ForguncyData.pageInfo.pageElementManager.initCellDefaultValue([t]);n.ForguncyData.pageInfo.pageElementManager.onDefaultDataSetted([t])},e.prototype.adjustSubPageDivForStretch=function(t,i,r,u){var e=n.PageManager.getPageStretchInfo(u),s=n.Stretch.Common.canHorizontallyStretch(e.StretchMode),h=n.Stretch.Common.canVerticallyStretch(e.StretchMode),f=this.CellElement.Width,o=this.CellElement.Height;s&&f>0&&(t.css("width",i*100/f+"%"),t.css("min-width",i));h&&(e.StretchMode===4?f>0&&(t.css("height","0"),t.css("padding-bottom",r*100/f+"%")):o>0&&(t.css("height",r*100/o+"%"),t.css("min-height",r)))},e.prototype.deleteRows=function(n,t){for(var r=this._container.children(".repeater-item"),i=n;i<t;i++)this.deleteOneRow(i,r)},e.prototype.deleteOneRow=function(t,i){var r=this._runTimePageNames[t];n.Common.IsEmpty(r)||(n.SubPageHelper.destroySubPage(r),$(i[t]).remove())},e.prototype.getListview=function(){return n.ListviewBase.getListview(this._listviewName,this.runTimePageName)},e.prototype._getListData=function(){return n.ForguncyData.pageInfo.dataModel.getListDataByListviewName(this._listviewName,this.runTimePageName)},e.prototype.refreshDataModel=function(){var i=n.ForguncyData.pageInfo.dataModel.normalCellDataModel,r,u,t;if(n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(this._runTimePageNames).forEach(function(t){n.Common.IsEmpty(t.templateCellSource)&&i.getValueType(t.id)!==1&&i.clearValue(t.id)}),r=this._getListData(),u=this.getTemplateCellRelations(),u){var f=r.getColumnCount(),e=function(t){var f=u[t];if(!f)return"continue";o._runTimePageNames.forEach(function(u,e){var o=r.getValue(e,t);f.forEach(function(t){return i.setValue(n.Common.getIdStr(t.Row,t.Column,u),{newValue:o,uiAction:!1},5)})})},o=this;for(t=0;t<f;t++)e(t)}},e.prototype.getTemplateCellRelations=function(){var i,r,t;return this._templateCellRelations?this._templateCellRelations:this._runTimePageNames.length===0?null:(i=this.getListview(),!i)?null:(r=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells([this._runTimePageNames[0]]),t=[],r.forEach(function(r){if(!n.Common.IsEmpty(r.templateCellSource)){var u=i.getColIndexOfNamedColumn(r.templateCellSource,!1);u!==-1&&(t[u]||(t[u]=[]),t[u].push({Row:r.row,Column:r.column}))}}),this._templateCellRelations=t,this._templateCellRelations)},e.prototype.destroy=function(){this._onValueChangedEventHandler&&(n.ForguncyData.pageInfo.dataModel.unbind(n.Events.ValueChanged,this._onValueChangedEventHandler),this._onValueChangedEventHandler=null);this._currentRowHelper&&(this._currentRowHelper.destroy(),this._currentRowHelper=null);this.getContainer().empty();this._container=null;this._itemsPart=null;this._waitingBlock=null;this._noItemPart=null;this._simpleBar=null},e.prototype.containRunTimePage=function(n){return this._runTimePageNames.indexOf(n)>=0},e.prototype.getDesignerPageName=function(n,t){return this.containRunTimePage(n)&&this._templatePage?this._templatePage.PageSettings.Name:null},e.prototype.getRunTimePageName=function(n){return this._templatePage&&this._templatePage.pageName===n&&this._runTimePageNames.length>0?this._runTimePageNames[0]:null},e.prototype.getTabIndex=function(n){return this._runTimePageNames.indexOf(n)},e.prototype.getAllRunTimePageNames=function(){return this._runTimePageNames},e.prototype.isLoading=function(){return!1},e.prototype.getTempalteRowCount=function(){return this._templatePage?this._templatePage.PageSettings.RowCount:0},e.prototype.getTempalteColumnCount=function(){return this._templatePage?this._templatePage.PageSettings.ColumnCount:0},e.prototype.getAdditionalRowInfo=function(n){var i=this.getTabIndex(n),t;return i===-1?null:(t=this.getListview(),t===null)?null:t.isGroupMode()?null:t.getRowInfo(i)},e.prototype.updateCurrentRowIndex=function(n){this._currentRowHelper&&this._currentRowHelper.updateCurrentRowIndex(n)},e.prototype.onWindowResized=function(){u.prototype.onWindowResized.call(this);this.showOrHideWaitingBlock();this.updateSimpleBar()},e.prototype.destroyAllPages=function(){this._runTimePageNames.forEach(function(t){n.SubPageHelper.destroySubPage(t)})},e}(n.ContainerCellTypeBase),r,t,i,f;n.RepeaterCellType=u,function(n){n[n.Horizontal=0]="Horizontal";n[n.Vertical=1]="Vertical"}(r||(r={})),function(n){n[n.Vertical=0]="Vertical";n[n.Horizontal=1]="Horizontal";n[n.Flow=2]="Flow"}(t||(t={})),function(n){n[n.Row=0]="Row";n[n.Column=1]="Column"}(i||(i={}));f=function(t){function i(n,i,r){var u=t.call(this)||this;u._id=n;u._container=i;u._pageID=r;u._currentRowIndex=-1;u._focusInEventName="focusin "+u._pageID+"repeater"+u._id;u._clickEventName="click "+u._pageID+"repeater"+u._id;u._focusInEventHandler=function(n){u.onCurrentElementChanged(document.activeElement)};u._clickEventHandler=function(n){u.onCurrentElementChanged(n.target)};$(document).on(u._focusInEventName,u._focusInEventHandler);$(document).on(u._clickEventName,u._clickEventHandler);return u}return __extends(i,t),i.prototype.onCurrentElementChanged=function(t){var r=$(t),u=-1,i;this._pageID===n.ForguncyData.pageInfo.pageID&&$("#page_"+this._pageID).has(t).length!==0&&this._container[0]!==t&&t.id!==this._id+"wait"&&(this._container.has(t).length>0?(i=void 0,i=r.hasClass("repeater-item")?r:r.parents("div.repeater-item"),u=i.length<=0?-1:this._container.children().index(i[0])):u=-1,this.updateCurrentRowIndex(u))},i.prototype.updateCurrentRowIndex=function(t){if(this._currentRowIndex!==t){var i=this._currentRowIndex;this._currentRowIndex=t;this.trigger(n.Events.RepeaterCurrentRowChanged,{newCurrentRowIndex:t,oldCurrentRowIndex:i})}},i.prototype.destroy=function(){$(document).off(this._focusInEventName,this._focusInEventHandler);$(document).off(this._clickEventName,this._clickEventHandler);this._container=null},i}(n.EventClassBase);n.CellTypeHelper.registerCellType("Forguncy.RepeaterCellType, Forguncy",u)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(n,i,r,u){var f=t.call(this,n,i,r,u)||this;return f._indicatorCount=0,f.allowSetValueByUser=!1,f}return __extends(i,t),i.prototype._getCellTypeData=function(t){return new n.AttachmentCelltypeData(t)},i.prototype._showLoadingIndicator=function(){this._indicatorCount++;this._indicatorContainer.css("display","")},i.prototype._hideLoadingIndicator=function(){this._indicatorCount--;this._indicatorCount<=0&&this._indicatorContainer.css("display","none")},i.prototype.createContent=function(){var o=this,s=this.CellElement,f=n.DomUtilities.createJqueryDomElement("div"),e,r,t,u;f.css("width","100%");f.css("height","100%");e=s.CellType;r=n.DomUtilities.createJqueryDomElement("div");r.css("width","100%");r.css("height","100%");r.css("display","flex");r.css("flex-direction","column");r.css("align-items","flex-start");f.append(r);t=n.DomUtilities.createJqueryDomElement("div");t.css("width","100%");t.css("flex-grow","1");n.DomUtilities.setContainerOverFlow(t,"auto");t.attr("index",0);t.attr("forguncyAttachment","true");e.TabIndex&&n.ForguncyData.pageInfo.enableTabIndex&&t.data("tabindex",e.TabIndex);n.DomUtilities.setPropertyToDom(s,t,o._getDomCreateInfo(),[2,0]);r.append(t);u=n.DomUtilities.createJqueryDomElement("input");u.attr("type","button");u.attr("id",o.ID+"Add");u.val(n.RS.addStr);r.append(u);u.on("click",{cellType:this,div:t},i._onAttachmentCellAddButtonClick);return n.Platform.isMobile()&&u.addClass("mobileButtonStyle"),u.css("flex-grow","0"),u.css("margin-bottom","5px"),this._registerDragUpload(t,this),this._indicatorContainer=n.DomUtilities.createLoadingIndicator(),f.append(this._indicatorContainer),this.isEnabled||this._disable(f),this.isReadOnly()&&this.updateReadOnlyStatus(),f},i.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID+",#"+this.ID+"_a_div a")},i._onAttachmentCellAddButtonClick=function(t){var i=t.data.cellType,r,u;i.isReadOnly()||i._checkMaxUploadCount()&&(r=i.CellElement.CellType.UploadLimit,u=r?r.ExtensionFilter:null,n.Common.updateFile(u,!0,function(n){var i=t.data.cellType;i._hideLoadingIndicator();i._addAttachmentToCell(t.data.div,n)},function(t,r){if(i._hideLoadingIndicator(),t){var u=r&&r.status==401?n.RS.UnauthorizedUpload:t;alert(u)}},r,i.CellElement.ServerPropertiesId.UploadLimit,function(){i._showLoadingIndicator()}))},i.prototype._setAttachmentCellValue=function(n,t){var u,o,f,i,s=(i=(f=(u=t)===null||u===void 0?void 0:(o=u).toString)===null||f===void 0?void 0:f.call(o),i!==null&&i!==void 0?i:""),e,r;for(n.empty(),n.attr("attachmentValue",""),e=s.split("|"),r=0;r<e.length;r++)this._addAttachmentToCell(n,e[r])},i.prototype._checkMaxUploadCount=function(){var t,i,r=this.CellElement.CellType;return((i=(t=r)===null||t===void 0?void 0:t.UploadLimit)===null||i===void 0?void 0:i.MaxUploadFileCount)&&this._getFileCount()>=r.UploadLimit.MaxUploadFileCount?(alert(n.RS.uploadFileBiggerThanMaxFileCount),!1):!0},i.prototype._getFileCount=function(){var n=this.getValue(!0),r,u,t,i;if(n){for(n=n+"",r=n.split("|"),u=0,t=0;t<r.length;t++)i=r[t],i&&i.length>37&&i.charAt(36)==="_"&&u++;return u}return 0},i.prototype._addAttachmentToCell=function(t,i){var e=t.data("tabindex"),o=t.attr("attachmentValue"),s=t.attr("id"),h=t.attr("index"),u,r;if(o||(o=""),i&&i.length>37&&i.charAt(36)==="_"){if(!this._checkMaxUploadCount())return;var c=i,l=i.substring(37),f=n.DomUtilities.createJqueryDomElement("div");f.attr("id",s+"_a_div");u=n.DomUtilities.createJqueryDomElement("a");u.text(l);u.attr("id",s+h+"Download");u.css("margin-right",10);u.attr("href",n.ForguncyData.ForguncyRoot+"FileDownloadUpload/Download?file="+encodeURIComponent(c));u.css("color",t.css("color"));u.css("text-decoration",t.css("text-decoration"));e!==undefined&&u.attr("tabindex",e);f.append(u);r=n.DomUtilities.createJqueryDomElement("a");r.attr("href","#");r.text(n.RS.deleteStr);r.attr("id",s+h+"Delete");r.attr("isDelete",1);r.css("color",t.css("color"));r.css("text-decoration",t.css("text-decoration"));r.attr("fileName",c);e!==undefined&&r.attr("tabindex",e);f.append(r);this._attachDeleteEventHandler(r,f,t,c);n.Platform.isMobile()&&f.addClass("mobileButtonStyle");t.append(f);t.attr("attachmentValue",o+i+"|");t.attr("index",Number(h)+1);this.isEnabled||this._disable(t.parent());this.isVisible()||this._setVisible(this.getContainer(),!1);this.isReadOnly()&&this.updateReadOnlyStatus();this._onValueChanged();this.validate()}else i.indexOf("<")>=0&&(t.append($("<div>"+n.RS.AttachmentCell_NotSupportedFile+"<\/div>")),t.attr("attachmentValue",o+i+"|"))},i.prototype._attachDeleteEventHandler=function(n,t,i,r){var u=this;n.on("click",{cellType:this,itemContainer:t,div:i,url:r},function(n){var t,i;return u.isReadOnly()?!1:(t=n.data,t.div.focus(),t.itemContainer.remove(),i=t.div.attr("attachmentValue"),t.div.attr("attachmentValue",i.replace(t.url+"|","")),t.cellType._onValueChanged(),t.cellType.validate(),!1)})},i.prototype.setValueToElement=function(n,t){this._setAttachmentCellValue(n,t)},i.prototype.getValueFromElement=function(n){var t=$("#"+this.ID);return t.length>0?t.attr("attachmentValue")?t.attr("attachmentValue"):null:null},i.prototype._disable=function(t){var u=t.find("#"+this.ID+"Add"),i,r;u.attr("disabled","disabled");i=t.find("a");i.attr("disabled","disabled");i.off("click");i.on("click",function(){return!1});r=$("#"+this.ID);n.DragFileToUploadHelper.unRegister(r);i.css("cursor","default")},i.prototype._enable=function(){var f=$("#"+this.ID+"Add"),n,r,u,t,i;for(f.removeAttr("disabled"),n=$("#"+this.ID+"_div").find("a"),n.removeAttr("disabled"),n.off("click"),n.css("cursor","pointer"),r=$("#"+this.ID+"_div").find("a[fileName]"),u=$("#"+this.ID),t=r.length-1;t>=0;t--)i=$(r[t]),this._attachDeleteEventHandler(i,i.parent(),u,i.attr("fileName"));this._registerDragUpload(u,this)},i.prototype._registerDragUpload=function(t,i){var r=this;n.DragFileToUploadHelper.register(t,function(u){return i._checkMaxUploadCount()?i.isReadOnly()?!1:(r._showLoadingIndicator(),n.Common.uploadFileByHTML5(u,function(n){i._addAttachmentToCell(t,n);r._hideLoadingIndicator()},function(n){r._hideLoadingIndicator();n&&alert(n)},i.CellElement.CellType.UploadLimit,i.CellElement.ServerPropertiesId.UploadLimit),!0):!1})},i.prototype._getVisibleParts=function(n){return n.find("a,input")},i.prototype.updateReadOnlyStatus=function(){var n=this.getContainer().find("a[isDelete],input");this.isReadOnly()?n.css("display","none"):n.css("display","")},i}(n.CellTypeBase);n.AttachmentCellType=t;n.CellTypeHelper.registerCellType("Forguncy.AttachmentCelltype, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i=function(t){function i(){var n=t.call(this)||this;return n.CellTypeString="Forguncy.ButtonCellType",n.TemplateNameParts=["BUTTON"],n}return __extends(i,t),i.prototype.MapPartsNameToDom=function(n){return{BUTTON:n.find("button")}},i.prototype.OnTemplateStyleApplied=function(n,t){if(t){var i=t.find("button");this.adjustButtonBorder(n);i.css("outline","none");t.css("overflow","visible");i.css("overflow","hidden")}},i.prototype.adjustButtonBorder=function(t){var i,r,o;if(t&&t.Styles&&t.Styles.BUTTON&&t.Styles.BUTTON.NormalStyle&&(i=t.Styles.BUTTON.NormalStyle,!i.BorderString)){r=[];i.BorderTopString||r.push("border-top:none");i.BorderRightString||r.push("border-right:none");i.BorderBottomString||r.push("border-bottom:none");i.BorderLeftString||r.push("border-left:none");var f=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(this.CellTypeString,t.Key,this.TemplateNameParts[0]),u=document.getElementById(f),e="style-updated";u&&!u.getAttribute(e)&&(o="."+f+" { "+r.join(";")+"; }",u.innerText=o+u.innerText,u.setAttribute(e,"true"))}},i}(n.CellTypeStyleTemplateHelperBase),t;n.ButtonCellTypeStyleTemplateHelper=i;t=function(t){function r(i,r,u,f){var e=t.call(this,i,r,u,f)||this;return e.supportedEvents=[n.Events.Click,n.Events.MouseEnter,n.Events.MouseLeave],e}return __extends(r,t),r.prototype.needValidate=function(){return!1},r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.createContent=function(){var r=this,i=this.CellElement,f=this.isInListview,t=n.DomUtilities.createJqueryDomElement("button"),u;return t.addClass("fgc-btn"),t.attr("id",r.ID+"_btn"),i.StyleInfo.Background&&(n.Platform.isIpad()||t.css("background-color",n.ColorHelper.Convert(i.StyleInfo.Background))),i.CellType.AutoExecute||t.attr("type","button"),u=this.createContentElement(i,r._getDomCreateInfo()),t.append(u),t.css("white-space","nowrap"),n.DomUtilities.setPropertyToDom(i,t,r._getDomCreateInfo(),[3,5]),t},r.prototype.createContentElement=function(t,i){var r=n.DomUtilities.createJqueryDomElement("label"),e=n.CellDomCreateHelper.createTextElement(t,r,i),f=t.CellType,o=f.IconSize,u=n.ImageDataHelper.CreateImage(f.Icon,o);return u&&(u.insertBefore(r),u.css("margin-right",n.Common.IsEmpty(t.Value)?0:5),u.css("display","inline-block"),r.css("display","inline-block"),r.css("vertical-align","middle"),u.css("margin-left",r.css("padding-left")),r.css("padding-left",0),this._image=u),e},r.prototype.setValueToElement=function(n,t){this._updateText(n,t)},r.prototype._updateText=function(t,i){var r={value:null},u=n.FormatHelper.formatValue(i,this.getFormatString(),r);n.GeneralCellType.setValueToLabel(t,u,this.isEnabled?r.value:null,this.CellElement);this._image&&this._image.css("margin-right",n.Common.IsEmpty(i)?0:5)},r.prototype.getValueFromElement=function(n){return null},r.prototype.onFormatterChanged=function(){var t=$("#"+this.ID),i;t.length===1&&(i=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID),this._updateText(t,i))},r.prototype._disable=function(n){var t=n;t.attr("disabled","disabled")},r.prototype._getPartsUseBackcolor=function(){return $("#"+this.ID+"_btn")},r.prototype._setVisible=function(n,t){var r=this.ID+"_btn",i=n.find("#"+r);t?i.css("display",""):i.css("display","none")},r.prototype._getVisibleParts=function(n){var t=this.ID+"_btn";return n.find("#"+t)},r.prototype._enable=function(){var n=$("#"+this.ID+"_btn");n.removeAttr("disabled")},r.prototype._getClickableDomId=function(){return this.ID+"_btn"},r.prototype.shouldDisplayInListviewNewRow=function(){return!1},r.StyleTemplateHelper=new i,r}(n.ClickableCellTypeBase);n.ButtonCellType=t;n.CellTypeHelper.registerCellType("Forguncy.ButtonCellType, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){function r(t,r){return(r instanceof i||r instanceof n.SpreadJSViewBarcodeCellType)&&(t=u(t)+"",t=f(t)),t}function u(n){for(var t,i=[],r=0;r<n.length;r++)t=n.charCodeAt(r),t<128?i.push(t):t<2048?i.push(192|t>>6,128|t&63):t<55296||t>=57344?i.push(224|t>>12,128|t>>6&63,128|t&63):(r++,t=65536+((t&1023)<<10|n.charCodeAt(r)&1023),i.push(240|t>>18,128|t>>12&63,128|t>>6&63,128|t&63));return i}function f(n){for(var i="",u=0,e=n.length,r,f,o;u<e;){if(r=n.charCodeAt(u++)&255,u===e){i+=t.charAt(r>>2);i+=t.charAt((r&3)<<4);i+="==";break}if(f=n.charCodeAt(u++),u===e){i+=t.charAt(r>>2);i+=t.charAt((r&3)<<4|(f&240)>>4);i+=t.charAt((f&15)<<2);i+="=";break}o=n.charCodeAt(u++);i+=t.charAt(r>>2);i+=t.charAt((r&3)<<4|(f&240)>>4);i+=t.charAt((f&15)<<2|(o&192)>>6);i+=t.charAt(o&63)}return i}var i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.createContent=function(){var t;return n.Platform.isIE()||n.Platform.isOldEdge()?t=n.DomUtilities.createJqueryDomElement("div"):(t=n.DomUtilities.createJqueryDomElement("img"),t.css("object-fit","contain")),t.addClass("fgc-barcode"),n.DomUtilities.setPropertyToDom(this.CellElement,t,this._getDomCreateInfo(),[2]),this.image=t,t},i.prototype.shouldSetPenetrable=function(){return!0},i.prototype.needValidate=function(){return!1},i.prototype.setValueToElement=function(t,r){var f=this.CellElement.CellType,u=this,e="Barcode/GetBarcode";n.Common.forguncyPost(e,i.GetRequestParam(r,f,this.CellElement.Width,this.CellElement.Height,this.CellElement.StyleInfo.Background,this.CellElement.StyleInfo.Foreground,u),function(t){n.Platform.isIE()||n.Platform.isOldEdge()?u.image.css("background-image",'url("'+t+'")'):u.image.attr("src",t)},"GetBarcode "+this.ID)},i.GetRequestParam=function(t,i,u,f,e,o,s){return{value:r(t+"",s),codeType:i.CodeType,width:u,height:f,background:n.ColorHelper.Convert(e),connection:n.Common.IsEmpty(i.Connection)?!1:i.Connection,connectionNo:n.Common.IsEmpty(i.ConnectionNo)?0:i.ConnectionNo,version:n.Common.IsEmpty(i.Version)?-1:i.Version,checkDigit:n.Common.IsEmpty(i.CheckDigit)?!0:i.CheckDigit,checkDigitAlgorithm:n.Common.IsEmpty(i.CheckDigitAlgorithm)?"Modulus16":i.CheckDigitAlgorithm,foreground:n.ColorHelper.Convert(o)}},i.prototype.shouldDisplayInListviewNewRow=function(){return!1},i}(n.CellTypeBase),t;n.BarcodeCellType=i;n.ConvertThenEncode=r;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";n.CellTypeHelper.registerCellType("Forguncy.BarcodeCellType, Forguncy",i)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var s=function(t){function s(){return t!==null&&t.apply(this,arguments)||this}return __extends(s,t),s.prototype.create=function(n){t.prototype.create.call(this,n);var i=this.CellElement,r=i.CellType;r.Style===3&&n.css("overflow","initial")},s.prototype.createContent=function(){var v=this,h=this.CellElement,t=h.CellType,l,c,s,a;if(this.checkbox=t.Style===3?new r(""):new i(""),this.checkbox.text=t.Caption?t.Caption:"",this.checkbox.isChecked=this.cellTypeData.getDefaultValue()===!0,this.checkbox.primaryColor=t.PrimaryColor?n.ColorHelper.Convert(t.PrimaryColor):"",this.checkbox.secondaryColor=t.SecondaryColor?n.ColorHelper.Convert(t.SecondaryColor):"",l=this._getDomCreateInfo(),l.id+="checkBoxLabel",this.checkbox.id=l.id,t.Style===3&&(this.checkbox.horizontalAlignment=h.StyleInfo.HorizontalAlignment,this.checkbox.verticalAlignment=h.StyleInfo.VerticalAlignment,this.checkbox.textIndent=h.StyleInfo.TextIndent),c=u,t.Style===1?c=f:t.Style===2?c=e:t.Style===3&&(c=o),s=this.checkbox.createUI(c),this.ui=s,this.isInListview)s.textContainer.css("overflow","hidden"),s.inputContainer.attr(n.StaticValues.isInListview,this.isInListview),s.inputContainer.css("outline","thin transparent");else{this.checkbox.on("PropertyChanged",function(n,t){t==="isChecked"&&v.commitValue()});n.FocusMoveHelper.AllowMoveFocusByEnterKey(s.inputContainer,this.isInListview,this.CellElement)}return n.DomUtilities.setPropertyToDom(h,s.inputContainer,this._getDomCreateInfo(),[2,5]),t.Style===3?s.container:(a=n.CellDomCreateHelper.createTextElement(h,s.container,l,!0,!1,!0),s.container.css("display",""),a)},s.prototype.setValueToElement=function(t,i){this.checkbox.isChecked=n.Common.isEquals(!0,i)||n.Common.isEquals(1,i)},s.prototype.getValueFromElement=function(n){return this.checkbox.isChecked?1:0},s.prototype.validateValue=function(i,r){return r===void 0&&(r=null),n.Common.IsEmpty(i)||typeof i=="boolean"||typeof i=="number"&&(i===1||i===0)?t.prototype.validateValue.call(this,i,r):n.RS.InvalidValueTypeMessage},s.prototype.destroy=function(){t.prototype.destroy.call(this);this.checkbox.dispose()},s.prototype._getCellTypeData=function(t){return new n.CheckBoxCellTypeData(t)},s.prototype._enable=function(){this.updateCheckboxEnabled(!0)},s.prototype._disable=function(n){this.updateCheckboxEnabled(!1)},s.prototype._getPartsUseFontStyle=function(){return this.ui.textContainer},s.prototype.setStlyeInternal=function(t){n.DomUtilities.setPropertyToDom(t,this.ui.container,this._getDomCreateInfo(),[0])},s.prototype._getVisibleParts=function(n){return this.ui.container},s.prototype.updateReadOnlyStatus=function(){this.updateCheckboxEnabled(this.isEnabled)},s.prototype.updateCheckboxEnabled=function(n){this.checkbox.enabled=!this.isReadOnly()&&n},s.count=0,s}(n.ListviewEditModeCellType),i,t,r,u,f,e,o,h;n.CheckBoxCellType=s;i=function(n){function i(r){var u=n.call(this,r)||this;return u.defaultUI=t,u.styleId=(i.count++).toString(),u.registProperty("styleId"),u.registProperty("foreColor"),u.registProperty("primaryColor"),u.registProperty("secondaryColor"),u}return __extends(i,n),i.count=0,i}(n.UI.CheckBox);n.DefaultCheckBox=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"styleId",{set:function(n){this.container.attr("styleid",n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"foreColor",{set:function(n){this.textContainer.css("color",n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraCssName",{get:function(){return""},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(){n.prototype.createContainer.call(this);this.container.addClass(this.extraCssName)},t}(n.UI.CheckBoxUI);n.DefaultCheckBoxUI=t;r=function(n){function t(t){var i=n.call(this,t)||this;return i.registProperty("horizontalAlignment"),i.registProperty("verticalAlignment"),i.registProperty("textIndent"),i}return __extends(t,n),t}(i);n.ButtonCheckBox=r;u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"extraCssName",{get:function(){return"fgc-checkbox-system"},enumerable:!0,configurable:!0}),t}(t);n.SystemCheckBoxUI=u;f=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"fgc-checkbox-modern"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.innerContainer.css("color",t);var i='.FUI-checkbox[styleId="'+this.target.styleId+'"].FUI-checked.FUI-focus > .FUI-toggle-inner';this.container.append("<style>"+i+"{box-shadow: 0 0 3px 2px "+n.ColorHelper.UpdateTint(t,0,128)+" }<\/style>")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){this.container.append('<style>.FUI-checkbox[styleid="'+this.target.styleId+'"] >.FUI-toggle-inner::after{color:'+n+" !important}<\/style>")},enumerable:!0,configurable:!0}),i}(t);n.ModernCheckBoxUI=f;e=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"fgc-toggle-switch"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.innerContainer.css("color",t);var i='.FUI-checkbox[styleId="'+this.target.styleId+'"].FUI-focus > .FUI-toggle-inner';this.container.append("<style>"+i+"{box-shadow: 0 0 3px 2px "+n.ColorHelper.UpdateTint(t,0,128)+" }<\/style>")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){this.container.append('<style>.FUI-checkbox[styleId="'+this.target.styleId+'"] > .FUI-toggle-inner::after{color:'+n+" !important}<\/style>")},enumerable:!0,configurable:!0}),i}(t);n.SwitchCheckBoxUI=e;o=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"fgc-toggle-button"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.container.css("color",t);var i='.FUI-checkbox[styleId="'+this.target.styleId+'"].FUI-checked.FUI-focus';this.container.append("<style>"+i+"{box-shadow: 0 0 3px 2px "+n.ColorHelper.UpdateTint(t,0,128)+" }<\/style>")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){this.container.append('<style>.FUI-checkbox[styleId="'+this.target.styleId+'"].FUI-checked > .FUI-toggle-text{color:'+n+" !important}<\/style>")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"horizontalAlignment",{set:function(t){switch(t){case n.CellHorizontalAlignment.Left:this.container.css("justify-content","flex-start");break;case n.CellHorizontalAlignment.General:case n.CellHorizontalAlignment.Center:this.container.css("justify-content","center");break;case n.CellHorizontalAlignment.Right:this.container.css("justify-content","flex-end");break}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"verticalAlignment",{set:function(t){switch(t){case n.CellVerticalAlignment.Top:this.container.css("align-items","flex-start");break;case n.CellVerticalAlignment.Center:this.container.css("align-items","center");break;case n.CellVerticalAlignment.Bottom:this.container.css("align-items","flex-end");break}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textIndent",{set:function(t){if(t!==undefined&&t!==null){var i=this.target.horizontalAlignment;i===n.CellHorizontalAlignment.General||i===n.CellHorizontalAlignment.Left?this.textContainer.css("text-indent",t):i===n.CellHorizontalAlignment.Right&&this.textContainer.css("padding-right",t)}},enumerable:!0,configurable:!0}),i}(t);n.ButtonCheckBoxUI=o;h=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"fgc-toggle-button fgc-toggle-groupbutton"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{set:function(t){n.Common.IsEmpty(t)?this.textContainer.text(" "):this.textContainer.text(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.container.css("color",t);var i='.FUI-checkbox[styleId="'+this.target.styleId+'"].FUI-checked.FUI-focus';this.container.append("<style>"+i+"{box-shadow: 0 0 3px 2px "+n.ColorHelper.UpdateTint(t,0,128)+" }<\/style>")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){this.container.append('<style>.FUI-checkbox[styleId="'+this.target.styleId+'"].FUI-checked > .FUI-toggle-text{color:'+n+" !important}<\/style>")},enumerable:!0,configurable:!0}),i}(t);n.GroupButtonCheckBoxUI=h;n.CellTypeHelper.registerCellType("Forguncy.CheckBoxCellType, Forguncy",s)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i=function(t){function i(){var n=t.call(this)||this;return n.CellTypeString="Forguncy.HyperlinkCellType",n.TemplateNameParts=["LINK"],n}return __extends(i,t),i.prototype.MapPartsNameToDom=function(n){return{LINK:n}},i.prototype.OnTemplateStyleApplied=function(t,i){var u,f,r;i&&(u=i.find("a"),u.css({fontSize:"inherit",color:"inherit",fontWeight:"inherit",fontStyle:"inherit",outline:"none"}),f=t.Key,r=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(this.CellTypeString,f,"LINK"),n.CellTypeStyleTemplateUtils.AddFocusStyleToContainer(r,i),n.CellTypeStyleTemplateUtils.AddDiableCallbackToContainer(r,i),n.CellTypeStyleTemplateUtils.AddActiveStyleToContainer(r,i))},i.prototype.Clear=function(){t.prototype.Clear.call(this)},i}(n.CellTypeStyleTemplateHelperBase),t;n.HyperlinkCellTypeStyleTemplateHelper=i;t=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.create=function(n){t.prototype.create.call(this,n);var i=this.CellElement.CellType;i&&!i.IsDisabled&&i.ClickMode===1&&n.css("cursor","pointer")},r.prototype.adjustForeColor=function(i,r){return i=t.prototype.adjustForeColor.call(this,i,r),n.Common.IsEmpty(i)?"inherit":i},r.prototype.needValidate=function(){return!1},r.prototype.createContent=function(){return r.createHyperlinkControl(this.CellElement,this._getDomCreateInfo())},r.createHyperlinkControl=function(t,i){var r=n.DomUtilities.createJqueryDomElement("a");return r.attr("href","#"),t.StyleInfo.Underline||(t.StyleInfo.Underline=!1),n.DomUtilities.setPropertyToDom(t,r,i,[5]),n.CellDomCreateHelper.createTextElement(t,r,i)},r.prototype.setValueToElement=function(n,t){this._updateText(n,t)},r.prototype._updateText=function(t,i){var r={value:null},u=n.FormatHelper.formatValue(i,this.getFormatString(),r);n.GeneralCellType.setValueToLabel(t,u,r.value,this.CellElement)},r.prototype.onFormatterChanged=function(){var t=$("#"+this.ID),i;t.length===1&&(i=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID),this._updateText(t,i))},r.prototype.getValueFromElement=function(n){return null},r.prototype._getClickableDomId=function(){var n=this.CellElement.CellType;return n&&n.ClickMode===1?this.ID+"_div":this.ID},r.prototype._getVisibleParts=function(n){return n.find("a")},r.prototype._disable=function(n){var r=n.find("a"),i;r.attr("disabled","disabled").css("cursor","default");i=this.getContainer();i.css("cursor","");i.attr("disabled","disabled");t.prototype._disable.call(this,i)},r.prototype._enable=function(n){var r=$("#"+this.ID),i;r.removeAttr("disabled");r.css("cursor","");i=this.getContainer();i.css("cursor","pointer");i.removeAttr("disabled");t.prototype._enable.call(this,i)},r.prototype._getPartsUseBackcolor=function(){var n=$("#"+this.ID+"_backColor");return n.length===0?t.prototype._getPartsUseBackcolor.call(this):n},r.prototype.shouldDisplayInListviewNewRow=function(){return!1},r.prototype.hasFocus=function(){var n=$("#"+this.ID);return n.length>0&&document.activeElement===n[0]?!0:!1},r.prototype.setFocus=function(){var n=$("#"+this.ID);n.length>0&&n[0].focus()},r.StyleTemplateHelper=new i,r}(n.ClickableCellTypeBase);n.HyperlinkCellType=t;n.CellTypeHelper.registerCellType("Forguncy.HyperlinkCellType, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i=function(t){function i(){var n=t.call(this)||this;return n.CellTypeString="Forguncy.ImageCellType",n.TemplateNameParts=["CONTAINER"],n}return __extends(i,t),i.prototype.MapPartsNameToDom=function(n){return{CONTAINER:n}},i.prototype.OnTemplateStyleApplied=function(t,i){if(t&&i){var r=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(this.CellTypeString,t.Key,"CONTAINER");n.CellTypeStyleTemplateUtils.AddActiveStyleToContainer(r,i);n.CellTypeStyleTemplateUtils.AddDiableCallbackToContainer(r,i)}},i}(n.CellTypeStyleTemplateHelperBase),r,t,u;n.ImageCellTypeStyleTemplateHelper=i;r=function(n){function t(){var t=n.call(this)||this;return t.CellTypeString="Forguncy.UploadImageCellType",t}return __extends(t,n),t}(i);n.UploadImageCellTypeStyleTemplateHelper=r;t=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.isEditable=function(){return!1},r.prototype.needValidate=function(){return t.prototype.needValidate.call(this)&&this.isEditable()},r.prototype.createContent=function(){var f=this,r=this.CellElement,a=this.isInListview,u,s,y,h,e,c,o,l;a||(r.Value=null);u=n.DomUtilities.createJqueryDomElement("div");u.css("width","100%");u.css("height","100%");u.css("position","relative");var i=r.CellType,p=n.ImageHelper.getImageSrcFromCellContentElement(r),t=n.DomUtilities.createJqueryDomElement("div"),v=this.isEditable();return a||v||(s=null,i.ImagePath&&(s=n.ImageHelper.getImageUrlFromImagePath(i.BuiltIn,i.ImagePath,!1)),t.attr("imagename",s),n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(f.ID,{newValue:s},1)),i.ImageSizeMode===undefined||i.ImageSizeMode===0?(t.css("background-repeat","no-repeat"),t.attr("forguncyImage","true")):"background-size"in t[0].style||"backgroundSize"in t[0].style?(t.css("background-repeat","no-repeat"),i.ImageSizeMode===1?t.css("background-size","contain"):t.css("background-size","100% 100%"),t.attr("forguncyImage","true")):t=n.DomUtilities.createJqueryDomElement("img"),t.css("width","100%"),t.css("height","100%"),(i.HorizontalAlignment===n.CellHorizontalAlignment.Center||i.HorizontalAlignment===undefined||i.HorizontalAlignment===null)&&t.css("background-position-x","50%"),i.HorizontalAlignment==n.CellHorizontalAlignment.Right&&t.css("background-position-x","100%"),(i.VerticalAlignment===n.CellVerticalAlignment.Center||i.VerticalAlignment===undefined||i.VerticalAlignment===null)&&t.css("background-position-y","50%"),i.VerticalAlignment===n.CellVerticalAlignment.Bottom&&t.css("background-position-y","100%"),this.updateImageSource(p,t),y=[5,2,3],n.DomUtilities.setPropertyToDom(r,t,f._getDomCreateInfo(),y),u.append(t),i.Text&&!v&&(e=n.DomUtilities.createContainerDiv(),e.css("top",0),r.Value=i.Text,c=f._getDomCreateInfo(),c.id=f.ID+"_text",h=n.GeneralCellType.createLabelElement(r,c),n.DomUtilities.setPropertyToDom(r,e,c,[3]),e.append(h),u.append(e),r.Value=null),o=i.ToolTip,n.Common.IsEmpty(o)||(l=n.Common.IsEmpty(h)?t:h,n.FormulaManager.shouldEvaluateFormula(o)?l.hover(function(){var t=f.getDefaultFormulaCalcInfo(),i=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(o,t);l.attr("title",i)}):l.attr("title",o)),u},r.prototype.shouldSetPenetrable=function(){var n;return((n=this.CellElement.CellType.CommandList)===null||n===void 0?void 0:n.length)>0?t.prototype.shouldSetPenetrable.call(this):!0},r.prototype.setValueToElement=function(t,i){var r,u,f;i!==this.getValue(!1)&&(t.attr("imagename",i),n.Common.isForguncyFile(i)&&(i=i+n.ImageQueryHelper.getImageQueryString(this.CellElement.Width,this.CellElement.Height)),r=this.CellElement.CellType,t.empty(),u=i,n.Common.IsEmpty(i)&&(u=n.ImageHelper.getImageUrlFromImagePath(r.BuiltIn,r.ImagePath,!1)),f=this.updateImageSource(u,t,i),f&&(t.attr("forguncyImage")?t.css("background-image",""):t.attr("src","")))},r.prototype.updateImageSource=function(t,i,r){var u=this,f;return r===void 0&&(r=null),n.ImageDataHelper.IsBuiltInSvg(t)?(this._svgSrc=t,f=this.CellElement.CellType,n.ImageDataHelper.AppendSvg(i,t,f.Color,function(n){return u.isInListview?!1:u._svgSrc!==n}),!0):(this._svgSrc=null,n.ImageHelper.setImageSource(i,n.Common.IsEmpty(r)?t:r),!1)},r.prototype.getValueFromElement=function(n){var t=$("#"+this.ID);return t.length>0&&t.attr("imagename")?t.attr("imagename"):null},r.prototype._getClickableDomId=function(){return this.ID+"_div"},r.prototype._enable=function(n){this.getContainer().removeAttr("disabled");t.prototype._enable.call(this,this.getContainer());this.updateCursor(!0)},r.prototype._disable=function(n){this.updateCursor(!1);this.getContainer().attr("disabled","disabled");t.prototype._disable.call(this,this.getContainer())},r.prototype.shouldDisplayInListviewNewRow=function(){return!1},r.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID+"_text")},r.prototype.updateReadOnlyStatus=function(){this.updateCursor(this.isEnabled)},r.prototype.updateCursor=function(n){var t=this.getContainer(),i=t.find("#"+this.ID).parent().children(),r=t.find("label");this.usePointerCursor(n)?(i.css("cursor","pointer"),r.css("cursor","pointer")):(i.css("cursor",""),r.css("cursor",""))},r.prototype.usePointerCursor=function(n){return n?this.isEditable()?!this.isReadOnly():!!this.CellElement.CellType.CommandList:!1},r.StyleTemplateHelper=new i,r}(n.ClickableCellTypeBase);n.ImageCellType=t;u=function(t){function i(n,i,r,u){var f=t.call(this,n,i,r,u)||this;return f.allowSetValueByUser=!1,f.supportedEvents=[],f}return __extends(i,t),i.prototype.getStyleTemplateHelper=function(){return i.StyleTemplateHelper},i.prototype._getCellTypeData=function(t){return new n.UploadImageCellTypeData(t)},i.prototype.isEditable=function(){return!0},i.prototype.shouldSetPenetrable=function(){return!this.isVisible()},i.prototype._disable=function(i){var r=i.find("#"+this.ID);r.off("click");n.DragFileToUploadHelper.unRegister(r);r.css("cursor","default");t.prototype._disable.call(this,this.getContainer())},i.prototype._enable=function(){var i=$("#"+this.ID);i.on("click",{cellType:this,image:i},this._onUploadImageClick);n.ImageUploadHelper.registerDragFile(i,this);i.css("cursor","pointer");t.prototype._enable.call(this,this.getContainer())},i.prototype._getClickableDomId=function(){return null},i.prototype.shouldDisplayInListviewNewRow=function(){return!0},i.prototype._onUploadImageClick=function(t){var r=t.data.cellType,u,f;r.isEditable()&&r.isEnabled&&!r.isReadOnly()&&(u=t.data.image,f=r.CellElement.CellType.UploadImageLimit,n.Common.uploadImage(f,i.allowDragFileType,function(t){r._indicatorContainer.css("display","none");n.ImageUploadHelper.uploadSuccess(t,u,r)},function(t,i){var u,f;r._indicatorContainer.css("display","none");t&&(f=((u=i)===null||u===void 0?void 0:u.status)==401?n.RS.UnauthorizedUpload:t,alert(f))},function(){r._indicatorContainer.css("display","")}))},i.prototype.createContent=function(){var r=t.prototype.createContent.call(this),u=this.isEditable(),i;if(u){i=r.children("[forguncyimage]");i.on("click",{cellType:this,image:i},this._onUploadImageClick);n.ImageUploadHelper.registerDragFile(i,this);i.css("cursor","pointer")}return this._indicatorContainer=n.DomUtilities.createLoadingIndicator(),r.append(this._indicatorContainer),r},i.allowDragFileType=".art, .bmp, .cmx, .cod, .dib, .gif, .ico, .ief, .jfif, .jpe, .jpeg, .jpg, .pbm, .pgm, .png, .pnm, .pnz, .ppm, .ras, .rf, .rgb, .svg, .tif, .tiff, .wbmp, .xbm, .xpm, .xwd",i.StyleTemplateHelper=new r,i}(t);n.UploadImageCellType=u;n.CellTypeHelper.registerCellType("Forguncy.ImageCellType, Forguncy",t);n.CellTypeHelper.registerCellType("Forguncy.UploadImageCellType, Forguncy",u)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getStyleTemplateHelper=function(){return i.StyleTemplateHelper},i.prototype._getCellTypeData=function(t){return new n.InputCellTypeData(t)},i.prototype.createContent=function(){var i=this,s=this.CellElement,c=this.isInListview,t=n.DomUtilities.createJqueryDomElement("input"),f,o,u,e,r,h;if(t.attr("type","password"),t.css("display","block"),n.CellDomCreateHelper.initalInputBox(s,t,this._getDomCreateInfo()),f=s.CellType,c||(t.change(function(){i.isReadOnly()||i._onValueChanged()}),t.focusout(function(){i.isReadOnly()||i.validate()}),n.FocusMoveHelper.AllowMoveFocusByEnterKey(t,this.isInListview,this.CellElement)),o=this.cellTypeData.getDefaultValue(),n.Common.IsEmpty(o)||this._setValue(t,o),u=n.CellDomCreateHelper.createControlContainer(),u.append(t),e=f.IconSize,r=n.ImageDataHelper.CreateImage(f.Icon,e),r&&(r.css("margin","0px 5px"),r.css("position","absolute"),r.css("top","calc(50% - "+e/2+"px)"),u.append(r),this.CellElement.StyleInfo.HorizontalAlignment!==n.CellHorizontalAlignment.Center&&t.css("padding-left",e+10)),f.IsSelectAllOnFocus){h=u.find("#"+this.ID);h.on("focusin",function(){n.Platform.isChrome()?i.selectAll():n.DelayRefresh.setTimeout(function(){i.selectAll()})})}return u},i.prototype.setValueToElement=function(n,t){n.val(t)},i.prototype.getValueFromElement=function(n){var t=$("#"+this.ID);return t.length>0?t.val():null},i.prototype.setBackColor=function(n){var i=$("#"+this.ID);i.css("background-color","transparent");t.prototype.setBackColor.call(this,n)},i.prototype.getListviewNoneEditModeText=function(t,i,r){return!n.Common.IsEmpty(t)&&this.CellElement.CellType.ShowPassword?"******":""},i.prototype.canInputChars=function(){return this.isEnabled&&!this.isReadOnly()},i.prototype.selectAll=function(){var n=$("#"+this.ID);n.length>0&&n.select()},i.prototype.setCaretAtLast=function(){var n=$("#"+this.ID),i=n.val(),t;i&&n.length>0&&(t=n[0],t.selectionStart=t.selectionEnd=i.length)},i.prototype.setStlyeInternal=function(t){var i=$("#"+this.ID);i.length<=0||(n.Common.IsEmpty(t.StyleInfo.Background)||i.css("background-color",n.ColorHelper.Convert(t.StyleInfo.Background)),n.DomUtilities.setPropertyToDom(t,i,this._getDomCreateInfo(),[0]))},i.prototype._disable=function(n){n.find("#"+this.ID).attr("disabled","disabled");t.prototype._disable.call(this,n)},i.prototype._enable=function(n){$("#"+this.ID).removeAttr("disabled");t.prototype._enable.call(this,n)},i.prototype.updateReadOnlyStatus=function(){var n=this.getContainer().find("#"+this.ID);this.isReadOnly()?n.attr("readonly","readonly"):n.prop("readonly",!1)},i.prototype._getVisibleParts=function(n){return n.find("#"+this.ID)},i.prototype.getIgnoreKeysInListview=function(){return[37,39]},i.StyleTemplateHelper=new n.InputCellTypeStyleTemplateHelperBase("Forguncy.TextCellType"),i}(n.ListviewEditModeCellType);n.PasswordCellType=t;n.CellTypeHelper.registerCellType("Forguncy.TextCellType, Forguncy",t,function(n){return n.CellType.ShowPassword})}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.needValidate=function(){return!1},i.prototype.createContent=function(){var u=this,r=this.CellElement,v=this.isInListview,e=n.DomUtilities.createJqueryDomElement("div"),t=r.CellType,c=i.AddImage(e,t.FirstImage,t,r),l=i.AddImage(e,t.PreviousImage,t,r),f,a,o,s,h;return t.ShowText&&(f=n.DomUtilities.createJqueryDomElement("div"),f.attr("id",u.ID+"Textdiv"),f.css("display","inline-block"),a=u.AddText(f,t.RecordDataTable,r,"currentIndexLabel","0",u.ID+"CurrentRow"),u.AddText(f,t.RecordDataTable,r,"","/",u.ID+"Slash"),u.AddText(f,t.RecordDataTable,r,"currentCountLabel"," 0",u.ID+"TotalRow"),i.AddRecordNavigationCellSpace(f,t,r),e.append(f)),o=i.AddImage(e,t.NextImage,t,r),s=i.AddImage(e,t.LastImage,t,r),i.AddGoToCommand(c,t.RecordDataTable,u.ID+"first",2,this),i.AddGoToCommand(l,t.RecordDataTable,u.ID+"previous",0,this),i.AddGoToCommand(o,t.RecordDataTable,u.ID+"next",1,this),i.AddGoToCommand(s,t.RecordDataTable,u.ID+"last",3,this),h=n.DomUtilities.createAlignmentContainer(e,r.StyleInfo.HorizontalAlignment,r.StyleInfo.VerticalAlignment,r.Height),e.css("white-space","nowrap"),h},i.AddGoToCommand=function(t,i,r,u,f){if(t){var e=[{$type:"Forguncy.Model.GoToRecordCommand, Forguncy",TableName:i,TargetRecord:u}];t.attr("id",r);n.DomUtilities.addCustomCommand(t,e,r,f)}},i.AddImage=function(t,r,u,f){var o=u.ImageSize?u.ImageSize:16,e=n.ImageDataHelper.CreateImage(r,o);if(e)return e.css("display","inline-block"),i.AddRecordNavigationCellSpace(e,u,f),t.append(e),e},i.AddRecordNavigationCellSpace=function(t,i,r){var u=i.Space?i.Space:5;r.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Left?t.css("margin-right",u):r.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Center?(t.css("margin-left",u/2),t.css("margin-right",u/2)):t.css("margin-left",u)},i.prototype.AddText=function(t,i,r,u,f,e){var o=n.DomUtilities.createJqueryDomElement("span");return o.text(f),o.attr("id",e),i||(i=""),u&&o.attr(u,i),o.css("min-width",50),n.DomUtilities.setPropertyToDom(r,o,this._getDomCreateInfo(),[0]),o.css("vertical-align","middle"),t.append(o),o},i.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID+"_div span")},i.prototype.getValueFromElement=function(n){return null},i.prototype.onCurrentRowInfoChanged=function(n){var t=this.CellElement.CellType.RecordDataTable;t&&t!==n||i.updateNavigationCellTypeText("currentIndexLabel",i._updateCurrentIndexLabel)},i._updateCurrentIndexLabel=function(n,t){t.text(i.getRecordID(n))},i.getRecordID=function(t){if(!t)return 0;var r=0,u=i.getRelatedListview(t.currentTable);return u?(r=u.getSelectedRowIndex()+1,(i.isInvalidNumber(r)||r>u.getActualDataLength())&&(r=0)):t&&!n.Common.IsEmpty(t.recordID)?(r=1+Number(t.recordID),i.isInvalidNumber(r)&&(r=0)):r=0,r},i.isInvalidNumber=function(n){return typeof n!="number"||isNaN(n)||n<0},i.getRelatedListview=function(t){for(var r=n.ListviewBase.getAllListviews(),i=0;i<r.length;i++)if(r[i].getDataTableName()===t)return r[i];return null},i.updateCurrentCountLabel=function(t,r){var u,f,e,o;if(!t)return r.text("0");if(u=i.getRelatedListview(t.currentTable),u){o=u.getActualDataLength();r.text(o);return}else f=n.ForguncyData.pageInfo.commandQuerys[t.currentTable],e="Home/GetRowCount",n.Common.forguncyPost(e,{queryCommandInfo:f?JSON.stringify(f):"",currentRowInfo:JSON.stringify(t)},function(t){if(!n.Common.IsEmpty(t)){r.text(t);return}},"GetRowCount "+r.attr("id"))},i.updateNavigationCellTypeText=function(t,i){for(var f,r,s=$("#centerDiv_"+n.ForguncyData.pageInfo.pageID).find("["+t+"]"),o=0;o<s.length;o++){var h=$(s[o]),e=h.attr(t),u=n.ListviewBase.getAllListviews();if(!e&&u&&u.length>0)for(r=0;r<u.length;r++)if(!u[r].isGroupMode()){e=u[r].getDataTableName();break}if(f=null,e){if(f=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(e),!f&&u)for(r=0;r<u.length;r++)u[r].isGroupMode()||u[r].getDataTableName()===e&&(f=u[r].getRowInfo())}else n.ForguncyData.pageInfo.currentRowInfoCollection.list.length>0&&(f=n.ForguncyData.pageInfo.currentRowInfoCollection.list[0]);i(f,h)}},i}(n.CellTypeBase);n.RecordNavigationCellType=t;n.CellTypeHelper.registerCellType("Forguncy.RecordNavigationCellType, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.needValidate=function(){return!1},i.prototype.onLoad=function(){var t=this,i=n.ListviewBase.getListview(t.getListviewName(),t.runTimePageName);t._listviewLocation=i.getLocationString();n.ForguncyData.pageingInfoList.Init(t._listviewLocation,t.getLimit());t.updateText(n.ForguncyData.pageingInfoList.GetInfo(t._listviewLocation));t._pagingInfoChangedEventHandler=function(n,i){t.onPagingInfoChanged(i)};t._pageingUIInvalideEventHandler=function(n,i){t.onRefreshUI(i)};n.ForguncyData.pageingInfoList.bind(n.Events.PageingInfoChanged,t._pagingInfoChangedEventHandler);n.ForguncyData.pageingInfoList.bind(n.Events.PageingRowcountChanged,t._pagingInfoChangedEventHandler);n.ForguncyData.pageingInfoList.bind(n.Events.PageingUIInvalide,t._pageingUIInvalideEventHandler)},i.suspendCellTypeCommand=function(){this._isSusspend=!0},i.resumeCellTypeCommand=function(){this._isSusspend=!1},i.prototype.createContent=function(){var r=this,t=this.CellElement,p=this.isInListview,f=n.DomUtilities.createJqueryDomElement("div"),u=t.CellType,o,s,h;this._pageIndexID=r.ID+"currentPageIndexID";this._pageCountID=r.ID+"currentPageCountID";var c=i.addImage(f,u.FirstImage,u,t),l=i.addImage(f,u.PreviousImage,u,t),e=n.DomUtilities.createJqueryDomElement("div");e.attr("id",r.ID+"Textdiv");e.css("display","inline-block");var a=1,v=1,y=r.addTextBox(e,t,a.toString(),this._pageIndexID);return i.addInputGoToCommand(y,this._pageIndexID,this),r.addText(e,t,"/",r.ID+"Slash"),r.addText(e,t," "+v,this._pageCountID),i.addPageNavigateCellSpace(e,u,t),f.append(e),o=i.addImage(f,u.NextImage,u,t),s=i.addImage(f,u.LastImage,u,t),i.addImageGoToCommand(c,r.ID+"first",0,this),i.addImageGoToCommand(l,r.ID+"previous",1,this),i.addImageGoToCommand(o,r.ID+"next",2,this),i.addImageGoToCommand(s,r.ID+"last",3,this),h=n.DomUtilities.createAlignmentContainer(f,t.StyleInfo.HorizontalAlignment,t.StyleInfo.VerticalAlignment,t.Height),f.css("white-space","nowrap"),h},i.prototype.onPagingInfoChanged=function(n){n.listviewLocation===this._listviewLocation&&this.updateText(n.pagingInfo)},i.prototype.onRefreshUI=function(n){n.listviewLocation===this._listviewLocation&&(i.suspendCellTypeCommand(),this.updateText(n.pagingInfo),i.resumeCellTypeCommand())},i.prototype.destroy=function(){this._pagingInfoChangedEventHandler&&(n.ForguncyData.pageingInfoList.unbind(n.Events.PageingInfoChanged,this._pagingInfoChangedEventHandler),n.ForguncyData.pageingInfoList.unbind(n.Events.PageingRowcountChanged,this._pagingInfoChangedEventHandler),n.ForguncyData.pageingInfoList.unbind(n.Events.PageingUIInvalide,this._pageingUIInvalideEventHandler),this._pagingInfoChangedEventHandler=null,this._pageingUIInvalideEventHandler=null);t.prototype.destroy.call(this)},i.prototype.setPageIndex=function(t){if(!isNaN(t)){var i=n.ForguncyData.pageingInfoList.GetInfo(this._listviewLocation).getPageCount();return t>i?t=i:t<=0&&(t=1),this.getCurrentPageIndexLabel().val(t)}},i.prototype.setPageCount=function(n){return this.getCurrentPageCountLabel().text(" "+n)},i.prototype.getPageIndex=function(){return Number(this.getCurrentPageIndexLabel().val())},i.prototype.getListviewName=function(){return this.CellElement.CellType.PageingListviewName},i.prototype.getLimit=function(){return this.CellElement.CellType.PageLimitRowCount},i.addImageGoToCommand=function(t,i,r,u){if(t){t.attr("id",i);t.css("cursor","pointer");t.on(n.Events.Click,function(){if(u.isEnabled){var t=[{$type:"Forguncy.Model.GoToPageCommand, Forguncy",targetPageKind:r,ListviewName:u.getListviewName(),TargetPageIndex:u.getPageIndex(),Limit:u.getLimit()}];n.ForguncyData.commandExcutor.excuteCommand(t,u.runTimePageName,u,i,n.Events.Click)}return!1})}},i.addInputGoToCommand=function(t,i,r){this._isSusspend!==!0&&t&&(t.focusout(function(){if(r.isEnabled){r.setPageIndex(r.getPageIndex());var t=[{$type:"Forguncy.Model.GoToPageCommand, Forguncy",targetPageKind:4,ListviewName:r.getListviewName(),TargetPageIndex:r.getPageIndex(),Limit:r.getLimit()}];n.ForguncyData.commandExcutor.excuteCommand(t,r.runTimePageName,r,i,n.Events.Click)}}),t.keydown(function(n){r.isEnabled&&n.keyCode===13&&$(this).blur()}))},i.addImage=function(t,r,u,f){var o=u.ImageSize?u.ImageSize:16,e=n.ImageDataHelper.CreateImage(r,o);if(e)return e.css("display","inline-block"),i.addPageNavigateCellSpace(e,u,f),t.append(e),e},i.addPageNavigateCellSpace=function(t,i,r){var u=i.Space?i.Space:5;r.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Left?t.css("margin-right",u):r.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Center?(t.css("margin-left",u/2),t.css("margin-right",u/2)):t.css("margin-left",u)},i.prototype.addText=function(t,i,r,u){var f=n.DomUtilities.createJqueryDomElement("span");return f.text(r),f.attr("id",u),f.css("min-width",50),n.DomUtilities.setPropertyToDom(i,f,this._getDomCreateInfo(),[0]),f.css("vertical-align","middle"),t.append(f),f},i.prototype.addTextBox=function(t,i,r,u){var f=n.DomUtilities.createJqueryDomElement("input"),e,o;return f.val(r),f.attr("id",u),e=n.MeasureHelper.getWidth(null,null,i.StyleInfo.FontSize,i.StyleInfo.FontFamily,"000000"),o=e,f.css("width",o),n.DomUtilities.setPropertyToDom(i,f,this._getDomCreateInfo(),[0]),f.css("vertical-align","middle"),f.css("text-align","center"),f.css("margin-right","10px"),t.append(f),f},i.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID+"_div span")},i.prototype.getValueFromElement=function(n){return null},i.prototype.getCurrentPageIndexLabel=function(){return $("#"+this._pageIndexID)},i.prototype.getCurrentPageCountLabel=function(){return $("#"+this._pageCountID)},i.prototype.updateText=function(n){var t=this.getPageIndexFromPagingInfo(n),i=n.getPageCount();this.setPageCount(i);this.setPageIndex(t)},i.prototype.getPageIndexFromPagingInfo=function(n){var t=n.getCurrentPageIndex(),i=n.limit;return t>0&&i>0?Math.max(1,Math.ceil(t*i/this.getLimit())):1},i}(n.CellTypeBase);n.PageNavigateCellType=t;n.CellTypeHelper.registerCellType("Forguncy.PageNavigateCellType, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i=function(i){function r(n,t,r,u){var f=i.call(this,n,t,r,u)||this;return f.allowSetValueByUser=!1,f}return __extends(r,i),r.prototype.createContent=function(){var n=this.CellElement,i=this.isInListview;return t.CreateCurrentUserCellType(n,this._getDomCreateInfo(),this)},r.prototype._setOverflowHidden=function(n){return},r.prototype._disable=function(n){r.disableCurrentUserCell(n,this.ID)},r.disableCurrentUserCell=function(n,t){var i=n.find("a"),r;i&&i.length&&(i.attr("disabled","disabled"),i.css("cursor","default"));r=n.find("#"+t+"_dropdown");r.length>0&&r.attr("data-toggle")==="dropdown"&&r.removeAttr("data-toggle")},r.prototype._enable=function(){r.enableCurrentUserCell(this.ID)},r.enableCurrentUserCell=function(n){var t=$("#"+n+"_div").find("a"),i;t&&t.length&&(t.removeAttr("disabled"),t.css("cursor",""));i=$("#"+n+"_dropdown");i.length>0&&i.attr("data-toggle","dropdown")},r.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID+" label,#"+this.ID+"_login")},r.prototype._setDropDownButtonVisible=function(n){var i=$("#"+this.ID+"_dropdown"),t;i.length>0&&(t=i.find("span[currentUserDropDownButton = show]"),t.length>0&&(n?t.css("display",""):t.css("display","none")))},r.prototype.enterPrintMode=function(){this._setDropDownButtonVisible(!1)},r.prototype.quitPrintMode=function(){this._setDropDownButtonVisible(!0)},r.prototype._getVisibleParts=function(n){return n.find("a")},r.prototype.getBindingTables=function(){var t=this.CellElement.CellType;return t.ShowNotification?n.ForguncyData.GlobalSettings.WorkflowTables:null},r.prototype.reload=function(i){i&&n.DelayRefresh.Push(r,function(){t.UpdateAllNotificationIcon()},"RefreshNotifications")},r}(n.CellTypeBase),t;n.CurrentUserCellType=i;t=function(){function t(){}return t.CreateCurrentUserCellType=function(i,r,u){var e=i.CellType,d=n.ForguncyData.AuthenticationType===3,b,f,h,o,p,k,l,s,c,w;if(d&&!n.Page.getUserName())return b=t._createLoginLink(i,u,r),n.DomUtilities.setPropertyToDom(i,b,r,[2]),b;f=n.DomUtilities.createJqueryDomElement("table");f.css("border-spacing",0);h=n.DomUtilities.createJqueryDomElement("tr");f.append(h);f.css("height","100%");n.DomUtilities.setPropertyToDom(i,f,r,[1]);var a=e.ShowUserPicture&&d,v=e.ShowDropDown&&n.ForguncyData.AllowLogout,g=!a||e.ShowUserDisplayName,nt=g&&e.ShowUserDisplayName,tt=a&&e.ShowNotification,y;if(a&&(y=n.DomUtilities.createJqueryDomElement("td"),o=n.DomUtilities.createJqueryDomElement("img"),o.css("max-height",i.Height-2),o.css("max-width",i.Height-2),o.css("padding",0),o.css("margin-right",10),o.attr("id",u.ID+"_image"),v&&o.css("cursor","pointer"),y.append(o),p=void 0,n.ForguncyData.userInfo.HasPicture?(k="",n.ForguncyData.doNotCacheUserProfileAvator&&(k="&v="+Math.floor(Math.random()*1e8),n.ForguncyData.doNotCacheUserProfileAvator=!1),p=n.ForguncyData.ForguncyRoot+"Account/UserImage?u="+n.ForguncyData.userInfo.UserName+k):p=n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/DefaultCurrentUser.png",n.ImageHelper.setImageSource(o,p),h.append(y)),g&&(l=n.DomUtilities.createJqueryDomElement("td"),s=n.DomUtilities.createJqueryDomElement("label"),s.attr("id",u.ID+"_name"),v&&s.css("cursor","pointer"),n.DomUtilities.setPropertyToDom(i,s,r,[0]),t._setVerticalAlign(l,i.StyleInfo.VerticalAlignment),l.append(s),h.append(l)),a||nt?(e.ShowUserDisplayName&&(n.ForguncyData.userInfo.FullName?s.text(n.ForguncyData.userInfo.FullName):s.text(n.ForguncyData.userInfo.UserName)),v&&t._createPopupDropdownArrow(i,h)):(s.text(n.Page.getUserName()),v&&t._createPopupDropdownArrow(i,h)),e.ShowNotification){if(c=t._createNoificationIcon(),c.css("display","none"),c.attr("notificationIcon",""),c.attr("id",u.ID+"_notification"),w=tt?y:l,w.append(c),e.NavigatePageNameForNotification){w.data("allowNavigate",!0);w.on("click",function(){if(c.css("display")!="none"){var i={NavigateType:"normal",DeleteCachedQuery:!0,PageName:e.NavigatePageNameForNotification},t=new n.NavigateCommand;return t.CommandParam=i,t.execute(),!1}})}u.reload(!0)}return t._setHorizonalAlign(f,i.StyleInfo.HorizontalAlignment),e.ShowDropDown&&n.ForguncyData.AllowLogout&&(f=n.DomUtilities.createDropDownListForFormUser(i,f,u),i.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Center&&f.find(".dropdown-menu").css({left:"50%","-webkit-transform":"translateX(-50%)","-ms-transform":"translateX(-50%)",transform:"translateX(-50%)"})),n.DomUtilities.setPropertyToDom(i,f,r,[2]),f},t.UpdateAllNotificationIcon=function(){t._updateNotificationIcon($("[notificationIcon]"))},t._updateNotificationIcon=function(t){t&&t.length!==0&&n.Common.forguncyPost("WorkflowApi/GetNotificationNum",null,function(n,i){var f,u,r;if(n!=null)for(f=Number(n),u=t.parent(),t.text(f),f>0?t.css("display","inline"):t.css("display","none"),r=0;r<u.length;r++)$(u[r]).data("allowNavigate")&&(f>0?$(u[r]).css("cursor","pointer"):$(u[r]).css("cursor",""))},"GetNotificationNum")},t._createLoginLink=function(t,i,r){var u=n.DomUtilities.createJqueryDomElement("a");return u.attr("href","#"),u.attr("id",i.ID+"_login"),u.text(n.RS.login),n.DomUtilities.setPropertyToDom(t,u,r,[0,1]),u=n.DomUtilities.createAlignmentContainer(u,t.StyleInfo.HorizontalAlignment,t.StyleInfo.VerticalAlignment,t.Height),n.DomUtilities.createNavigateCommand(u,n.BuiltInPageManager.builtInPages[n.BuiltInPageType.Login],i.ID+"login",i),u},t._setVerticalAlign=function(t,i){t.css("vertical-align",n.DomUtilities.getVerticalAlignmentText(i))},t._setHorizonalAlign=function(t,i){i===n.CellHorizontalAlignment.Center?t.css("margin","auto"):i===n.CellHorizontalAlignment.Right&&t.css("margin-left","auto")},t._createPopupDropdownArrow=function(i,r){var f=n.DomUtilities.createJqueryDomElement("td"),u=$("<span class='caret'><\/span>");u.attr("currentUserDropDownButton","show");u.css("height",4);u.css("margin",4);i.StyleInfo&&typeof i.StyleInfo.Foreground!="undefined"&&u.css("color",n.ColorHelper.Convert(i.StyleInfo.Foreground));f.append(u);t._setVerticalAlign(f,i.StyleInfo.VerticalAlignment);r.append(f)},t._createNoificationIcon=function(){var t=n.DomUtilities.createJqueryDomElement("span");return t.addClass("fgc-notification-icon"),t.css("font-family",n.LocaleFonts.default),t},t}();n.CurrentUserCellTypeBuilder=t;n.CellTypeHelper.registerCellType("Forguncy.CurrentUserCellType, Forguncy",i)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var u="label",t="div",k="processCellTypeTargetTable",e="FontInfo",o="cellTypeInfo",s="getUsersResult",h="GetHistoryResult",c="1px solid rgb(160, 160, 160)",l="_changeAssigneeBtn",a="_stateBtn",d="_createBy",g="_modifyBy",nt="_action_",v="_assignTo",tt="_nextStatus",y="_comment",it="_ok",rt="_cancel",ut="_assignToTitle",p="_assignee_",ft="_radio_assignee_",et="_history",ot="_row_",st="_operator",ht="_time",ct="_action",lt="_td",at="_endStatus",vt="3F47E3C5-01F5-41D3-AEDC-0F20EC5C560F",r="version",yt="_ActionPopup",pt="_HistoryPopup",wt="_AssignToPopup",bt="_ActionDiv",w="_AssigneeDiv",b=function(b){function kt(){return b!==null&&b.apply(this,arguments)||this}return __extends(kt,b),kt.prototype.needValidate=function(){return!1},kt.prototype.createContent=function(){return this.createProcessBarCellType(this.CellElement,this.isInListview)},kt.prototype.onWindowResized=function(){n.Platform.isMobile()||i.closePopup()},kt.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID+",#"+this.ID+" label")},kt.prototype._disable=function(n){var t=n.find("button");t.attr("disabled","disabled");t.css("cursor","default")},kt.prototype._enable=function(){var n=$("#"+this.ID).find("button");n.removeAttr("disabled");n.css("cursor","pointer")},kt.prototype._getVisibleParts=function(n){return n.find("button")},kt.prototype.onCurrentRowInfoChanged=function(n){this.CellElement.CellType.TableName===n&&this.refresh($("#"+this.ID))},kt.prototype.createProcessBarCellType=function(i,r){var h=this,f=n.DomUtilities.createJqueryDomElement(t),u,s;return f.attr("id",this.ID),u={},u.StyleInfo={},u.StyleInfo.FontWeight=i.StyleInfo.FontWeight,u.StyleInfo.FontFamily=i.StyleInfo.FontFamily,u.StyleInfo.FontSize=i.StyleInfo.FontSize,u.StyleInfo.Foreground=n.ColorHelper.Convert(i.StyleInfo.Foreground),u.StyleInfo.Underline=i.StyleInfo.Underline,u.StyleInfo.FontStyle=i.StyleInfo.FontStyle,u.StyleInfo.Strikethrough=i.StyleInfo.Strikethrough,u.StyleInfo.Underline=i.StyleInfo.Underline,n.DomUtilities.setPropertyToDom(u,f,h._getDomCreateInfo(),[0]),delete u.StyleInfo.Foreground,f.data(e,u),s=i.CellType,f.attr(k,s.TableName),f.data(o,s),i.CellType.TabIndex&&n.ForguncyData.pageInfo.enableTabIndex&&f.data("tabindex",i.CellType.TabIndex),n.DomUtilities.createAlignmentContainer(f,null,i.StyleInfo.VerticalAlignment,i.Height)},kt.prototype.getBindingTables=function(){var n=this.CellElement.CellType;return[n.TableName]},kt.prototype.reload=function(n){if(n){var t=$("#"+this.ID);this.refresh(t)}},kt.prototype.refresh=function(t){var f=n.Common.getUniqueNumber(),i,u,e;if(t.data(r,f),!n.ForguncyData.userInfo.UserName){t.empty();return}if(i=t.data(o),u=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(i.TableName),!u||!u.query){t.empty();return}e=this;n.Common.forguncyPost("WorkflowApi/GetWorkflowInfo",{currentInfo:JSON.stringify(u),needEditStatusInfo:i.ShowCreateBy||i.ShowModifyBy,needRecordInfo:i.ShowCurrentSate||i.ShowCurrentAssignTo},function(n){n&&t.data(r)===f&&e._createProcessBarByWorkflowInfo(t,i,n)},"GetWorkflowInfo"+this.ID)},kt.prototype._createProcessBarByWorkflowInfo=function(i,r,u){var f=this,s=i.data("tabindex"),h=i.data(e),o=n.DomUtilities.createJqueryDomElement(t),c=JSON.parse(u.EditStatusInfo);i.data("creator",u.Creator);i.data("lastModifier",u.LastModifier);f._createCreatorInfoPart(r,c,o);f._createModifierInfoPart(r,c,o);f._createStateButton(r,u,o,h,s);f._createCurrentAssignToPart(r,u,o,h,s);f._createActionButtonPart(r,u,o,h,s);i.empty();i.append(o);f.isEnabled||f._disable(i);f.isVisible()||f._setVisible(f.getContainer(),!1)},kt.prototype._createCreatorInfoPart=function(t,i,r){if(t.ShowCreateBy&&i.CreateDate){var f=n.DomUtilities.createJqueryDomElement(u);f.attr("id",this.ID+d);f.css("margin","5px 2px");f.append(n.Common.format(n.RS.ProcessBarCell_CreateBy,kt._getNameText(i.Creator),kt._getDateString(i.CreateDate)));f.css("float","right");f.css("clear","right");r.append(f)}},kt.prototype._createModifierInfoPart=function(t,i,r){if(t.ShowModifyBy&&i.LastModifyDate){var f=n.DomUtilities.createJqueryDomElement(u);f.attr("id",this.ID+g);f.css("margin","5px 2px");f.text(n.Common.format(n.RS.ProcessBarCell_LastModifyBy,kt._getNameText(i.LastModifier),kt._getDateString(i.LastModifyDate)));f.css("float","right");f.css("clear","right");r.append(f)}},kt.prototype._createStateButton=function(t,i,r,u,f){var o=this,e;if(t.ShowCurrentSate){if(e=o._createButton(n.Common.format(n.RS.ProcessBarCell_Status,i.RecordInfo.State),t.ShowHistory,u,!t.ShowHistory,f),e.attr("id",this.ID+a),t.ShowHistory)e.on("click",function(){return o._onStateButtonClick(t.TableName,u),!1});e.css("float","right");e.css("clear","right");t.ShowActionButton&&e.css("margin-bottom","2px");r.append(e)}},kt.prototype._createCurrentAssignToPart=function(t,i,r,u,f){var y=this,l,e,h,o,a,c,s;if(t.ShowCurrentAssignTo&&(l=!1,e=i.RecordInfo.AssignTo,e&&e.length>0&&(l=kt._isAssignToMe(e),!l||e.length>1))){if(h="",l)h=n.RS.ProcessBarCell_AssignedTo_me;else for(o=0;o<e.length;o++)if(e[o].FullName!==undefined&&e[o].FullName!==null){h=String(e[o].FullName||e[o].UserName);break}a="";c=!1;e.length>1?(c=!0,a=n.RS.ProcessBarCell_AssignedTo+": "+n.Common.format(n.RS.ProcessBarCell_AssignedToMultiUser,h,e.length-1)):a=n.RS.ProcessBarCell_AssignedTo+": "+h;s=y._createButton(a,c,u,!c,f);c&&s.click(function(){return y._showAssignToPopup(s,e,u),!1});s.attr("id",this.ID+v);s.css("float","left").css("margin-bottom","2px");r.append(s)}},kt.prototype._createActionButtonPart=function(i,r,u,f,e){var h=this,o=n.DomUtilities.createJqueryDomElement(t),c,s,a,v;if(o.attr("id",this.ID+bt),c=h._createActionButton(o,i,r,f,e),r.IsAdminOrAllowPermission){s=h._createStyledButtonOrLink(null,n.RS.ProcessBarCell_ChangeAssignee,f,e);kt._notOnlyHasActionButton(i)&&s.css("margin-bottom","2px");s.attr("id",h.ID+l);s.on("click",function(){return h._onChangeAssigneeButtonClick(i.TableName,f,r.RecordInfo.AssignTo),!1});o.append(s);c=!0}c&&(o.css({float:"left",clear:"left",display:"flex","flex-wrap":"wrap","align-items":"center"}),u.append(o),o.children().length>0&&(a=o.children().first(),v=o.children().last(),a.css("margin-left",0),v.css("margin-right",0)))},kt._notOnlyHasActionButton=function(n){return n.ShowCreateBy||n.ShowCurrentAssignTo||n.ShowCurrentSate||n.ShowHistory||n.ShowModifyBy},kt.prototype._createActionButton=function(t,i,r,u,f){var s=this,a=!1,o;if(i.ShowActionButton)for(o=0;o<r.PossibleAction.length;o++){var h=r.PossibleAction[o],e=null,c=h.Action.ActionName===""?" ":h.Action.ActionName,l=kt._getActionButtonMergedStyle(i,c);if(l){if(!l.Visible)continue;e=s._createStyledButtonOrLink(l,c,u,f)}else e=s._createButton(c,!1,u,!1,f);kt._notOnlyHasActionButton(i)&&e.css("margin-bottom","2px");e.attr("id",s.ID+nt+o.toString());e.possibleAction=h,function(t,i,r){t.on("click",function(){return s._showChangeStatePopup(t,t.possibleAction,i,n.RS.ProcessBarCell_ActionPopup_Title,!0,r,u,null),!1})}(e,i.TableName,i.AllowEditComments);t.append(e);a=!0}return a},kt._getActionButtonMergedStyle=function(n,t){var u,i,r;return n.ActionButtonStyleInfo?(u=n.ActionButtonStyleInfo.CommonStyle,kt._addDefaultColor(u),i=null,n.ActionButtonStyleInfo.SpecialStyleMap&&(i=n.ActionButtonStyleInfo.SpecialStyleMap[t]),!u)?(i&&kt._addDefaultColor(i),i):i?(r=$.extend(!0,{},u),kt._addDefaultColor(i),i.IsDefaultSize||(r.IsDefaultSize=!1,r.Width=i.Width,r.Height=i.Height),r.Visible=i.Visible,i.IsDefaultGap||(r.IsDefaultGap=!1,r.Gap=i.Gap),i.IsDefaultFont||(r.IsDefaultFont=!1,r.FontFamily=i.FontFamily,r.FontSize=i.FontSize,r.FontWeight=i.FontWeight,r.FontStyle=i.FontStyle,r.IsUnderline=i.IsUnderline,r.IsStrikeThrough=i.IsStrikeThrough),i.IsDefaultColor||(r.IsDefaultColor=!1,r.ForegroundColor=i.ForegroundColor,r.BackgroundColor=i.BackgroundColor),i.IsDefaultBorder||(r.IsDefaultBorder=!1,r.BorderColor=i.BorderColor,r.BorderWidth=i.BorderWidth),r.DisplayType=i.DisplayType,i.CssClassName&&(r.CssClassName=i.CssClassName),r):u:null},kt._addDefaultColor=function(n){n.ForegroundColor||(n.ForegroundColor="#000");n.BackgroundColor||(n.BackgroundColor="#d3d3d3");n.BorderColor||(n.BorderColor="#000")},kt.prototype._createStyledButtonOrLink=function(t,i,r,u){var s=this;t||(t={DisplayType:f.ShowAsButton,IsDefaultBorder:!0,IsDefaultColor:!0,IsDefaultFont:!0,IsDefaultGap:!0,IsDefaultSize:!0});var h=t.DisplayType==f.ShowAsButton,o=null,c=null,e=null;return e=h?n.DomUtilities.createJqueryDomElement("button"):n.DomUtilities.createJqueryDomElement("a"),e.css("display","flex").css("justify-content","center").css("align-items","center").css("vertical-align","bottom").css("box-sizing","border-box").css("cursor","pointer").css("overflow","hidden").css("margin","0 2px"),n.Platform.isMobile()?e.addClass("mobileButtonStyle"):e.css("padding","1px 6px"),o=n.DomUtilities.createJqueryDomElement("span"),n.DomUtilities.setPropertyToDom(r,o,s._getDomCreateInfo(),[0]),o.text(i),e.append(o),u!==undefined&&e.attr("tabindex",u),n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.moveFocusByEnter&&e.attr("type","button"),t.IsDefaultSize||(t.Width>0&&e.css("width",t.Width+"px"),t.Height>0&&e.css("height",t.Height+"px")),!t.IsDefaultGap&&t.Gap>=0&&e.css("margin-right",t.Gap+"px"),t.IsDefaultFont||(t.FontFamily&&o.css("font-family",t.FontFamily),t.FontSize&&o.css("font-size",t.FontSize),t.FontWeight&&o.css("font-weight",t.FontWeight),t.FontStyle&&o.css("font-style",t.FontStyle),t.IsUnderline&&o.css("text-decoration","underline")),t.IsDefaultColor||(t.ForegroundColor&&e.css("color",n.ColorHelper.Convert(t.ForegroundColor)),t.BackgroundColor&&e.css("background-color",n.ColorHelper.Convert(t.BackgroundColor))),t.IsDefaultBorder||t.BorderColor&&t.BorderWidth&&e.css("border",t.BorderWidth+"px solid "+n.ColorHelper.Convert(t.BorderColor)),t.CssClassName&&e.addClass(t.CssClassName),e},kt.prototype._createButton=function(t,i,r,u,f){var v=this,e=n.DomUtilities.createJqueryDomElement("button"),o,s,h;e.css("margin","auto 2px");n.Platform.isMobile()?e.addClass("mobileButtonStyle"):e.css("padding","1px 6px");o=n.DomUtilities.createJqueryDomElement("table");o.css("border-spacing","0px");var c=n.DomUtilities.createJqueryDomElement("tr"),l=n.DomUtilities.createJqueryDomElement("td"),a=n.DomUtilities.createJqueryDomElement("span");if(n.DomUtilities.setPropertyToDom(r,a,v._getDomCreateInfo(),[0]),a.text(t),l.css("padding","0px"),l.append(a),c.append(l),i&&(s=n.DomUtilities.createJqueryDomElement("td"),h=n.DomUtilities.createJqueryDomElement("span"),h.addClass("caret"),h.css("height","4px"),s.css("padding","0px"),s.append(h),c.append(s)),u){e.css("cursor","default");e.on("click",function(){return!1})}else e.css("cursor","pointer");return o.append(c),e.append(o),f!==undefined&&e.attr("tabindex",f),n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.moveFocusByEnter&&e.attr("type","button"),e},kt._getWorkflowCommand=function(n,t,i,r){return{$type:"WorkflowCommand.WorkflowCommand, WorkflowCommand",ActionGUID:n.Action.GUID,AssignTo:r?r.join(","):"",WorkflowComments:i,TableName:t}},kt.prototype._getCommands=function(t,i,r){var u,f,e;return typeof t=="string"?(!n.Common.IsEmpty(r)&&r.toString()&&(u=r.toString().replace(/\,/g,";"),t=t.replace(new RegExp("%AssignTo%","g"),u)),f=$("#"+this.ID).data("creator"),e=$("#"+this.ID).data("lastModifier"),t=t.replace(new RegExp("%Creator%","g"),f),t=t.replace(new RegExp("%LastModifier%","g"),e),JSON.parse(t)):[]},kt._addTableNameToSendMailCommand=function(n,t){for(var i=0;i<n.length;i++)n[i].$type.indexOf("SendMailCommand")>-1&&(n[i].TableName=t)},kt.prototype._createNextStatePart=function(i,r){var u=n.DomUtilities.createJqueryDomElement(t);u.append(n.RS.ProcessBarCell_ActionPopup_NextStatus);u.css("margin","0px 0px 10px 0px");u.css("font-weight","bold");i.append(u);u=n.DomUtilities.createJqueryDomElement(t);u.attr("id",this.ID+tt);u.append(r.ToSateName);u.css("margin","0px 0px 15px 0px");i.append(u)},kt.prototype._createAssigneePart=function(i,r,u,f){var o=[],e;return r.AssignTo&&r.AssignTo.length>0&&(e=n.DomUtilities.createJqueryDomElement(t),e.attr("id",this.ID+ut),e.css("margin","0px 0px 5px 0px"),e.css("font-weight","bold"),e.append(r.Policy==="Choose"?n.RS.ProcessBarCell_ActionPopup_Assignto_Choose:n.RS.ProcessBarCell_ActionPopup_Assignto_All),i.append(e),e=n.DomUtilities.createJqueryDomElement(t),e.attr("id",this.ID+w),e.css("border-width","0px"),e.css("overflow","auto"),e.css("max-height","150px"),r.Policy==="Choose"?o=this._createChooseModeAssigneePart(e,r,f):this._createAllModeAssigneePart(e,r,u),i.append(e)),o},kt.prototype._createChooseModeAssigneePart=function(i,r,f){for(var s,c,o,h,l=this,a=[],v=n.Common.getUniqueNumber().toString(),e=0;e<r.AssignTo.length;e++)s=n.DomUtilities.createJqueryDomElement(t),n.Platform.isMobile()?e===0?s.css("margin","10px 0px 0px 0px"):s.css("margin","10px 0px 0px 0px"):e===0?s.css("margin","5px 0px 0px 0px"):s.css("margin","5px 0px 5px 0px"),c=l.ID+ft+e.toString(),o=n.DomUtilities.createJqueryDomElement("input"),o.css("margin","0px 0px 3px 0px"),o.css("padding","0px"),o.attr("type","radio"),o.attr("id",c),o.attr("ignoreFocusInPopup","true"),o.val(r.AssignTo[e].UserName),o.attr("name",v),r.Action.GUID===vt?f&&f.length>0?r.AssignTo[e].UserName===f[0].UserName&&o.prop("checked",!0):r.AssignTo[e].UserName||o.prop("checked",!0):e===0&&o.prop("checked",!0),a.push(o),s.append(o),h=n.DomUtilities.createJqueryDomElement(u),h.attr("id",l.ID+p+e.toString()),h.text(kt._getNameText(n.Common.IsEmpty(r.AssignTo[e].FullName)?r.AssignTo[e].UserName:r.AssignTo[e].FullName)),h.attr("for",c),s.append(h),i.append(s);return a},kt.prototype._createAllModeAssigneePart=function(n,t,i){var r=this._getListWithBlackSquare(t.AssignTo,i);n.append(r)},kt.prototype._createCommentPart=function(i,r){var f=n.DomUtilities.createJqueryDomElement(t),u;return f.append(n.RS.ProcessBarCell_ActionPopup_Comments),f.css("margin","15px 0px 10px 0px"),f.css("font-weight","bold"),i.append(f),u=n.DomUtilities.createJqueryDomElement("textarea"),n.DomUtilities.setPropertyToDom(r,u,this._getDomCreateInfo(),[0]),u.attr("id",this.ID+y),u.attr("ignoreFocusInPopup","true"),u.css("margin","0px"),u.css("border",c),u.css("padding","2px"),u.css("resize","none"),u.width(244),u.height(100),i.append(u),u},kt.prototype._showChangeStatePopup=function(i,r,u,f,e,o,s,h){var l=this,c=n.DomUtilities.createJqueryDomElement(t),y,v,a;c.css("white-space","pre-wrap");c.css("padding","10px");c.width(264);y=null;e&&this._createNextStatePart(c,r);v=this._createAssigneePart(c,r,s,h);a=o?this._createCommentPart(c,s):null;l._showPopup(i,c,f,s,l.ID+yt,function(){var t,i;if(r.Policy==="Choose")t=kt._getRadiosValue(v);else for(t=[],i=0;i<r.AssignTo.length;i++)t.push(r.AssignTo[i].UserName);var f=l._getCommands(r.PreCommands,r,t),e=l._getCommands(r.Commands,r,t),o=kt._getWorkflowCommand(r,u,a?a.val():null,t);kt._addTableNameToSendMailCommand(f,u);kt._addTableNameToSendMailCommand(e,u);n.ForguncyData.commandExcutor.excuteCommand(f.concat(o,e),l.runTimePageName,null,null,n.Events.Click)})},kt.prototype._getListWithBlackSquare=function(t,i){var c=this,s=n.DomUtilities.createJqueryDomElement("table"),r,f,e,o,h;for(n.DomUtilities.setPropertyToDom(i,s,c._getDomCreateInfo(),[0]),s.css("white-space","pre-wrap"),r=0;r<t.length;r++)f=n.DomUtilities.createJqueryDomElement("tr"),r===0?f.css("margin","5px 0px 0px 0px"):f.css("margin","5px 0px 5px 0px"),e=n.DomUtilities.createJqueryDomElement("td"),o=n.DomUtilities.createJqueryDomElement("div"),o.width(4),o.height(4),o.css("background-color","black"),e.append(o),f.append(e),e=n.DomUtilities.createJqueryDomElement("td"),h=n.DomUtilities.createJqueryDomElement(u),h.attr("id",c.ID+p+r.toString()),h.text(kt._getNameText(n.Common.IsEmpty(t[r].FullName)?t[r].UserName:t[r].FullName)),e.append(h),f.append(e),s.append(f);return s},kt._getNameText=function(n){return n===undefined||n===null?"":String(n)},kt.prototype._showPopup=function(r,u,f,e,o,s){var v=this,y=n.DomUtilities.createJqueryDomElement(t),w,a,p,h,l;if(n.DomUtilities.setPropertyToDom(e,y,v._getDomCreateInfo(),[0]),w=n.DomUtilities.createJqueryDomElement(t),w.css("margin","5px 2px"),w.append(f),y.append(w),a=n.DomUtilities.createJqueryDomElement(t),a.css("background-color","white"),a.css("border",c),a.css("padding","2px"),a.css("margin","2px"),a.css("border-radius","4px"),a.append(u),y.append(a),s!==undefined){p=n.DomUtilities.createJqueryDomElement(t);p.css("margin","2px");h=n.DomUtilities.createJqueryDomElement("button");h.attr("id",v.ID+it);n.DomUtilities.setPropertyToDom(e,h,v._getDomCreateInfo(),[0]);h.text(n.RS.ProcessBarCell_OK);h.css("margin","2px 2px 2px 0px");h.attr("ignoreFocusInPopup","true");h.on("click",function(){i.closePopup();s()});p.append(h);l=n.DomUtilities.createJqueryDomElement("button");l.attr("id",v.ID+rt);n.DomUtilities.setPropertyToDom(e,l,v._getDomCreateInfo(),[0]);l.text(n.RS.ProcessBarCell_Cancel);l.css("margin","2px");l.attr("ignoreFocusInPopup","true");l.on("click",function(){i.closePopup()});p.append(l);n.Platform.isMobile()&&(h.addClass("mobileButtonStyle"),l.addClass("mobileButtonStyle"));y.append(p)}i.showPopup(r,y,o)},kt.prototype._onStateButtonClick=function(t,i){var u=this,s=$("#"+u.ID).data(r),f=$("#"+u.ID+a),e,o;f.length===1&&(e=f.data(h),e===undefined?(o=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(t),n.Common.forguncyPost("WorkflowApi/GetHistory",{currentInfo:JSON.stringify(o)},function(n){s===$("#"+u.ID).data(r)&&(f.data(h,n),u._showHistoryPopup(f,t,i,n))},"GetHistory "+u.ID)):u._showHistoryPopup(f,t,i,e))},kt.prototype._showHistoryPopup=function(t,r,u,f){i.closePopup();var e=this._createHistoryPopupContent(JSON.parse(f),u);this._showPopup(t,e,n.RS.ProcessBarCell_HistoryPopup_Title,u,this.ID+pt)},kt.prototype._createHistoryPopupContent=function(i,r){var a=this,f=n.DomUtilities.createJqueryDomElement(t),s,e,h,l,o,u,c,p;if(f.css("max-height","300px"),f.css("overflow","auto"),i&&i.length>0){for(s=n.DomUtilities.createJqueryDomElement("table"),s.attr("id",a.ID+et),n.DomUtilities.setPropertyToDom(r,s,a._getDomCreateInfo(),[0]),s.addClass("proceeBarHistoryTable"),e=n.DomUtilities.createJqueryDomElement("tr"),h=r.StyleInfo.FontWeight===n.StaticValues.FontWeight_Bold,kt._addTh(e,n.RS.ProcessBarCell_History_Operator,h),kt._addTh(e,n.RS.ProcessBarCell_History_Time,h),kt._addTh(e,n.RS.ProcessBarCell_History_ActionName,h),kt._addTh(e,n.RS.ProcessBarCell_History_EndStatus,h),kt._addTh(e,n.RS.ProcessBarCell_AssignedTo,h),kt._addTh(e,n.RS.ProcessBarCell_History_Comments,h),s.append(e),l=0;l<i.length;l++)o=i[l],u=n.DomUtilities.createJqueryDomElement("tr"),l%2==1&&u.css("background-color","#fafaf8"),c=a.ID+ot+l.toString(),kt._addTd(u,c+st,kt._getNameText(o.Who),0),kt._addTd(u,c+ht,kt._getDateString(o.When),0),kt._addTd(u,c+ct,o.ActionName,0),kt._addTd(u,c+at,o.State,0),kt._addTd(u,c+v,kt._getAssignToStr(o.AssignTo),0,kt._getAssignToTooltipStr(o.AssignTo)),kt._addTd(u,c+y,o.Comments,200),s.append(u);f.append(s)}else p=n.DomUtilities.createJqueryDomElement(t),p.append(n.RS.None),f.css("min-width","130px"),f.css("text-align","center"),f.css("padding","20px 0px"),f.append(p);return f},kt._getAssignToStr=function(t){if(t&&t.length>0)if(t.length>1){var i=kt._getFistAssigneeNameText(t);return n.Common.format(n.RS.ProcessBarCell_AssignedToMultiUser,i,t.length-1)}else return t[0];return n.RS.None},kt._getFistAssigneeNameText=function(n){if(n&&n.length)for(var t=0;t<n.length;t++)if(n[t]!==undefined&&n[t]!==null)return String(n[t]);return""},kt._getAssignToTooltipStr=function(n){var i,t;if(n&&n.length>0){for(i="",t=0;t<n.length;t++)i+=kt._getNameText(n[t])+(t===n.length-1?"":"\r\n");return i}return null},kt._addTh=function(t,i,r){var u=n.DomUtilities.createJqueryDomElement("th");r||u.css("font-weight","normal");u.text(i);t.append(u)},kt._addTd=function(i,r,u,f,e){var s=n.DomUtilities.createJqueryDomElement("td"),o,h;s.attr("id",r+lt);o=n.DomUtilities.createJqueryDomElement(t);h=n.DomUtilities.createJqueryDomElement("label");h.attr("id",r);h.text(u);o.append(h);f&&o.css("width",f+"px");o.css("max-height","50px");o.css("vertical-align","middle");o.css("overflow-x","hidden");o.css("word-break","break-word");o.css("text-overflow","ellipsis");s.attr("title",e?e:u);s.append(o);i.append(s)},kt.prototype._showAssignToPopup=function(i,r,u){var f=n.DomUtilities.createJqueryDomElement(t),e;f.css("white-space","pre-wrap");f.css("padding","10px");f.css("max-height","200px");f.css("min-width","200px");f.css("overflow","auto");f.attr("id",this.ID+w);e=this._getListWithBlackSquare(r,u);f.append(e);this._showPopup(i,f,n.RS.ProcessBarCell_AssignedToPopup_Title,u,this.ID+wt)},kt.prototype._onChangeAssigneeButtonClick=function(t,i,u){var f=this,h=$("#"+f.ID).data(r),e=$("#"+f.ID+l),o;e.length===1&&(o=e.data(s),o===undefined?n.Common.forguncyPost("Account/GetUsers",{role:"",columns:3,sortedByFullName:!0},function(o){var l,c;h===$("#"+f.ID).data(r)&&o&&o.Result&&(l=o.Properties.users,l&&(c={},c.FullName=n.RS.None,c.UserName=null,l.unshift(c)),e.data(s,o),f._showChangeAssigneePopup(e,t,i,o,u))},"GetUsers "+f.ID):f._showChangeAssigneePopup(e,t,i,o,u))},kt.prototype._showChangeAssigneePopup=function(t,i,r,u,f){var e=u.Properties.users;t.possibleAction={Action:{ActionName:n.RS.ProcessBarCell_ChangeAssignee,GUID:"3F47E3C5-01F5-41D3-AEDC-0F20EC5C560F"},Policy:"Choose",AssignTo:e};this._showChangeStatePopup(t,t.possibleAction,i,n.RS.ProcessBarCell_ChangeAssignee,!1,!0,r,f)},kt._getRadiosValue=function(n){var i=[],t;if(n)for(t=0;t<n.length;t++)n[t][0].checked&&i.push(n[t].val());return i},kt._isAssignToMe=function(t){var r,i;if(t&&t.length>0&&n.ForguncyData.userInfo.UserName)for(r=n.ForguncyData.userInfo.UserName.toLowerCase(),i=0;i<t.length;i++)if(t[i].UserName.toLowerCase()===r)return!0;return!1},kt._getDateString=function(t){return typeof t=="number"?n.FormatHelper.getTextFromValue(n.Convertor.fromOADateToDate(t)):n.FormatHelper.getTextFromValue(t)},kt.prototype.destroy=function(){i.closePopup();b.prototype.destroy.call(this)},kt}(n.CellTypeBase),f,i;n.ProcessBarCellType=b,function(n){n[n.ShowAsButton=0]="ShowAsButton";n[n.ShowAsHyperLink=1]="ShowAsHyperLink"}(f||(f={}));i=function(){function t(){}return t.showPopup=function(i,r,u){var l=$(document.body),s=n.Common.getPageConver("#FFF",.01),f,e,h,c,o,a;s.attr("FGCPopup","true");s.css("z-index",-1);f=n.DomUtilities.createJqueryDomElement("div");e=n.DomUtilities.createJqueryDomElement("div");e.css("padding",5);e.css("background-color","#e0e0e0");e.css("border","1px solid #a0a0a0");e.css("border-radius","4px");f.css("overflow","auto");f.css("position","absolute");f.css("z-index","100");f.attr("id",u);h=t._createIndicator(!0);f.append(h);e.append(r);f.append(e);c=t._createIndicator(!1);f.append(c);l.append(s);l.append(f);f.attr("FGCPopup","true");o=i.offset();/webkit.*mobile/i.test(navigator.userAgent)&&!/iPhone|iPad/i.test(navigator.userAgent)&&n.ForguncyData.pageInfo.allowZoomScreen&&(o.top=o.top-window.scrollY,o.left=o.left-window.scrollX);a={x:o.left,y:o.top,width:i.outerWidth(),height:i.outerHeight()};t._updatePosition(f,h,c,a);n.DelayRefresh.setTimeout(function(){s.css("z-index",99)},0);f.on("click",function(n){return!0});s.on("click",function(n){t.closePopup()})},t._updatePosition=function(n,i,r,u){var c=$(window).outerWidth(),a=$(window).outerHeight(),f=n.outerWidth(),e=t._setLeft(n,f,u,c),s,h,o,l;f=n.outerWidth();(e>u.x+u.width-20||e+f<u.x+20)&&(e=t._setLeft(n,f,u,c));s=Math.ceil(n.outerHeight())+10;t._isPopupPlaceDown(a,s,u)?(h=u.y+u.height+i.outerHeight(),$(n.children()[1]).css("margin-top",10),o=i):(h=Math.floor(u.y-s),n.css("padding-bottom",10),o=r);n.css("top",h);o.css("display","");l=n.outerWidth()-30;o.css("margin-left",Math.min(l,u.x-e+u.width/3-10))},t._setLeft=function(n,t,i,r){var u=i.x+(i.width-t)/3,f=$(document).scrollLeft();return u=Math.min(u,r-t-10+f),u=Math.max(f,u),n.css("left",u),u},t._isPopupPlaceDown=function(n,t,i){return n-(i.y+i.height-window.pageYOffset)>t||i.y-window.pageYOffset<t},t._createIndicator=function(i){var u=n.DomUtilities.createJqueryDomElement("div"),f,r;return i?u.css("top",1):u.css("margin-top",-1),t._setArrowProperty(u,"#e0e0e0",i),f=n.DomUtilities.createJqueryDomElement("div"),t._setArrowProperty(f,"#a0a0a0",i),r=n.DomUtilities.createJqueryDomElement("div"),r.append(f),r.append(u),r.css("display","none"),r},t._setArrowProperty=function(n,t,i){n.width(0);n.height(0);n.css(i?"border-bottom":"border-top","10px solid "+t);n.css("border-left","10px solid transparent");n.css("border-right","10px solid transparent");n.css("position","absolute")},t.closePopup=function(){var n=$("[FGCPopup]");n.off("click");n.remove()},t}();n.CellTypeHelper.registerCellType("Forguncy.ProcessBarCellType, Forguncy",b)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.createSingleItemToggle=function(t,i){var u=this.CellElement.CellType,r=new n.DefaultCheckBox(t);return r.foreColor=i,r.primaryColor=n.ColorHelper.Convert(u.PrimaryColor),r.secondaryColor=n.ColorHelper.Convert(u.SecondaryColor),r},i.prototype.createSingleItemUI=function(t){var r=this.CellElement.CellType,i=n.SystemCheckBoxUI;return r.Style===1?i=n.ModernCheckBoxUI:r.Style===2?i=n.SwitchCheckBoxUI:r.Style===3&&(i=n.GroupButtonCheckBoxUI),t.createUI(i)},i.prototype.setValueToUIInternal=function(t,i,r,u){var o=u?u.toString().split(","):null,s=null,h,c,e,f;if(o){for(h=o.length-1,e=h;e>=0;e--)o[e]=n.Common.trimStr(o[e]);for(f=0;f<r.length;f++){if(typeof r[f]!="string")if(n.Common.IsEmpty(r[f]))continue;else u=r[f]+"";else u=n.Common.trimStr(r[f]);if(c=!1,o)for(e=h;e>=0;e--)if(o[e]===u){c=!0;break}s=i[f];s.checked=c;$(s).trigger("change")}}else for(f=0;f<r.length;f++)typeof r[f]!="function"&&(s=i[f],s.checked=!1,$(s).trigger("change"))},i.prototype.getValueInternal=function(t,i){for(var u,e,o=i.length,r="",f=0;f<o;f++)t[f].checked&&(u=i[f],typeof u=="function"?u()&&(r.length>0&&(r+=","),r+=u()):(r.length>0&&(r+=","),e=n.Common.IsEmpty(u)?"":u.toString(),r+=e));return n.Common.IsEmpty(r)?null:r},i.prototype.getOtherValue=function(n,t){var r,f,i,u;if(this.containsOtherItem()&&t)for(r=t.toString().split(","),f=function(t){var i=(r[t]+"").trim(),u=!1;return $(n).each(function(){if((this||this===0)&&(this+"").trim()===i)return u=!0,!1}),u?void 0:{value:i}},i=0;i<r.length;i++)if(u=f(i),typeof u=="object")return u.value},i.prototype.allowFormatValue=function(){return!1},i.prototype.getListviewNoneEditModeText=function(n,i,r){for(var f=this.getValuesToFormat(n),e=[],u=0;u<f.length;u++)e.push(t.prototype.getListviewNoneEditModeText.call(this,f[u],null,r));return e.join(",")},i.prototype.getValuesToFormat=function(t){var s=[],u=this.CellElement.CellType,f,l,e,o,h,c,i,r;if(!n.Common.IsEmpty(t)&&u.haveLoadItems&&u.ItemsInfo&&(f=t.toString().split(","),f)){for(l="",e=u.ItemsInfo.Items,o=0;o<f.length;o++)for(i=e.length-1;i>=0;i--)e[i].Value==f[o]&&s.push(e[i].DisplayValue);if(this.containsOtherItem()){for(h=[],c=u.ItemsInfo.Items,i=0;i<c.length;i++)h.push(c[i].Value);r=this.getOtherValue(h,t);n.Common.IsEmpty(r)||(r=r+"",r!=""&&s.push(r))}}return s},i.prototype.getEnsuredValueAfterItemsChanged=function(t,i,r){var o=!1,s=[],h,f,u,e,c;if(n.Common.IsEmpty(i))return null;for(f=i.toString().split(","),u=0;u<f.length;u++){for(o=!1,e=0;e<t.length;e++)if(c=t[e],typeof t[e]=="function"&&(c=t[e]()),n.Common.isEquals(c,f[u])){o=!0;s.push(f[u]);break}o||u!==f.length-1||(h=f[u])}return r?(n.Common.IsEmpty(h)||s.push(h),i=s.join(",")):i=s.join(","),o||r?i:null},i}(n.GroupCellTypeBase);n.CheckBoxGroupCellType=t;n.CellTypeHelper.registerCellType("Forguncy.CheckBoxGroupCellType, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var o=function(t){function o(){return t!==null&&t.apply(this,arguments)||this}return __extends(o,t),o.prototype.createSingleItemToggle=function(t,r){var f=this.CellElement.CellType,u=new i(t);return u.foreColor=r,u.primaryColor=n.ColorHelper.Convert(f.PrimaryColor),u.secondaryColor=n.ColorHelper.Convert(f.SecondaryColor),u},o.prototype.createSingleItemUI=function(n){var i=this.CellElement.CellType,t=r;return i.Style===1?t=u:i.Style===2?t=f:i.Style===3&&(t=e),n.createUI(t)},o.prototype.setValueToUIInternal=function(t,i,r,u){for(var e,f=0;f<r.length;f++)e=i[f],e.checked=n.Common.isEquals(r[f],u),$(e).trigger("change")},o.prototype.getValueInternal=function(n,t){for(var r,u=t.length,i=0;i<u;i++)if(n[i].checked)return r=t[i],typeof r=="function"?r():r;return null},o.prototype.getOtherValue=function(t,i){var u,r,f;if(this.containsOtherItem()){for(u=n.Common.IsEmpty(i)?"":i.toString(),r=0;r<t.length;r++)if(f=n.Common.IsEmpty(t[r])?"":t[r].toString(),u===f)return;return i}},o.prototype.getListviewNoneEditModeText=function(n,i,r){return n=this.getValueToFormat(n),t.prototype.getListviewNoneEditModeText.call(this,n,i,r)},o.prototype.getValueToFormat=function(n){var r=this.CellElement.CellType,i,t;if(r.haveLoadItems&&r.ItemsInfo)for(i=r.ItemsInfo.Items,t=0;t<i.length;t++)if(i[t].Value==n)return i[t].DisplayValue;return this.containsOtherItem()?n:""},o.prototype.getEnsuredValueAfterItemsChanged=function(t,i,r){var f,u,e;if(n.Common.IsEmpty(i))return null;if(r)return i;for(f=!1,u=0;u<t.length;u++)if(e=t[u],typeof t[u]=="function"&&(e=t[u]()),n.Common.isEquals(e,i)){f=!0;break}return f===!0?i:null},o}(n.GroupCellTypeBase),i,t,r,u,f,e;n.RadioGroupCellType=o;i=function(n){function i(r){var u=n.call(this,r)||this;return u.defaultUI=t,u.styleId=(i.count++).toString(),u.registProperty("styleId"),u.registProperty("foreColor"),u.registProperty("primaryColor"),u.registProperty("secondaryColor"),u}return __extends(i,n),i.count=0,i}(n.UI.Radio);n.DefaultRadio=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"styleId",{set:function(n){this.container.attr("styleid",n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"foreColor",{set:function(n){this.textContainer.css("color",n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraCssName",{get:function(){return""},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(){n.prototype.createContainer.call(this);this.container.addClass(this.extraCssName)},t}(n.UI.RadioUI);n.DefaultRadioUI=t;r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"extraCssName",{get:function(){return"fgc-radio-system"},enumerable:!0,configurable:!0}),t}(t);n.SystemRadioUI=r;u=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"fgc-radio-modern"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.innerContainer.css("color",t);var i='.FUI-radio[styleId="'+this.target.styleId+'"].FUI-checked.FUI-focus > .FUI-toggle-inner';this.container.append("<style>"+i+"{box-shadow: 0 0 3px 2px "+n.ColorHelper.UpdateTint(t,0,128)+"}<\/style>")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){this.container.append('<style>.FUI-radio[styleid="'+this.target.styleId+'"] >.FUI-toggle-inner::after{background-color:'+n+" !important}<\/style>")},enumerable:!0,configurable:!0}),i}(t);n.ModernRadioUI=u;f=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"fgc-toggle-switch"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.innerContainer.css("color",t);var i='.FUI-radio[styleId="'+this.target.styleId+'"].FUI-focus > .FUI-toggle-inner';this.container.append("<style>"+i+"{box-shadow: 0 0 3px 2px "+n.ColorHelper.UpdateTint(t,0,128)+"}<\/style>")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){this.container.append('<style>.FUI-radio[styleid="'+this.target.styleId+'"] > .FUI-toggle-inner::after{color:'+n+" !important}<\/style>")},enumerable:!0,configurable:!0}),i}(t);n.SwitchRadioUI=f;e=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"fgc-toggle-button fgc-toggle-groupbutton"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{set:function(t){n.Common.IsEmpty(t)?this.textContainer.text(" "):this.textContainer.text(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.container.css("color",t);var i='.FUI-radio[styleId="'+this.target.styleId+'"].FUI-checked.FUI-focus';this.container.append("<style>"+i+"{box-shadow: 0 0 3px 2px "+n.ColorHelper.UpdateTint(t,0,128)+"}<\/style>")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){this.container.append('<style>.FUI-radio[styleid="'+this.target.styleId+'"].FUI-checked > .FUI-toggle-text{color:'+n+" !important}<\/style>")},enumerable:!0,configurable:!0}),i}(t);n.ButtonRadioUI=e;n.CellTypeHelper.registerCellType("Forguncy.RadioGroupCellType, Forguncy",o)}(Forguncy||(Forguncy={})),function(n){var t;(function(t){var i=function(){function t(){}return t.setStretch=function(n,i,r){var s=r.StretchMode,u=r.MainPartWidth,f=r.MainPartHeight,e=i.Left,o=i.Top,h=i.Height,c=i.Width,l=t.canHorizontallyStretch(s),a=t.canVerticallyStretch(s);l&&u>0?(n.css("left",e===0?0:e*100/u+"%"),n.css("width",c*100/u+"%")):(n.css("width",c),n.css("left",e));a&&f>0?(n.css("height",h*100/f+"%"),n.css("top",o===0?0:o*100/f+"%")):(n.css("height",h),n.css("top",o))},t.adjustCell=function(n,i,r){if(r){var e=r.StretchMode,u=r.MainPartWidth,f=r.MainPartHeight;switch(e){case 1:t._adjustStretchWidth(n,i,u);break;case 2:t._adjustStretchHeight(n,i,f);break;case 3:case 5:case 4:t._adjustStretchWidth(n,i,u);t._adjustStretchHeight(n,i,f);break;default:break}}},t.adjustTable=function(n,i,r){t.adjustCell(n,i,r)},t.adjustCellContainer=function(n,i,r,u,f){var s,e,o,h;i&&(s=t.canHorizontallyStretch(i.StretchMode),e=i.MainPartWidth,s&&e>0?(o=r*100/e,o-99>0&&n.attr("full-overflow","true"),n.css("width",o+"%"),f&&(h=u*100/e,n.css("left",h+"%"))):(n.css("width",r),f&&n.css("left",u)))},t.adjustCellContent=function(n,i,r,u,f,e){var o;if(r){var s=r.StretchMode,h=r.MainPartWidth,c=t.canHorizontallyStretch(s),l=t.canVerticallyStretch(s);l&&n.css("height","100%");o=e&&h>0?h:i.LeftOverflowSpace+i.RightOverflowSpace+i.Width;c&&o>0?(n.css("width",100*u/o+"%"),n.css("left",100*f/o+"%")):(n.css("width",u),n.css("left",f))}},t.adjustBackColorDiv=function(n,i,r,u){var f;if(r){var e=r.MainPartWidth,o=r.StretchMode,s=t.canHorizontallyStretch(o);s&&(f=u?e:i.LeftOverflowSpace+i.RightOverflowSpace+i.Width,f>0&&n.css("margin-left",100*i.LeftOverflowSpace/f+"%"))}},t.canHorizontallyStretch=function(n){return n===1||n===3||n===4||n===5},t.canVerticallyStretch=function(n){return n===2||n===3||n===4||n===5},t.storePageLoadedPageInfo=function(i){n.PageManager.whetherExistPageStretch(i.pageStretchInfos)&&!t._previousPageId&&(t._previousPageId=i.pageID)},t.resizeStoredPages=function(){if(t._previousPageId){var i=n.ForguncyData.pageInfoStack.filter(function(n){return n.pageID===t._previousPageId});i.length>0&&(i[0].pageElementManager.resizePageElements(),t._previousPageId=0)}},t._adjustStretchHeight=function(n,t,i){var r,u,f,e,o;i&&(r=t.ExtendHeight,r&&(u=t.Top,f=t.Height,u-=r,f+=r,e=100*u/i,o=100*f/i,n.css("top","calc("+e+"% + "+r+"px)"),n.css("height","calc("+o+"% - "+r+"px)")))},t._adjustStretchWidth=function(n,t,i){var r,u,f,e,o;i&&(r=t.ExtendWidth,r&&(u=t.Left,f=t.Width,u-=r,f+=r,e=100*u/i,o=100*f/i,n.css("left","calc("+e+"% + "+r+"px)"),n.css("width","calc("+o+"% - "+r+"px)")))},t._popupPagesInPageLoadedCommand=[],t}();t.Common=i})(t=n.Stretch||(n.Stretch={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(n){var t=function(){function n(){}return n.adjust=function(t,i,r){var e=i.StretchMode,u=i.MainPartWidth,f=i.MainPartHeight;switch(e){case 1:u>0&&(n._calcBorderTop(t,r,u),n._adjustLeftMostBorder(t,r,u));break;case 2:f>0&&(n._calcBorderLeft(t,r,f),n._adjustBottomMostBorder(t,r,f));break;case 3:case 4:case 5:u>0&&(n._calcBorderTop(t,r,u),n._adjustLeftMostBorder(t,r,u));f>0&&(n._calcBorderLeft(t,r,f),n._adjustBottomMostBorder(t,r,f));break;case 0:default:break}},n._calcBorderLeft=function(t,i,r){if(i.Position==="border-left"){var u=n._calcStretchedBorderHeight(i,r);t.css("height",u)}},n._calcBorderTop=function(t,i,r){if(i.Position==="border-top"){var u=n._calcStrectedBorderWidth(i,r);t.css("width",u)}},n._adjustLeftMostBorder=function(n,t,i){t.Position==="border-left"&&t.Left===i&&(n.css("left","calc(100% - "+t.BorderWidth+"px)"),n.css("width",0))},n._adjustBottomMostBorder=function(n,t,i){t.Position==="border-top"&&t.Top===i&&(n.css("top","calc(100% - "+t.BorderWidth+"px)"),n.css("height",0))},n._calcStrectedBorderWidth=function(t,i){var f=t.Width,r=t.ExtendWidth,e=t.Left,u;return(r===undefined&&(r=0),u=(f-r)*100/i,n._isBorderTopAtRightMost(e,f,i))?u+"%":"calc("+u+"% + "+r+"px)"},n._isBorderTopAtRightMost=function(n,t,i){return n+t>=i},n._isBorderLeftAtBottomMost=function(n,t,i){return n+t>=i},n._calcStretchedBorderHeight=function(t,i){var f=t.Height,e=t.Top,r=t.ExtendHeight,u;return(r===undefined&&(r=0),u=(f-r)*100/i,n._isBorderLeftAtBottomMost(e,f,i))?u+"%":"calc("+u+"% + "+t.ExtendHeight+"px)"},n}();n.Border=t})(t=n.Stretch||(n.Stretch={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(t){var r=function(){function n(){}return n.adjustMainDiv=function(t,i,r,u){switch(i){case 1:t.css("width","100%");t.css("min-width",r);t.css("height",u);break;case 2:t.css("width",r);t.css("height","100%");t.css("min-height",u);break;case 3:t.css("width","100%");t.css("min-width",r);t.css("height","100%");t.css("min-height",u);break;case 4:t.css("width","100%");t.css("min-width",r);t.css("height","0");t.css("padding-bottom",n._calcPaddingBottomRatio(r,u)+"%");break;case 0:default:t.css("width",r);t.css("height",u);break}},n.adjustPagesContainer=function(n,i,r){var u=t.Common.canVerticallyStretch(i.StretchMode);u&&n.css("min-width",r)},n.adjustCurrentForm=function(n,i){var r=t.Common.canVerticallyStretch(i.StretchMode);r&&n.css("height","100%")},n.adjustCurrentPageContainer=function(n,i,r){var u=t.Common.canVerticallyStretch(r.StretchMode);u&&(n.css("height","100%"),i.css("height","100%"))},n._calcPaddingBottomRatio=function(n,t){return n>0?100*t/n:100},n}(),i;t.Layout=r;i=function(){function t(){}return t.getStretchMode=function(i){switch(i){case 0:return n.ForguncyData.GlobalSettings.PageResponsiveMode==0?0:t.getStretchMode(n.ForguncyData.GlobalSettings.PageResponsiveMode);case 4:return 3;case 2:return 1;case 3:return 2;case 5:return 4;default:return 0}},t.getPageResponsiveMode=function(n){switch(n){case 3:return 4;case 1:return 2;case 2:return 3;case 4:return 5;default:return 1}},t}();t.Helper=i})(t=n.Stretch||(n.Stretch={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(n){var t=function(){function n(){}return n.adjust=function(n,t){var i=t.StretchMode;(i===1||i===3)&&n.css("overflow-x","hidden")},n}();n.Placeholder=t})(t=n.Stretch||(n.Stretch={}))}(Forguncy||(Forguncy={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var o=function(){function r(){}return Object.defineProperty(r,"pagesContainer",{get:function(){return $("#pagesContainer")},enumerable:!0,configurable:!0}),Object.defineProperty(r,"pageCover",{get:function(){return $("#pageCover")},enumerable:!0,configurable:!0}),Object.defineProperty(r,"pageLoadingCover",{get:function(){return $("#pageLoadingCover")},enumerable:!0,configurable:!0}),Object.defineProperty(r,"pageLoadingText",{get:function(){return $("#pageLoadingText")},enumerable:!0,configurable:!0}),r.hidePageLoadingCover=function(){var n,t;(t=(n=r)===null||n===void 0?void 0:n.pageLoadingCover)===null||t===void 0?void 0:t.hide()},r.showPageLoadingCover=function(n){var t,i,u,f;(i=(t=r)===null||t===void 0?void 0:t.pageLoadingCover)===null||i===void 0?void 0:i.css("background-color",n!==null&&n!==void 0?n:this.DefaultLoadingCoverColor);(f=(u=r)===null||u===void 0?void 0:u.pageLoadingCover)===null||f===void 0?void 0:f.show()},r.init=function(){var t=this;$(document).on("initPageData",function(){n.PageBuilder.OnRowCountChanged()});$(document).on("click",function(n){var u,t,i,r,f;if(n.clientX&&n.clientY&&$(n.target).closest(".penetrable").length!==0&&(u=document.elementsFromPoint||document.msElementsFromPoint,t=u.call(document,n.clientX,n.clientY),t))for(i=0;i<t.length;i++)if(r=$(t[i]),f=r.closest(".penetrable"),f.length<1){r.closest("[fgc-gui='isBgImg']").triggerHandler("click");r.closest("[fgc-gui='isImg']").triggerHandler("click");break}});f.disablePageZoom();n.PageBuilder._addWindowResizeListener();n.MetadataLoader.GetMetaDataResult(function(r){var u=i.createPageMetadata(r,!1);t.applyGlobalFontFamilyAndTextColor();n.PageBuilder.createPage(u,n.Common.getPageContext())});$(window).on("popstate",function(t){if(t.originalEvent.state){var i=t.originalEvent.state;if(i.pageName===n.ForguncyData.pageInfo.pageName)return;i.pageContext&&(i.pageContext.querys=undefined,i.pageContext.passValues=undefined,i.pageContext.sortInfoCache=undefined);n.SessionStorageManager.pageContext=n.Common.JsonUrlSwitch(JSON.stringify(i.pageContext));n.PageBuilder.loadPage(i.pageName,i.pageContext);n.SessionStorageManager.pageContext=null;n.Platform.isIOSDevice()&&window.location.reload()}});$(window).on("ForguncyRowCountChanged",function(){n.PageBuilder.OnRowCountChanged()});window.onpageshow=function(t){t.persisted&&n.Platform.isIOSDevice()&&($("body").remove(),window.location.reload())}},r.applyGlobalFontFamilyAndTextColor=function(){var i=n.ForguncyData.GlobalSettings&&n.ForguncyData.GlobalSettings.ThemeFont||"",t="",r;n.RS.Culture==="CN"?t='"'+i+'","PingFangSC","Helvetica neue","Hiragino sans gb","Arial","Microsoft YaHei UI","Microsoft YaHei","SimSun","sans-serif"':n.RS.Culture==="JA"?t='"'+i+'","Meiryo","\u30d2\u30e9\u30ae\u30ce\u89d2\u30b4 Pro W3","Hiragino Kaku Gothic Pro","\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af","Arial","sans-serif"':n.RS.Culture==="KR"&&(t='"'+i+'","Malgun Gothic","\ub3cb\uc6c0","Dotum","Helvetica Neue","Helvetica","Arial","sans-serif"');r=n.ColorHelper.Convert("Text 1");$(document.head).append($("<style>html {font-family: "+t+"; color:"+r+";}<\/style>"))},r.executePageLoadedCommand=function(t,i,r){n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells().filter(function(t){return t.cellType instanceof n.SubPageContainerCellTypeBase}).forEach(function(n){return n.cellType.executePageLoadedCommand()});n.ForguncyData.commandExcutor&&t&&t.length>0?(n.Stretch.Common.storePageLoadedPageInfo(n.ForguncyData.pageInfo),n.ForguncyData.commandExcutor.excuteCommand(t,i,null,i,n.Events.PageLoaded,r)):r()},r.loadPage=function(t,u,f){r.pageCover.show();n.Common.initalTimeStamp();n.MetadataLoader.GetMetadataRequest(t,function(t){if(t){var r=i.createPageMetadata(t,f&&f.isShowAsPopup);n.PageBuilder.createPage(r,u,f)}})},r.reloadPage=function(){var u=n.ForguncyData.pageInfo.pageName,i=n.Common.getPageContext(),r=n.ForguncyData.pageInfo.pageElementManager.getCurrentPageContext(),t;if(n.MetadataLoader.globalSettingsInited=!1,n.CellTypeStyleTemplateUtils.CellTypeTemplateStyleCache){for(t in n.CellTypeStyleTemplateUtils.CellTypeTemplateStyleCache)n.CellTypeStyleTemplateUtils.PrePageCellTypeTemplateStyleCache[t]=!0;n.CellTypeStyleTemplateUtils.CellTypeTemplateStyleCache={}}if(i)for(t in r)r[t]&&(i[t]=r[t]);else i=r;n.ForguncyData.pageInfoStack=[];n.ForguncyData.pageingInfoList=new n.PageingInfoList;this.loadPage(u,i,null);n.CellTypeStyleTemplateUtils.PrePageCellTypeTemplateStyleCache={}},r.closePopup=function(i,u,f){var c,v,o,l,s,a,e,h,y;for(n.Common.initalTimeStamp(),c=n.ForguncyData.pageInfo.currentRowInfoCollection.list,n.PageBuilder._clearForCreateNewPage(t.ClosePopup),v=n.ForguncyData.pageInfoStack,o=v.pop(),n.PageInfo.setCurrentPageInfo(o),n.ForguncyData.updatePopupCoverVisbility(!1),l=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(),e=0;e<l.length;e++)(s=l[e],s.cellType&&s.cellType.CellElement)&&(a=s.cellType.CellElement.CellType,a&&a.CommandExcuteKind===1&&s.cellType.initValueWhenTriggerValueChangedCommand());for(n.PageBuilder._restoreParentPageElements(r.pagesContainer.find("#centerDiv_"+o.pageID)),n.ListviewBase.onPageCreated(),e=0;e<c.length;e++)n.Common.isPageContainsTableBinding(o.pageName,c[e].currentTable)&&o.currentRowInfoCollection.setCurrentRowInfo(c[e],!1);if(f&&i&&i.querys)for(h in i.querys)n.ForguncyData.pageInfo.commandQuerys[h]!==i.querys[h]&&(n.ForguncyData.pageInfo.commandQuerys[h]=i.querys[h],u=!0);n.NormalCellBindingManager.reloadData(null,u);i&&i.passValues&&(y=i.passValues,n.DelayOperateHelper.Push(null,function(){n.ForguncyData.pageInfo.pageElementManager.initPassedValues(y)},1));n.DelayOperateHelper.Push(null,function(){n.Page._trigger(n.Events.PopupClosed)},1);r.pageCover.hide()},r.createPage=function(i,u,o){var s,l,v;if(r.checkError(i)!==!1){s=o&&o.isShowAsPopup;n.ForguncyData.enterHistoryCount=history.length;r.pageIsLoading=!0;f.setAllowZoomPage(i.AllowZoomScreen);n.ForguncyData.pageInfoStack.push(n.PageInfo.getCurrentPageInfo());n.PageBuilder._clearForCreateNewPage(s?t.ShowPopup:t.Navigate,o);var h=n.StaticValues.RunTimeNormalPage,c=n.StaticValues.RunTimeMasterPage,a=new e(i,n.ForguncyData.pageInfo,h,c,!s);a.initForguncyData(s);a.setPageInfoByMetadata();l=function(){r.initDefaultDataAndModels(i,h,c);var t=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells().some(function(t){return t.cellType instanceof n.SubPageContainerCellTypeBase});t?n.DelayOperateHelper.Push(null,function(){r.initPageDataAndExecutePageLoadedCommand(i,u,s,h,c)},1):r.initPageDataAndExecutePageLoadedCommand(i,u,s,h,c)};v=n.PageBuilder.loadUserJavaScript(i,l);n.PageBuilder._createPageElements(i,i.TrailMessage,o,h,c);r.onLoad([h,c]);n.ListviewBase.onPageCreated();v&&l();n.ForguncyData.AutoDisconnectTimeout=i.autoDisconnectTimeout;n.ForguncyData.IsConcurrenyUserLicense=i.isConcurrenyUserLicense;n.HomeController.Operate();$(document).trigger("forguncyPageloaded")}},r.checkError=function(t){var i=t?t.ErrorMessage:"",u,f;return i==="UserLoginedInOtherPlace"?(n.ForguncyData&&n.ForguncyData.userInfo&&n.ForguncyData.userInfo.UserName&&alert(n.Common.format("\u8d26\u53f7{0}\u5df2\u7ecf\u5728\u5176\u4ed6\u8ba1\u7b97\u673a\u4e0a\u767b\u5f55",n.ForguncyData.userInfo.UserName)),location.reload(),!1):i==="YouHaveBeKickoffed"?(alert(n.RS.ConcurrentLicenseError_Kickoffed),r.hidePageLoadingCover(),!1):i&&i.indexOf("DoNotHaveEnoughConcurrencyLicense")===0?(u=i.split("|"),f="",u.length>=2&&(f=u[1]),n.SendEmailHelper.appendSendEmailConfirm({email:f}),!1):!0},r._addWindowResizeListener=function(){$(window).resize(n.PageBuilder._onWindowResize.bind(undefined,!1))},r._onWindowResize=function(t){t?n.PageBuilder._reallyResize():(n.PageBuilder._resizeTimer&&(n.DelayRefresh.clearTimeout(n.PageBuilder._resizeTimer),n.PageBuilder._resizeTimer=null),n.PageBuilder._resizeTimer=n.DelayRefresh.setTimeout(n.PageBuilder._reallyResize,100));r.adjustBackgroundImageSize(!0)},r.adjustBackgroundImageSize=function(n){for(var f=$("[FitToBrowserHeight]"),o=$("[FitToBrowserWidth]"),e=$("[fgcMainPart]"),t=0;t<f.length;t++){var i=$(f[t]),s=i.offset(),c=i.position().top,h=parseFloat(e.css("padding-bottom"));i.css("top",c-s.top);i.css("height",Math.max($(document.body).height(),e.height(),isNaN(h)?0:h))}for(t=0;t<o.length;t++){var u=$(o[t]),s=u.offset(),l=u.position().left;u.css("left",l-s.left);u.css("width",Math.max($(document.body).width(),e.width()))}n&&f.length>0&&r.adjustBackgroundImageSize(!1)},r._reallyResize=function(){n.Stretch.Common.resizeStoredPages();n.PageManager.whetherExistPageStretch(n.ForguncyData.pageInfo.pageStretchInfos)&&n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.pageElementManager&&n.ForguncyData.pageInfo.pageElementManager.resizePageElements();n.PageBuilder._resizeTimer=null},r._clearForCreateNewPage=function(i,u){i===t.ShowPopup&&n.ListviewBase.getAllListviews().forEach(function(n){return n.focus(!1)});i!==t.ClosePopup&&n.DelayRefresh.RunNow();n.ForguncyData.commandExcutor&&n.ForguncyData.commandExcutor.init();n.ForguncyData.pageInfo.pageID&&n.ListviewBase.onPageDestroyed();i===t.ClosePopup&&r._destroyOldPageElements(n.ForguncyData.pageInfo);n.ForguncyData.ClearTempDataWhenNavigate(i===t.ShowPopup,u);n.Page._init();n.DelayRefresh.Init()},r._destroyOldPageElements=function(n){n&&n.pageElementManager&&(n.releaseDialog(),n.pageElementManager.destroy())},r._changeParentPageElements=function(n,t){var u,f,o,i,s,r,e;if(n.length!==0){for(u=n.find("[id]"),f=u.length,r=0;r<f;r++)i=$(u[r]),t&&t[i.attr("id")]&&(u[r].nodeName==="INPUT"||u[r].nodeName==="TEXTAREA")&&(o=i.attr("tabindex"),i.attr("tabindex_temp",o===undefined?"undefined":o),i.attr("tabindex",-1)),i.attr("id_temp",i.attr("id")),i.attr("name_temp",i.attr("name")),i.attr("id",null),i.attr("name",null);for(u=n.find("[fgcname]"),f=u.length,r=0;r<f;r++)i=$(u[r]),i.attr("fgcname_temp",i.attr("fgcname")),i.attr("fgcname",null);for(s=n.find("[gcuielement=gcSheetFocusElementForTab]"),r=0;r<s.length;r++)e=$(s[r]),e.attr("tabindex_temp",e.attr("tabindex")),e.attr("tabindex",-1)}},r._restoreParentPageElements=function(n){var r,f,i,e,t,u,o;if(n.length!==0){for(r=n.find("[id_temp]"),f=r.length,t=0;t<f;t++)i=$(r[t]),i.attr("id",i.attr("id_temp")),i.attr("name",i.attr("name_temp")),i.attr("id_temp",null),i.attr("name_temp",null);for(r=n.find("[fgcname_temp]"),f=r.length,t=0;t<f;t++)i=$(r[t]),i.attr("fgcname",i.attr("fgcname_temp")),i.attr("fgcname_temp",null);for(e=n.find("[tabindex_temp]"),t=0;t<e.length;t++)u=$(e[t]),o=u.attr("tabindex_temp"),o==="undefined"?u.removeAttr("tabindex"):u.attr("tabindex",o),u.removeAttr("tabindex_temp")}},r._createPageElements=function(t,i,u,f,e){var a=r.pagesContainer,y=n.ForguncyData.pageInfoStack,p=y.length,d,w,o,v,b,g,k,h,s,l;if(p>0&&(d=y[p-1].pageID,n.PageBuilder._changeParentPageElements(a.find("#centerDiv_"+d),y[p-1]._iMControlList)),w=n.ForguncyData.pageInfo.pageID,o=$("<form id='form_"+w+"' method='post'/>"),o.addClass("fgc-container-form"),v=n.PageManager.getPageStretchInfo(t.MasterPage?e:f),b=t.MasterPage?t.MasterPage.PageSettings.Width:t.PageSettings.Width,u&&u.isShowAsPopup?(g=t.MasterPage?t.MasterPage.PageSettings.Height:t.PageSettings.Height,k=n.PopupHelper.createPopupDom(a,o,b,g,t.PageSettings.Title,u),k.zIndex=n.ForguncyData.pageInfoStack.length,n.ForguncyData.pageInfo.dialogUI=k):(o.css("z-index",n.ForguncyData.pageInfoStack.length),o.css("display","none"),a.append(o),n.Stretch.Layout.adjustPagesContainer(a,v,b),n.Stretch.Layout.adjustCurrentForm(o,v)),h=n.DomUtilities.createJqueryDomElement("div"),h.attr("id","page_"+w),o.append(h),o.append("<input style='display:none'>"),n.ForguncyData.pageInfo.normalCellBindingManager=new n.NormalCellBindingManager(n.ForguncyData.pageInfo.dataModel.normalCellDataModel),n.PageBuilder.initalPageElementManager(t.PageSettings),s=n.DomUtilities.createJqueryDomElement("div"),n.Stretch.Layout.adjustCurrentPageContainer(h,s,v),!i||u&&u.isShowAsPopup||n.RS.Culture!=="CN"&&s.append("<div style='color:red;text-align: center;position:relative;z-index:1000'>"+i+"<div>"),s.append(r.createPageContent(t,f,e,u&&u.isShowAsPopup)),!i||u&&u.isShowAsPopup||n.RS.Culture==="CN"&&s.append("<a href='https://www.grapecity.com.cn/solutions/huozige?utm_source=exe&utm_medium=huozige' target='_blank' style='color:black; text-decoration: none;'><div style='display:flex; align-items:center; justify-content: center; text-align: center; background-color:#F1F3F4; font-size:12px; position:fixed; bottom:0; width:100%; height:30px;'><img src='"+n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/huozigeLogo.png' width='16' height='16' /><span style='margin-left:5px;'>\u672c\u7cfb\u7edf\u7531\u6d3b\u5b57\u683c\u514d\u8d39\u7248\u5f00\u53d1<\/span><\/div><\/a>"),h.append(s),n.ForguncyData.forceMobileChild&&!(u&&u.isShowAsPopup)){var nt=327,tt=582,c=nt/s.children().width();c>1&&(c=1);l=$("#fgc-mobile-iframe",window.parent.document);l.css("transform","scale("+c+")");l.css("transform-origin","left top");l.width(nt/c);l.height(tt/c)}u&&u.isShowAsPopup||window.scrollTo(0,0)},r.createPageContent=function(t,i,r,f){var e=u.create(t,i,r,f?2:0);switch(n.ForguncyData.GlobalSettings.MainPageHorizontalAlignment){case 1:e.css("margin","0 auto");break;case 2:e.css("margin","0 0 0 auto");break;default:break}return e.attr("id","centerDiv_"+n.ForguncyData.pageInfo.pageID),e.attr("fgcMainPart","fgcMainPart"),e},r.onLoad=function(t){var r=n.ListviewBase.getAllListviews(t),i;r.forEach(function(n){return n.onLoad()});i=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(t);i.forEach(function(n){return n.onLoad()})},r._initAutoGeneratedID=function(t){var i=n.ForguncyData.pageInfo.autoGeneratedIDs,r,u,f;if(i)for(r in i)for(u in i[r])f={TableName:r,ColumnName:u},n.ForguncyData.pageInfo.normalCellBindingManager.setValueToBindingCell(f,i[r][u],t)},r.initDefaultDataAndModels=function(t,i,u){var f=[i,u];n.ForguncyData.pageInfo.pageElementManager.initCellDefaultValue(f);r._initAutoGeneratedID(f);n.ForguncyData.pageInfo.formulaManager.init(t,n.ForguncyData.pageInfo.dataModel,i,u);n.ForguncyData.pageInfo.defaultFormulaManager.setDefaultFormula(f);n.ForguncyData.pageInfo.pageElementManager.onDefaultDataSetted(f)},r.initPageDataAndExecutePageLoadedCommand=function(t,i,u,f,e){var o,s,h;n.Page._trigger(n.Events.Loaded);n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells().filter(function(t){return t.cellType instanceof n.SubPageContainerCellTypeBase}).forEach(function(n){return n.cellType.triggerPageLoadedEvent()});n.ForguncyData.pageInfo.pageElementManager.setPrePageContext(i);this.fillAllListviewData();i&&i.passValues&&(o=i.passValues,n.DelayOperateHelper.Push(null,function(){n.ForguncyData.pageInfo.pageElementManager.initPassedValues(o)},1));s=n.ForguncyData.pageInfoStack;u||(n.Page._clearState(),n.ForguncyData.pageInfoStack=[]);h=n.ForguncyData.pageInfo.pageID;n.PageBuilder.executePageLoadedCommand(t.PageSettings.PageLoadedCommandList,f,function(){n.DelayOperateHelper.Push(null,function(){n.DelayRefresh.Push(null,function(){n.ForguncyData.pageInfo.defaultFormulaManager.clearDefaultFormula([f,e])},"clearDefaultFormula"+f);r.showNewPage(t,u,h,s);r.pageIsLoading=!1},1)});$(document).trigger("initPageData")},r.fillAllListviewData=function(t){var i=n.ListviewBase.getAllListviews(t);i.forEach(function(n){n.listviewData.getDoNotLoadDataWhenLoadPage()?(n.clearCurrentRow(),n.getEditorInfo(!0)):n.fillData(null,!0)})},r.showNewPage=function(t,i,u,f){n.DelayRefresh.Push(null,function(){var h="form_"+u,c=f.length,o,s,e;if(r.hidePageLoadingCover(),r.pageCover.hide(),i)n.ForguncyData.updatePopupCoverVisbility(!0),o=n.ForguncyData.pageInfoStack.filter(function(n){return n.pageID===u}),o&&o.length>0?o[0].dialogUI.target.visibility=!0:n.ForguncyData.pageInfo.dialogUI.target.visibility=!0;else{for(e=0;e<c;e++)r._destroyOldPageElements(f[e]);for(document.title=t.PageSettings.Title,r.onDocumentTitleChanged(),$("#"+h).css("display",""),$("#"+h).css("z-index","0"),s=r.pagesContainer.children(),e=0;e<s.length-1;e++){if(s[e].id===h)break;$(s[e]).remove()}}n.Page._trigger(n.Events.PageDefaultDataLoaded);n.PageBuilder._onWindowResize(!0)},"showNewPage"+u)},r.onDocumentTitleChanged=function(){if(window!==window.top)try{window.parent.location.origin===location.origin&&window.parent.postMessage({type:"TITLE CHANGED",message:{title:window.document.title,url:window.location.href,uid:window.name}},window.location.origin)}catch(n){}},r.loadUserJavaScript=function(t,i){var u,f,r;return n.Common.IsEmpty(t.PageSettings.Script)?!0:(u="userScript_"+t.PageSettings.Name,document.getElementById(u))?!0:(f=document.getElementsByTagName("head")[0],r=document.createElement("script"),r.setAttribute("type","text/javascript"),r.setAttribute("id",u),r.setAttribute("src",n.Common.format("{0}GeneratedResources/UserJavaScript/{1}?v={2}",n.ForguncyData.ForguncyRoot,t.PageSettings.Script,n.StaticData.MetaDataVersion)),r.readyState==="loaded")?(f.appendChild(r),!0):(r.onload=r.onreadystatechange=function(){r.ready||r.readyState&&r.readyState!=="loaded"&&r.readyState!=="complete"||(r.ready=!0,i())},f.appendChild(r),!1)},r.OnRowCountChanged=function(t){t===void 0&&(t=!1);n.RecordNavigationCellType.updateNavigationCellTypeText("currentCountLabel",n.RecordNavigationCellType.updateCurrentCountLabel)},r.initalPageElementManager=function(t){n.ForguncyData.pageInfo.currentRowInfoCollection=new n.CurrentRowInfoCollection(n.ForguncyData.pageInfo.normalCellBindingManager);var i=new n.PageElementManager(n.ForguncyData.pageInfo.currentRowInfoCollection,n.ForguncyData.pageInfo.dataModel);n.ForguncyData.pageInfo.pageElementManager=i},r.DefaultLoadingCoverColor="rgba(255, 255, 255, 0.70)",r.pageIsLoading=!1,r._resizeTimer=null,r}(),u,t,i,f,e,r;n.PageBuilder=o;u=function(){function t(n){this.runTimeNormalPageName=n}return t.create=function(n,i,r,u){var f=new t(i);return n.MasterPage?f.createPagePartDiv(n.MasterPage,n,r,u):f.createPagePartDiv(n,null,i,u)},t.prototype.createPagePartDiv=function(t,i,r,u){var f=n.DomUtilities.createJqueryDomElement("div"),s=n.PageManager.getPageStretchInfo(r),o,e;return f.css("position","relative"),o=u===1?0:s.StretchMode,n.Stretch.Layout.adjustMainDiv(f,o,t.PageSettings.Width,t.PageSettings.Height),e=t.PageSettings.DefaultBackColor,e===undefined&&(e="white"),f.css("background-color",n.ColorHelper.Convert(e)),this.createPageUIElements(t,i,r,f,3,t.BackgroundImages,u),this.createPageUIElements(t,i,r,f,1,t.Backgrounds,u),this.createPageUIElements(t,i,r,f,0,t.UIElements,u),this.createPageUIElements(t,i,r,f,5,t.Borders,u),this.createPageUIElements(t,i,r,f,2,t.Images,u),this.createPageUIElements(t,i,r,f,4,t.Charts,u),f},t.prototype.createPageUIElements=function(n,t,i,r,u,f,e){for(var s,o=0;o<f.length;o++)s=this.createUIElement(f[o],n,t,i,u,e),r.append(s)},t.prototype.createUIElement=function(t,i,r,u,f,e){var o=n.DomUtilities.createJqueryDomElement("div"),h=n.PageManager.getPageStretchInfo(u),c=null,a=!1,l=null,s,v;return o.css("position","absolute"),n.Stretch.Common.setStretch(o,t,h),s=!1,f===5?(this.createBorder(o,t,h),s=!0):f===1?(this.createBackground(o,t),s=!0):f===2?(this.createImage(o,t,u),s=!this.hasCommandInImage(t)):f===3?(this.createBackgroundImage(o,t,e,u),s=!this.hasCommandInImage(t)):f===4?this.createChart(o,t,u):f===0&&(t.IsPlaceHolder?this.createPlaceHolder(o,r,t.Width):t.IsListView?(a=!0,c=t.Data.Name,this.createTable(o,t,h,u)):(c=this.getNormalCellFgcName(t),l=t.CssClassName,v=this.createCell(o,t,h,u),s=v.cellType.shouldSetPenetrable())),o.attr("isListviewDiv",a),c&&o.attr("fgcName",c),l&&o.addClass(l),s&&o.addClass("penetrable"),o},t.prototype.hasCommandInImage=function(n){var t,i=n.CommandList;return((t=i)===null||t===void 0?void 0:t.length)>0},t.prototype.getNormalCellFgcName=function(t){return n.Common.IsEmpty(t.TemplateCellSource)?(t.Name&&t.Name.length)>0?t.Name[0]:null:t.TemplateCellSource},t.prototype.createBorder=function(t,i,r){var u,f;t.attr("isborder",!0);u=i.Left+"-"+i.Top+"-"+i.Width+"-"+i.Height;t.addClass(u);n.Stretch.Border.adjust(t,r,i);f=i.Style?i.Style:"solid";t.css(i.Position,i.BorderWidth+"px "+f+" "+n.ColorHelper.Convert(i.Color))},t.prototype.createBackground=function(t,i){t.css("background-color",n.ColorHelper.Convert(i.Color))},t.prototype.createPlaceHolder=function(t,i,r){var u=this.createPagePartDiv(i,null,this.runTimeNormalPageName,2),f=n.PageManager.getPageStretchInfo(this.runTimeNormalPageName);i.PageOverflowMode===2?(t.css("overflow-x","hidden"),t.css("overflow-y","hidden"),n.Stretch.Placeholder.adjust(u,f)):i.PageOverflowMode===1&&(t.css("overflow-x","auto"),t.css("overflow-y","hidden"));t.attr("id","placeHolderDiv");t.append(u)},t.prototype.createTable=function(t,i,r,u){var f;n.Stretch.Common.adjustTable(t,i,r);f=i.Width>0&&i.Height>0;f||(t.css("visibility","collapse"),t.css("overflow","hidden"));var s=n.ListviewMetadataHelper.restore(n.ListviewBase.getLocationString(u,i.Data.Name))||i.Data,e=new n.ListviewData(s,u),h={top:i.Top,left:i.Left,width:i.Width,height:i.Height};t.attr("id",e.name);var c={ExtendWidth:i.ExtendWidth||0,ExtendHeight:i.ExtendHeight||0},l=n.ForguncyData.pageInfo.pageElementManager.listviewCollection.addListview(null,e,u,h,f,c),o=l.getRangeInfo();t.attr(n.StaticValues.InnerID,n.Common.getIdStr(o.Row,o.Column,u))},t.prototype.createImage=function(t,i,r){var f,e,u,o,s;t.attr("fgc-gui","isImg");f=n.DomUtilities.createJqueryDomElement("div");f.css("overflow","hidden");f.attr("fgc-gui","imageContainer");this.setImageContainerStyle(f,i);i.Background&&(e=n.DomUtilities.createJqueryDomElement("div"),e.css("background",n.ColorHelper.Convert(i.Background)),e.attr("fgc-gui","imagebg"),this.fullSizeElement(e),f.append(e));(i.ImageSrc||i.PictureName)&&(u=n.DomUtilities.createJqueryDomElement("img"),u.attr("fgc-gui","image"),o=this.getImageUrl(i),s=n.ImageHelper.encodeImageUrl(o),u[0].src=s,this.fullSizeElement(u),(n.Platform.isIE()||n.Platform.isOldEdge())&&i.ImageWidth&&i.ImageHeight?i.Width/i.ImageWidth<i.Height/i.ImageHeight?(u.css("width","100%"),u.css("height","auto"),u.css("top","50%"),u.css("transform","translateY(-50%)")):i.Width/i.ImageWidth>i.Height/i.ImageHeight&&(u.css("width","auto"),u.css("height","100%"),u.css("left","50%"),u.css("transform","translateX(-50%)")):u.css("object-fit","contain"),f.append(u));t.on("click",this.getImageClickFunction(i,r));t.append(f)},t.prototype.createBackgroundImage=function(t,i,r,u){var e,o,f,s,h;if(t.attr("fgc-gui","isBgImg"),e=n.DomUtilities.createJqueryDomElement("div"),e.css("overflow","hidden"),(i.ImageSrc||i.PictureName)&&i.Background?(o=n.DomUtilities.createJqueryDomElement("div"),f=n.DomUtilities.createJqueryDomElement("div"),this.fullSizeElement(o),this.fullSizeElement(f),e.append(o),e.append(f),e.attr("fgc-gui","bgImageContainer"),o.attr("fgc-gui","bgImagebg"),f.attr("fgc-gui","bgImage")):i.Background?(o=e,o.attr("fgc-gui","bgImagebg+C")):(i.ImageSrc||i.PictureName)&&(f=e,f.attr("fgc-gui","bgImage+C")),i.ImageSrc||i.PictureName)if(s=this.getImageUrl(i),h=n.ImageHelper.encodeImageUrl(s),f.css("background-image",'url("'+n.Helper.preProcessImageSrc(h)+'")'),i.Repeat)f.css("background-size","auto"),f.css("background-repeat","repeat");else{f.css("background-repeat","no-repeat");switch(i.Stretch){case 1:f.css("background-size","100% 100%");break;case 2:f.css("background-size","contain");f.css("background-position","50% 50%");break;case 3:f.css("background-size","cover");break;case 0:f.css("background-size","auto");f.css("background-position","50% 50%");break;default:break}}i.Background&&o.css("background",n.ColorHelper.Convert(i.Background));this.setImageContainerStyle(e,i);i.FitToBrowserHeight&&r===0&&e.attr("FitToBrowserHeight","true");i.FitToBrowserWidth&&r===0&&e.attr("FitToBrowserWidth","true");t.on("click",this.getImageClickFunction(i,u));t.append(e)},t.prototype.getImageClickFunction=function(t,i){return function(){var r=t.CommandList;r&&r.length>0&&n.ForguncyData.commandExcutor.excuteCommand(r,i,null,t.PictureName+"_"+i,n.Events.Click)}},t.prototype.getImageUrl=function(t){return t.PictureName?n.ImageHelper.getImageUrlFromImagePath(t.IsBuiltIn,t.PictureName,t.IsThemeImage):n.ForguncyData.ForguncyRoot+"GeneratedResources/Images/GenerateImages/FlowingImages/"+t.ImageSrc},t.prototype.setImageContainerStyle=function(t,i){t.css("box-sizing","border-box");i.BoxShadow&&t.css("box-shadow",n.ColorHelper.ConvertShadow(i.BoxShadow));i.Border&&t.css("border",n.ColorHelper.ConvertBorder(i.Border));i.CornerRadius>0&&t.css("border-radius",i.CornerRadius);i.Transparency<1&&t.css("opacity",i.Transparency);this.fullSizeElement(t)},t.prototype.fullSizeElement=function(n){n.css("position","absolute");n.css("height","100%");n.css("width","100%")},t.prototype.createChart=function(t,i,r){var u=n.ForguncyData.pageInfo.pageElementManager.chartCollection.createChart(i,r);t.append(u)},t.prototype.createCell=function(t,i,r,u){var e=n.Common.getIdStr(i.Row,i.Column,u),f;return t.attr("id",e+"_div"),t.attr(n.StaticValues.InnerID,e),n.Stretch.Common.adjustCell(t,i,r),f=new n.NormalCell(i,0,e,u),n.ForguncyData.pageInfo.pageElementManager.cells.addCell(f),f.create(t),f},t}();n.PageContentCreator=u,function(n){n[n.Navigate=0]="Navigate";n[n.ShowPopup=1]="ShowPopup";n[n.ClosePopup=2]="ClosePopup"}(t||(t={}));i=function(){function t(){}return t.createPageMetadata=function(i,r){var f,u,o,e;return typeof i=="string"?{ErrorMessage:i}:(f=i,f.globalSettings&&(u=f.globalSettings,n.ForguncyData.AuthenticationType=u.AuthenticationType,n.ForguncyData.AllowLogout=u.AllowLogout,n.ForguncyData.SecurityProviderValidateType=u.SecurityProviderValidateType,n.ForguncyData.PageBindingTables=u.PageBindingTables?JSON.parse(u.PageBindingTables):{},n.ForguncyData.IsAutoTest=u.IsAutoTest,n.BuiltInPageManager.builtInPages=JSON.parse(u.builtInPages),o=JSON.parse(u.themeData),n.ColorHelper.Colors=o.Colors,n.ColorHelper.ColorCache={},n.ForguncyData.GlobalSettings=JSON.parse(u.globalSetting),n.ForguncyData.GlobalSettings.ThemeFont=o.Font,n.ForguncyData.GlobalSettings.ThemeBasePath=o.ThemeBasePath,n.ForguncyData.GlobalSettings.ListViewTemplates=JSON.parse(u.listViewStyleTemplates),n.ForguncyData.GlobalSettings.CellTypeStyleTemplates=JSON.parse(u.cellTypeStyleTemplates),n.ForguncyData.GlobalSettings.PageUIPermissions=JSON.parse(u.pageUIPermissions)),e=JSON.parse(f.metaData),f.masterPageMetaData&&(e.MasterPage=JSON.parse(f.masterPageMetaData)),e=__assign(__assign({},f),e),t.preProcess(e,r),e)},t.preProcess=function(i,r){var f,e,u;i.MasterPage&&(t._updateMasterPageUIElementSizeOfPosition(i),f=t.getPageStretchInfo(i,!1,r),f&&(e=n.Stretch.Common.canHorizontallyStretch(f.StretchMode),e&&i.PageOverflowMode===2&&(u=i.MasterPage.UIElements.filter(function(n){return n.IsPlaceHolder}),u&&u.length>0&&(i.PageSettings.Width=Math.min(i.PageSettings.Width,u[0].Width)))));t.referStyles(i);n.CellTypeStyleTemplateUtils.PrepareTemplateStyles(n.ForguncyData.GlobalSettings.CellTypeStyleTemplates);n.ListViewStyleTemplateUtils.ListViewStyleTemplates=n.ForguncyData.GlobalSettings.ListViewTemplates},t._updateMasterPageUIElementSizeOfPosition=function(i){var r=n.ArrayHelper.firstOrDefault(i.MasterPage.UIElements,function(n){return n.IsPlaceHolder}),e=i.PageSettings.Height;if(r&&r.Height<e){var u=e-r.Height,f=r.Height+r.Top,o=t.getAllElements(i.MasterPage);o.forEach(function(n,t,i){n.Top>=f?n.Top+=u:n.Top<f&&n.Top+n.Height>=f&&(n.Height+=u)});i.MasterPage.PageSettings.Height+=u}},t.getAllElements=function(n){return[].concat(n.UIElements,n.Borders,n.Backgrounds,n.Images,n.Charts)},t.referStyles=function(i){var u,r;if(i){for(u=0;u<i.UIElements.length;u++)r=i.UIElements[u],r.StyleIndex>=0&&(r.StyleInfo=n.Common.clone(i.StyleMetaDatas[r.StyleIndex])),t.referStyleTemplateMetadata(r,i);t.referStyles(i.MasterPage)}},t.referStyleTemplateMetadata=function(t,i){if(t.CellType&&t.CellType.TemplateKey){var r=t.CellType.$type.split(",")[0],u=t.CellType.TemplateKey;t.StyleTemplate=n.CellTypeStyleTemplateUtils.GetStyleTemplateByKey(r,u,n.ForguncyData.GlobalSettings.CellTypeStyleTemplates)}},t.getPageStretchInfo=function(t,i,r){var u={StretchMode:0},f=null;if(!r)return u;if(i){if(n.Common.IsEmpty(t.MasterPage))return u;f=t.MasterPage.PageSettings}else f=t.PageSettings;return u.StretchMode=n.Stretch.Helper.getStretchMode(f.PageResponsiveMode),u.MainPartWidth=f.Width,u.MainPartHeight=f.Height,u},t}();n.MetadataHelper=i;f=function(){function t(){}return t.setAllowZoomPage=function(i){n.ForguncyData.pageInfo.allowZoomScreen=!n.Platform.isMobile()||i;t.removeDisableZoomCss();n.ForguncyData.pageInfo.allowZoomScreen?$("meta[name='viewport']").replaceWith("<meta name='viewport' content='width=device-width'>"):($("meta[name='viewport']").replaceWith("<meta name='viewport' content='width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi' />"),t.injectDisableZoomCss())},t.disablePageZoom=function(){if(n.Platform.isMobile()){var t=function(t){n.ForguncyData.pageInfo.allowZoomScreen||t.touches.length>1&&t.preventDefault()};window.addEventListener("touchstart",t,!1)}},t.injectDisableZoomCss=function(){var t,i;n.Platform.isIOSDevice()&&(t=document.createElement("style"),t.setAttribute("id","disablegestures"),document.body.appendChild(t),i=t.sheet,i.insertRule?i.insertRule("*{touch-action:manipulation;}",0):i.addRule("*","{touch-action:manipulation;}",0))},t.removeDisableZoomCss=function(){if(n.Platform.isIOSDevice()){var t=$("style#disablegestures");t.length!=0&&t.remove()}},t}();e=function(){function t(n,t,i,r,u){this.pageMetadata=n;this.pageInfo=t;this.runTimeNormalPageName=i;this.runTimeMasterPageName=r;this.supportStretch=u}return t.prototype.initForguncyData=function(t){var i=this.pageMetadata;n.ForguncyData.userInfo.UserName=i.storageUserName?i.storageUserName:"";n.ForguncyData.userInfo.FullName=i.fullName?i.fullName:"";n.ForguncyData.userInfo.HasPicture=i.hasPicture?i.hasPicture:!1;n.ForguncyData.userInfo.Email=i.email?i.email:"";n.ForguncyData.userInfo.Role=i.role;n.ForguncyData.userInfo.OrganizationSuperior=i.organizationSuperior?i.organizationSuperior:"";n.ForguncyData.userInfo.Properties=i.properties?i.properties:null;n.ForguncyData.userInfo.OrganizationLevelValues=i.organizationLevelValues?i.organizationLevelValues:null;this.initPageInfo(t)},t.prototype.initPageInfo=function(t){var i=this.pageInfo,u=this.pageMetadata;i.pageName=u.PageSettings.Name;i.masterPageName=u.MasterPage?u.MasterPage.PageSettings.Name:"";i.enableTabIndex=u.PageSettings.EnableTabIndex;i.moveFocusByEnter=n.ForguncyData.GlobalSettings.MoveFocusByEnter;i.tableColumnsCacheManager=new r;i.pageID=n.Common.getUniqueNumber();i.ViewInfoList=[];i.PrimaryTableForeignKeyInfo={};i.ReturnUrl=n.Common.IsEmpty(u.ReturnUrl)?null:u.ReturnUrl;i.noPermissionPage=n.Common.IsEmpty(u.noPermissionPage)?null:u.noPermissionPage;i.formulaManager=new n.FormulaManager(n.ForguncyData.pageInfo.dataModel);i.defaultFormulaManager=new n.DefaultFormulaManager;i.dependenceCellValueChangedEventHandlers={};i.pageStretchInfos={};i.isPopup=t},t.prototype.setPageInfoByMetadata=function(){this._setAutoGeneratedIDs();this._setPageStretchInfos();this._setViewInfoList();this._setPrimaryTableForeignKeyInfo();r.initRequestTablesDataCache(this.pageMetadata)},t.prototype._setAutoGeneratedIDs=function(){var t,n,i;if(this.pageInfo.autoGeneratedIDs||(this.pageInfo.autoGeneratedIDs={}),this.pageMetadata.autoGeneratedIDs){t=JSON.parse(this.pageMetadata.autoGeneratedIDs);for(n in t){this.pageInfo.autoGeneratedIDs[n]||(this.pageInfo.autoGeneratedIDs[n]={});for(i in t[n])this.pageInfo.autoGeneratedIDs[n][i]=t[n][i]}}},t.prototype._setPageStretchInfos=function(){this.pageInfo.pageStretchInfos||(this.pageInfo.pageStretchInfos={});this.pageInfo.pageStretchInfos[this.runTimeNormalPageName]=i.getPageStretchInfo(this.pageMetadata,!1,this.supportStretch);this.pageInfo.pageStretchInfos[this.runTimeMasterPageName]=i.getPageStretchInfo(this.pageMetadata,!0,this.supportStretch)},t.prototype._setViewInfoList=function(){var n=this.pageMetadata.ViewInfoList,t;this.pageMetadata.MasterPage&&(n=n.concat(this.pageMetadata.MasterPage.ViewInfoList));t=this.pageInfo.ViewInfoList;n.forEach(function(n){t.some(function(t){return t.ViewName===n.ViewName})||t.push(n)})},t.prototype._setPrimaryTableForeignKeyInfo=function(){var n=__assign(__assign({},this.pageInfo.PrimaryTableForeignKeyInfo),this.pageMetadata.PrimaryTableForeignKeyInfo);this.pageMetadata.MasterPage&&(n=__assign(__assign({},n),this.pageMetadata.MasterPage.PrimaryTableForeignKeyInfo));this.pageInfo.PrimaryTableForeignKeyInfo=n},t}();n.ForguncyDataSetter=e;r=function(){function t(){this.tableColumnsCache={};this.tablesDataCache={}}return t.initRequestTablesDataCache=function(i){var r=[];t.initRequestTablesDataCacheForOnePage(i.CachedTableColumns,r);i.MasterPage&&t.initRequestTablesDataCacheForOnePage(i.MasterPage.CachedTableColumns,r);r.forEach(function(i){return t.getRequestOneTableDataCache(i,n.ForguncyData.pageInfo.tableColumnsCacheManager.tableColumnsCache[i],!1)})},t.initRequestTablesDataCacheForOnePage=function(n,i){var r=function(r){var u=!1;n[r].forEach(function(n){u=t.addTableColumnsCache(r,n)||u});u&&i.indexOf(r)===-1&&i.push(r)};for(var u in n)r(u)},t.addTableColumnsCache=function(t,i){var r=n.ForguncyData.pageInfo.tableColumnsCacheManager.tableColumnsCache,u;return r[t]?(u=r[t].every(function(n){return JSON.stringify(n)!==JSON.stringify(i)}),u?(r[t].push(i),!0):!1):(r[t]=[i],!0)},t.updateCache=function(i){var r=n.ForguncyData.pageInfo.tableColumnsCacheManager.tableColumnsCache,u;if(n.Common.IsEmpty(i))for(u in r)t.getRequestOneTableDataCache(u,r[u],!1);else t.getRequestOneTableDataCache(i,r[i],!1)},t.getRequestOneTableDataCache=function(t,i,r){var e,f,u,o,s;if(r===void 0&&(r=!0),i&&!(i.length<=0)){for(e=[],f=[],u=0;u<i.length;u++)i[u].ColumnBindingInfo&&(o=JSON.stringify(i[u].ColumnBindingInfo),f.indexOf(o)===-1&&(f.push(o),e.push(i[u].ColumnBindingInfo)));s={tableName:t,columnBindingInfos:e};n.HomeController.GetTableDataByColumnBindingInfo(s,function(r){for(var s,a,h,c,e,o={},u=0;u<i.length;u++){s=JSON.stringify(i[u]);o[s]||(o[s]=[]);var v=i[u].ColumnBindingInfo,l=i[u].FormatString,y=i[u].AddNoneItem;if(y?(e={Value:i[u].NoneItemText,FormatValue:i[u].NoneItemText},o[s].push(e)):(e={Value:null,FormatValue:null},o[s].push(e)),r&&!(r.length<=0))for(a="C"+f.indexOf(JSON.stringify(v)),h=0;h<r.length;h++)c=r[h][a],e={},e.Value=c,e.FormatValue=l?n.FormatHelper.format(l,c).text:c,o[s].push(e)}n.ForguncyData.pageInfo.tableColumnsCacheManager.tablesDataCache[t]=o},t,r)}},t.getTableData=function(t,i){var r=n.ForguncyData.pageInfo.tableColumnsCacheManager.tablesDataCache;return r[t]?r[t][JSON.stringify(i)]:null},t}();n.TableColumnsCacheManager=r}(Forguncy||(Forguncy={})),function(n){var t=jQuery,i;t(document).ready(function(){new i});i=function(){function i(){var r=this;t(document.body).on("click","["+i.AttributeName+"]",function(u){var s=t(this),e=s.attr(i.AttributeName),o=r.getUserManagerOperation(e),f;if(o!==9)return f=[],f.push({$type:"Forguncy.Model.UserManagerCommand, Forguncy",operation:o}),n.ForguncyData.commandExcutor.excuteCommand(f,n.StaticValues.RunTimeNormalPage,null,e,n.Events.Click),!1});t(document).on("forguncyPageloaded",function(){r.loadUserProfile();r.loadUserSubscription()})}return i.prototype.getUserManagerOperation=function(n){switch(n){case"LogIn_Button":return 0;case"ForgotPassword_Send":return 4;case"ChangeProfile_Button":return 7;case"ChangePassword_Button":return 5;case"ResetPassword_Button":return 6;case"Logout":return 1;case"LogoutAndNavigateToHomePage":return 2;case"401Login":return 3;case"MailSubscription_Button":return 8;default:return 9}},i.prototype.loadUserProfile=function(){var r=t("#form_"+n.ForguncyData.pageInfo.pageID).find("["+i.AttributeName+"=ChangeProfile_Button]");r.length>0&&n.Common.forguncyPost("Account/GetUserProfile",null,function(r,u){if(r!=null){var f=t("["+i.AttributeName+"=ChangeProfile_Picture]");n.ForguncyData.pageInfo.pageElementManager.cells.setValueToForguncyattrCell("ChangeProfile_FullName",r.FullName);n.ForguncyData.pageInfo.pageElementManager.cells.setValueToForguncyattrCell("ChangeProfile_Email",r.Email);n.ImageHelper.setImageSource(f,r.Picture)}})},i.prototype.loadUserSubscription=function(){var f=t("#form_"+n.ForguncyData.pageInfo.pageID).find("["+i.AttributeName+"=MailSubscription_Button]"),u,r;f.length>0&&(u=n.Common.getPageContext(),r={},r.commandID=u.commandID,n.Common.forguncyPost("Home/GetSubscription",r,function(t,i){t!=null&&n.ForguncyData.pageInfo.pageElementManager.cells.setValueToForguncyattrCell("MailSubscription_Choice",t)}))},i.AttributeName="forguncyattr",i}()}(Forguncy||(Forguncy={}));__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var f=function(){function r(n){this.runTimePageName=n}return r.prototype.init=function(i,r){var u=t.getSXChartType(i.chartType);this.isFromPivotTable=r!=null&&!n.Common.IsEmpty(r.pivotTableID);this.chartDataInfo={chartType:u,is100pcChart:i.chartType.toLowerCase().indexOf("100pc")!==-1,displayEmptyCellAs:i.displayEmptyCellsAs.toLowerCase(),categoryAxisInfo:this.initCategoryAxisInfo(i,r),valueAxisInfo:this.initValueAxisInfo(i),valueAxisInfo2:{axis:i.YAxis2,axisPosition:"y2",isDateAxis:!1,dateIndexInSeriesDataArray:0},xValueAxisInfo:null,sizeMaxValue:NaN,seriesInfos:this.initSeriesInfo(i,r),chartSize:{width:i.width,height:i.height}}},r.prototype.initCategoryAxisInfo=function(i,r){var o=t.getSXChartType(i.chartType),f=i.xAxis,h="x",s,e,u;return o===3&&(f=i.yAxis,h="y"),e=f.type.toLowerCase()==="date",e&&(s=0,o===3&&(s=1),t.isEchartLineChart(o)||(e=!1)),u={axis:f,axisPosition:h,isDateAxis:e,dateIndexInSeriesDataArray:s},r&&r.items&&(u.mapping=r.items),u.data=i.forPaint||this.isFromPivotTable?f.items:u.mapping?t.getDataFromListViewColumnMappingInfo(u.mapping,this.runTimePageName):t.getCategoryAxisData(u,this.runTimePageName),u.formattedData=u.data.map(function(i){return t.IsEmpty(i)&&(i=""),t.IsEmpty(f.labelFormatter)?i instanceof Date&&(i=n.FormatHelper.format("yyyy/M/d",i).text):i=n.FormatHelper.format(f.labelFormatter,i).text,i}),u},r.prototype.initValueAxisInfo=function(n){var u=t.getSXChartType(n.chartType),i=n.yAxis,r="y";return u===3&&(i=n.xAxis,r="x"),{axis:i,axisPosition:r,isDateAxis:!1,dateIndexInSeriesDataArray:0}},r.prototype.initSeriesInfo=function(n,i){var f=[],o,e,c,v,y,s,h,u,l,a,p,r;if(n.dataSeries){for(o=n.dataSeries.map(function(n){return n}).sort(t.sortSeriesByChartType),e=[],r=0;r<o.length;r++){if(r===0){e.push(0);continue}c=t.getSXChartType(o[r].chartType);t.getSXChartType(o[r-1].chartType)===c&&o[r-1].IsSecondaryAxis===o[r].IsSecondaryAxis&&c!==4?e.push(e[r-1]):e.push(e[e.length-1]+1)}for(v=t.getSXChartType(n.chartType),y=n.dataSeries.length,r=0;r<y;r++)u={},s=n.dataSeries[r],u.series=s,u.seriesIndex=r,h=2,v!==5&&(h=e[o.indexOf(s)]+h),u.zIndex=h,u.stackedSummary=t.getSeriesStackedSummary(s),u.is100percentChart=s.chartType.toLowerCase().indexOf("100pc")!==-1,s.conditionalFormatRules&&(u.conditionalFormatRules=s.conditionalFormatRules),f.push(u)}if(i&&i.dataSeries)for(r=0;r<i.dataSeries.length;r++)u=f[r],u&&(u.mapping=i.dataSeries[r][0]);if(f.length>0){for(r=0;r<f.length;r++)u=f[r],u.data=n.forPaint||this.isFromPivotTable?u.series.values:u.mapping?t.getDataFromListViewColumnMappingInfo(u.mapping,this.runTimePageName):t.getDataFromFormula(u.series.valueFormula,this.runTimePageName),l=u.data.map(t.toNumber),u.max=Math.max.apply(Math,l),u.min=Math.min.apply(Math,l);for(a=this.initSeriesDataTotalArray(f),p=function(n){var i=f[n],o,r;if(!t.IsEmpty(i.stackedSummary)){var s=f.filter(function(n){return n.stackedSummary===i.stackedSummary&&n.seriesIndex<=i.seriesIndex}),u=t.getSXChartType(i.series.chartType),e=!1;for(u===1&&(e=!0),i.stackedData=[],i.percentData=[],i.stackedPercentData=[],o=function(n){var r=a[n].firstAxis[u],f,h;if(i.series.IsSecondaryAxis&&(r=a[n].secondaryAxis[u]),f=t.toNumber(i.data[n]),h=t.sum(s.map(function(i){var r=t.toNumber(i.data[n]);return!e&&(f>=0&&r<0||f<0&&r>0)?0:r})),i.stackedData.push(h),r===0)return i.percentData.push(0),i.stackedPercentData.push(0),"continue";var o=1e7,c=Math.round(f/r*o)/o,l=Math.round(h/r*o)/o;i.percentData.push(c);i.stackedPercentData.push(l)},r=0;r<i.data.length;r++)o(r)}},r=0;r<f.length;r++)p(r)}return f},r.prototype.initSeriesDataTotalArray=function(n){for(var i,u,f,s,r,o=[],e=0;e<n[0].data.length;e++){for(i={firstAxis:{},secondaryAxis:{}},u=0;u<n.length;u++)f=Number(n[u].data[e]),isNaN(f)&&(f=0),s=n[u].series.IsSecondaryAxis,r=t.getSXChartType(n[u].series.chartType),s?(i.secondaryAxis[r]===undefined&&(i.secondaryAxis[r]=0),i.secondaryAxis[r]+=Math.abs(f)):(i.firstAxis[r]===undefined&&(i.firstAxis[r]=0),i.firstAxis[r]+=Math.abs(f));o.push(i)}return o},r.prototype.convertChartModelToEchart=function(i,r,u){return this.forPaint=i.forPaint,this.geoJsonInfo=u,this.init(i,r),this.option={},this.option.animation=n.ForguncyData.IsAutoTest?!1:!0,this.option.backgroundColor=t.convertBackgoundColor(i.backgroundColor,this.forPaint),this.option.tooltip=this.convertChartTooltip(),this.option.title=this.convertChartTitle(i.chartTitle),this.supportLegendElement()&&(this.option.legend=this.convertChartLegend(i.legend)),this.option.series=this.convertDataSeries(),this.supportAxisElement()&&this.convertAxes(i),this.supportRadarElement()&&(this.option.radar=this.convertRadar(i)),this.supportMapElement()?(this.option.geo=this.convertGeo(i),this.option.visualMap=this.convertVisualMap(i)):this.convertChartGrid(this.option,i),this.sortSeriesByDate(this.option),this.option.color=this.getColorPalette(i),this.option},r.prototype.useEchartDefaultStack=function(n){var t=n.series.chartType.toLowerCase();return t.indexOf("stacked")!==-1&&t.indexOf("line")!==-1?!1:!0},r.prototype.getColorPalette=function(n){return null},r.prototype.supportLegendElement=function(){return!0},r.prototype.supportMapElement=function(){return!1},r.prototype.supportAxisElement=function(){return!0},r.prototype.supportRadarElement=function(){return!1},r.prototype.convertRadar=function(n){return null},r.prototype.convertVisualMap=function(n){return null},r.prototype.convertGeo=function(n){return null},r.prototype.convertChartGrid=function(i,r){var u=n.ChartLayoutHelper.GetChartLayout(i,r,this.supportAxisElement());i.grid={left:u.x1,top:u.y1,right:u.x2,bottom:u.y2,backgroundColor:t.convertBackgoundColor(r.plotArea.backgroundColor,this.forPaint),borderWidth:r.plotArea.borderStyle.borderWidth,borderColor:n.ColorHelper.Convert(r.plotArea.borderStyle.borderColor),borderType:t.convertBorderType(r.plotArea.borderStyle.borderType),show:!0}},r.prototype.sortSeriesByDate=function(n){var u=n.xAxis,f=n.yAxis,i,t,r;if(u&&u.type==="time"||f&&f.type==="time"){if(i=n.series,i==null||i.length<=0)return;if(t=this.chartDataInfo.categoryAxisInfo||this.chartDataInfo.xValueAxisInfo,t.isDateAxis)for(r=0;r<i.length;r++)i[r].data.sort(function(n,i){return n.value!==undefined&&i.value!==undefined?n.value[t.dateIndexInSeriesDataArray]-i.value[t.dateIndexInSeriesDataArray]:n[t.dateIndexInSeriesDataArray]-i[t.dateIndexInSeriesDataArray]})}},r.prototype.convertChartTooltip=function(){var n={};return n.trigger=this.getTooltipTriggerType(),t._isUnitTest===!1&&(n.formatter=this.getToolTipFormatter()),n},r.prototype.getTooltipTriggerType=function(){var n=this.chartDataInfo.seriesInfos.some(function(n){var i=t.getSXChartType(n.series.chartType);return i===4?!0:i===1||i===8?n.series.chartType.toLowerCase().indexOf("markers")===-1||n.series.markerType.toLowerCase()==="none"||n.series.markerHeight===0:!1});return n?"axis":"item"},r.prototype.getToolTipFormatter=function(){var n=this;return function(t){return t.length===undefined?n.getItemFormatterTextFromTooltipParams(t):n.getAxisFormatterTextFromTooltipParams(t)}},r.prototype.getItemFormatterTextFromTooltipParams=function(t){var r=this.chartDataInfo.categoryAxisInfo,i=t.value,u;return t.data.orignalValue!==undefined?i=t.data.orignalValue:r.isDateAxis&&(i=t.value[1-r.dateIndexInSeriesDataArray]),this.chartDataInfo.seriesInfos[t.seriesIndex].series.cellsFormatter&&(i=n.FormatHelper.format(this.chartDataInfo.seriesInfos[t.seriesIndex].series.cellsFormatter,i).text),u=r.isDateAxis?t.seriesName+"<br/>"+n.FormatHelper.format(r.axis.labelFormatter,t.value[r.dateIndexInSeriesDataArray]).text+" : "+i:t.name+"<br/>"+t.seriesName+" : "+i,t.seriesType==="pie"&&(u+=" ("+t.percent+"%)"),u},r.prototype.getAxisFormatterTextFromTooltipParams=function(t){var i,r;if(t.length>0){var u=this.chartDataInfo.categoryAxisInfo,e=u.isDateAxis?n.FormatHelper.format(u.axis.labelFormatter,t[0].value[u.dateIndexInSeriesDataArray]).text:t[0].name,f=e;for(i=0;i<t.length;i++)r=t[i].value,t[i].data.orignalValue!==undefined?r=t[i].data.orignalValue:u.isDateAxis&&(r=t[i].value[1-u.dateIndexInSeriesDataArray]),this.chartDataInfo.seriesInfos[t[i].seriesIndex].series.cellsFormatter&&(r=n.FormatHelper.format(this.chartDataInfo.seriesInfos[t[i].seriesIndex].series.cellsFormatter,r).text),f+="<br/>"+t[i].seriesName+" : "+r;return f}},r.prototype.convertChartTitle=function(i){return i?{left:"center",top:Math.floor(i.borderStyle.borderWidth/2)+1,text:i.text,backgroundColor:t.convertBackgoundColor(i.backgroundColor,this.forPaint),borderColor:n.ColorHelper.Convert(i.borderStyle.borderColor),borderWidth:i.borderStyle.borderWidth,borderType:t.convertBorderType(i.borderStyle.borderType),textStyle:t.convertTextStyle(i.textStyle)}:null},r.prototype.convertChartLegend=function(i){var o;if(!i)return null;var s=i.orientation.toLowerCase(),u=this.getLegendData(),r={show:!0,orient:s,align:"left",backgroundColor:t.convertBackgoundColor(i.backgroundColor,this.forPaint),borderColor:n.ColorHelper.Convert(i.borderStyle.borderColor),borderWidth:i.borderStyle.borderWidth,borderType:t.convertBorderType(i.borderStyle.borderType),textStyle:t.convertTextStyle(i.textStyle),data:u},f=t.convertAlignmentToX(i.alignment),e=t.convertAlignmentToY(i.alignment);return f==="left"?r.left=n.ChartLayoutHelper.legendMargin:f==="right"?r.right=n.ChartLayoutHelper.legendMargin:r.left="center",e==="top"?r.top=n.ChartLayoutHelper.legendMargin:e==="bottom"?r.bottom=n.ChartLayoutHelper.legendMargin:r.top="center",o=u.every(function(n){return n.icon==="roundRect"}),(o||this.chartDataInfo.chartType===7)&&(r.itemWidth=14),r},r.prototype.getLegendData=function(){var n=[];return this.chartDataInfo.seriesInfos.forEach(function(i){var f=i.series,r=f.chartType.toLowerCase(),u=null,e;r.indexOf("line")!==-1?r.indexOf("marker")===-1?u="line":(f.markerType.toLowerCase()==="none"||f.markerHeight===0)&&(u="line"):r==="radar"?u="line":(r.indexOf("area")!==-1||r.indexOf("bar")!==-1||r.indexOf("column")!==-1||r.indexOf("radar")!==-1)&&(u="roundRect");e={name:t.IsEmpty(f.name)?" ":f.name};u&&(e.icon=u);n.push(e)}),n},r.prototype.convertDataSeries=function(){for(var u,o,f,l,a,h=[],c=this.chartDataInfo.seriesInfos,s=0;s<c.length;s++){var e=c[s],r=e.series,i={};i.name=r.name;i.z=e.zIndex;u=t.getSXChartType(r.chartType);i.type=t.convertChartTypeToEChart(u);r.IsSecondaryAxis&&(i.yAxisIndex=1);i.data=this.getSeriesData(e);i.label=this.getSeriesDataLabel(e);i.itemStyle={};i.itemStyle.color=this.getSeriesColor(r);i.itemStyle.opacity=1;(u===3||u===0)&&(o=i,o.barGap=0,o.barCategoryGap="30%",o.itemStyle.borderColor=n.ColorHelper.Convert(r.borderStyle.borderColor),o.itemStyle.borderWidth=r.borderStyle.borderWidth,o.itemStyle.borderType=t.convertBorderType(r.borderStyle.borderType));(u===1||u===4||u===5||u===7||u===8||u===9)&&(f=i,f.showAllSymbol=!0,f.connectNulls=this.chartDataInfo.displayEmptyCellAs==="connect"?!0:!1,u!==7&&(f.lineStyle=t.convertBorderStyle(r.borderStyle)),r.chartType.toLowerCase().indexOf("smooth")!==-1&&(f.smooth=!0),this.convertChartMarker(e,f),(u===4||r.chartType.toLocaleLowerCase()==="radarfilled")&&(f.areaStyle={},f.areaStyle.color=t.convertBackgoundColor(r.backgroundColor,this.forPaint),f.areaStyle.opacity=1));t.isStackedChart(r.chartType)&&(l=this.useEchartDefaultStack(e),l&&(a=i,a.stack=e.stackedSummary));h.push(i)}return h},r.prototype.getSeriesData=function(n){var e=this.chartDataInfo.displayEmptyCellAs,i=this.chartDataInfo.categoryAxisInfo,l=i.isDateAxis,r,o,s,h,c;l&&(r=i.data,o=i.dateIndexInSeriesDataArray,s=1-i.dateIndexInSeriesDataArray);var a=this,u=n.data,f=this.useEchartDefaultStack(n);return f||(u=n.stackedData),n.is100percentChart&&(u=f?n.percentData:n.stackedPercentData),h=i.axis.labelFormatter,c=u.map(function(i,u){var l=t.parseToNumber(i,e),w=t.parseToNumber(n.data[u],e),p,c,y;n.percentData&&(p=n.percentData[u]);var v=a.getSeriesDataPointConditionalFormatStyle(n,w,u,p),b=v.itemStyle,k=v.markerType,d=v.markerSize;return r&&r.length>0&&(c=[],c[o]=t.ConvertToEchartDate(r[u],h),c[s]=l,l=c),y={value:l,itemStyle:b,symbol:k,symbolSize:d},(!f||n.is100percentChart)&&(y.orignalValue=n.data[u]),y}),c},r.prototype.getSeriesDataPointConditionalFormatStyle=function(n,i,r,u){var f,e,o,h;if(u===void 0&&(u=null),f=n.conditionalFormatRules,!f||f.length===0)return{};var s=this.chartDataInfo.categoryAxisInfo,l=n.data.slice(0,n.data.length).sort(function(n,i){return t.toNumber(n)-t.toNumber(i)}),c=!1;for(e=0;e<f.length;e++)if(o=void 0,s&&s.formattedData?o=s.formattedData[r]:this.chartDataInfo.xValueAxisInfo&&(o=n.xData[r]),h=NaN,n.sizeData&&(h=n.sizeData[r]),c=this.isMatchConditionalFormat(f[e],i,o,h,u,l),c)return this.convertConditionFormatStyleInfo(f[e]);return{}},r.prototype.convertConditionFormatStyleInfo=function(i){var r,u,f;return i?(r={},t.IsEmpty(i.background)||(r.color=n.ColorHelper.Convert(i.background)),i.enableBorder&&(t.IsEmpty(i.borderStyle.borderColor)||(r.borderColor=n.ColorHelper.Convert(i.borderStyle.borderColor)),t.IsEmpty(i.borderStyle.borderWidth)||(r.borderWidth=i.borderStyle.borderWidth),t.IsEmpty(i.borderStyle.borderType)||(r.borderType=t.convertBorderType(i.borderStyle.borderType))),i.enableMarker&&(t.IsEmpty(i.markerType)||(u=t.convertChartMarker(i.markerType,this.getChartSeriesDefaultMarker())),i.markerSize>0&&(f=i.markerSize)),{itemStyle:r,markerType:u,markerSize:f}):{}},r.prototype.isMatchConditionalFormat=function(r,u,f,e,o,s){var h,c,p,b,k,l,d,a;if(!r||!r.conditions)return!0;for(h=0;h<r.conditions.length;h++){c=r.conditions[h].ConditionKind;switch(c){case 0:return p=r.conditions[h],b=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(p.Value,this.getDefaultFormulaCalcInfo()),!!i.calculateTextConditionResult(p.CompareType,f,b);case 1:case 2:case 3:case 4:case 7:c===2?u=f:c===4?u=e:c===7&&(u=o);var w=r.conditions[h],v=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(w.Value1,this.getDefaultFormulaCalcInfo()),y=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(w.Value2,this.getDefaultFormulaCalcInfo());return c===3&&(t.IsEmpty(f)||(u=t.ConvertToOADate(t.ConvertToEchartDate(f,null))),t.IsEmpty(v)||(v=t.ConvertToOADate(t.ConvertToEchartDate(v,null))),t.IsEmpty(y)||(y=t.ConvertToOADate(t.ConvertToEchartDate(y,null)))),!!i.calculateNumberConditionResult(w.CompareType,u,v,y);case 5:return(k=r.conditions[h],l=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(k.Value,this.getDefaultFormulaCalcInfo()),isNaN(l)||l<=0)?!1:(l>s.length&&(l=s.length),s.slice(s.length-l,s.length).indexOf(u)!==-1);case 6:return(d=r.conditions[h],a=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(d.Value,this.getDefaultFormulaCalcInfo()),isNaN(a)||a<=0)?!1:(a>s.length&&(a=s.length),s.slice(0,a).indexOf(u)!==-1);default:break}}return!0},r.prototype.getDefaultFormulaCalcInfo=function(){return{runTimePageName:this.runTimePageName,supportReferToListview:!0,nullAsException:!1,listInfo:null,rowOffset:0,columnOffset:0}},r.prototype.getSeriesColor=function(i){var r=t.getSXChartType(i.chartType);return r===1?n.ColorHelper.Convert(i.borderStyle.borderColor):t.convertBackgoundColor(i.backgroundColor,this.forPaint)},r.prototype.getSeriesDataLabel=function(n){var i={},r=n.series,f=r.dataLabelSettings,u,e;return f&&(u=this.showSeriesDataLabel(f),i.show=u,u&&(i.position=this.getDataLabelPosition(n),t._isUnitTest===!1&&(e=this,i.formatter=function(n){return function(t){return e.getDataSeriesLabelFormatter(t,n)}}(r)),this.setSeriesDataLabelStyle(r,i))),i},r.prototype.getDataLabelPosition=function(n){var i=t.getSXChartType(n.series.chartType);return i===1?"right":i===4?"bottom":i===3?"inside":t.IsEmpty(n.stackedSummary)?"outside":"inside"},r.prototype.showSeriesDataLabel=function(n){return n&&(n.showCategoryName===!0||n.showSeriesName===!0||n.showValue===!0||n.showPercent===!0||n.showBubbleSize===!0)?!0:!1},r.prototype.getDataSeriesLabel_CategoryName=function(t){if(t.value&&t.value.length>1&&this.chartDataInfo.categoryAxisInfo){var i=this.chartDataInfo.categoryAxisInfo.dateIndexInSeriesDataArray,r=t.value[i];return n.FormatHelper.format(this.chartDataInfo.categoryAxisInfo.axis.labelFormatter,r).text}return t.name},r.prototype.getDataSeriesLabelFormatter=function(t,i){var r=[],u,o,e,f;return i.dataLabelSettings&&(i.dataLabelSettings.showSeriesName===!0&&r.push(t.seriesName),i.dataLabelSettings.showCategoryName===!0&&r.push(this.getDataSeriesLabel_CategoryName(t)),i.dataLabelSettings.showValue===!0&&(u=t.value,t.data.orignalValue!==undefined?u=t.data.orignalValue:t.value&&t.value.length>1&&(this.chartDataInfo.categoryAxisInfo?(o=1-this.chartDataInfo.categoryAxisInfo.dateIndexInSeriesDataArray,u=t.value[o]):u=t.value[1]),e=this.chartDataInfo.valueAxisInfo.axis,i.IsSecondaryAxis&&(e=this.chartDataInfo.valueAxisInfo2.axis),f=e.displayUnit,isNaN(f)||f==0||(u=u/f),i.dataLabelStyle.formatter!=null&&(u=n.FormatHelper.format(i.dataLabelStyle.formatter,u).text),r.push(u)),i.dataLabelSettings.showPercent===!0&&(i.dataLabelSettings.showValue?r.push(Math.round(t.percent)+"%"):i.dataLabelStyle&&i.dataLabelStyle.formatter&&i.dataLabelStyle.formatter.toLocaleLowerCase()!=="general"?r.push(n.FormatHelper.format(i.dataLabelStyle.formatter,t.percent/100).text):r.push(Math.round(t.percent)+"%")),i.dataLabelSettings.showBubbleSize===!0&&(!i.dataLabelSettings.showValue&&i.dataLabelStyle&&i.dataLabelStyle.formatter?r.push(n.FormatHelper.format(i.dataLabelStyle.formatter,t.value[2]).text):r.push(t.value[2]))),r.join(i.dataLabelSettings.separator)},r.prototype.setSeriesDataLabelStyle=function(i,r){if(i.dataLabelStyle){var u=i.dataLabelStyle.textStyle;u&&(r.color=n.ColorHelper.Convert(u.color),r.fontFamily="'"+u.fontFamily+"'",r.fontSize=u.fontSize,r.fontStyle=u.fontStyle,r.fontWeight=u.fontWeight);r.backgroundColor=t.convertBackgoundColor(i.dataLabelStyle.backgroundColor,this.forPaint);r.borderColor=n.ColorHelper.Convert(i.dataLabelStyle.borderStyle.borderColor);r.borderWidth=i.dataLabelStyle.borderStyle.borderWidth;r.borderType=t.convertBorderType(i.dataLabelStyle.borderStyle.borderType);r.padding=3}},r.prototype.getChartSeriesMarker=function(n){return t.convertChartMarker(n.markerType,this.getChartSeriesDefaultMarker())},r.prototype.getChartSeriesDefaultMarker=function(){return"diamond"},r.prototype.supportMarker=function(n){return n.chartType.toLowerCase().indexOf("markers")!==-1&&n.markerType.toLowerCase()!=="none"?!0:!1},r.prototype.convertChartMarker=function(n,t){var i=n.series;this.supportMarker(i)?(t.symbol=this.getChartSeriesMarker(i),t.symbolSize=parseInt(Math.sqrt(i.markerHeight*i.markerHeight).toFixed(0))):this.showSeriesDataLabel(i.dataLabelSettings)?(t.symbol="line",t.symbolSize=.1):t.symbol="none"},r.prototype.convertAxes=function(n){var i=this.getDateAxisMaxMinData(),r=this.getValueAxisMaxMinData(),u=this.getValueAxisMaxMinData(!0),f=this.convertAxis(this.chartDataInfo.categoryAxisInfo,i.max,i.min),e=this.convertAxis(this.chartDataInfo.valueAxisInfo,r.max,r.min),o,s;this.option.xAxis=this.chartDataInfo.chartType===3?e:f;this.option.yAxis=this.chartDataInfo.chartType===3?f:e;n.HasSecondaryYAxis&&(o=this.convertAxis(this.chartDataInfo.valueAxisInfo2,u.max,u.min),this.option.yAxis=[this.option.yAxis,o]);s=n.dataSeries.every(function(n){return t.getSXChartType(n.chartType)===4});this.option.xAxis.boundaryGap=s?!1:!0},r.prototype.convertAxis=function(n,t,i){var u=n.axis,r={};return r.show=u.visible===!0?!0:!1,this.convertAxisTypeToEChart(n,r),this.convertAxisTitleToEChart(u,r),this.convertAxisLineToEChart(u,r),this.convertAxisTickToEChart(u,r),this.convertAxisLabelToEChart(u,r),this.convertAxisSplitLineToEChart(u,r),r.type=="category"?r.data=n.formattedData:r.type=="time"?this.convertDateAxisMaxAndMinValue(r,t,i):r.type=="log"?this.convertLogAxisMaxAndMinValue(u,r,t,i):this.convertValueAxisMaxAndMinValue(u,r,t,i),r},r.prototype.convertAxisTypeToEChart=function(n,t){var i=n.axis;switch(i.type.toLowerCase()){case"date":t.type=n.isDateAxis?"time":"category";break;case"category":t.type="category";break;case"value":i.useLogBase!==!0||isNaN(i.logBase)?t.type="value":(t.type="log",t.logBase=i.logBase);break;default:break}},r.prototype.convertAxisTitleToEChart=function(i,r){if(i.title!=null){var u=i.title;r.name=u.text;r.nameTextStyle=t.convertTextStyle(u.textStyle);r.nameTextStyle.backgroundColor=t.convertBackgoundColor(u.backgroundColor,this.forPaint);r.nameTextStyle.borderColor=n.ColorHelper.Convert(u.borderStyle.borderColor);r.nameTextStyle.borderWidth=u.borderStyle.borderWidth;r.nameTextStyle.borderType=t.convertBorderType(u.borderStyle.borderType);r.nameTextStyle.padding=[3,2]}},r.prototype.getAxisLine=function(n){var i=n.visible===!0?!0:!1,r={show:i};return i&&(r.lineStyle=t.convertBorderStyle(n.borderStyle)),r},r.prototype.convertAxisLineToEChart=function(n,t){t.axisLine=this.getAxisLine(n)},r.prototype.getAxisTick=function(t){if(!t.visible)return{show:!1,length:0};var r=t.tickPosition,i={};return i.show=r.toLowerCase()!=="none"?!0:!1,i.inside=r.toLowerCase()==="inside"?!0:!1,i.length=t.tickHeight,i.lineStyle={color:n.ColorHelper.Convert(t.borderStyle.borderColor),width:t.borderStyle.borderWidth},i},r.prototype.convertAxisTickToEChart=function(n,t){t.axisTick=this.getAxisTick(n)},r.prototype.getAxisLabel=function(i,r){var u=0,f;return i.labelAngle!=null&&(u=Number(i.labelAngle),u=isNaN(u)?0:-u),f={show:i.showAxisLabel===!0?!0:!1,rotate:u,textStyle:t.convertTextStyle(i.textStyle)},t._isUnitTest===!1&&(f.formatter=function(t){return function(i){return r==="time"?i=new Date(i):(r==="value"||r==="log")&&(isNaN(t.displayUnit)||t.displayUnit==0||(i=i/t.displayUnit)),r!=="category"?n.FormatHelper.format(t.labelFormatter,i).text:i}}(i)),f},r.prototype.convertAxisLabelToEChart=function(n,t){t.axisLabel=this.getAxisLabel(n,t.type)},r.prototype.getSplitLine=function(n){var i=n.showGridlines?!0:!1,r={show:i};return i&&(r.lineStyle=t.convertBorder(n.gridlinesColor,n.gridlinesWidth,n.gridlinesType)),r},r.prototype.convertAxisSplitLineToEChart=function(n,t){t.splitLine=this.getSplitLine(n)},r.prototype.getValueAxisMaxMinData=function(n){n===void 0&&(n=!1);var i=this.chartDataInfo.seriesInfos.filter(function(t){return!!t.series.IsSecondaryAxis==!!n}),r=i.map(function(n){return n.is100percentChart?Math.max.apply(Math,n.stackedPercentData):t.IsEmpty(n.stackedSummary)?Math.max.apply(Math,n.data.map(t.toNumber)):Math.max.apply(Math,n.stackedData)}),u=i.map(function(n){return n.is100percentChart?Math.min.apply(Math,n.stackedPercentData):t.IsEmpty(n.stackedSummary)?Math.min.apply(Math,n.data.map(t.toNumber)):Math.min.apply(Math,n.stackedData)});return{max:Math.max.apply(Math,r),min:Math.min.apply(Math,u)}},r.prototype.getDateAxisMaxMinData=function(){var f=this.chartDataInfo.categoryAxisInfo,h=f.isDateAxis,n;if(!h)return{max:0,min:0};var e=0,o=0,i=f.data;if(i){var r=0,u=0,s=!1;for(n=0;n<i.length;n++)t.IsEmpty(i[n])||(typeof i[n]=="string"&&(i[n]=t.ConvertToEchartDate(i[n],f.axis.labelFormatter)),i[n]instanceof Date&&(i[n]=t.ConvertToOADate(i[n])),s?(i[n]>r&&(r=i[n]),i[n]<u&&(u=i[n])):(r=i[n],u=i[n],s=!0));e=r;o=u}return{max:e,min:o}},r.prototype.getValueAxisMaxMinValue=function(n,t,i){var r,u,f;return n.autoMax?(t===0&&i===0&&(t=1),t<0&&(t=1.2*t<=i&&t>i?parseFloat((t+.5*(t-i)).toPrecision(15)):0)):t=n.max?n.max:0,n.autoMin?i>0&&(i=t<=1.2*i&&t>i?parseFloat((i-.5*(t-i)).toPrecision(15)):0):i=n.min?n.min:0,n.autoMajorUnit?(u=parseFloat(Math.abs(t-i).toPrecision(15)),r=Math.pow(10,Math.floor(Math.log(u)/Math.log(10))),u/r<=1.6?r/=5:u/r<=4?r/=2:u/r>8&&(r*=2)):r=n.majorUnit?n.majorUnit:0,n.autoMax?(this.isMaxValueAutoTouchAxisTopBottom()||(t>0&&t%r==0||Math.abs(t%r)>r/2)&&(t+=r),t=Math.ceil(t/r)*r):t=n.max===undefined?0:n.max,n.autoMin?(this.isMaxValueAutoTouchAxisTopBottom()||i<0&&(i%r==0||Math.abs(i%r)>r/2)&&(i-=r),i=Math.floor(i/r)*r):i=n.min===undefined?0:n.min,f=parseFloat((t-i).toPrecision(15)),r=parseFloat(r.toPrecision(15)),{max:parseFloat(t.toPrecision(15)),min:parseFloat(i.toPrecision(15)),splitNumber:parseFloat((f/r).toPrecision(15)),interval:!n.autoMajorUnit&&n.majorUnit?n.majorUnit:undefined}},r.prototype.isMaxValueAutoTouchAxisTopBottom=function(){return this.chartDataInfo.is100pcChart?!0:!1},r.prototype.convertValueAxisMaxAndMinValue=function(n,t,i,r){var u=this.getValueAxisMaxMinValue(n,i,r);t.max=u.max;t.min=u.min;u.interval?t.interval=u.interval:t.splitNumber=u.splitNumber},r.prototype.getLogAxisMaxMinValue=function(n,t,i){n.autoMax||(t=n.max);n.autoMin||(i=n.min);t<=0&&(t=1);i<=0&&(i=1);var r=Math.floor(Math.log(i)/Math.log(n.logBase)),u=Math.ceil(Math.log(t)/Math.log(n.logBase));return{splitNumber:u-r,max:Math.pow(n.logBase,u),min:Math.pow(n.logBase,r)}},r.prototype.convertLogAxisMaxAndMinValue=function(n,t,i,r){var u=this.getLogAxisMaxMinValue(n,i,r);t.max=u.max;t.min=u.min;t.splitNumber=u.splitNumber},r.prototype.convertDateAxisMaxAndMinValue=function(n,t,i){var u,r=t-i;u=r<2/1440?1/86400:r<10/1440?1/1440:r<30/1440?3/1440:r<2/24?10/1440:r<1?1/24:r<1?2/24:r<2?4/24:r<14?1:r<60?7:r<730?30:365;n.splitNumber=(t-i)/u+1},r.prototype.calcColors=function(n,i){return t.calcColors(n,i)},r}(),i,t,r,u;n.ChartConvertorBase=f;i=function(){function n(){}return n.calculateTextConditionResult=function(t,i,r){switch(t){case 0:return n.contains(i,r);case 1:return!n.contains(i,r);case 2:return n.startsWith(i,r);case 3:return n.endsWith(i,r);case 4:return n.isEqualTo(i,r);case 5:return!n.isEqualTo(i,r);default:return!1}},n.calculateNumberConditionResult=function(n,t,i,r){i||(i=0);r||(r=0);switch(n){case 0:return t>=Math.min(i,r)&&t<=Math.max(i,r);case 1:return t>Math.max(i,r)||t<Math.min(i,r);case 4:return t>i;case 6:return t>=i;case 5:return t<i;case 7:return t<=i;case 2:return t==i;case 3:return t!=i;default:return!1}},n.contains=function(n,i){if(t.IsEmpty(n)||t.IsEmpty(i))return!1;var r=n+"",u=i+"";return r.indexOf(u)!==-1},n.startsWith=function(n,i){if(t.IsEmpty(n)||t.IsEmpty(i))return!1;var r=n+"",u=i+"";return r.indexOf(u)===0},n.endsWith=function(n,i){if(t.IsEmpty(n)||t.IsEmpty(i))return!1;var r=n+"",u=i+"",f=r.lastIndexOf(u);return f!==-1&&f===r.length-u.length},n.isEqualTo=function(n,i){return t.IsEmpty(n)?t.IsEmpty(i)?!0:!1:n==i},n}();n.ChartConditionHelper=i;t=function(){function t(){}return t.calcColors=function(t,i){var e=[],r,h,c;if(t.ColorList&&t.ColorList.length!==0||(t.ColorList=n.ColorHelper.Colors.slice(4,10)),t.ChartColorGenerateAlgorithm==0){var l=this.GetBasedThemeColor(t.ColorList[0]),o=this.GetThemeColorLOffset(t.ColorList[0]),a=this.GetThemeColorLOffset(t.ColorList[t.ColorList.length-1]),v=i<=1?0:(a-o)/(i-1);for(r=0;r<i;r++)e.push(this.UpdateThemeColorLOffset(l,o+r*v))}else if(t.ChartColorGenerateAlgorithm==1)for(var u=0,f=0,s=0;s<i;)h=t.ColorList[u],c=t.RepeatAlgorithmTint[f],e.push(this.UpdateThemeColorLOffset(h,c)),s++,u++,u>=t.ColorList.length&&(u=0,f++,f>=t.RepeatAlgorithmTint.length&&(f=0));return e.map(function(t){return n.ColorHelper.Convert(t)})},t.UpdateThemeColorLOffset=function(t,i){if(!n.ColorHelper.IsThemeColor(t))return t;var r=t.split(" ");return r.length>=3?r[2]=i+"":r=[r[0],r[1],i+""],r.join(" ")},t.GetBasedThemeColor=function(n){var t=n.split(" ");return t[0]+" "+t[1]},t.GetThemeColorLOffset=function(n){var t=n.split(" ");return t.length>=3?Number(t[2]):0},t.IsEmpty=function(n){return n===null||n===""||n===undefined?!0:!1},t.getMapChartGeoJsonInfo=function(i,r){var e,u,o,s,f;if(!i)return null;if(e={runTimePageName:r,supportReferToListview:!0,nullAsException:!1,listInfo:null,rowOffset:0,columnOffset:0},u=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(i.GeoAreaJsonFileName,e),typeof u!="string"||t.IsEmpty(u))return null;else u=u.replace(/\\/g,"/"),o=n.ForguncyData.ForguncyRoot+"GeneratedResources/UserMapFile/"+u+"_area.json";return f=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(i.GeoPointJsonFileName,e),t.IsEmpty(f)||(f=f.replace(/\\/g,"/"),s=n.ForguncyData.ForguncyRoot+"GeneratedResources/UserMapFile/"+f+"_point.json"),{areaJsonFileFullPath:t.IsEmpty(o)?null:o+"?v="+n.StaticData.MetaDataVersion,geoAreaJsonKey:t.IsEmpty(u)?"":u.replace(/\//g,"_"),pointJsonFileFullPath:t.IsEmpty(s)?null:s+"?v="+n.StaticData.MetaDataVersion}},t.convertChartModelToECharts=function(i,r,u,f){f===void 0&&(f=null);var h=n.ConvertChartHelper.getSXChartType(i.chartType),o=t.getMapChartGeoJsonInfo(f,u),s,e;return o&&(s=o.geoAreaJsonKey,e=null,f.GeoPointJsonContent&&(e=JSON.parse(f.GeoPointJsonContent))),this.CreateConverter(h,u).convertChartModelToEchart(i,r,{geoAreaJsonKey:s,geoPointJsonObject:e})},t.CreateConverter=function(t,i){return t===2||t===6?new n.PieChartConvertor(i):t===5?new n.RadarChartConvertor(i):t===7||t===8||t===9?new n.ScatterChartConvertor(i):t===10||t===11||t===12?new n.MapChartConvertor(i):new n.ChartConvertorBase(i)},t.getDataFormatterTextFromFormula=function(i,r,u){var o=[],s=n.Common.returnArrayFormulaItems(i),c,h,f,e;if(s!==null)for(c=s.length,f=0;f<c;f++)e=s[f],o.push(e);else for(h=n.Common.parseCellReferenceFormula(i,u),length=h.length,f=0;f<length;f++)e=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(h[f]),o.push(e);return o.map(function(n){return t.getFormatValue(n,r)})},t.getFormatValue=function(t,i){return i===null?t instanceof Date&&(t=n.FormatHelper.format("yyyy/M/d",t).text):t=n.FormatHelper.format(i,t).text,t},t.getDataFromFormula=function(i,r){var o=[],s=n.Common.returnArrayFormulaItems(i),e,h,f,u;if(s!==null)return s;for(e=n.Common.parseCellReferenceFormula(i,r),h=e.length,f=0;f<h;f++)u=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(e[f]),u instanceof Date&&(u=t.ConvertToOADate(u)),o.push(u);return o},t.getDataFromListViewColumnMappingInfo=function(t,i){var r,e;if(!t)return null;var o=t.listViewName,u=n.ForguncyData.pageInfo.dataModel.getListDataByListviewName(o,i),s=u.getRowCount(),f=[];for(r=0;r<s;r++)e=u.getValue(r,t.columnIndex),f.push(e);return f},t.getDataFromListView=function(t,i,r,u){return n.ForguncyData.pageInfo.dataModel.getListDataByListviewName(t,u).getValue(i,r)},t.getCategoryAxisData=function(n,i){var f=[],e=n.axis,w=e.itemsFormula,o=e.items.length,u,s,v,h,y,c,l,r,p,a;if(t.IsEmpty(w)){for(r=1;r<=o;r++)f.push(r+"");return f}for(u=t.getDataFormatterTextFromFormula(w,e.labelFormatter,i),s=0;s<u.length;s++)u[s]==null&&(u[s]="");if(u.length<=o||n.isDateAxis)return u;if(v="vertical",e.itemsDataOrientation&&(v=e.itemsDataOrientation.toLocaleLowerCase()),v==="vertical")for(h=0,y=u.length/o,c=0;c<u.length;c=c+y){for(f[h]==null&&(f[h]=[]),l=0;l<y;l++)f[h].push(u[c+l]);h++}else for(r=0;r<u.length;r++)f[r%o]==null&&(f[r%o]=[]),f[r%o].push(u[r]);for(p=[],a=0;a<f.length;a++)p.push(f[a].join(e.itemsValueSeperator));return p},t.ConvertToEchartDate=function(t,i){if(t==null)return"";if(typeof t=="string")try{return n.FormatHelper.getValueFromText(t,i)}catch(u){}if(t instanceof Date)return t;var r=Number(t);return n.SpreadJSHelpMethods._DateTimeHelper._fromOADate(r)},t.ConvertToOADate=function(t){return n.SpreadJSHelpMethods._DateTimeHelper.___toOADate(t)},t.parseToNumber=function(n,i){var u="-",r;if(i==="zero"?u=0:i==="connect"&&(u=null),r=n,t.IsEmpty(r))return u;try{r instanceof Date?r=t.ConvertToOADate(r):(r=Number(r),isNaN(r)&&(r=u))}catch(f){r=u}return r},t.convertChartMarker=function(n,t){return t===void 0&&(t="diamond"),n=n.toLowerCase(),n==="none"?"none":n==="box"?"rect":n==="dot"?"pin":n==="diamond"?"diamond":n==="triangle"?"triangle":n==="star4"?"path://M0 100 L75 75 L100 0 L125 75 L200 100 L125 125 L100 200 L75 125 Z":n==="star8"?"path://M0 100 L50 80 L30 30 L80 50 L100 0 L120 50 L170 30 L150 80 L200 100 L150 120 L170 170 L120 150 L100 200 L80 150 L30 170 L50 120Z":n==="circle"?"circle":n==="cross"?"path://M63.47 0.01L63.54 0.01L63.6 0.02L63.67 0.03L63.73 0.05L63.8 0.07L63.86 0.09L63.92 0.11L63.98 0.13L64.04 0.16L64.1 0.19L64.16 0.22L64.21 0.25L64.26 0.28L64.32 0.32L64.37 0.36L64.42 0.4L64.47 0.44L64.51 0.49L64.56 0.53L64.6 0.58L64.64 0.63L64.68 0.68L64.72 0.74L64.75 0.79L64.78 0.84L64.81 0.9L64.84 0.96L64.87 1.02L64.89 1.08L64.91 1.14L64.93 1.2L64.95 1.27L64.97 1.33L64.98 1.4L64.99 1.46L64.99 1.53L65 1.6L65 1.67L65 35L98.33 35L98.4 35L98.47 35.01L98.54 35.01L98.6 35.02L98.67 35.03L98.73 35.05L98.8 35.07L98.86 35.09L98.92 35.11L98.98 35.13L99.04 35.16L99.1 35.19L99.16 35.22L99.21 35.25L99.26 35.28L99.32 35.32L99.37 35.36L99.42 35.4L99.47 35.44L99.51 35.49L99.56 35.53L99.6 35.58L99.64 35.63L99.68 35.68L99.72 35.74L99.75 35.79L99.78 35.84L99.81 35.9L99.84 35.96L99.87 36.02L99.89 36.08L99.91 36.14L99.93 36.2L99.95 36.27L99.97 36.33L99.98 36.4L99.99 36.46L99.99 36.53L100 36.6L100 36.67L100 63.33L100 63.4L99.99 63.47L99.99 63.54L99.98 63.6L99.97 63.67L99.95 63.73L99.93 63.8L99.91 63.86L99.89 63.92L99.87 63.98L99.84 64.04L99.81 64.1L99.78 64.16L99.75 64.21L99.72 64.26L99.68 64.32L99.64 64.37L99.6 64.42L99.56 64.47L99.51 64.51L99.47 64.56L99.42 64.6L99.37 64.64L99.32 64.68L99.26 64.72L99.21 64.75L99.16 64.78L99.1 64.81L99.04 64.84L98.98 64.87L98.92 64.89L98.86 64.91L98.8 64.93L98.73 64.95L98.67 64.97L98.6 64.98L98.54 64.99L98.47 64.99L98.4 65L98.33 65L65 65L65 98.33L65 98.4L64.99 98.47L64.99 98.54L64.98 98.6L64.97 98.67L64.95 98.73L64.93 98.8L64.91 98.86L64.89 98.92L64.87 98.98L64.84 99.04L64.81 99.1L64.78 99.16L64.75 99.21L64.72 99.26L64.68 99.32L64.64 99.37L64.6 99.42L64.56 99.47L64.51 99.51L64.47 99.56L64.42 99.6L64.37 99.64L64.32 99.68L64.26 99.72L64.21 99.75L64.16 99.78L64.1 99.81L64.04 99.84L63.98 99.87L63.92 99.89L63.86 99.91L63.8 99.93L63.73 99.95L63.67 99.97L63.6 99.98L63.54 99.99L63.47 99.99L63.4 100L63.33 100L36.67 100L36.6 100L36.53 99.99L36.46 99.99L36.4 99.98L36.33 99.97L36.27 99.95L36.2 99.93L36.14 99.91L36.08 99.89L36.02 99.87L35.96 99.84L35.9 99.81L35.84 99.78L35.79 99.75L35.74 99.72L35.68 99.68L35.63 99.64L35.58 99.6L35.53 99.56L35.49 99.51L35.44 99.47L35.4 99.42L35.36 99.37L35.32 99.32L35.28 99.26L35.25 99.21L35.22 99.16L35.19 99.1L35.16 99.04L35.13 98.98L35.11 98.92L35.09 98.86L35.07 98.8L35.05 98.73L35.03 98.67L35.02 98.6L35.01 98.54L35.01 98.47L35 98.4L35 98.33L35 65L1.67 65L1.6 65L1.53 64.99L1.46 64.99L1.4 64.98L1.33 64.97L1.27 64.95L1.2 64.93L1.14 64.91L1.08 64.89L1.02 64.87L0.96 64.84L0.9 64.81L0.84 64.78L0.79 64.75L0.74 64.72L0.68 64.68L0.63 64.64L0.58 64.6L0.53 64.56L0.49 64.51L0.44 64.47L0.4 64.42L0.36 64.37L0.32 64.32L0.28 64.26L0.25 64.21L0.22 64.16L0.19 64.1L0.16 64.04L0.13 63.98L0.11 63.92L0.09 63.86L0.07 63.8L0.05 63.73L0.03 63.67L0.02 63.6L0.01 63.54L0.01 63.47L0 63.4L0 63.33L0 36.67L0 36.6L0.01 36.53L0.01 36.46L0.02 36.4L0.03 36.33L0.05 36.27L0.07 36.2L0.09 36.14L0.11 36.08L0.13 36.02L0.16 35.96L0.19 35.9L0.22 35.84L0.25 35.79L0.28 35.74L0.32 35.68L0.36 35.63L0.4 35.58L0.44 35.53L0.49 35.49L0.53 35.44L0.58 35.4L0.63 35.36L0.68 35.32L0.74 35.28L0.79 35.25L0.84 35.22L0.9 35.19L0.96 35.16L1.02 35.13L1.08 35.11L1.14 35.09L1.2 35.07L1.27 35.05L1.33 35.03L1.4 35.02L1.46 35.01L1.53 35.01L1.6 35L1.67 35L35 35L35 1.67L35 1.6L35.01 1.53L35.01 1.46L35.02 1.4L35.03 1.33L35.05 1.27L35.07 1.2L35.09 1.14L35.11 1.08L35.13 1.02L35.16 0.96L35.19 0.9L35.22 0.84L35.25 0.79L35.28 0.74L35.32 0.68L35.36 0.63L35.4 0.58L35.44 0.53L35.49 0.49L35.53 0.44L35.58 0.4L35.63 0.36L35.68 0.32L35.74 0.28L35.79 0.25L35.84 0.22L35.9 0.19L35.96 0.16L36.02 0.13L36.08 0.11L36.14 0.09L36.2 0.07L36.27 0.05L36.33 0.03L36.4 0.02L36.46 0.01L36.53 0.01L36.6 0L36.67 0L63.33 0L63.4 0L63.47 0.01Z":n==="diagonalcross"?"path://M67.95 50L100 82.05L82.05 100L50 67.95L17.95 100L0 82.05L32.05 50L0 17.95L17.95 0L50 32.05L82.05 0L100 17.95L67.95 50Z":t},t.convertAlignmentToX=function(n){return n.toLocaleLowerCase().indexOf("right")!==-1?"right":n.toLocaleLowerCase().indexOf("left")!==-1?"left":"center"},t.convertAlignmentToY=function(n){return n.toLocaleLowerCase().indexOf("top")!=-1?"top":n.toLocaleLowerCase().indexOf("bottom")!=-1?"bottom":"center"},t.convertBackgoundColor=function(i,r){return t.IsEmpty(i)?"transparent":n.ColorHelper.Convert(i)},t.convertTextStyle=function(t){return t?{color:n.ColorHelper.Convert(t.color),fontFamily:"'"+t.fontFamily+"'",fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight}:null},t.convertBorder=function(i,r,u){var f={};return f.color=n.ColorHelper.Convert(i),f.width=r,f.type=t.convertBorderType(u),f},t.convertBorderStyle=function(n){return t.convertBorder(n.borderColor,n.borderWidth,n.borderType)},t.convertBorderType=function(n){return n=n.toLowerCase(),n==="none"&&(n="solid"),n},t.getSXChartType=function(n){var t=n.toLowerCase();return t.indexOf("column")!==-1?0:t.indexOf("bar")!==-1?3:t.indexOf("line")!==-1?t.indexOf("scatter")!==-1?8:1:t.indexOf("area")!==-1?4:t.indexOf("pie")!==-1?t.indexOf("doughnut")!==-1?6:2:t.indexOf("radar")!==-1?5:t.indexOf("scatter")!==-1?7:t.indexOf("bubble")!==-1?t.indexOf("map")!==-1?11:9:t.indexOf("heatmap")!==-1?12:t.indexOf("colormap")!==-1?10:null},t.convertChartTypeToEChart=function(n){return n===3||n===0?"bar":t.isEchartLineChart(n)?"line":n===2||n===6?"pie":n===5?"radar":n===7||n===9||n===11?"scatter":n===10?"map":n===12?"heatmap":null},t.isEchartLineChart=function(n){return n===1||n===4||n===8?!0:!1},t.isStackedChart=function(n){return n.toLowerCase().indexOf("stacked")!==-1},t.getSeriesStackedSummary=function(n){if(!t.isStackedChart(n.chartType))return null;var i=t.getSXChartType(n.chartType),r=1;return(n.IsSecondaryAxis&&(r=2),!t.IsEmpty(i))?i.toString()+"_"+r:null},t.sum=function(n){return n.reduce(function(n,t){return n+t},0)},t.toNumber=function(n){var t=Number(n);return isNaN(t)?0:t},t.sortSeriesByChartType=function(n,i){var u=t.getSXChartType(n.chartType),r=t.getSXChartType(i.chartType),f,e;if(u===1)return r===1?0:1;else if(r===1)return-1;if(f=n.IsSecondaryAxis,e=i.IsSecondaryAxis,u===0)return r===0?t.sortSeriesBySecondaryAxis(f,e):1;else if(r===0)return-1;if(u===4)return r===4?t.sortSeriesBySecondaryAxis(f,e):-1;else if(r===4)return 1;return 0},t.sortSeriesBySecondaryAxis=function(n,t){if(n)return t?0:1;else if(t)return-1;return 0},t._isUnitTest=!1,t}();n.ConvertChartHelper=t;r=function(){function i(){}return i.isPivotChart=function(n){return n&&n.pivotTableID?!0:!1},i.getPivortChartOption=function(t,r){var f=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells([t]).filter(function(t){if(t.cellType instanceof n.PivotTableCellType){var i=t.cellType;return i.CellElement.CellType.PivotTableID===r.pivotTableID}}),u,e,o;if(f.length>0)return(u=f[0].cellType.getPivot(),e=u.getSetting(),!i.HasPivotSetting(e))?void 0:(o=new PivotData.PivotChartDataBuilder(u,undefined),o.buildChartData());else return},i.HasPivotSetting=function(n){return n.getColumns().length!==0||n.getRows().length!==0||n.getValues().some(function(n){return n.length!==0})},i.correctPivotChartInfo=function(n,t,r){var u,f;this.isPivotChart(t)&&(u=i.getPivortChartOption(r,t),u&&u.data.length>0?(f=this.getCategoryNameArray(u),n.dataSeries=this.getDataSeries(n,u,f),this.setCategoryItems(n,i.getCategoryNames(f))):(n.dataSeries=n.dataSeries.slice(0,1).map(function(n){return n.values=[],n.name="",n}),this.setCategoryItems(n,[])))},i.setCategoryItems=function(n,i){var r=t.getSXChartType(n.chartType);r===3?n.yAxis.items=i:n.xAxis.items=i},i.getDataSeriesNameArray=function(t){var i=this;return t.map(function(t){return n.Common.IsEmpty(t)?"":t.display?t.display:t.name?t.name:i.ConvertDateItemToOADate(t)+""})},i.getDataSeries=function(n,i,r){for(var e,u,h,o,s,y,p=this,c=[],l=i.series.length,a=t.calcColors(n.chartColorPalette,l),v=this.getTemplateDataLabalInfo(n),w=this.buildSeriesNameSeriesMap(i),f=0;f<l;f++)e={},e.borderType="none",e.borderColor=a[f],u={},u.chartType=n.chartType,u.borderStyle=e,h=this.getDataSeriesNameArray(i.series[f]),o=this.joinStringArray(h),u.name=o.trim()?o:" "+o,u.markerHeight=7,u.markerType="Automatic",u.markerWidth=7,u.backgroundColor=a[f],s=w[JSON.stringify(h)],i.shema.axes&&i.shema.axes.length!==0?(y=this.buildCategoryNameArraySeriesValueMap(s),u.values=this.getSeriesValue(r,y)):u.values=s.values.map(function(n){return p.ConvertDateItemToOADate(n.y)}),u.dataLabelSettings=v.dataLabelSetting,u.dataLabelStyle=v.dataLabelStyle,u.cellsFormatter=s.valueFormats[1],c.push(u);return c},i.buildCategoryNameArraySeriesValueMap=function(n){var t=this,i={};return n.values.forEach(function(n){var r=t.ConvertDateItemToOADate(n.y);i[n.axis.every(function(n){return n===null})?JSON.stringify([null]):JSON.stringify(n.axis.map(function(n){return t.ConvertDateItemToOADate(n)}))]=r}),i},i.buildSeriesNameSeriesMap=function(n){var t=this,i={};return n.data.reduce(function(n,i){return n[JSON.stringify(t.getDataSeriesNameArray(i.key))]=i,n},i)},i.getCategoryNameArray=function(n){var r=[],u,t,f,i;if(n&&n.data&&n.data.length>0)for(u=[n.data.axes];!u.every(function(n){return n[0].key===undefined});)for(t=u.shift(),f=r.shift(),i=0;i<t.length;i++)t.hasOwnProperty("key")?r.push(__spreadArrays(f,[this.ConvertDateItemToOADate(t[i].key)])):r.push([this.ConvertDateItemToOADate(t[i].key)]),u.push(t[i]);return r.map(function(n){return n.every(function(n){return n===null})?[null]:n})},i.ConvertDateItemToOADate=function(t){return t instanceof Date?n.ConvertDateToOADate(t):t},i.getCategoryNames=function(n){var t=this;return n.map(function(n){return t.joinStringArray(n)})},i.joinStringArray=function(n){return n.join("-")},i.getTemplateDataLabalInfo=function(n){for(var i=new u,t=0;t<n.dataSeries.length;t++)if(n.dataSeries[t].dataLabelSettings){i.dataLabelSetting=n.dataSeries[t].dataLabelSettings;i.dataLabelStyle=n.dataSeries[t].dataLabelStyle;break}return i},i.getSeriesValue=function(n,t){return n.map(function(n){return JSON.stringify(n)}).map(function(n){return t.hasOwnProperty(n)?t[n]:"-"})},i}();n.PivotChartHelper=r;u=function(){function n(){}return n}()}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.init=function(n,i){t.prototype.init.call(this,n,i);this.chartDataInfo.categoryAxisInfo.isDateAxis=!1},i.prototype.getLegendData=function(){var t=this.chartDataInfo.categoryAxisInfo.formattedData;return t.map(function(t){return{name:n.ConvertChartHelper.IsEmpty(t)?" ":t,icon:"roundRect"}})},i.prototype.supportAxisElement=function(){return!1},i.prototype.getColorPalette=function(n){var t=n.chartColorPalette,i=this.chartDataInfo.categoryAxisInfo.data.length;return this.calcColors(t,i)},i.prototype.convertChartGrid=function(t,i){var r,u;if(t.series&&t.series.length!==0){var o=n.ChartLayoutHelper.GetPieChartLayout(t,i),s=o.center,f=o.radius,l=n.ConvertChartHelper.getSXChartType(i.chartType);if(l===6){var h=i.dataSeries.length,e=.5,a=.85,c=(a-e)/h;for(r=0;r<h;r++)u=t.series[r],u.center=s,u.radius=[f*(e+c*r),f*(e+c*(r+1))]}else u=t.series[0],u.center=s,u.radius=f*.75}},i.prototype.convertDataSeries=function(){var n=this.chartDataInfo.seriesInfos.length,t,i,u,r;if(n===0)return null;for(t=[],this.chartDataInfo.chartType===2&&(n=1),i=0;i<n;i++)u=this.chartDataInfo.seriesInfos[i],r=this.convertSingleSeries(u),r&&t.push(r);return this.chartDataInfo.chartType===6&&n>1&&t.forEach(function(n){n.hoverAnimation=!1;n.selectedMode=!1}),t},i.prototype.convertSingleSeries=function(n){if(!n)return null;var t={};return t.name=n.series.name,t.type="pie",t.selectedMode=!0,t.stillShowZeroSum=!1,t.data=this.getSeriesData(n),t.label=this.getSeriesDataLabel(n),this.chartDataInfo.chartType===6&&(t.labelLine={show:!1}),t},i.prototype.getSeriesData=function(t){var o=[],s=this.chartDataInfo.categoryAxisInfo.formattedData,h=t.data,f={borderColor:"white",borderWidth:2,borderType:"solid"},u,i,e,r;for(t.series.dataPoints&&t.series.dataPoints.length>0&&(f=t.series.dataPoints[0].borderStyle),u=0;u<h.length;u++)i={},e=n.ConvertChartHelper.parseToNumber(h[u],this.chartDataInfo.displayEmptyCellAs),i.value=e,i.name=n.ConvertChartHelper.IsEmpty(s[u])?" ":s[u],i.itemStyle={},i.itemStyle.borderColor=n.ColorHelper.Convert(f.borderColor),i.itemStyle.borderWidth=f.borderWidth,i.itemStyle.borderType=n.ConvertChartHelper.convertBorderType(f.borderType),r=this.getSeriesDataPointConditionalFormatStyle(t,e,u).itemStyle,r&&(i.itemStyle.color=r.color,r.borderColor&&(i.itemStyle.borderColor=r.borderColor),r.borderWidth!==undefined&&(i.itemStyle.borderWidth=r.borderWidth),r.borderType&&(i.itemStyle.borderType=r.borderType)),o.push(i);return o},i.prototype.getDataLabelPosition=function(n){return this.chartDataInfo.chartType===6?"inside":"outside"},i}(n.ChartConvertorBase);n.PieChartConvertor=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.categoryNameIndex=0,n}return __extends(i,t),i.prototype.supportRadarElement=function(){return!0},i.prototype.supportAxisElement=function(){return!1},i.prototype.convertChartGrid=function(t,i){var r=t.radar,u;r!==null&&(u=n.ChartLayoutHelper.GetRadarChartLayout(t,i),r.center=u.center,r.radius=u.radius)},i.prototype.convertRadar=function(t){var i={},s=this.chartDataInfo.categoryAxisInfo.formattedData,f=this.getValueAxisMaxMinData(),r=this.chartDataInfo.valueAxisInfo.axis,o=r.type.toLowerCase(),u,e;return o==="log"?u=this.getLogAxisMaxMinValue(r,f.max,f.min):o==="value"&&(u=this.getValueAxisMaxMinValue(r,f.max,f.min)),i.splitNumber=u.splitNumber,i.indicator=s.map(function(n){return{name:n,max:u.max,min:u.min}}).reverse(),i.indicator&&i.indicator.length==0&&i.indicator.push({name:""}),i.name={},e=this.chartDataInfo.categoryAxisInfo.axis,i.name.show=e.visible?!0:!1,i.name.textStyle=n.ConvertChartHelper.convertTextStyle(e.textStyle),i.axisLine=this.getAxisLine(r),i.axisTick=this.getAxisTick(r),i.splitLine=this.getSplitLine(r),i.splitArea={show:!0,areaStyle:{color:n.ColorHelper.Convert(t.plotArea.backgroundColor)}},i.indicator.length&&(i.startAngle=90+360/i.indicator.length),i.z=2,i},i.prototype.getSeriesColor=function(t){return t.chartType.toLocaleLowerCase()==="radarfilled"?n.ColorHelper.Convert(t.backgroundColor):n.ColorHelper.Convert(t.borderStyle.borderColor)},i.prototype.getSeriesData=function(n){var i=[],r=t.prototype.getSeriesData.call(this,n).map(function(n){return n.value});return i.push({value:r.reverse()}),i},i.prototype.getDataSeriesLabel_CategoryName=function(n){var t=this.categoryNameIndex++%this.option.radar.indicator.length;return this.option.radar.indicator[t].name},i.prototype.getToolTipFormatter=function(){var t=this;return function(i){var e=i.seriesName,f=null,r,u;for(t.chartDataInfo.seriesInfos[i.seriesIndex].series.cellsFormatter&&(f=t.chartDataInfo.seriesInfos[i.seriesIndex].series.cellsFormatter),r=i.value.length-1;r>=0;r--)u=i.value[r],f&&(u=n.FormatHelper.format(f,u).text),e+="<\/br>"+t.option.radar.indicator[r].name+":"+u;return e}},i.prototype.isMaxValueAutoTouchAxisTopBottom=function(){return!0},i}(n.ChartConvertorBase);n.RadarChartConvertor=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.init=function(t,i){var r=n.ConvertChartHelper.getSXChartType(t.chartType),u=this.initSeriesInfo(t,i),f=NaN;r===9&&(f=Math.max.apply(Math,u.map(function(n){return n.sizeMax})));this.chartDataInfo={chartType:r,categoryAxisInfo:null,valueAxisInfo:{axis:t.yAxis,axisPosition:"y",isDateAxis:!1,dateIndexInSeriesDataArray:0},valueAxisInfo2:{axis:t.YAxis2,axisPosition:"y2",isDateAxis:!1,dateIndexInSeriesDataArray:0},xValueAxisInfo:{axis:t.xAxis,axisPosition:"x",isDateAxis:t.xAxis.type.toLowerCase()==="date",dateIndexInSeriesDataArray:0},sizeMaxValue:f,is100pcChart:!1,displayEmptyCellAs:t.displayEmptyCellsAs.toLowerCase(),seriesInfos:u,chartSize:{width:t.width,height:t.height}}},i.prototype.initSeriesInfo=function(t,i){var o=[],v,h,e,s,u,r,f,y,c,l,a;if(t.dataSeries)for(v=t.dataSeries.length,u=0;u<v;u++)r={},h=t.dataSeries[u],r.series=h,r.seriesIndex=u,h.conditionalFormatRules&&(r.conditionalFormatRules=h.conditionalFormatRules),o.push(r);if(i&&i.dataSeries)for(u=0;u<i.dataSeries.length;u++)r=o[u],r&&(e=i.dataSeries[u],e&&e.length>=2&&(r.mapping=e[0],r.xMapping=e[1],e.length===3&&(r.sizeMapping=e[2])));if(o.length>0)for(s=n.ConvertChartHelper.getSXChartType(t.chartType)===9,u=0;u<o.length;u++)r=o[u],f=r.series,t.forPaint?(r.data=f.values,r.xData=f.xValues,s&&(r.sizeData=f.sizeValues)):r.mapping?(r.data=n.ConvertChartHelper.getDataFromListViewColumnMappingInfo(r.mapping,this.runTimePageName),r.xData=n.ConvertChartHelper.getDataFromListViewColumnMappingInfo(r.xMapping,this.runTimePageName),s&&(r.sizeData=n.ConvertChartHelper.getDataFromListViewColumnMappingInfo(r.sizeMapping,this.runTimePageName))):(r.data=n.ConvertChartHelper.getDataFromFormula(f.valueFormula,this.runTimePageName),n.ConvertChartHelper.IsEmpty(f.xValueFormula)||(r.xData=n.ConvertChartHelper.getDataFromFormula(f.xValueFormula,this.runTimePageName)),s&&!n.ConvertChartHelper.IsEmpty(f.sizeValueFormula)&&(r.sizeData=n.ConvertChartHelper.getDataFromFormula(f.sizeValueFormula,this.runTimePageName))),y=n.ConvertChartHelper.IsEmpty(r.xData)||r.xData.every(function(t){return n.ConvertChartHelper.IsEmpty(t)||isNaN(Number(t))}),y&&(r.originalXData=r.xData?r.xData.slice(0):r.data.map(function(n,t){return t+1}),r.xData=r.data.map(function(n,t){return t+1})),n.ConvertChartHelper.IsEmpty(r.sizeData)&&(r.sizeData=r.data.map(function(n,t){return 1})),c=r.data.map(n.ConvertChartHelper.toNumber),r.max=Math.max.apply(Math,c),r.min=Math.min.apply(Math,c),l=r.xData.map(n.ConvertChartHelper.toNumber),r.xMax=Math.max.apply(Math,l),r.xMin=Math.min.apply(Math,l),s&&(a=r.sizeData.map(n.ConvertChartHelper.toNumber),r.sizeMax=Math.max.apply(Math,a),r.sizeMin=Math.min.apply(Math,a));return o},i.prototype.getItemFormatterTextFromTooltipParams=function(t){var u=t.value,i=u[0],r,f;return t.data.originalXData&&(i=t.data.originalXData),this.chartDataInfo.xValueAxisInfo&&this.chartDataInfo.xValueAxisInfo.axis&&this.chartDataInfo.xValueAxisInfo.axis.labelFormatter&&(i=n.FormatHelper.format(this.chartDataInfo.xValueAxisInfo.axis.labelFormatter,i).text),r=u[1],this.chartDataInfo.seriesInfos[t.seriesIndex].series.cellsFormatter&&(r=n.FormatHelper.format(this.chartDataInfo.seriesInfos[t.seriesIndex].series.cellsFormatter,r).text),f=t.seriesName+"<br/>( "+i+" , "+r+" )",this.chartDataInfo.chartType===9&&(f+=" "+n.RS.Echart_BubbleChartToolTip.replace("{0}",u[2])),f},i.prototype.getAxisFormatterTextFromTooltipParams=function(t){var r,u,i,o,f,e;if(t.length>0){for(r="",u=void 0,this.chartDataInfo.xValueAxisInfo&&this.chartDataInfo.xValueAxisInfo.axis&&(u=this.chartDataInfo.xValueAxisInfo.axis.labelFormatter),i=0;i<t.length;i++)i!=0&&(r+="<br/>"),o=t[i].value,f=o[0],u&&(f=n.FormatHelper.format(u,f).text),e=o[1],this.chartDataInfo.seriesInfos[t[i].seriesIndex].series.cellsFormatter&&(e=n.FormatHelper.format(this.chartDataInfo.seriesInfos[t[i].seriesIndex].series.cellsFormatter,e).text),r+=t[i].seriesName+" ( "+f+" , "+e+" )";return r}},i.prototype.getSeriesData=function(t){var i=this.chartDataInfo.displayEmptyCellAs,u=this,f=t.data,e=t.xData,r=t.originalXData,o=t.sizeData,s=this.chartDataInfo.xValueAxisInfo.isDateAxis,h=this.chartDataInfo.xValueAxisInfo.axis.labelFormatter,c=this.chartDataInfo.chartType===9;return f.map(function(f,l){var y=n.ConvertChartHelper.parseToNumber(f,i),a=n.ConvertChartHelper.parseToNumber(e[l],i),p;r&&(p=r[l]);s&&(a instanceof Date||(a=n.ConvertChartHelper.ConvertToEchartDate(a,h)));var v=u.getSeriesDataPointConditionalFormatStyle(t,y,l),b=v.itemStyle,k=v.markerType,d=v.markerSize,w={value:[a,y],itemStyle:b,symbol:k,symbolSize:d,originalXData:p};return c&&w.value.push(n.ConvertChartHelper.parseToNumber(o[l],"zero")),w})},i.prototype.getDataSeriesLabel_CategoryName=function(t){var i=t.value[0];return t.data.originalXData&&(i=t.data.originalXData),n.FormatHelper.format(this.chartDataInfo.xValueAxisInfo.axis.labelFormatter,i).text},i.prototype.getSeriesColor=function(t){return this.chartDataInfo.chartType===7||this.chartDataInfo.chartType===9?n.ColorHelper.Convert(t.backgroundColor):n.ColorHelper.Convert(t.borderStyle.borderColor)},i.prototype.getChartSeriesDefaultMarker=function(){return"circle"},i.prototype.convertChartMarker=function(n,i){var u=n.series,r=this;u.chartType.toLowerCase()==="bubble"?(i.symbol="circle",i.symbolSize=function(n,t){return isNaN(r.chartDataInfo.sizeMaxValue)||r.chartDataInfo.sizeMaxValue<=0?0:n[2]/r.chartDataInfo.sizeMaxValue*Math.max(r.chartDataInfo.chartSize.width/8,r.chartDataInfo.chartSize.height/8,10)}):t.prototype.convertChartMarker.call(this,n,i)},i.prototype.supportMarker=function(n){return n.chartType.toLowerCase()==="scatter"?!0:t.prototype.supportMarker.call(this,n)},i.prototype.convertAxes=function(n){var t=this.getValueAxisMaxMinData(),i=this.getValueAxisMaxMinData(!0),r=this.getXAxisMaxMinData(),u;this.option.xAxis=this.convertAxis(this.chartDataInfo.xValueAxisInfo,r.max,r.min);this.option.yAxis=this.convertAxis(this.chartDataInfo.valueAxisInfo,t.max,t.min);n.HasSecondaryYAxis&&(u=this.convertAxis(this.chartDataInfo.valueAxisInfo2,i.max,i.min),this.option.yAxis=[this.option.yAxis,u])},i.prototype.getXAxisMaxMinData=function(){var n=this.chartDataInfo.seriesInfos.map(function(n){return Math.max.apply(Math,n.xData)}),t=this.chartDataInfo.seriesInfos.map(function(n){return Math.min.apply(Math,n.xData)});return{max:Math.max.apply(Math,n),min:Math.min.apply(Math,t)}},i}(n.ChartConvertorBase);n.ScatterChartConvertor=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.supportAxisElement=function(){return!1},i.prototype.supportMapElement=function(){return!0},i.prototype.supportLegendElement=function(){return!1},i.prototype.supportMarker=function(n){return this.chartDataInfo.chartType===11?!0:!1},i.prototype.convertChartMarker=function(n,t){var i=n.series;this.supportMarker(i)&&(t.symbol="circle",t.symbolSize=function(t,i){return isNaN(n.max)||n.max<=0?0:t[2]/n.max*20})},i.prototype.init=function(n,i){this.checkRegisteredMapExist(n);t.prototype.init.call(this,n,i)},i.prototype.checkRegisteredMapExist=function(t){if(!this.geoJsonInfo||!this.geoJsonInfo.geoAreaJsonKey||!window.echarts.getMap(this.geoJsonInfo.geoAreaJsonKey)){this.geoJsonInfo=null;console.error("Does not find matched area geo json file or the area geo json file content has error, and please check the file.");return}var i=n.ConvertChartHelper.getSXChartType(t.chartType),r=i===11||i===12;r&&(this.geoJsonInfo.geoPointJsonObject||console.error("Does not find matched point geo json file or the point geo json file content has error, and please check the file."))},i.prototype.getTooltipTriggerType=function(){return"item"},i.prototype.getItemFormatterTextFromTooltipParams=function(t){var i=t.value;return i.length===undefined&&isNaN(i)?undefined:(i.length>=3&&(i=i[2]),this.chartDataInfo.seriesInfos[t.seriesIndex].series.cellsFormatter&&(i=n.FormatHelper.format(this.chartDataInfo.seriesInfos[t.seriesIndex].series.cellsFormatter,i).text),t.name+"<br/>"+i)},i.prototype.getCoordinateSystem=function(){return"geo"},i.prototype.convertDataSeries=function(){var r=this.chartDataInfo.seriesInfos.length;if(r===0||!this.geoJsonInfo)return null;var t=[],i=this.chartDataInfo.seriesInfos[0],n=this.convertMapSeriesCommonProperties(i);return this.convertMapSeriesSpecialProperties(n,i),n&&t.push(n),t},i.prototype.convertMapSeriesSpecialProperties=function(n,t){this.chartDataInfo.chartType===10?n.mapType=this.geoJsonInfo.geoAreaJsonKey:n.coordinateSystem=this.getCoordinateSystem()},i.prototype.convertMapSeriesCommonProperties=function(t){var i,r;return!t||!this.geoJsonInfo?null:(i={},i.name=t.series.name,i.type=n.ConvertChartHelper.convertChartTypeToEChart(this.chartDataInfo.chartType),i.data=this.getSeriesData(t),r=this,this.chartDataInfo.chartType===10?i.data.forEach(function(n){n.label=r.getSeriesDataLabel(t)}):i.label=this.getSeriesDataLabel(t),this.convertChartMarker(t,i),i.itemStyle={},i.itemStyle.color=this.getSeriesColor(t.series),i.itemStyle.opacity=1,i)},i.prototype.getDataSeriesLabelFormatter=function(t,i){var u=[],r;return i.dataLabelSettings&&(i.dataLabelSettings.showSeriesName===!0&&u.push(t.seriesName),i.dataLabelSettings.showCategoryName===!0&&u.push(t.name),i.dataLabelSettings.showValue===!0&&(r=t.value,t.value&&t.value.length===3&&(r=t.value[2]),i.dataLabelStyle.formatter!=null&&(r=n.FormatHelper.format(i.dataLabelStyle.formatter,r).text),u.push(r))),u.join(i.dataLabelSettings.separator)},i.prototype.getSeriesData=function(t){var r=this.chartDataInfo.displayEmptyCellAs,i=this,u=t.data,f=this.chartDataInfo.categoryAxisInfo.data,e=this.chartDataInfo.chartType===11||this.chartDataInfo.chartType===12;return u.map(function(u,o){var s=n.ConvertChartHelper.parseToNumber(u,r),c=f[o],l=i.getSeriesDataPointConditionalFormatStyle(t,s,o).itemStyle,h;return e&&(h=i.getPointGeoCoord(i.geoJsonInfo.geoPointJsonObject,c,["Point","MultiPoint"]),h!==undefined&&(s=h.concat([s]))),{name:c,value:s,itemStyle:l}})},i.prototype.getPointGeoCoord=function(n,t,i){for(var r,f=n.features,u=0;u<f.length;u++)if(r=f[u],i.indexOf(r.geometry.type)!==-1&&r.properties.name===t)return r.geometry.coordinates},i.prototype.convertVisualMap=function(t){var i,r,f;if(!this.geoJsonInfo||this.chartDataInfo.chartType===11)return undefined;var e=Math.max.apply(Math,this.chartDataInfo.seriesInfos.map(function(n){return n.max})),o=Math.min.apply(Math,this.chartDataInfo.seriesInfos.map(function(n){return n.min})),u=this.getValueAxisMaxMinValue({autoMax:!0,autoMin:!0,autoMajorUnit:!0},e,o);return((isNaN(u.max)||isNaN(u.min))&&(u.max=1,u.min=0),!t.mapChartSettings||!t.mapChartSettings.VisualMapSetttings)?{show:!1,max:u.max,min:u.min,color:this.getVisualMapElementColor(t,2)}:(i=t.mapChartSettings.VisualMapSetttings,r={show:i.Show!==!1,type:this.getVisualMapType(i.VisualMapType),calculable:!0,orient:this.getVisualMapOrientation(i.Orientation),left:this.getVisualMapHorizontalAlignment(i.VisualMapAlignment),top:this.getVisualMapVerticalAlignment(i.VisualMapAlignment),max:u.max,min:u.min,backgroundColor:n.ConvertChartHelper.convertBackgoundColor(i.Fill,this.forPaint),borderColor:n.ColorHelper.Convert(i.Stroke),borderWidth:i.StrokeThickness,textStyle:{fontFamily:"'"+i.FontFamily+"'",fontSize:i.FontSize,fontStyle:i.FontStyle,fontWeight:i.FontWeight,color:n.ConvertChartHelper.IsEmpty(i.Foreground)?"black":n.ColorHelper.Convert(i.Foreground)}},r.left==="right"&&r.top!=="center"&&(r.left=undefined,r.right=10),r.orient==="horizontal"&&(r.itemGap=15),this.convertPieces(i,u,r),f=2,r.pieces&&r.pieces.length>0&&(f=r.pieces.length),r.color=this.getVisualMapElementColor(t,f),i.VisualMapType===0&&(r.text=n.ConvertChartHelper.IsEmpty(i.LabelsOnBothEnds)||i.LabelsOnBothEnds.length===0?null:i.LabelsOnBothEnds.slice(0,2)),r)},i.prototype.isMaxValueAutoTouchAxisTopBottom=function(){return!0},i.prototype.getVisualMapElementColor=function(n,t){var i=n.chartColorPalette;return this.calcColors(i,t).reverse()},i.prototype.convertPieces=function(t,i,r){var f,o,y,p,a,s,e,l,w,u,v;if(t.VisualMapType===1){if(f=[],o=t.Pieces,o&&o.length>0){for(y=o.length,u=0;u<y-1;u++){var e={},h=o[u+1],c=o[u];if(this.isInfinityValue(h)){if(this.isInfinityValue(c))return;e.gt=c}else this.isInfinityValue(c)?e.lt=h:c===h?e.value=h:(e.gt=c,e.lt=h);f.push(e)}f.map(function(n,t){if(t===f.length-1){n.lt!==undefined&&(n.lte=n.lt,n.lt=undefined);return}t===0&&n.gt!==undefined&&(n.gte=n.gt,n.gt=undefined);var i=f[t+1];n.lt!==undefined&&i.gt!==undefined&&n.lt<=i.gt&&(n.lte=n.lt,n.lt=undefined)})}else for(p=i.splitNumber,a=Math.ceil((i.max-i.min)/p),s=i.min;s<i.max;s=s+a)e={max:s+a,min:s},f.push(e);if(l=t.PiecesLabels,l)for(w=Math.min(l.length,f.length),u=0;u<w;u++)v=l[u],n.ConvertChartHelper.IsEmpty(v)||(f[u].label=v);r.pieces=f}},i.prototype.isInfinityValue=function(n){return n==="-Infinity"||n==="Infinity"?!0:!1},i.prototype.getVisualMapType=function(n){return n===1?"piecewise":"continuous"},i.prototype.getVisualMapOrientation=function(n){return n===0?"horizontal":"vertical"},i.prototype.getVisualMapHorizontalAlignment=function(n){return n===0||n===1||n===2?"left":n===3||n===4||n===5?"right":"center"},i.prototype.getVisualMapVerticalAlignment=function(n){return n===0||n===6||n===3?"top":n===2||n===7||n===5?"bottom":"center"},i.prototype.convertGeo=function(n){return this.chartDataInfo.chartType===10||!this.geoJsonInfo?undefined:{map:this.geoJsonInfo.geoAreaJsonKey,roam:!0}},i}(n.ChartConvertorBase);n.MapChartConvertor=t}(Forguncy||(Forguncy={})),function(n){var i=function(){function i(){}return i.GetChartLayout=function(n,t,r){var y;r===void 0&&(r=!0);y=n.legend&&n.legend.data&&n.legend.data.every(function(n){return n.icon==="roundRect"});i.legendIconWidth=y||t.chartType.toLowerCase()==="scatter"?14:25;var p=i.GetChartTitleSize(n.title),o=i.GetLegendSize(n.legend,t.width,t.height,!1),f=null,u=null,e=null,it=t.chartType;r&&(f=n.xAxis,n.yAxis instanceof Array?(u=n.yAxis[0],e=n.yAxis[1]):u=n.yAxis);var c=null,l=null,w=0,b=0,s=null,h=null,a=null,k=0,v=null;f!=null&&(c=i.GetAxisTitleSize(f),w=f.axisTick.length,s=i.GetAxisLabelMaxSize(f,t.xAxis.labelFormatter,t.xAxis.displayUnit));u!=null&&(l=i.GetAxisTitleSize(u),b=u.axisTick.length,h=i.GetAxisLabelMaxSize(u,t.yAxis.labelFormatter,t.yAxis.displayUnit));e&&(a=i.GetAxisTitleSize(e),k=e.axisTick.length,v=i.GetAxisLabelMaxSize(e,t.YAxis2.labelFormatter,t.YAxis2.displayUnit));var d=i.GetGridOffset_X1(n.legend,o,l,h,b,s),g=i.GetGridOffset_Y1(n.legend,p,o,l,h,a,v),nt=i.GetGridOffset_X2(n.legend,o,c,s,a,v,k),tt=i.GetGridOffset_Y2(n.legend,o,c,s,w,h);return d+=i.chartPadding,g+=i.chartPadding,nt+=i.chartPadding,tt+=i.chartPadding,i.ReSetLegendLayout(n.legend,p),{x1:parseFloat(d.toFixed(4)),y1:parseFloat(g.toFixed(4)),x2:parseFloat(nt.toFixed(4)),y2:parseFloat(tt.toFixed(4))}},i.ReSetLegendLayout=function(n,t){t!=null&&n!=null&&n.top===i.legendMargin&&(n.top=t.height+i.chartTitleMarginBottom+i.legendMargin);n!=null&&n.orient==="vertical"&&i.verticallegendIconGap!==10&&(n.itemGap=i.verticallegendIconGap)},i.GetPieChartLayout=function(n,t){var u=i.GetChartTitleSize(n.title),r=i.GetLegendSize(n.legend,t.width,t.height,!0),e=t.width,f=t.height,s=0,o=0,h,c;return u!=null&&(f-=u.height+i.chartTitleMarginBottom,o+=u.height+i.chartTitleMarginBottom),r!==null&&(t.legend.alignment.toLocaleLowerCase().indexOf("top")!=-1||t.legend.alignment.toLocaleLowerCase().indexOf("bottom")!=-1?(f-=r.height+i.legendMargin*2,t.legend.alignment.toLocaleLowerCase().indexOf("top")!=-1&&(o+=r.height+i.legendMargin*2)):(t.legend.alignment.toLocaleLowerCase().indexOf("left")!=-1||t.legend.alignment.toLocaleLowerCase().indexOf("right"))&&(e-=r.width+i.legendMargin,t.legend.alignment.toLocaleLowerCase().indexOf("left")!=-1&&(s+=r.width+i.legendMargin))),h=[s+e/2,o+f/2],c=Math.min(e,f)/2,i.ReSetLegendLayout(n.legend,u),{center:h,radius:c}},i.GetRadarChartLayout=function(n,t){var e=i.GetChartTitleSize(n.title),r=i.GetLegendSize(n.legend,t.width,t.height,!1),u=i.GetIndicatorSize(n.radar),o=t.width,f=t.height,h=0,s=0,c,l;return e!=null&&(f-=e.height+i.chartTitleMarginBottom,s+=e.height+i.chartTitleMarginBottom),r!==null&&(t.legend.alignment.toLocaleLowerCase().indexOf("top")!=-1||t.legend.alignment.toLocaleLowerCase().indexOf("bottom")!=-1?(f-=r.height+i.legendMargin*2,t.legend.alignment.toLocaleLowerCase().indexOf("top")!=-1&&(s+=r.height+i.legendMargin*2)):(t.legend.alignment.toLocaleLowerCase().indexOf("left")!=-1||t.legend.alignment.toLocaleLowerCase().indexOf("right"))&&(o-=r.width+i.legendMargin,t.legend.alignment.toLocaleLowerCase().indexOf("left")!=-1&&(h+=r.width+i.legendMargin))),u&&(f-=u.height*2,s+=u.height,o-=u.width*2,h+=u.width),c=[h+o/2,s+f/2],l=Math.min(o,f)/2*.75,i.ReSetLegendLayout(n.legend,e),{center:c,radius:l}},i.GetGridOffset_X1=function(n,t,r,u,f,e){var o=0,s=0,h=0,c=0;return t!==null&&n.left===i.legendMargin&&n.top==="center"&&(o=t.width+i.legendMargin),r!=null&&(s=r.width/2),u!=null&&(h=u.width),e!=null&&(c=e.width/2),Math.max(o+h+f,s,c)},i.GetGridOffset_Y1=function(n,t,r,u,f,e,o){var c=0,s,h;return t!==null&&(c+=t.height+i.chartTitleMarginBottom),r!==null&&n.top===i.legendMargin&&(c+=r.height+i.legendMargin),s=0,h=0,u!=null?s=u.height+i.axisNameGap:f!=null&&(s=f.height/2),e!=null?h=e.height+i.axisNameGap:o!=null&&(h=o.height/2),c+Math.max(s,h)},i.GetGridOffset_X2=function(n,t,r,u,f,e,o){var s=0,h=0,c=0,l=0,a=0;return t!==null&&n.right===i.legendMargin&&n.top==="center"&&(s=t.width+i.legendMargin),r!==null&&(h=r.width+i.axisNameGap),u!==null&&(c=u.width/2),e&&(l=e.width),f&&(a=f.width/2),Math.max(s+l+o,h,c,a)},i.GetGridOffset_Y2=function(n,t,r,u,f,e){var o=0,s=0,h=0,c=0;return t!==null&&n.left=="center"&&n.bottom===i.legendMargin&&(o+=t.height+i.legendMargin),r!==null&&(s=r.height/2),u!==null&&(h=u.height),e!==null&&(c=e.height/2),o+Math.max(s,c,h+f)},i.GetValueAxisLabelMaxSize=function(t,r,u){var e=null,o=Number(t.max.toFixed(13)),f=Number(t.min.toFixed(13)),h=t.interval!==undefined?t.interval:Number(((o-f)/Math.floor(t.splitNumber)).toFixed(13)),c,s;for(isNaN(u)||u==0||(o=o/u,f=f/u,h=h/u);f<=o;)c=n.FormatHelper.format(r,f).text,s=i.GetMeasureTextSize(t.axisLabel.textStyle,c),(e===null||s.width>e.width)&&(e={width:s.width,height:s.height}),f+=h,f=Number(f.toFixed(13));return e},i.GetLogAxisLabelMaxSize=function(t,r,u){var e=null,o=t.max*t.logBase,f=t.min/t.logBase,h=(o-f)/Math.floor(t.splitNumber),c,s;for(isNaN(u)||u==0||(o=o/u,f=f/u,h=h/u);f<=o;)c=n.FormatHelper.format(r,f).text,s=i.GetMeasureTextSize(t.axisLabel.textStyle,c),(e===null||s.width>e.width)&&(e={width:s.width,height:s.height}),f*=t.logBase;return e},i.GetTimeAxisLabelMaxSize=function(t,r){var u=n.FormatHelper.format(r,new Date(2010,11,30)).text;return i.GetMeasureTextSize(t.axisLabel.textStyle,u)},i.GetAxisLabelMaxSize=function(n,t,r){if(n==null||!n.show||!n.axisLabel.show)return null;if(n.type==="category")return i.GetCategoryAxisLabelMaxSize(n,t);var u=null;return(n.type==="value"?u=i.GetValueAxisLabelMaxSize(n,t,r):n.type==="log"?u=i.GetLogAxisLabelMaxSize(n,t,r):n.type==="time"&&(u=i.GetTimeAxisLabelMaxSize(n,t)),u==null)?null:(n.axisLabel.rotate!=0&&(u=i.GetRotatedLabelSize(u,n.axisLabel.rotate)),{width:u.width,height:u.height})},i.GetCategoryAxisLabelMaxSize=function(t,r){for(var h,u,s=t.data,f=0,e=0,o=0;o<s.length;o++)h=n.FormatHelper.format(r,s[o]).text,u=i.GetMeasureTextSize(t.axisLabel.textStyle,h),t.axisLabel.rotate!==0&&(u=i.GetRotatedLabelSize(u,t.axisLabel.rotate)),u.width>f&&(f=u.width),u.height>e&&(e=u.height);return{width:f,height:e}},i.GetIndicatorSize=function(n){var u=0,f=0,r,t;if(n)for(r=0;r<n.indicator.length;r++)t=i.GetMeasureTextSize(n.name.textStyle,n.indicator[r].name),t.width>u&&(u=t.width),t.height>f&&(f=t.height);return{width:u,height:f}},i.GetRotatedLabelSize=function(n,t){t<0&&(t=-t);t=t%180==0?0:t%90==0?Math.PI/2:t%90/180*Math.PI;var i=n.width*Math.cos(t)+n.height*Math.sin(t),r=n.width*Math.sin(t)+n.height*Math.cos(t);return{width:Math.ceil(i),height:Math.ceil(r)}},i.GetAxisTitleSize=function(n){return n==null||n.name==null?null:i.GetMeasureTextSize(n.nameTextStyle,n.name)},i.GetLegendSize=function(t,r,u,f){var s,a,h,e,o,c;if(t==null)return null;s=t.data.map(function(t){var i=n.ConvertChartHelper.IsEmpty(t.name)?t:t.name;return typeof i!="string"&&(i=""),i});f&&(s=s.filter(function(n,t,i){return i.indexOf(n)===t}));var v=0,l=0,y=0,p=0;for(a=0;a<s.length;a++)h=i.GetMeasureTextSize(t.textStyle,s[a]),y+=h.width,p+=h.height,h.width>v&&(v=h.width),h.height>l&&(l=h.height);return y===0||p===0?null:(t.orient=="horizontal"?(e=y+i.legendIconWidth*s.length+i.legendIconGap*(s.length-1),o=l,e>r&&(o=Math.ceil(e/r)*o,e=r),c={width:e,height:o}):(i.verticallegendIconGap=l/5*4,e=v+i.legendIconWidth,o=p+i.verticallegendIconGap*(s.length-1),o>u&&(e=Math.ceil(o/u)*e,o=u),c={width:e,height:o}),t.borderWidth==null&&(t.borderWidth=0),c.width+=i.legendPadding*2+t.borderWidth*2,c.height+=i.legendPadding*2+t.borderWidth*2,c)},i.GetChartTitleSize=function(n){if(n==null)return null;var t=i.GetMeasureTextSize(n.textStyle,n.text);return n.borderWidth==null&&(n.borderWidth=0),t.width+=n.borderWidth*2,t.height+=n.borderWidth*2,t},i.GetMeasureTextSize=function(t,i){var f=this,u,r;return n.ConvertChartHelper.IsEmpty(i)?{width:0,height:0}:(u=1,r=[i],i&&(r=i.split("\n"),u=r.length),{width:Math.max.apply(Math,r.map(function(n){return f.getWidth(t,n.trim())})),height:this.getWidth(t,"\u56fd")*u})},i.getWidth=function(n,i){return t.getWidth(n.fontStyle,n.fontWeight,n.fontSize||12,n.fontFamily,i)},i.chartTitleMarginBottom=10,i.legendMargin=5,i.legendPadding=5,i.legendIconGap=10,i.verticallegendIconGap=10,i.legendIconWidth=25,i.chartPadding=8,i.axisNameGap=15,i}(),t;n.ChartLayoutHelper=i;t=function(){function t(){}return t.getHeight=function(n,t,i,r,u,f){return u===void 0&&(u="\u56fd"),f===void 0&&(f=1),this.getWidth(n,t,i,r,u)*f},t.getWidth=function(n,i,r,u,f){var h=t.getFontString(n,i,r,u),e=f+":"+h,c,o,s;return this._cachedSize[e]?this._cachedSize[e]:(this._cachedContext||(c=document.createElement("canvas"),this._cachedContext=c.getContext("2d")),o=this._cachedContext,o.font=h,s=o.measureText(f).width,this._cachedSize[e]=s,s)},t.getFontString=function(t,i,r,u){return[t?t:"normal",i?i:"normal",r+"px",u?u:n.LocaleFonts.default].join(" ")},t._cachedSize={},t}();n.MeasureHelper=t}(Forguncy||(Forguncy={})),function(n){var i=function(){function i(n){this._chartArray=[];this._chartGeoJsonContentDictionary={};this._bindingDataModelValueChangedEvent(n)}return i.prototype.createChart=function(i,r,u){var f=n.DomUtilities.createJqueryDomElement("div"),e,c;this.initChartBorder(i,f);f.css("position","absolute");f.css("z-index",i.ChartJson.zIndex);f.css("box-sizing","content-box");f.attr("chartname",i.ChartName);var o=i.ChartJson.borderStyle.borderWidth===undefined?0:i.ChartJson.borderStyle.borderWidth,s=i.Width-o*2,h=i.Height-o*2;return i.ChartJson.width=s,i.ChartJson.height=h,e=new t(f[0],i.ChartJson,s,h,i.ChartName,i.PageName,i.ChartDataMapping,i.ChartCommandMetadata,i.ChartGeoJsonMetadata,r),u&&(e.unitTestId=u,this.unitTestObject||(this.unitTestObject={})),this._chartArray.push(e),c=this,n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(i.DependenceCells,function(){c._delayUpdateChart(e)},r),f},i.prototype.destoryRunTimePage=function(n){this._chartArray.filter(function(t){return n.indexOf(t.runTimePageName)>=0}).forEach(function(n){return n.dispose()});this._chartArray=this._chartArray.filter(function(t){return n.indexOf(t.runTimePageName)===-1})},i.prototype.destroy=function(){this._chartArray.forEach(function(n){return n.dispose()});this._chartArray=[]},i.prototype.onSizeChanged=function(t){var i=this._chartArray.filter(function(n){return t?t.indexOf(n.runTimePageName)!=-1:!0}),r=this;i.forEach(function(t){var i;if(t.echartObj&&n.PageManager.getPageStretchInfo(t.runTimePageName).StretchMode!==0){i=t.chartModel.borderStyle.borderWidth===undefined?0:t.chartModel.borderStyle.borderWidth;$(t.chartDOM).css("width","calc(100% - "+i*2+"px)");$(t.chartDOM).css("height","calc(100% - "+i*2+"px)");var u=t.chartModel,f=$(t.chartDOM).width(),e=$(t.chartDOM).height();f!==0&&e!==0&&(u.width=f-i*2,u.height=e-i*2,n.PivotChartHelper.correctPivotChartInfo(u,t.chartDataMapping,t.runTimePageName),r.setEchartOption(t,t.echartObj),t.echartObj.resize({width:f,height:e}))}})},i.prototype.setEchartOptionInternal=function(t,i,r){n.Helper&&n.Helper.preSetEchartOption&&n.Helper.preSetEchartOption(r,t.pageName,t.chartName);i&&i.setOption(r,!0)},i.prototype.setEchartOption=function(t,i){var r=n.ConvertChartHelper.convertChartModelToECharts(t.chartModel,t.chartDataMapping,t.runTimePageName,t.chartGeoJsonMetadata);this.setEchartOptionInternal(t,i,r)},i.prototype.initChartBorder=function(t,i){var r=t.ChartJson.borderStyle;return r.borderColor==null&&(r.borderColor="rgba(134, 134, 134, 1)"),i.css("border-color",n.ColorHelper.Convert(r.borderColor)),r.borderWidth==null&&(r.borderWidth=0),i.css("border-width",r.borderWidth+"px"),(r.borderType==null||r.borderType==="none")&&(r.borderType="solid"),i.css("border-style",r.borderType),r},i.prototype.initChart=function(n){var t=this;t._chartArray.filter(function(t){return n.indexOf(t.runTimePageName)>=0}).forEach(function(n){t.initChartByModel(n)})},i.prototype._bindingDataModelValueChangedEvent=function(t){if(t){var i=this;t.bind(n.Events.ValueChanged,function(n,t){if(t.calcName)i.onListviewValueChanged(t.calcName);else i.onNormalCellValueChanged(t.arg.id)})}},i.prototype.onNormalCellValueChanged=function(n){var t=this;t._chartArray.filter(function(t){return t.chartReferCells&&t.chartReferCells.indexOf(n)>=0}).forEach(function(n){return t._delayUpdateChart(n)})},i.prototype.onListviewValueChanged=function(t){var i=this,r=n.ForguncyData.pageInfo.dataModel.getListDataByCalcSheetName(t);i._chartArray.filter(function(n){return n.chartReferListivews&&n.runTimePageName===r.runTimePageName&&n.chartReferListivews.indexOf(r.listviewName)>=0}).forEach(function(n){return i._delayUpdateChart(n)})},i.prototype._updateChart=function(n){this.initChartByModel(n)},i.prototype._delayUpdateChart=function(t){var i=this;n.DelayRefresh.Push(this,function(){i._updateChart(t)},"UpdateChart"+t.chartName+"|"+t.runTimePageName)},i.prototype.initChartByModel=function(t){var i=window.echarts.init(t.chartDOM,null,{width:t.width,height:t.height}),r={text:n.RS.Echart_DataLoadingText};i.showLoading(r);this.convertGeoJsonContentInfos(t);this.setChartOptionInternal(t,i)},i.prototype.convertGeoJsonContentInfos=function(t){var i=n.ConvertChartHelper.getMapChartGeoJsonInfo(t.chartGeoJsonMetadata,t.runTimePageName),u,r;if(i){if(u=this,!window.echarts.getMap(i.geoAreaJsonKey)){if(!i.areaJsonFileFullPath)return;$.ajax({url:i.areaJsonFileFullPath,success:function(n){window.echarts.registerMap(i.geoAreaJsonKey,n)},async:!1})}i.pointJsonFileFullPath&&(r=this._chartGeoJsonContentDictionary[i.pointJsonFileFullPath],r?t.chartGeoJsonMetadata.GeoPointJsonContent=r:$.ajax({url:i.pointJsonFileFullPath,success:function(n){t.chartGeoJsonMetadata.GeoPointJsonContent=n;u._chartGeoJsonContentDictionary[i.pointJsonFileFullPath]=n},async:!1}))}},i.prototype.setChartOptionInternal=function(t,i){var u=t.chartDataMapping,r=t.chartModel;if(n.PivotChartHelper.correctPivotChartInfo(r,u,t.runTimePageName),this.setEchartOption(t,i),this.supportCommands(r.chartType)){i.off("click",this.getChartClickFunction(t));i.on("click",this.getChartClickFunction(t))}i.hideLoading();t.echartObj!==i&&(t.echartObj&&(t.echartObj.clear(),t.echartObj.dispose()),t.echartObj=i);t.unitTestId&&(this.unitTestObject[t.unitTestId]=i)},i.prototype.getChartClickFunction=function(n){var t=this;return function(i){var f=n.chartModel.chartType.toLowerCase(),e=i.name,o=i.value,h,c;if(i.data&&i.data.value&&i.data.value.length>1){var r=i.data.value,u=0,s=1;f.indexOf("bar")!==-1&&(u=1,s=0);f.indexOf("map")!==-1&&r.length===3&&(u=-1,s=2);f==="bubble"&&r.length===3&&(h=r[2]);o=r[s];u!==-1&&(e=r[u])}i.data&&i.data.orignalValue!==undefined&&(o=i.data.orignalValue);i.data&&i.data.originalXData&&(e=i.data.originalXData);c=n.chartCommandMetadata;t.onChartClicked(c,n.chartName,n.runTimePageName,{seriesName:i.seriesName,categoryName:e,value:o,bubbleSize:h})}},i.prototype.supportCommands=function(n){return(n=n.toLowerCase(),n.indexOf("area")!==-1||n.indexOf("radar")!==-1||n==="heatmap")?!1:n.indexOf("line")!==-1&&n.indexOf("marker")===-1?!1:!0},i.prototype.onChartClicked=function(t,i,r,u){var e,c,o,l,s,a,h,v,f;t&&(e=t.Series,e&&(c=this.getCellID(e,r),n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(c,{newValue:u.seriesName},5)),o=t.Category,o&&(l=this.getCellID(o,r),n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(l,{newValue:u.categoryName},5)),s=t.Value,s&&(a=this.getCellID(s,r),n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(a,{newValue:u.value},5)),h=t.BubbleSize,h&&(v=this.getCellID(h,r),n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(v,{newValue:u.bubbleSize},5)),f=t.Commands,f&&f.length>0&&n.ForguncyData.commandExcutor.excuteCommand(f,r,null,i+"_"+r,n.Events.Click))},i.prototype.getCellID=function(t,i){if(n.ConvertChartHelper.IsEmpty(t.Name))return n.Common.getIdStr(t.Row,t.Column,i);else{var r=n.ForguncyData.pageInfo.pageElementManager.cells.getCellsByName(t.Name,!1);return r&&r.length>0?r[0].id:null}},i.prototype.getEchartObject=function(n,t){var i=this._chartArray.filter(function(i){return i.runTimePageName==t&&i.chartName==n});if(i&&i.length>0)return i[0].echartObj},i}(),r,t;n.ChartCollection=i;r=function(){function n(){}return n}();t=function(){function t(n,t,i,r,u,f,e,o,s,h){var p,a,v,l,c,y;if(this.chartDOM=n,this.chartModel=t,this.width=i,this.height=r,this.chartName=u,this.pageName=f,this.chartDataMapping=e,this.chartCommandMetadata=o,this.chartGeoJsonMetadata=s,this.runTimePageName=h,this.chartModel=t,this.chartDataMapping){if(this.chartReferListivews=[],this.chartDataMapping.dataSeries)for(p=this.chartDataMapping.dataSeries.length,c=0;c<p;c++)if(a=this.chartDataMapping.dataSeries[c],a&&a.length>0)for(v=0;v<a.length;v++)l=a[v].listViewName,this.chartReferListivews.indexOf(l)===-1&&this.chartReferListivews.push(l);this.chartDataMapping.items&&(l=this.chartDataMapping.items.listViewName,this.chartReferListivews.indexOf(l)===-1&&this.chartReferListivews.push(l))}for(this.AddReferCells(this.chartModel.itemsFormula),c=0;c<this.chartModel.dataSeries.length;c++)this.AddReferCells(this.chartModel.dataSeries[c].valueFormula),y=this.chartModel.dataSeries[c],y&&(this.AddReferCells(y.xValueFormula),this.AddReferCells(y.sizeValueFormula));this.AddPivotReferCells()}return t.prototype.AddPivotReferCells=function(){var f=this,i,t,r,u;this.chartDataMapping&&this.chartDataMapping.pivotTableID&&(i=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells([this.runTimePageName]).filter(function(t){if(t.cellType instanceof n.PivotTableCellType){var i=t.cellType;return i.CellElement.CellType.PivotTableID===f.chartDataMapping.pivotTableID}}),i.length>0&&(this.chartReferCells==null&&(this.chartReferCells=[]),this.chartReferListivews==null&&(this.chartReferListivews=[]),t=i[0].cellType,this.chartReferListivews.push(t.CellElement.CellType.PivotTableSetting.SelectedListViewName),r=t.CellElement.CellType.PivotTableSetting.RowMaster,r&&this.chartReferListivews.push(r),u=t.CellElement.CellType.PivotTableSetting.ColumnMaster,u&&this.chartReferListivews.push(u)))},t.prototype.AddReferCells=function(t){var u,r,i;if(t){if(u=n.Common.returnArrayFormulaItems(t),u!==null)return;for(this.chartReferCells==null&&(this.chartReferCells=[]),r=n.Common.parseCellReferenceFormula(t,this.runTimePageName),i=0;i<r.length;i++)this.chartReferCells.push(r[i])}},t.prototype.dispose=function(){this.echartObj&&(this.echartObj.clear(),this.echartObj.dispose());this.echartObj=null;this.chartDOM=null},t}()}(Forguncy||(Forguncy={})),function(){function f(n,t,i){switch(i.length){case 0:return n.call(t);case 1:return n.call(t,i[0]);case 2:return n.call(t,i[0],i[1]);case 3:return n.call(t,i[0],i[1],i[2])}return n.apply(t,i)}function fc(n,t,i,r){for(var f=-1,e=n==null?0:n.length,u;++f<e;)u=n[f],t(r,u,i(u),n);return r}function c(n,t){for(var i=-1,r=n==null?0:n.length;++i<r;)if(t(n[i],i,n)===!1)break;return n}function ec(n,t){for(var i=n==null?0:n.length;i--;)if(t(n[i],i,n)===!1)break;return n}function ie(n,t){for(var i=-1,r=n==null?0:n.length;++i<r;)if(!t(n[i],i,n))return!1;return!0}function tt(n,t){for(var i=-1,f=n==null?0:n.length,e=0,u=[],r;++i<f;)r=n[i],t(r,i,n)&&(u[e++]=r);return u}function pi(n,t){var i=n==null?0:n.length;return!!i&&yt(n,t,0)>-1}function br(n,t,i){for(var r=-1,u=n==null?0:n.length;++r<u;)if(i(t,n[r]))return!0;return!1}function r(n,t){for(var i=-1,r=n==null?0:n.length,u=Array(r);++i<r;)u[i]=t(n[i],i,n);return u}function it(n,t){for(var i=-1,r=t.length,u=n.length;++i<r;)n[u+i]=t[i];return n}function kr(n,t,i,r){var u=-1,f=n==null?0:n.length;for(r&&f&&(i=n[++u]);++u<f;)i=t(i,n[u],u,n);return i}function oc(n,t,i,r){var u=n==null?0:n.length;for(r&&u&&(i=n[--u]);u--;)i=t(i,n[u],u,n);return i}function dr(n,t){for(var i=-1,r=n==null?0:n.length;++i<r;)if(t(n[i],i,n))return!0;return!1}function sc(n){return n.split("")}function hc(n){return n.match(os)||[]}function ue(n,t,i){var r;return i(n,function(n,i,u){if(t(n,i,u))return r=i,!1}),r}function wi(n,t,i,r){for(var f=n.length,u=i+(r?1:-1);r?u--:++u<f;)if(t(n[u],u,n))return u;return-1}function yt(n,t,i){return t===t?dc(n,t,i):wi(n,fe,i)}function cc(n,t,i,r){for(var u=i-1,f=n.length;++u<f;)if(r(n[u],t))return u;return-1}function fe(n){return n!==n}function ee(n,t){var i=n==null?0:n.length;return i?tu(n,t)/i:oi}function gr(t){return function(i){return i==null?n:i[t]}}function nu(t){return function(i){return t==null?n:t[i]}}function oe(n,t,i,r,u){return u(n,function(n,u,f){i=r?(r=!1,n):t(i,n,u,f)}),i}function lc(n,t){var i=n.length;for(n.sort(t);i--;)n[i]=n[i].value;return n}function tu(t,i){for(var r,f=-1,e=t.length,u;++f<e;)u=i(t[f]),u!==n&&(r=r===n?u:r+u);return r}function iu(n,t){for(var i=-1,r=Array(n);++i<n;)r[i]=t(i);return r}function ac(n,t){return r(t,function(t){return[t,n[t]]})}function e(n){return function(t){return n(t)}}function ru(n,t){return r(t,function(t){return n[t]})}function ui(n,t){return n.has(t)}function se(n,t){for(var i=-1,r=n.length;++i<r&&yt(t,n[i],0)>-1;);return i}function he(n,t){for(var i=n.length;i--&&yt(t,n[i],0)>-1;);return i}function vc(n,t){for(var i=n.length,r=0;i--;)n[i]===t&&++r;return r}function yc(n){return"\\"+tc[n]}function pc(t,i){return t==null?n:t[i]}function pt(n){return ph.test(n)}function wc(n){return wh.test(n)}function bc(n){for(var t,i=[];!(t=n.next()).done;)i.push(t.value);return i}function uu(n){var i=-1,t=Array(n.size);return n.forEach(function(n,r){t[++i]=[r,n]}),t}function ae(n,t){return function(i){return n(t(i))}}function rt(n,t){for(var i=-1,f=n.length,e=0,u=[],r;++i<f;)r=n[i],(r===t||r===fi)&&(n[i]=fi,u[e++]=i);return u}function bi(n){var i=-1,t=Array(n.size);return n.forEach(function(n){t[++i]=n}),t}function kc(n){var i=-1,t=Array(n.size);return n.forEach(function(n){t[++i]=[n,n]}),t}function dc(n,t,i){for(var r=i-1,u=n.length;++r<u;)if(n[r]===t)return r;return-1}function gc(n,t,i){for(var r=i+1;r--;)if(n[r]===t)return r;return r}function wt(n){return pt(n)?nl(n):re(n)}function v(n){return pt(n)?tl(n):sc(n)}function nl(n){for(var t=yr.lastIndex=0;yr.test(n);)++t;return t}function tl(n){return n.match(yr)||[]}function il(n){return n.match(yh)||[]}var n,ye="4.17.11",ki=200,pe="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",di="__lodash_hash_undefined__",we=500,fi="__lodash_placeholder__",g=1,eu=2,ot=4,st=1,ei=2,s=1,ut=2,ou=4,y=8,ht=16,p=32,ct=64,b=128,bt=256,gi=512,be=30,ke="...",de=800,ge=16,su=1,no=2,to=3,ft=1/0,nt=9007199254740991,io=17976931348623157e292,oi=NaN,w=4294967295,ro=w-1,uo=w>>>1,fo=[["ary",b],["bind",s],["bindKey",ut],["curry",y],["curryRight",ht],["flip",gi],["partial",p],["partialRight",ct],["rearg",bt]],lt="[object Arguments]",si="[object Array]",eo="[object AsyncFunction]",kt="[object Boolean]",dt="[object Date]",oo="[object DOMException]",hi="[object Error]",ci="[object Function]",hu="[object GeneratorFunction]",l="[object Map]",gt="[object Number]",so="[object Null]",k="[object Object]",cu="[object Promise]",ho="[object Proxy]",ni="[object RegExp]",a="[object Set]",ti="[object String]",li="[object Symbol]",co="[object Undefined]",ii="[object WeakMap]",lo="[object WeakSet]",ri="[object ArrayBuffer]",at="[object DataView]",nr="[object Float32Array]",tr="[object Float64Array]",ir="[object Int8Array]",rr="[object Int16Array]",ur="[object Int32Array]",fr="[object Uint8Array]",er="[object Uint8ClampedArray]",or="[object Uint16Array]",sr="[object Uint32Array]",ao=/\b__p \+= '';/g,vo=/\b(__p \+=) '' \+/g,yo=/(__e\(.*?\)|\b__t\)) \+\n'';/g,lu=/&(?:amp|lt|gt|quot|#39);/g,au=/[&<>"']/g,po=RegExp(lu.source),wo=RegExp(au.source),bo=/<%-([\s\S]+?)%>/g,ko=/<%([\s\S]+?)%>/g,vu=/<%=([\s\S]+?)%>/g,go=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ns=/^\w*$/,ts=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,hr=/[\\^$.*+?()[\]{}|]/g,is=RegExp(hr.source),yu=/^\s+|\s+$/g,pu=/^\s+/,rs=/\s+$/,us=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,fs=/\{\n\/\* \[wrapped with (.+)\] \*/,es=/,? & /,os=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ss=/\\(\\)?/g,hs=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,wu=/\w*$/,cs=/^[-+]0x[0-9a-f]+$/i,ls=/^0b[01]+$/i,as=/^\[object .+?Constructor\]$/,vs=/^0o[0-7]+$/i,ys=/^(?:0|[1-9]\d*)$/,ps=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ai=/($^)/,ws=/['\n\r\u2028\u2029\\]/g,vi="\\ud800-\\udfff",bs="\\u0300-\\u036f",ks="\\ufe20-\\ufe2f",ds="\\u20d0-\\u20ff",bu=bs+ks+ds,ku="\\u2700-\\u27bf",du="a-z\\xdf-\\xf6\\xf8-\\xff",gs="\\xac\\xb1\\xd7\\xf7",nh="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",th="\\u2000-\\u206f",ih=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",gu="A-Z\\xc0-\\xd6\\xd8-\\xde",nf="\\ufe0e\\ufe0f",tf=gs+nh+th+ih,cr="['\u2019]",rh="["+vi+"]",rf="["+tf+"]",yi="["+bu+"]",uf="\\d+",uh="["+ku+"]",ff="["+du+"]",ef="[^"+vi+tf+uf+ku+du+gu+"]",lr="\\ud83c[\\udffb-\\udfff]",fh="(?:"+yi+"|"+lr+")",of="[^"+vi+"]",ar="(?:\\ud83c[\\udde6-\\uddff]){2}",vr="[\\ud800-\\udbff][\\udc00-\\udfff]",vt="["+gu+"]",sf="\\u200d",hf="(?:"+ff+"|"+ef+")",eh="(?:"+vt+"|"+ef+")",cf="(?:"+cr+"(?:d|ll|m|re|s|t|ve))?",lf="(?:"+cr+"(?:D|LL|M|RE|S|T|VE))?",af=fh+"?",vf="["+nf+"]?",oh="(?:"+sf+"(?:"+[of,ar,vr].join("|")+")"+vf+af+")*",sh="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",hh="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",yf=vf+af+oh,ch="(?:"+[uh,ar,vr].join("|")+")"+yf,lh="(?:"+[of+yi+"?",yi,ar,vr,rh].join("|")+")",ah=RegExp(cr,"g"),vh=RegExp(yi,"g"),yr=RegExp(lr+"(?="+lr+")|"+lh+yf,"g"),yh=RegExp([vt+"?"+ff+"+"+cf+"(?="+[rf,vt,"$"].join("|")+")",eh+"+"+lf+"(?="+[rf,vt+hf,"$"].join("|")+")",vt+"?"+hf+"+"+cf,vt+"+"+lf,hh,sh,uf,ch].join("|"),"g"),ph=RegExp("["+sf+vi+bu+nf+"]"),wh=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,bh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],kh=-1,i={},t,re,ce,le,ve,fu,d;i[nr]=i[tr]=i[ir]=i[rr]=i[ur]=i[fr]=i[er]=i[or]=i[sr]=!0;i[lt]=i[si]=i[ri]=i[kt]=i[at]=i[dt]=i[hi]=i[ci]=i[l]=i[gt]=i[k]=i[ni]=i[a]=i[ti]=i[ii]=!1;t={};t[lt]=t[si]=t[ri]=t[at]=t[kt]=t[dt]=t[nr]=t[tr]=t[ir]=t[rr]=t[ur]=t[l]=t[gt]=t[k]=t[ni]=t[a]=t[ti]=t[li]=t[fr]=t[er]=t[or]=t[sr]=!0;t[hi]=t[ci]=t[ii]=!1;var dh={"\u00c0":"A","\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u00c7":"C","\u00e7":"c","\u00d0":"D","\u00f0":"d","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u00d1":"N","\u00f1":"n","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d8":"O","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o","\u00f8":"o","\u00d9":"U","\u00da":"U","\u00db":"U","\u00dc":"U","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00dd":"Y","\u00fd":"y","\u00ff":"y","\u00c6":"Ae","\u00e6":"ae","\u00de":"Th","\u00fe":"th","\u00df":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"},gh={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},nc={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},tc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ic=parseFloat,rc=parseInt,pf=typeof global=="object"&&global&&global.Object===Object&&global,uc=typeof self=="object"&&self&&self.Object===Object&&self,u=pf||uc||Function("return this")(),pr=typeof exports=="object"&&exports&&!exports.nodeType&&exports,et=pr&&typeof module=="object"&&module&&!module.nodeType&&module,wf=et&&et.exports===pr,wr=wf&&pf.process,h=function(){try{var n=et&&et.require&&et.require("util").types;return n?n:wr&&wr.binding&&wr.binding("util")}catch(t){}}(),bf=h&&h.isArrayBuffer,kf=h&&h.isDate,df=h&&h.isMap,gf=h&&h.isRegExp,ne=h&&h.isSet,te=h&&h.isTypedArray;re=gr("length");ce=nu(dh);le=nu(gh);ve=nu(nc);fu=function fu(h){function et(n){if(wr(n)&&!vi(n)&&!(n instanceof lr)){if(n instanceof af)return n;if(vr.call(n,"__wrapped__"))return pd(n)}return new af(n)}function da(){}function af(t,i){this.__wrapped__=t;this.__actions__=[];this.__chain__=!!i;this.__index__=0;this.__values__=n}function lr(n){this.__wrapped__=n;this.__actions__=[];this.__dir__=1;this.__filtered__=!1;this.__iteratees__=[];this.__takeCount__=w;this.__views__=[]}function ait(){var n=new lr(this.__wrapped__);return n.__actions__=ff(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=ff(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=ff(this.__views__),n}function vit(){if(this.__filtered__){var n=new lr(this);n.__dir__=-1;n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function yit(){var n=this.__wrapped__.value(),f=this.__dir__,e=vi(n),o=f<0,s=e?n.length:0,h=yft(0,s,this.__views__),c=h.start,l=h.end,t=l-c,a=o?l:c-1,v=this.__iteratees__,d=v.length,y=0,p=nf(t,this.__takeCount__),r,u,i;if(!e||!o&&s==t&&p==t)return rk(n,this.__actions__);r=[];n:while(t--&&y<p){for(a+=f,u=-1,i=n[a];++u<d;){var w=v[u],g=w.iteratee,b=w.type,k=g(i);if(b==no)i=k;else if(!k)if(b==su)continue n;else break n}r[y++]=i}return r}function gh(n){var i=-1,r=n==null?0:n.length,t;for(this.clear();++i<r;)t=n[i],this.set(t[0],t[1])}function pit(){this.__data__=vl?vl(null):{};this.size=0}function wit(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t}function bit(t){var i=this.__data__,r;return vl?(r=i[t],r===di?n:r):vr.call(i,t)?i[t]:n}function kit(t){var i=this.__data__;return vl?i[t]!==n:vr.call(i,t)}function dit(t,i){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=vl&&i===n?di:i,this}function nh(n){var i=-1,r=n==null?0:n.length,t;for(this.clear();++i<r;)t=n[i],this.set(t[0],t[1])}function git(){this.__data__=[];this.size=0}function nrt(n){var t=this.__data__,i=ga(t,n),r;return i<0?!1:(r=t.length-1,i==r?t.pop():va.call(t,i,1),--this.size,!0)}function trt(t){var i=this.__data__,r=ga(i,t);return r<0?n:i[r][1]}function irt(n){return ga(this.__data__,n)>-1}function rrt(n,t){var i=this.__data__,r=ga(i,n);return r<0?(++this.size,i.push([n,t])):i[r][1]=t,this}function th(n){var i=-1,r=n==null?0:n.length,t;for(this.clear();++i<r;)t=n[i],this.set(t[0],t[1])}function urt(){this.size=0;this.__data__={hash:new gh,map:new(ll||nh),string:new gh}}function frt(n){var t=vv(this,n)["delete"](n);return this.size-=t?1:0,t}function ert(n){return vv(this,n).get(n)}function ort(n){return vv(this,n).has(n)}function srt(n,t){var i=vv(this,n),r=i.size;return i.set(n,t),this.size+=i.size==r?0:1,this}function nc(n){var t=-1,i=n==null?0:n.length;for(this.__data__=new th;++t<i;)this.add(n[t])}function hrt(n){return this.__data__.set(n,di),this}function crt(n){return this.__data__.has(n)}function os(n){var t=this.__data__=new nh(n);this.size=t.size}function lrt(){this.__data__=new nh;this.size=0}function art(n){var t=this.__data__,i=t["delete"](n);return this.size=t.size,i}function vrt(n){return this.__data__.get(n)}function yrt(n){return this.__data__.has(n)}function prt(n,t){var i=this.__data__,r;if(i instanceof nh){if(r=i.__data__,!ll||r.length<ki-1)return r.push([n,t]),this.size=++i.size,this;i=this.__data__=new th(r)}return i.set(n,t),this.size=i.size,this}function rb(n,t){var r=vi(n),u=!r&&dc(n),f=!r&&!u&&oh(n),o=!r&&!u&&!f&&nl(n),s=r||u||f||o,e=s?iu(n.length,att):[],h=e.length;for(var i in n)!(t||vr.call(n,i))||s&&(i=="length"||f&&(i=="offset"||i=="parent")||o&&(i=="buffer"||i=="byteLength"||i=="byteOffset")||eh(i,h))||e.push(i);return e}function ub(t){var i=t.length;return i?t[dy(0,i-1)]:n}function wrt(n,t){return yv(ff(n),tc(t,0,n.length))}function brt(n){return yv(ff(n))}function sy(t,i,r){(r===n||bs(t[i],r))&&(r!==n||i in t)||ih(t,i,r)}function wl(t,i,r){var u=t[i];vr.call(t,i)&&bs(u,r)&&(r!==n||i in t)||ih(t,i,r)}function ga(n,t){for(var i=n.length;i--;)if(bs(n[i][0],t))return i;return-1}function krt(n,t,i,r){return rh(n,function(n,u,f){t(r,n,i(n),f)}),r}function fb(n,t){return n&&ds(t,du(t),n)}function drt(n,t){return n&&ds(t,of(t),n)}function ih(n,t,i){t=="__proto__"&&ya?ya(n,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):n[t]=i}function hy(t,i){for(var r=-1,u=i.length,f=bu(u),e=t==null;++r<u;)f[r]=e?n:uw(t,i[r]);return f}function tc(t,i,r){return t===t&&(r!==n&&(t=t<=r?t:r),i!==n&&(t=t>=i?t:i)),t}function vf(i,r,u,f,e,o){var s,l=r&g,a=r&eu,d=r&ot,v,h,y,p,b,w;if(u&&(s=e?u(i,f,e,o):u(i)),s!==n)return s;if(!pr(i))return i;if(v=vi(i),v){if(s=wft(i),!l)return ff(i,s)}else{if(h=tf(i),y=h==ci||h==hu,oh(i))return ok(i,l);if(h==k||h==lt||y&&!e){if(s=a||y?{}:ed(i),!l)return a?eft(i,drt(s,i)):fft(i,fb(s,i))}else{if(!t[h])return e?i:{};s=bft(i,h,l)}}return(o||(o=new os),p=o.get(i),p)?p:(o.set(i,s),rw(i))?(i.forEach(function(n){s.add(vf(n,r,u,n,i,o))}),s):iw(i)?(i.forEach(function(n,t){s.set(t,vf(n,r,u,t,i,o))}),s):(b=d?a?cp:hp:a?of:du,w=v?n:b(i),c(w||i,function(n,t){w&&(t=n,n=i[t]);wl(s,t,vf(n,r,u,t,i,o))}),s)}function grt(n){var t=du(n);return function(i){return eb(i,n,t)}}function eb(t,i,r){var u=r.length;if(t==null)return!u;for(t=yr(t);u--;){var f=r[u],o=i[f],e=t[f];if(e===n&&!(f in t)||!o(e))return!1}return!0}function ob(t,i,r){if(typeof t!="function")throw new lf(o);return ia(function(){t.apply(n,r)},i)}function bl(n,t,i,u){var a=-1,h=pi,c=!0,v=n.length,s=[],y=t.length,f,o,l;if(!v)return s;i&&(t=r(t,e(i)));u?(h=br,c=!1):t.length>=ki&&(h=ui,c=!1,t=new nc(t));n:while(++a<v)if(f=n[a],o=i==null?f:i(f),f=u||f!==0?f:0,c&&o===o){for(l=y;l--;)if(t[l]===o)continue n;s.push(f)}else h(t,o,u)||s.push(f);return s}function nut(n,t){var i=!0;return rh(n,function(n,r,u){return i=!!t(n,r,u)}),i}function nv(t,i,r){for(var o=-1,h=t.length,f,u,e,s;++o<h;)f=t[o],u=i(f),u!=null&&(e===n?u===u&&!cf(u):r(u,e))&&(e=u,s=f);return s}function tut(t,i,r,u){var f=t.length;for(r=yi(r),r<0&&(r=-r>f?0:f+r),u=u===n||u>f?f:yi(u),u<0&&(u+=f),u=r>u?0:cn(u);r<u;)t[r++]=i;return t}function sb(n,t){var i=[];return rh(n,function(n,r,u){t(n,r,u)&&i.push(n)}),i}function gu(n,t,i,r,u){var e=-1,o=n.length,f;for(i||(i=dft),u||(u=[]);++e<o;)f=n[e],t>0&&i(f)?t>1?gu(f,t-1,i,r,u):it(u,f):r||(u[u.length]=f);return u}function ks(n,t){return n&&tv(n,t,du)}function ay(n,t){return n&&ly(n,t,du)}function iv(n,t){return tt(t,function(t){return sh(n[t])})}function fl(t,i){i=yh(i,t);for(var r=0,u=i.length;t!=null&&r<u;)t=t[gs(i[r++])];return r&&r==u?t:n}function hb(n,t,i){var r=t(n);return vi(n)?r:it(r,i(n))}function rf(t){return t==null?t===n?co:so:wh&&wh in yr(t)?vft(t):uet(t)}function vy(n,t){return n>t}function iut(n,t){return n!=null&&vr.call(n,t)}function rut(n,t){return n!=null&&t in yr(n)}function uut(n,t,i){return n>=nf(t,i)&&n<ku(t,i)}function yy(t,i,u){for(var b=u?br:pi,k=t[0].length,a=t.length,f=a,v=bu(a),y=Infinity,l=[],o,p,c,s,h,w;f--;)o=t[f],f&&i&&(o=r(o,e(i))),y=nf(o.length,y),v[f]=!u&&(i||k>=120&&o.length>=120)?new nc(f&&o):n;o=t[0];p=-1;c=v[0];n:while(++p<k&&l.length<y)if(s=o[p],h=i?i(s):s,s=u||s!==0?s:0,!(c?ui(c,h):b(l,h,u))){for(f=a;--f;)if(w=v[f],!(w?ui(w,h):b(t[f],h,u)))continue n;c&&c.push(h);l.push(s)}return l}function fut(n,t,i,r){return ks(n,function(n,u,f){t(r,i(n),u,f)}),r}function kl(t,i,r){i=yh(i,t);t=ld(t,i);var u=t==null?t:t[gs(pf(i))];return u==null?n:f(u,t,r)}function cb(n){return wr(n)&&rf(n)==lt}function eut(n){return wr(n)&&rf(n)==ri}function out(n){return wr(n)&&rf(n)==dt}function dl(n,t,i,r,u){return n===t?!0:n==null||t==null||!wr(n)&&!wr(t)?n!==n&&t!==t:sut(n,t,i,r,dl,u)}function sut(n,t,i,r,u,f){var s=vi(n),p=vi(t),e=s?si:tf(n),o=p?si:tf(t),l,a,v,y;e=e==lt?k:e;o=o==lt?k:o;var h=e==k,w=o==k,c=e==o;if(c&&oh(n)){if(!oh(t))return!1;s=!0;h=!1}return c&&!h?(f||(f=new os),s||nl(n)?rd(n,t,i,r,u,f):lft(n,t,e,i,r,u,f)):!(i&st)&&(l=h&&vr.call(n,"__wrapped__"),a=w&&vr.call(t,"__wrapped__"),l||a)?(v=l?n.value():n,y=a?t.value():t,f||(f=new os),u(v,y,i,r,f)):c?(f||(f=new os),aft(n,t,i,r,u,f)):!1}function hut(n){return wr(n)&&tf(n)==l}function py(t,i,r,u){var e=r.length,l=e,a=!u,f,h,c;if(t==null)return!l;for(t=yr(t);e--;)if(f=r[e],a&&f[2]?f[1]!==t[f[0]]:!(f[0]in t))return!1;while(++e<l){f=r[e];var o=f[0],s=t[o],v=f[1];if(a&&f[2]){if(s===n&&!(o in t))return!1}else if(h=new os,u&&(c=u(s,v,o,t,i,h)),!(c===n?dl(v,s,st|ei,u,h):c))return!1}return!0}function lb(n){if(!pr(n)||net(n))return!1;var t=sh(n)?btt:as;return t.test(sc(n))}function cut(n){return wr(n)&&rf(n)==ni}function lut(n){return wr(n)&&tf(n)==a}function aut(n){return wr(n)&&gv(n.length)&&!!i[rf(n)]}function ab(n){return typeof n=="function"?n:n==null?sf:typeof n=="object"?vi(n)?pb(n[0],n[1]):yb(n):htt(n)}function wy(n){var i,t;if(!ta(n))return rit(n);i=[];for(t in yr(n))vr.call(n,t)&&t!="constructor"&&i.push(t);return i}function vut(n){var r,i,t;if(!pr(n))return ret(n);r=ta(n);i=[];for(t in n)t=="constructor"&&(r||!vr.call(n,t))||i.push(t);return i}function by(n,t){return n<t}function vb(n,t){var r=-1,i=ef(n)?bu(n.length):[];return rh(n,function(n,u,f){i[++r]=t(n,u,f)}),i}function yb(n){var t=lp(n);return t.length==1&&t[0][2]?hd(t[0][0],t[0][1]):function(i){return i===n||py(i,n,t)}}function pb(t,i){return vp(t)&&sd(i)?hd(gs(t),i):function(r){var u=uw(r,t);return u===n&&u===i?fw(r,t):dl(i,u,st|ei)}}function rv(t,i,r,u,f){t!==i&&tv(i,function(e,o){if(pr(e))f||(f=new os),yut(t,i,o,r,rv,u,f);else{var s=u?u(pp(t,o),e,o+"",t,i,f):n;s===n&&(s=e);sy(t,o,s)}},of)}function yut(t,i,r,u,f,e,o){var c=pp(t,r),s=pp(i,r),y=o.get(s),h,l;if(y){sy(t,r,y);return}if(h=e?e(c,s,r+"",t,i,o):n,l=h===n,l){var a=vi(s),v=!a&&oh(s),p=!a&&!v&&nl(s);h=s;a||v||p?vi(c)?h=c:nu(c)?h=ff(c):v?(l=!1,h=ok(s,!0)):p?(l=!1,h=sk(s,!0)):h=[]:ua(s)||dc(s)?(h=c,dc(c)?h=ln(c):(!pr(c)||sh(c))&&(h=ed(s))):l=!1}l&&(o.set(s,h),f(h,s,u,e,o),o["delete"](s));sy(t,r,h)}function wb(t,i){var r=t.length;if(r)return i+=i<0?r:0,eh(i,r)?t[i]:n}function bb(n,t,i){var f=-1,u;return t=r(t.length?t:[sf],e(vt())),u=vb(n,function(n,i,u){var e=r(t,function(t){return t(n)});return{criteria:e,index:++f,value:n}}),lc(u,function(n,t){return uft(n,t,i)})}function put(n,t){return kb(n,t,function(t,i){return fw(n,i)})}function kb(n,t,i){for(var f=-1,o=t.length,e={},r,u;++f<o;)r=t[f],u=fl(n,r),i(u,r)&&gl(e,yh(r,n),u);return e}function wut(n){return function(t){return fl(t,n)}}function ky(n,t,i,u){var c=u?cc:yt,s=-1,l=t.length,f=n;for(n===t&&(t=ff(t)),i&&(f=r(n,e(i)));++s<l;)for(var o=0,h=t[s],a=i?i(h):h;(o=c(f,a,o,u))>-1;)f!==n&&va.call(f,o,1),va.call(n,o,1);return n}function db(n,t){for(var r=n?t.length:0,f=r-1,i,u;r--;)i=t[r],(r==f||i!==u)&&(u=i,eh(i)?va.call(n,i,1):ip(n,i));return n}function dy(n,t){return n+wa(tb()*(t-n+1))}function but(n,t,i,r){for(var e=-1,u=ku(pa((t-n)/(i||1)),0),f=bu(u);u--;)f[r?u:++e]=n,n+=i;return f}function gy(n,t){var i="";if(!n||t<1||t>nt)return i;do t%2&&(i+=n),t=wa(t/2),t&&(n+=n);while(t);return i}function cr(n,t){return wp(cd(n,t,sf),n+"")}function kut(n){return ub(hl(n))}function dut(n,t){var i=hl(n);return yv(i,tc(t,0,i.length))}function gl(t,i,r,u){var e,o,h;if(!pr(t))return t;i=yh(i,t);for(var s=-1,c=i.length,l=c-1,f=t;f!=null&&++s<c;)e=gs(i[s]),o=r,s!=l&&(h=f[e],o=u?u(h,e,f):n,o===n&&(o=pr(h)?h:eh(i[s+1])?[]:{})),wl(f,e,o),f=f[e];return t}function gut(n){return yv(hl(n))}function yf(n,t,i){var u=-1,r=n.length,f;for(t<0&&(t=-t>r?0:r+t),i=i>r?r:i,i<0&&(i+=r),r=t>i?0:i-t>>>0,t>>>=0,f=bu(r);++u<r;)f[u]=n[u+t];return f}function nft(n,t){var i;return rh(n,function(n,r,u){return i=t(n,r,u),!i}),!!i}function uv(n,t,i){var f=0,r=n==null?f:n.length,e,u;if(typeof t=="number"&&t===t&&r<=uo){while(f<r)e=f+r>>>1,u=n[e],u!==null&&!cf(u)&&(i?u<=t:u<t)?f=e+1:r=e;return r}return tp(n,t,sf,i)}function tp(t,i,r,u){var v;i=r(i);for(var s=0,e=t==null?0:t.length,y=i!==i,p=i===null,w=cf(i),b=i===n;s<e;){var h=wa((s+e)/2),f=r(t[h]),c=f!==n,l=f===null,o=f===f,a=cf(f);v=y?u||o:b?o&&(u||c):p?o&&c&&(u||!l):w?o&&c&&!l&&(u||!a):l||a?!1:u?f<=i:f<i;v?s=h+1:e=h}return nf(e,ro)}function nk(n,t){for(var r=-1,o=n.length,s=0,f=[],i,u,e;++r<o;)i=n[r],u=t?t(i):i,r&&bs(u,e)||(e=u,f[s++]=i===0?0:i);return f}function tk(n){return typeof n=="number"?n:cf(n)?oi:+n}function hf(n){if(typeof n=="string")return n;if(vi(n))return r(n,hf)+"";if(cf(n))return ib?ib.call(n):"";var t=n+"";return t=="0"&&1/n==-ft?"-0":t}function lh(n,t,i){var l=-1,o=pi,a=n.length,s=!0,e=[],r=e,h,u,f,c;if(i)s=!1,o=br;else if(a>=ki){if(h=t?null:gk(n),h)return bi(h);s=!1;o=ui;r=new nc}else r=t?[]:e;n:while(++l<a)if(u=n[l],f=t?t(u):u,u=i||u!==0?u:0,s&&f===f){for(c=r.length;c--;)if(r[c]===f)continue n;t&&r.push(f);e.push(u)}else o(r,f,i)||(r!==e&&r.push(f),e.push(u));return e}function ip(n,t){return t=yh(t,n),n=ld(n,t),n==null||delete n[gs(pf(t))]}function ik(n,t,i,r){return gl(n,t,i(fl(n,t)),r)}function fv(n,t,i,r){for(var f=n.length,u=r?f:-1;(r?u--:++u<f)&&t(n[u],u,n););return i?yf(n,r?0:u,r?u+1:f):yf(n,r?u+1:0,r?f:u)}function rk(n,t){var i=n;return i instanceof lr&&(i=i.value()),kr(t,function(n,t){return t.func.apply(t.thisArg,it([n],t.args))},i)}function rp(n,t,i){var u=n.length,r,f,o,e;if(u<2)return u?lh(n[0]):[];for(r=-1,f=bu(u);++r<u;)for(o=n[r],e=-1;++e<u;)e!=r&&(f[r]=bl(f[r]||o,n[e],t,i));return lh(gu(f,1),t,i)}function uk(t,i,r){for(var u=-1,o=t.length,s=i.length,f={},e;++u<o;)e=u<s?i[u]:n,r(f,t[u],e);return f}function up(n){return nu(n)?n:[]}function fp(n){return typeof n=="function"?n:sf}function yh(n,t){return vi(n)?n:vp(n,t)?[n]:bp(ar(n))}function ph(t,i,r){var u=t.length;return r=r===n?u:r,!i&&r>=u?t:yf(t,i,r)}function ok(n,t){if(t)return n.slice();var i=n.length,r=kw?kw(i):new n.constructor(i);return n.copy(r),r}function ep(n){var t=new n.constructor(n.byteLength);return new la(t).set(new la(n)),t}function tft(n,t){var i=t?ep(n.buffer):n.buffer;return new n.constructor(i,n.byteOffset,n.byteLength)}function ift(n){var t=new n.constructor(n.source,wu.exec(n));return t.lastIndex=n.lastIndex,t}function rft(n){return pl?yr(pl.call(n)):{}}function sk(n,t){var i=t?ep(n.buffer):n.buffer;return new n.constructor(i,n.byteOffset,n.length)}function hk(t,i){if(t!==i){var o=t!==n,s=t===null,r=t===t,u=cf(t),h=i!==n,c=i===null,f=i===i,e=cf(i);if(!c&&!e&&!u&&t>i||u&&h&&f&&!c&&!e||s&&h&&f||!o&&f||!r)return 1;if(!s&&!u&&!e&&t<i||e&&o&&r&&!s&&!u||c&&o&&r||!h&&r||!f)return-1}return 0}function uft(n,t,i){for(var r=-1,f=n.criteria,o=t.criteria,s=f.length,h=i.length,u,e;++r<s;)if(u=hk(f[r],o[r]),u)return r>=h?u:(e=i[r],u*(e=="desc"?-1:1));return n.index-t.index}function ck(n,t,i,r){for(var u=-1,o=n.length,s=i.length,f=-1,h=t.length,c=ku(o-s,0),e=bu(h+c),l=!r;++f<h;)e[f]=t[f];while(++u<s)(l||u<o)&&(e[i[u]]=n[u]);while(c--)e[f++]=n[u++];return e}function lk(n,t,i,r){for(var u=-1,s=n.length,h=-1,c=i.length,e=-1,l=t.length,a=ku(s-c,0),f=bu(a+l),v=!r,o;++u<a;)f[u]=n[u];for(o=u;++e<l;)f[o+e]=t[e];while(++h<c)(v||u<s)&&(f[o+i[h]]=n[u++]);return f}function ff(n,t){var i=-1,r=n.length;for(t||(t=bu(r));++i<r;)t[i]=n[i];return t}function ds(t,i,r,u){var h=!r,o,s,f,e;for(r||(r={}),o=-1,s=i.length;++o<s;)f=i[o],e=u?u(r[f],t[f],f,r,t):n,e===n&&(e=t[f]),h?ih(r,f,e):wl(r,f,e);return r}function fft(n,t){return ds(n,ap(n),t)}function eft(n,t){return ds(n,ud(n),t)}function ev(n,t){return function(i,r){var u=vi(i)?fc:krt,f=t?t():{};return u(i,n,vt(r,2),f)}}function el(t){return cr(function(i,r){var e=-1,u=r.length,f=u>1?r[u-1]:n,s=u>2?r[2]:n,o;for(f=t.length>3&&typeof f=="function"?(u--,f):n,s&&uf(r[0],r[1],s)&&(f=u<3?n:f,u=1),i=yr(i);++e<u;)o=r[e],o&&t(i,o,e,f);return i})}function ak(n,t){return function(i,r){if(i==null)return i;if(!ef(i))return n(i,r);for(var f=i.length,u=t?f:-1,e=yr(i);t?u--:++u<f;)if(r(e[u],u,e)===!1)break;return i}}function vk(n){return function(t,i,r){for(var s=-1,f=yr(t),e=r(t),o=e.length,u;o--;)if(u=e[n?o:++s],i(f[u],u,f)===!1)break;return t}}function oft(n,t,i){function r(){var t=this&&this!==u&&this instanceof r?e:n;return t.apply(f?i:this,arguments)}var f=t&s,e=na(n);return r}function yk(t){return function(i){i=ar(i);var r=pt(i)?v(i):n,u=r?r[0]:i.charAt(0),f=r?ph(r,1).join(""):i.slice(1);return u[t]()+f}}function ol(n){return function(t){return kr(rtt(gn(t).replace(ah,"")),n,"")}}function na(n){return function(){var t=arguments,i,r;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}return i=dh(n.prototype),r=n.apply(i,t),pr(r)?r:i}}function sft(t,i,r){function e(){for(var s=arguments.length,h=bu(s),c=s,l=sl(e),a,v;c--;)h[c]=arguments[c];return(a=s<3&&h[0]!==l&&h[s-1]!==l?[]:rt(h,l),s-=a.length,s<r)?dk(t,i,ov,e.placeholder,n,h,a,n,n,r-s):(v=this&&this!==u&&this instanceof e?o:t,f(v,this,h))}var o=na(t);return e}function pk(t){return function(i,r,u){var e=yr(i),o,f;return ef(i)||(o=vt(r,3),i=du(i),r=function(n){return o(e[n],n,e)}),f=t(i,r,u),f>-1?e[o?i[f]:f]:n}}function wk(t){return fh(function(i){var s=i.length,e=s,c=af.prototype.thru,u,r,h,f;for(t&&i.reverse();e--;){if(u=i[e],typeof u!="function")throw new lf(o);c&&!r&&av(u)=="wrapper"&&(r=new af([],!0))}for(e=r?e:s;++e<s;)u=i[e],h=av(u),f=h=="wrapper"?lv(u):n,r=f&&yp(f[0])&&f[1]==(b|y|p|bt)&&!f[4].length&&f[9]==1?r[av(f[0])].apply(r,f[3]):u.length==1&&yp(u)?r[h]():r.thru(u);return function(){var u=arguments,f=u[0],n,t;if(r&&u.length==1&&vi(f))return r.plant(f).value();for(n=0,t=s?i[n].apply(this,u):f;++n<s;)t=i[n].call(this,t);return t}})}function ov(t,i,r,f,e,o,h,c,l,a){function p(){for(var s=arguments.length,n=bu(s),b=s,tt,ut,ft,it,y;b--;)n[b]=arguments[b];return(v&&(tt=sl(p),ut=vc(n,tt)),f&&(n=ck(n,f,e,v)),o&&(n=lk(n,o,h,v)),s-=ut,v&&s<a)?(ft=rt(n,tt),dk(t,i,ov,p.placeholder,r,n,ft,c,l,a-s)):(it=d?r:this,y=w?it[t]:t,s=n.length,c?n=fet(n,c):g&&s>1&&n.reverse(),k&&l<s&&(n.length=l),this&&this!==u&&this instanceof p&&(y=nt||na(y)),y.apply(it,n))}var k=i&b,d=i&s,w=i&ut,v=i&(y|ht),g=i&gi,nt=w?n:na(t);return p}function bk(n,t){return function(i,r){return fut(i,n,t(r),{})}}function sv(t,i){return function(r,u){var f;if(r===n&&u===n)return i;if(r!==n&&(f=r),u!==n){if(f===n)return u;typeof r=="string"||typeof u=="string"?(r=hf(r),u=hf(u)):(r=tk(r),u=tk(u));f=t(r,u)}return f}}function op(n){return fh(function(t){return t=r(t,e(vt())),cr(function(i){var r=this;return n(t,function(n){return f(n,r,i)})})})}function hv(t,i){var r,u;return(i=i===n?" ":hf(i),r=i.length,r<2)?r?gy(i,t):i:(u=gy(i,pa(t/wt(i))),pt(i)?ph(v(u),0,t).join(""):u.slice(0,t))}function hft(n,t,i,r){function e(){for(var a=-1,c=arguments.length,t=-1,l=r.length,s=bu(l+c),v=this&&this!==u&&this instanceof e?h:n;++t<l;)s[t]=r[t];while(c--)s[t++]=arguments[++a];return f(v,o?i:this,s)}var o=t&s,h=na(n);return e}function kk(t){return function(i,r,u){return u&&typeof u!="number"&&uf(i,r,u)&&(r=u=n),i=hh(i),r===n?(r=i,i=0):r=hh(r),u=u===n?i<r?1:-1:hh(u),but(i,r,u,t)}}function cv(n){return function(t,i){return typeof t=="string"&&typeof i=="string"||(t=re(t),i=re(i)),n(t,i)}}function dk(t,i,r,u,f,e,o,h,c,l){var a=i&y,b=a?o:n,k=a?n:o,d=a?e:n,g=a?n:e,w,v;return i|=a?p:ct,i&=~(a?ct:p),i&ou||(i&=~(s|ut)),w=[t,i,f,d,b,g,k,h,c,l],v=r.apply(n,w),yp(t)&&ad(v,w),v.placeholder=u,vd(v,t,i)}function sp(n){var t=tl[n];return function(n,i){if(n=re(n),i=i==null?0:nf(yi(i),292),i){var r=(ar(n)+"e").split("e"),u=t(r[0]+"e"+(+r[1]+i));return r=(ar(u)+"e").split("e"),+(r[0]+"e"+(+r[1]-i))}return t(n)}}function nd(n){return function(t){var i=tf(t);return i==l?uu(t):i==a?kc(t):ac(t,n(t))}}function uh(t,i,r,u,f,e,h,c){var w=i&ut,a,b,k,v,l,d,g;if(!w&&typeof t!="function")throw new lf(o);return a=u?u.length:0,a||(i&=~(p|ct),u=f=n),h=h===n?h:ku(yi(h),0),c=c===n?c:yi(c),a-=f?f.length:0,i&ct&&(b=u,k=f,u=f=n),v=w?n:lv(t),l=[t,i,r,u,f,b,k,e,h,c],v&&iet(l,v),t=l[0],i=l[1],r=l[2],u=l[3],f=l[4],c=l[9]=l[9]===n?w?0:t.length:ku(l[9]-a,0),!c&&i&(y|ht)&&(i&=~(y|ht)),d=i&&i!=s?i==y||i==ht?sft(t,i,c):i!=p&&i!=(s|p)||f.length?ov.apply(n,l):hft(t,i,r,u):oft(t,i,r),g=v?np:ad,vd(g(d,l),t,i)}function td(t,i,r,u){return t===n||bs(t,rl[r])&&!vr.call(u,r)?i:t}function id(t,i,r,u,f,e){return pr(t)&&pr(i)&&(e.set(i,t),rv(t,i,n,id,e),e["delete"](i)),t}function cft(t){return ua(t)?n:t}function rd(t,i,r,u,f,e){var p=r&st,l=t.length,w=i.length,a,o,h,y;if(l!=w&&!(p&&w>l))return!1;if(a=e.get(t),a&&e.get(i))return a==i;var s=-1,c=!0,v=r&ei?new nc:n;for(e.set(t,i),e.set(i,t);++s<l;){if(o=t[s],h=i[s],u&&(y=p?u(h,o,s,i,t,e):u(o,h,s,t,i,e)),y!==n){if(y)continue;c=!1;break}if(v){if(!dr(i,function(n,t){if(!ui(v,t)&&(o===n||f(o,n,r,u,e)))return v.push(t)})){c=!1;break}}else if(!(o===h||f(o,h,r,u,e))){c=!1;break}}return e["delete"](t),e["delete"](i),c}function lft(n,t,i,r,u,f,e){var o,h,s,c;switch(i){case at:if(n.byteLength!=t.byteLength||n.byteOffset!=t.byteOffset)return!1;n=n.buffer;t=t.buffer;case ri:return n.byteLength!=t.byteLength||!f(new la(n),new la(t))?!1:!0;case kt:case dt:case gt:return bs(+n,+t);case hi:return n.name==t.name&&n.message==t.message;case ni:case ti:return n==t+"";case l:o=uu;case a:return(h=r&st,o||(o=bi),n.size!=t.size&&!h)?!1:(s=e.get(n),s)?s==t:(r|=ei,e.set(n,t),c=rd(o(n),o(t),r,u,f,e),e["delete"](n),c);case li:if(pl)return pl.call(n)==pl.call(t)}return!1}function aft(t,i,r,u,f,e){var y=r&st,w=hp(t),b=w.length,g=hp(i),nt=g.length,s,o,k,h,p,c,l,d,a,v;if(b!=nt&&!y)return!1;for(s=b;s--;)if(o=w[s],!(y?o in i:vr.call(i,o)))return!1;if(k=e.get(t),k&&e.get(i))return k==i;for(h=!0,e.set(t,i),e.set(i,t),p=y;++s<b;){if(o=w[s],c=t[o],l=i[o],u&&(d=y?u(l,c,o,i,t,e):u(c,l,o,t,i,e)),!(d===n?c===l||f(c,l,r,u,e):d)){h=!1;break}p||(p=o=="constructor")}return h&&!p&&(a=t.constructor,v=i.constructor,a!=v&&"constructor"in t&&"constructor"in i&&!(typeof a=="function"&&a instanceof a&&typeof v=="function"&&v instanceof v)&&(h=!1)),e["delete"](t),e["delete"](i),h}function fh(t){return wp(cd(t,n,kd),t+"")}function hp(n){return hb(n,du,ap)}function cp(n){return hb(n,of,ud)}function av(n){for(var t=n.name+"",u=yl[t],f=vr.call(yl,t)?u.length:0,i,r;f--;)if(i=u[f],r=i.func,r==null||r==n)return i.name;return t}function sl(n){var t=vr.call(et,"placeholder")?et:n;return t.placeholder}function vt(){var n=et.iteratee||cw;return n=n===cw?ab:n,arguments.length?n(arguments[0],arguments[1]):n}function vv(n,t){var i=n.__data__;return gft(t)?i[typeof t=="string"?"string":"hash"]:i.map}function lp(n){for(var t=du(n),i=t.length,r,u;i--;)r=t[i],u=n[r],t[i]=[r,u,sd(u)];return t}function uc(t,i){var r=pc(t,i);return lb(r)?r:n}function vft(t){var u=vr.call(t,wh),f=t[wh],i,r;try{t[wh]=n;i=!0}catch(e){}return r=ha.call(t),i&&(u?t[wh]=f:delete t[wh]),r}function yft(n,t,i){for(var f=-1,e=i.length,u,r;++f<e;){u=i[f];r=u.size;switch(u.type){case"drop":n+=r;break;case"dropRight":t-=r;break;case"take":t=nf(t,n+r);break;case"takeRight":n=ku(n,t-r);break}}return{start:n,end:t}}function pft(n){var t=n.match(fs);return t?t[1].split(es):[]}function fd(n,t,i){var u;t=yh(t,n);for(var f=-1,r=t.length,e=!1;++f<r;){if(u=gs(t[f]),!(e=n!=null&&i(n,u)))break;n=n[u]}return e||++f!=r?e:(r=n==null?0:n.length,!!r&&gv(r)&&eh(u,r)&&(vi(n)||dc(n)))}function wft(n){var i=n.length,t=new n.constructor(i);return i&&typeof n[0]=="string"&&vr.call(n,"index")&&(t.index=n.index,t.input=n.input),t}function ed(n){return typeof n.constructor=="function"&&!ta(n)?dh(aa(n)):{}}function bft(n,t,i){var r=n.constructor;switch(t){case ri:return ep(n);case kt:case dt:return new r(+n);case at:return tft(n,i);case nr:case tr:case ir:case rr:case ur:case fr:case er:case or:case sr:return sk(n,i);case l:return new r;case gt:case ti:return new r(n);case ni:return ift(n);case a:return new r;case li:return rft(n)}}function kft(n,t){var i=t.length,r;return i?(r=i-1,t[r]=(i>1?"& ":"")+t[r],t=t.join(i>2?", ":" "),n.replace(us,"{\n/* [wrapped with "+t+"] */\n")):n}function dft(n){return vi(n)||dc(n)||!!(nb&&n&&n[nb])}function eh(n,t){var i=typeof n;return t=t==null?nt:t,!!t&&(i=="number"||i!="symbol"&&ys.test(n))&&n>-1&&n%1==0&&n<t}function uf(n,t,i){if(!pr(i))return!1;var r=typeof t;return(r=="number"?ef(i)&&eh(t,i.length):r=="string"&&t in i)?bs(i[t],n):!1}function vp(n,t){if(vi(n))return!1;var i=typeof n;return i=="number"||i=="symbol"||i=="boolean"||n==null||cf(n)?!0:ns.test(n)||!go.test(n)||t!=null&&n in yr(t)}function gft(n){var t=typeof n;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?n!=="__proto__":n===null}function yp(n){var r=av(n),t=et[r],i;return typeof t!="function"||!(r in lr.prototype)?!1:n===t?!0:(i=lv(t),!!i&&n===i[0])}function net(n){return!!bw&&bw in n}function ta(n){var t=n&&n.constructor,i=typeof t=="function"&&t.prototype||rl;return n===i}function sd(n){return n===n&&!pr(n)}function hd(t,i){return function(r){return r==null?!1:r[t]===i&&(i!==n||t in yr(r))}}function tet(n){var t=kv(n,function(n){return i.size===we&&i.clear(),n}),i=t.cache;return t}function iet(n,t){var f=n[1],u=t[1],e=f|u,o=e<(s|ut|b),h=u==b&&f==y||u==b&&f==bt&&n[7].length<=t[8]||u==(b|bt)&&t[7].length<=t[8]&&f==y,i,r;return(o||h)?(u&s&&(n[2]=t[2],e|=f&s?0:ou),i=t[3],i&&(r=n[3],n[3]=r?ck(r,i,t[4]):i,n[4]=r?rt(n[3],fi):t[4]),i=t[5],i&&(r=n[5],n[5]=r?lk(r,i,t[6]):i,n[6]=r?rt(n[5],fi):t[6]),i=t[7],i&&(n[7]=i),u&b&&(n[8]=n[8]==null?t[8]:nf(n[8],t[8])),n[9]==null&&(n[9]=t[9]),n[0]=t[0],n[1]=e,n):n}function ret(n){var t=[],i;if(n!=null)for(i in yr(n))t.push(i);return t}function uet(n){return ha.call(n)}function cd(t,i,r){return i=ku(i===n?t.length-1:i,0),function(){for(var e=arguments,n=-1,o=ku(e.length-i,0),s=bu(o),u;++n<o;)s[n]=e[i+n];for(n=-1,u=bu(i+1);++n<i;)u[n]=e[n];return u[i]=r(s),f(t,this,u)}}function ld(n,t){return t.length<2?n:fl(n,yf(t,0,-1))}function fet(t,i){for(var f=t.length,r=nf(i.length,f),e=ff(t),u;r--;)u=i[r],t[r]=eh(u,f)?e[u]:n;return t}function pp(n,t){if(t!="__proto__")return n[t]}function vd(n,t,i){var r=t+"";return wp(n,kft(r,eet(pft(r),i)))}function yd(t){var i=0,r=0;return function(){var u=uit(),f=ge-(u-r);if(r=u,f>0){if(++i>=de)return arguments[0]}else i=0;return t.apply(n,arguments)}}function yv(t,i){var r=-1,f=t.length,o=f-1,u,e;for(i=i===n?f:i;++r<i;)u=dy(r,o),e=t[u],t[u]=t[r],t[r]=e;return t.length=i,t}function gs(n){if(typeof n=="string"||cf(n))return n;var t=n+"";return t=="0"&&1/n==-ft?"-0":t}function sc(n){if(n!=null){try{return sa.call(n)}catch(t){}try{return n+""}catch(t){}}return""}function eet(n,t){return c(fo,function(i){var r="_."+i[0];t&i[1]&&!pi(n,r)&&n.push(r)}),n.sort()}function pd(n){if(n instanceof lr)return n.clone();var t=new af(n.__wrapped__,n.__chain__);return t.__actions__=ff(n.__actions__),t.__index__=n.__index__,t.__values__=n.__values__,t}function oet(t,i,r){var u;if(i=(r?uf(t,i,r):i===n)?1:ku(yi(i),0),u=t==null?0:t.length,!u||i<1)return[];for(var f=0,o=0,e=bu(pa(u/i));f<u;)e[o++]=yf(t,f,f+=i);return e}function set(n){for(var i=-1,u=n==null?0:n.length,f=0,r=[],t;++i<u;)t=n[i],t&&(r[f++]=t);return r}function het(){var n=arguments.length;if(!n)return[];for(var r=bu(n-1),t=arguments[0],i=n;i--;)r[i-1]=arguments[i];return it(vi(t)?ff(t):[t],gu(r,1))}function yet(t,i,r){var u=t==null?0:t.length;return u?(i=r||i===n?1:yi(i),yf(t,i<0?0:i,u)):[]}function pet(t,i,r){var u=t==null?0:t.length;return u?(i=r||i===n?1:yi(i),i=u-i,yf(t,0,i<0?0:i)):[]}function wet(n,t){return n&&n.length?fv(n,vt(t,3),!0,!0):[]}function bet(n,t){return n&&n.length?fv(n,vt(t,3),!0):[]}function ket(n,t,i,r){var u=n==null?0:n.length;return u?(i&&typeof i!="number"&&uf(n,t,i)&&(i=0,r=u),tut(n,t,i,r)):[]}function wd(n,t,i){var u=n==null?0:n.length,r;return u?(r=i==null?0:yi(i),r<0&&(r=ku(u+r,0)),wi(n,vt(t,3),r)):-1}function bd(t,i,r){var f=t==null?0:t.length,u;return f?(u=f-1,r!==n&&(u=yi(r),u=r<0?ku(f+u,0):nf(u,f-1)),wi(t,vt(i,3),u,!0)):-1}function kd(n){var t=n==null?0:n.length;return t?gu(n,1):[]}function det(n){var t=n==null?0:n.length;return t?gu(n,ft):[]}function get(t,i){var r=t==null?0:t.length;return r?(i=i===n?1:yi(i),gu(t,i)):[]}function not(n){for(var i=-1,u=n==null?0:n.length,r={},t;++i<u;)t=n[i],r[t[0]]=t[1];return r}function dd(t){return t&&t.length?t[0]:n}function tot(n,t,i){var u=n==null?0:n.length,r;return u?(r=i==null?0:yi(i),r<0&&(r=ku(u+r,0)),yt(n,t,r)):-1}function iot(n){var t=n==null?0:n.length;return t?yf(n,0,-1):[]}function eot(n,t){return n==null?"":iit.call(n,t)}function pf(t){var i=t==null?0:t.length;return i?t[i-1]:n}function oot(t,i,r){var f=t==null?0:t.length,u;return f?(u=f,r!==n&&(u=yi(r),u=u<0?ku(f+u,0):nf(u,f-1)),i===i?gc(t,i,u):wi(t,fe,u,!0)):-1}function sot(t,i){return t&&t.length?wb(t,yi(i)):n}function ng(n,t){return n&&n.length&&t&&t.length?ky(n,t):n}function hot(n,t,i){return n&&n.length&&t&&t.length?ky(n,t,vt(i,2)):n}function cot(t,i,r){return t&&t.length&&i&&i.length?ky(t,i,n,r):t}function lot(n,t){var r=[],u;if(!(n&&n.length))return r;var i=-1,f=[],e=n.length;for(t=vt(t,3);++i<e;)u=n[i],t(u,i,n)&&(r.push(u),f.push(i));return db(n,f),r}function kp(n){return n==null?n:eit.call(n)}function aot(t,i,r){var u=t==null?0:t.length;return u?(r&&typeof r!="number"&&uf(t,i,r)?(i=0,r=u):(i=i==null?0:yi(i),r=r===n?u:yi(r)),yf(t,i,r)):[]}function vot(n,t){return uv(n,t)}function yot(n,t,i){return tp(n,t,vt(i,2))}function pot(n,t){var r=n==null?0:n.length,i;return r&&(i=uv(n,t),i<r&&bs(n[i],t))?i:-1}function wot(n,t){return uv(n,t,!0)}function bot(n,t,i){return tp(n,t,vt(i,2),!0)}function kot(n,t){var r=n==null?0:n.length,i;return r&&(i=uv(n,t,!0)-1,bs(n[i],t))?i:-1}function dot(n){return n&&n.length?nk(n):[]}function got(n,t){return n&&n.length?nk(n,vt(t,2)):[]}function nst(n){var t=n==null?0:n.length;return t?yf(n,1,t):[]}function tst(t,i,r){return(t&&t.length)?(i=r||i===n?1:yi(i),yf(t,0,i<0?0:i)):[]}function ist(t,i,r){var u=t==null?0:t.length;return u?(i=r||i===n?1:yi(i),i=u-i,yf(t,i<0?0:i,u)):[]}function rst(n,t){return n&&n.length?fv(n,vt(t,3),!1,!0):[]}function ust(n,t){return n&&n.length?fv(n,vt(t,3)):[]}function sst(n){return n&&n.length?lh(n):[]}function hst(n,t){return n&&n.length?lh(n,vt(t,2)):[]}function cst(t,i){return i=typeof i=="function"?i:n,t&&t.length?lh(t,n,i):[]}function dp(n){if(!(n&&n.length))return[];var t=0;return n=tt(n,function(n){if(nu(n))return t=ku(n.length,t),!0}),iu(t,function(t){return r(n,gr(t))})}function ig(t,i){if(!(t&&t.length))return[];var u=dp(t);return i==null?u:r(u,function(t){return f(i,n,t)})}function wst(n,t){return uk(n||[],t||[],wl)}function bst(n,t){return uk(n||[],t||[],gl)}function ug(n){var t=et(n);return t.__chain__=!0,t}function kst(n,t){return t(n),n}function pv(n,t){return t(n)}function dst(){return ug(this)}function gst(){return new af(this.value(),this.__chain__)}function nht(){this.__values__===n&&(this.__values__=hn(this.value()));var t=this.__index__>=this.__values__.length,i=t?n:this.__values__[this.__index__++];return{done:t,value:i}}function tht(){return this}function iht(t){for(var u,r=this,i,f;r instanceof da;)i=pd(r),i.__index__=0,i.__values__=n,u?f.__wrapped__=i:u=i,f=i,r=r.__wrapped__;return f.__wrapped__=t,u}function rht(){var i=this.__wrapped__,t;return i instanceof lr?(t=i,this.__actions__.length&&(t=new lr(this)),t=t.reverse(),t.__actions__.push({func:pv,args:[kp],thisArg:n}),new af(t,this.__chain__)):this.thru(kp)}function uht(){return rk(this.__wrapped__,this.__actions__)}function fht(t,i,r){var u=vi(t)?ie:nut;return r&&uf(t,i,r)&&(i=n),u(t,vt(i,3))}function eht(n,t){var i=vi(n)?tt:sb;return i(n,vt(t,3))}function oht(n,t){return gu(wv(n,t),1)}function sht(n,t){return gu(wv(n,t),ft)}function hht(t,i,r){return r=r===n?1:yi(r),gu(wv(t,i),r)}function hg(n,t){var i=vi(n)?c:rh;return i(n,vt(t,3))}function cg(n,t){var i=vi(n)?ec:cy;return i(n,vt(t,3))}function cht(n,t,i,r){n=ef(n)?n:hl(n);i=i&&!r?yi(i):0;var u=n.length;return i<0&&(i=ku(u+i,0)),ty(n)?i<=u&&n.indexOf(t,i)>-1:!!u&&yt(n,t,i)>-1}function wv(n,t){var i=vi(n)?r:vb;return i(n,vt(t,3))}function lht(t,i,r,u){return t==null?[]:(vi(i)||(i=i==null?[]:[i]),r=u?n:r,vi(r)||(r=r==null?[]:[r]),bb(t,i,r))}function aht(n,t,i){var r=vi(n)?kr:oe,u=arguments.length<3;return r(n,vt(t,4),i,u,rh)}function vht(n,t,i){var r=vi(n)?oc:oe,u=arguments.length<3;return r(n,vt(t,4),i,u,cy)}function yht(n,t){var i=vi(n)?tt:sb;return i(n,dv(vt(t,3)))}function pht(n){var t=vi(n)?ub:kut;return t(n)}function wht(t,i,r){i=(r?uf(t,i,r):i===n)?1:yi(i);var u=vi(t)?wrt:dut;return u(t,i)}function bht(n){var t=vi(n)?brt:gut;return t(n)}function kht(n){if(n==null)return 0;if(ef(n))return ty(n)?wt(n):n.length;var t=tf(n);return t==l||t==a?n.size:wy(n).length}function dht(t,i,r){var u=vi(t)?dr:nft;return r&&uf(t,i,r)&&(i=n),u(t,vt(i,3))}function ght(n,t){if(typeof t!="function")throw new lf(o);return n=yi(n),function(){if(--n<1)return t.apply(this,arguments)}}function wg(t,i,r){return i=r?n:i,i=t&&i==null?t.length:i,uh(t,b,n,n,n,n,i)}function bg(t,i){var r;if(typeof i!="function")throw new lf(o);return t=yi(t),function(){return--t>0&&(r=i.apply(this,arguments)),t<=1&&(i=n),r}}function kg(t,i,r){i=r?n:i;var u=uh(t,y,n,n,n,n,n,i);return u.placeholder=kg.placeholder,u}function dg(t,i,r){i=r?n:i;var u=uh(t,ht,n,n,n,n,n,i);return u.placeholder=dg.placeholder,u}function gg(t,i,r){function p(i){var r=e,u=h;return e=h=n,c=i,s=t.apply(u,r)}function g(n){return c=n,u=ia(v,i),b?p(n):s}function nt(n){var r=n-f,u=n-c,t=i-r;return l?nf(t,a-u):t}function k(t){var r=t-f,u=t-c;return f===n||r>=i||r<0||l&&u>=a}function v(){var n=ra();if(k(n))return d(n);u=ia(v,nt(n))}function d(t){return(u=n,y&&e)?p(t):(e=h=n,s)}function tt(){u!==n&&ek(u);c=0;e=f=h=u=n}function it(){return u===n?s:d(ra())}function w(){var t=ra(),r=k(t);if(e=arguments,h=this,f=t,r){if(u===n)return g(f);if(l)return u=ia(v,i),p(f)}return u===n&&(u=ia(v,i)),s}var e,h,a,s,u,f,c=0,b=!1,l=!1,y=!0;if(typeof t!="function")throw new lf(o);return i=re(i)||0,pr(r)&&(b=!!r.leading,l="maxWait"in r,a=l?ku(re(r.maxWait)||0,i):a,y="trailing"in r?!!r.trailing:y),w.cancel=tt,w.flush=it,w}function nct(n){return uh(n,gi)}function kv(n,t){if(typeof n!="function"||t!=null&&typeof t!="function")throw new lf(o);var i=function(){var u=arguments,f=t?t.apply(this,u):u[0],r=i.cache,e;return r.has(f)?r.get(f):(e=n.apply(this,u),i.cache=r.set(f,e)||r,e)};return i.cache=new(kv.Cache||th),i}function dv(n){if(typeof n!="function")throw new lf(o);return function(){var t=arguments;switch(t.length){case 0:return!n.call(this);case 1:return!n.call(this,t[0]);case 2:return!n.call(this,t[0],t[1]);case 3:return!n.call(this,t[0],t[1],t[2])}return!n.apply(this,t)}}function tct(n){return bg(2,n)}function uct(t,i){if(typeof t!="function")throw new lf(o);return i=i===n?i:yi(i),cr(t,i)}function fct(n,t){if(typeof n!="function")throw new lf(o);return t=t==null?0:ku(yi(t),0),cr(function(i){var r=i[t],u=ph(i,0,t);return r&&it(u,r),f(n,this,u)})}function ect(n,t,i){var r=!0,u=!0;if(typeof n!="function")throw new lf(o);return pr(i)&&(r="leading"in i?!!i.leading:r,u="trailing"in i?!!i.trailing:u),gg(n,t,{leading:r,maxWait:t,trailing:u})}function oct(n){return wg(n,1)}function sct(n,t){return nw(fp(t),n)}function hct(){if(!arguments.length)return[];var n=arguments[0];return vi(n)?n:[n]}function cct(n){return vf(n,ot)}function lct(t,i){return i=typeof i=="function"?i:n,vf(t,ot,i)}function act(n){return vf(n,g|ot)}function vct(t,i){return i=typeof i=="function"?i:n,vf(t,g|ot,i)}function yct(n,t){return t==null||eb(n,t,du(t))}function bs(n,t){return n===t||n!==n&&t!==t}function ef(n){return n!=null&&gv(n.length)&&!sh(n)}function nu(n){return wr(n)&&ef(n)}function kct(n){return n===!0||n===!1||wr(n)&&rf(n)==kt}function dct(n){return wr(n)&&n.nodeType===1&&!ua(n)}function gct(n){var t,i;if(n==null)return!0;if(ef(n)&&(vi(n)||typeof n=="string"||typeof n.splice=="function"||oh(n)||nl(n)||dc(n)))return!n.length;if(t=tf(n),t==l||t==a)return!n.size;if(ta(n))return!wy(n).length;for(i in n)if(vr.call(n,i))return!1;return!0}function nlt(n,t){return dl(n,t)}function tlt(t,i,r){r=typeof r=="function"?r:n;var u=r?r(t,i):n;return u===n?dl(t,i,n,r):!!u}function tw(n){if(!wr(n))return!1;var t=rf(n);return t==hi||t==oo||typeof n.message=="string"&&typeof n.name=="string"&&!ua(n)}function ilt(n){return typeof n=="number"&&tit(n)}function sh(n){if(!pr(n))return!1;var t=rf(n);return t==ci||t==hu||t==eo||t==ho}function fn(n){return typeof n=="number"&&n==yi(n)}function gv(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=nt}function pr(n){var t=typeof n;return n!=null&&(t=="object"||t=="function")}function wr(n){return n!=null&&typeof n=="object"}function rlt(n,t){return n===t||py(n,t,lp(t))}function ult(t,i,r){return r=typeof r=="function"?r:n,py(t,i,lp(i),r)}function flt(n){return en(n)&&n!=+n}function elt(n){if(od(n))throw new pw(pe);return lb(n)}function olt(n){return n===null}function slt(n){return n==null}function en(n){return typeof n=="number"||wr(n)&&rf(n)==gt}function ua(n){var i,t;return!wr(n)||rf(n)!=k?!1:(i=aa(n),i===null)?!0:(t=vr.call(i,"constructor")&&i.constructor,typeof t=="function"&&t instanceof t&&sa.call(t)==ptt)}function hlt(n){return fn(n)&&n>=-nt&&n<=nt}function ty(n){return typeof n=="string"||!vi(n)&&wr(n)&&rf(n)==ti}function cf(n){return typeof n=="symbol"||wr(n)&&rf(n)==li}function clt(t){return t===n}function llt(n){return wr(n)&&tf(n)==ii}function alt(n){return wr(n)&&rf(n)==lo}function hn(n){if(!n)return[];if(ef(n))return ty(n)?v(n):ff(n);if(cl&&n[cl])return bc(n[cl]());var t=tf(n),i=t==l?uu:t==a?bi:hl;return i(n)}function hh(n){if(!n)return n===0?n:0;if(n=re(n),n===ft||n===-ft){var t=n<0?-1:1;return t*io}return n===n?n:0}function yi(n){var t=hh(n),i=t%1;return t===t?i?t-i:t:0}function cn(n){return n?tc(yi(n),0,w):0}function re(n){var t,i;return typeof n=="number"?n:cf(n)?oi:(pr(n)&&(t=typeof n.valueOf=="function"?n.valueOf():n,n=pr(t)?t+"":t),typeof n!="string")?n===0?n:+n:(n=n.replace(yu,""),i=ls.test(n),i||vs.test(n)?rc(n.slice(2),i?2:8):cs.test(n)?oi:+n)}function ln(n){return ds(n,of(n))}function vlt(n){return n?tc(yi(n),-nt,nt):n===0?n:0}function ar(n){return n==null?"":hf(n)}function blt(n,t){var i=dh(n);return t==null?i:fb(i,t)}function klt(n,t){return ue(n,vt(t,3),ks)}function dlt(n,t){return ue(n,vt(t,3),ay)}function glt(n,t){return n==null?n:tv(n,vt(t,3),of)}function nat(n,t){return n==null?n:ly(n,vt(t,3),of)}function tat(n,t){return n&&ks(n,vt(t,3))}function iat(n,t){return n&&ay(n,vt(t,3))}function rat(n){return n==null?[]:iv(n,du(n))}function uat(n){return n==null?[]:iv(n,of(n))}function uw(t,i,r){var u=t==null?n:fl(t,i);return u===n?r:u}function fat(n,t){return n!=null&&fd(n,t,iut)}function fw(n,t){return n!=null&&fd(n,t,rut)}function du(n){return ef(n)?rb(n):wy(n)}function of(n){return ef(n)?rb(n,!0):vut(n)}function hat(n,t){var i={};return t=vt(t,3),ks(n,function(n,r,u){ih(i,t(n,r,u),n)}),i}function cat(n,t){var i={};return t=vt(t,3),ks(n,function(n,r,u){ih(i,r,t(n,r,u))}),i}function vat(n,t){return bn(n,dv(vt(t)))}function bn(n,t){if(n==null)return{};var i=r(cp(n),function(n){return[n]});return t=vt(t),kb(n,i,function(n,i){return t(n,i[0])})}function yat(t,i,r){var e,f,u;for(i=yh(i,t),e=-1,f=i.length,f||(f=1,t=n);++e<f;)u=t==null?n:t[gs(i[e])],u===n&&(e=f,u=r),t=sh(u)?u.call(t):u;return t}function pat(n,t,i){return n==null?n:gl(n,t,i)}function wat(t,i,r,u){return u=typeof u=="function"?u:n,t==null?t:gl(t,i,r,u)}function bat(n,t,i){var u=vi(n),f=u||oh(n)||nl(n),r;return t=vt(t,4),i==null&&(r=n&&n.constructor,i=f?u?new r:[]:pr(n)?sh(r)?dh(aa(n)):{}:{}),(f?c:ks)(n,function(n,r,u){return t(i,n,r,u)}),i}function kat(n,t){return n==null?!0:ip(n,t)}function dat(n,t,i){return n==null?n:ik(n,t,fp(i))}function gat(t,i,r,u){return u=typeof u=="function"?u:n,t==null?t:ik(t,i,fp(r),u)}function hl(n){return n==null?[]:ru(n,du(n))}function nvt(n){return n==null?[]:ru(n,of(n))}function tvt(t,i,r){return r===n&&(r=i,i=n),r!==n&&(r=re(r),r=r===r?r:0),i!==n&&(i=re(i),i=i===i?i:0),tc(re(t),i,r)}function ivt(t,i,r){return i=hh(i),r===n?(r=i,i=0):r=hh(r),t=re(t),uut(t,i,r)}function rvt(t,i,r){var f,u;return(r&&typeof r!="boolean"&&uf(t,i,r)&&(i=r=n),r===n&&(typeof i=="boolean"?(r=i,i=n):typeof t=="boolean"&&(r=t,t=n)),t===n&&i===n?(t=0,i=1):(t=hh(t),i===n?(i=t,t=0):i=hh(i)),t>i&&(f=t,t=i,i=f),r||t%1||i%1)?(u=tb(),nf(t+u*(i-t+ic("1e-"+((u+"").length-1))),i)):dy(t,i)}function dn(n){return ry(ar(n).toLowerCase())}function gn(n){return n=ar(n),n&&n.replace(ps,ce).replace(vh,"")}function uvt(t,i,r){var u,f;return t=ar(t),i=hf(i),u=t.length,r=r===n?u:tc(yi(r),0,u),f=r,r-=i.length,r>=0&&t.slice(r,f)==i}function fvt(n){return n=ar(n),n&&wo.test(n)?n.replace(au,le):n}function evt(n){return n=ar(n),n&&is.test(n)?n.replace(hr,"\\$&"):n}function cvt(n,t,i){var r,u;return(n=ar(n),t=yi(t),r=t?wt(n):0,!t||r>=t)?n:(u=(t-r)/2,hv(wa(u),i)+n+hv(pa(u),i))}function lvt(n,t,i){n=ar(n);t=yi(t);var r=t?wt(n):0;return t&&r<t?n+hv(t-r,i):n}function avt(n,t,i){n=ar(n);t=yi(t);var r=t?wt(n):0;return t&&r<t?hv(t-r,i)+n:n}function vvt(n,t,i){return i||t==null?t=0:t&&(t=+t),fit(ar(n).replace(pu,""),t||0)}function yvt(t,i,r){return i=(r?uf(t,i,r):i===n)?1:yi(i),gy(ar(t),i)}function pvt(){var n=arguments,t=ar(n[0]);return n.length<3?t:t.replace(n[1],n[2])}function wvt(t,i,r){return(r&&typeof r!="number"&&uf(t,i,r)&&(i=r=n),r=r===n?w:r>>>0,!r)?[]:(t=ar(t),t&&(typeof i=="string"||i!=null&&!ny(i))&&(i=hf(i),!i&&pt(t)))?ph(v(t),0,r):t.split(i,r)}function bvt(n,t,i){return n=ar(n),i=i==null?0:tc(yi(i),0,n.length),t=hf(t),n.slice(i,i+t.length)==t}function kvt(t,i,r){var s=et.templateSettings,e,f;r&&uf(t,i,r)&&(i=n);t=ar(t);i=iy({},i,s,td);var h=iy({},i.imports,s.imports,td),c=du(h),y=ru(h,c),l,o,a=0,v=i.interpolate||ai,u="__p += '",p=uy((i.escape||ai).source+"|"+v.source+"|"+(v===vu?hs:ai).source+"|"+(i.evaluate||ai).source+"|$","g"),w="//# sourceURL="+("sourceURL"in i?i.sourceURL:"lodash.templateSources["+ ++kh+"]")+"\n";if(t.replace(p,function(n,i,r,f,e,s){return r||(r=f),u+=t.slice(a,s).replace(ws,yc),i&&(l=!0,u+="' +\n__e("+i+") +\n'"),e&&(o=!0,u+="';\n"+e+";\n__p += '"),r&&(u+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),a=s+n.length,n}),u+="';\n",e=i.variable,e||(u="with (obj) {\n"+u+"\n}\n"),u=(o?u.replace(ao,""):u).replace(vo,"$1").replace(yo,"$1;"),u="function("+(e||"obj")+") {\n"+(e?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(l?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+u+"return __p\n}",f=sw(function(){return ww(c,w+"return "+u).apply(n,y)}),f.source=u,tw(f))throw f;return f}function dvt(n){return ar(n).toLowerCase()}function gvt(n){return ar(n).toUpperCase()}function nyt(t,i,r){if(t=ar(t),t&&(r||i===n))return t.replace(yu,"");if(!t||!(i=hf(i)))return t;var u=v(t),f=v(i),e=se(u,f),o=he(u,f)+1;return ph(u,e,o).join("")}function tyt(t,i,r){if(t=ar(t),t&&(r||i===n))return t.replace(rs,"");if(!t||!(i=hf(i)))return t;var u=v(t),f=he(u,v(i))+1;return ph(u,0,f).join("")}function iyt(t,i,r){if(t=ar(t),t&&(r||i===n))return t.replace(pu,"");if(!t||!(i=hf(i)))return t;var u=v(t),f=se(u,v(i));return ph(u,f).join("")}function ryt(t,i){var s=be,e=ke,r,h,o,u,f,a,y,c,l;if(pr(i)&&(r="separator"in i?i.separator:r,s="length"in i?yi(i.length):s,e="omission"in i?hf(i.omission):e),t=ar(t),h=t.length,pt(t)&&(o=v(t),h=o.length),s>=h)return t;if(u=s-wt(e),u<1)return e;if(f=o?ph(o,0,u).join(""):t.slice(0,u),r===n)return f+e;if(o&&(u+=f.length-u),ny(r)){if(t.slice(u).search(r)){for(y=f,r.global||(r=uy(r.source,ar(wu.exec(r))+"g")),r.lastIndex=0;a=r.exec(y);)c=a.index;f=f.slice(0,c===n?u:c)}}else t.indexOf(hf(r),u)!=u&&(l=f.lastIndexOf(r),l>-1&&(f=f.slice(0,l)));return f+e}function uyt(n){return n=ar(n),n&&po.test(n)?n.replace(lu,ve):n}function rtt(t,i,r){return(t=ar(t),i=r?n:i,i===n)?wc(t)?il(t):hc(t):t.match(i)||[]}function fyt(n){var t=n==null?0:n.length,i=vt();return n=t?r(n,function(n){if(typeof n[1]!="function")throw new lf(o);return[i(n[0]),n[1]]}):[],cr(function(i){for(var u=-1,r;++u<t;)if(r=n[u],f(r[0],this,i))return f(r[1],this,i)})}function eyt(n){return grt(vf(n,g))}function hw(n){return function(){return n}}function oyt(n,t){return n==null||n!==n?t:n}function sf(n){return n}function cw(n){return ab(typeof n=="function"?n:vf(n,g))}function syt(n){return yb(vf(n,g))}function hyt(n,t){return pb(n,vf(t,g))}function lw(n,t,i){var u=du(t),r=iv(t,u),f,e;return i!=null||pr(t)&&(r.length||!u.length)||(i=t,t=n,n=this,r=iv(t,du(t))),f=!(pr(i)&&"chain"in i)||!!i.chain,e=sh(n),c(r,function(i){var r=t[i];n[i]=r;e&&(n.prototype[i]=function(){var i=this.__chain__,t,u;return f||i?(t=n(this.__wrapped__),u=t.__actions__=ff(this.__actions__),u.push({func:r,args:arguments,thisArg:n}),t.__chain__=i,t):r.apply(n,it([this.value()],arguments))})}),n}function cyt(){return u._===this&&(u._=wtt),this}function aw(){}function lyt(n){return n=yi(n),cr(function(t){return wb(t,n)})}function htt(n){return vp(n)?gr(gs(n)):wut(n)}function pyt(t){return function(i){return t==null?n:fl(t,i)}}function vw(){return[]}function yw(){return!1}function wyt(){return{}}function byt(){return""}function kyt(){return!0}function dyt(n,t){var i,r,u;if(n=yi(n),n<1||n>nt)return[];for(i=w,r=nf(n,w),t=vt(t),n-=w,u=iu(r,t);++i<n;)t(i);return u}function gyt(n){return vi(n)?r(n,gs):cf(n)?[n]:ff(bp(ar(n)))}function npt(n){var t=++ytt;return ar(n)+t}function fpt(t){return t&&t.length?nv(t,sf,vy):n}function ept(t,i){return t&&t.length?nv(t,vt(i,2),vy):n}function opt(n){return ee(n,sf)}function spt(n,t){return ee(n,vt(t,2))}function hpt(t){return t&&t.length?nv(t,sf,by):n}function cpt(t,i){return t&&t.length?nv(t,vt(i,2),by):n}function ypt(n){return n&&n.length?tu(n,sf):0}function ppt(n,t){return n&&n.length?tu(n,vt(t,2)):0}var dh,rh,cy,tv,ly,np,gb,fk,ek,gk,lv,od,bp,gd,tg,rg,fg,eg,og,sg,lg,ag,vg,yg,pg,ra,bv,gp,nn,tn,oh,un,iw,ny,rw,nl,on,sn,vn,yn,wn,ew,ow,kn,ntt,ttt,itt,ry,sw,utt,ftt,ett,ott,stt,ctt,ltt;h=h==null?u:d.defaults(u.Object(),h,d.pick(u,bh));var bu=h.Array,fa=h.Date,pw=h.Error,ww=h.Function,tl=h.Math,yr=h.Object,uy=h.RegExp,att=h.String,lf=h.TypeError,ea=bu.prototype,vtt=ww.prototype,rl=yr.prototype,oa=h["__core-js_shared__"],sa=vtt.toString,vr=rl.hasOwnProperty,ytt=0,bw=function(){var n=/[^.]+$/.exec(oa&&oa.keys&&oa.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),ha=rl.toString,ptt=sa.call(yr),wtt=u._,btt=uy("^"+sa.call(vr).replace(hr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ca=wf?h.Buffer:n,ch=h.Symbol,la=h.Uint8Array,kw=ca?ca.allocUnsafe:n,aa=ae(yr.getPrototypeOf,yr),dw=yr.create,gw=rl.propertyIsEnumerable,va=ea.splice,nb=ch?ch.isConcatSpreadable:n,cl=ch?ch.iterator:n,wh=ch?ch.toStringTag:n,ya=function(){try{var n=uc(yr,"defineProperty");return n({},"",{}),n}catch(t){}}(),ktt=h.clearTimeout!==u.clearTimeout&&h.clearTimeout,dtt=fa&&fa.now!==u.Date.now&&fa.now,gtt=h.setTimeout!==u.setTimeout&&h.setTimeout,pa=tl.ceil,wa=tl.floor,fy=yr.getOwnPropertySymbols,nit=ca?ca.isBuffer:n,tit=h.isFinite,iit=ea.join,rit=ae(yr.keys,yr),ku=tl.max,nf=tl.min,uit=fa.now,fit=h.parseInt,tb=tl.random,eit=ea.reverse,ey=uc(h,"DataView"),ll=uc(h,"Map"),oy=uc(h,"Promise"),ul=uc(h,"Set"),al=uc(h,"WeakMap"),vl=uc(yr,"create"),ba=al&&new al,yl={},oit=sc(ey),sit=sc(ll),hit=sc(oy),cit=sc(ul),lit=sc(al),ka=ch?ch.prototype:n,pl=ka?ka.valueOf:n,ib=ka?ka.toString:n;dh=function(){function t(){}return function(i){if(!pr(i))return{};if(dw)return dw(i);t.prototype=i;var r=new t;return t.prototype=n,r}}();et.templateSettings={escape:bo,evaluate:ko,interpolate:vu,variable:"",imports:{_:et}};et.prototype=da.prototype;et.prototype.constructor=et;af.prototype=dh(da.prototype);af.prototype.constructor=af;lr.prototype=dh(da.prototype);lr.prototype.constructor=lr;gh.prototype.clear=pit;gh.prototype["delete"]=wit;gh.prototype.get=bit;gh.prototype.has=kit;gh.prototype.set=dit;nh.prototype.clear=git;nh.prototype["delete"]=nrt;nh.prototype.get=trt;nh.prototype.has=irt;nh.prototype.set=rrt;th.prototype.clear=urt;th.prototype["delete"]=frt;th.prototype.get=ert;th.prototype.has=ort;th.prototype.set=srt;nc.prototype.add=nc.prototype.push=hrt;nc.prototype.has=crt;os.prototype.clear=lrt;os.prototype["delete"]=art;os.prototype.get=vrt;os.prototype.has=yrt;os.prototype.set=prt;rh=ak(ks);cy=ak(ay,!0);tv=vk();ly=vk(!0);np=ba?function(n,t){return ba.set(n,t),n}:sf;gb=ya?function(n,t){return ya(n,"toString",{configurable:!0,enumerable:!1,value:hw(t),writable:!0})}:sf;fk=cr;ek=ktt||function(n){return u.clearTimeout(n)};gk=(ul&&1/bi(new ul([,-0]))[1]==ft)?function(n){return new ul(n)}:aw;lv=ba?function(n){return ba.get(n)}:aw;var ap=fy?function(n){return n==null?[]:(n=yr(n),tt(fy(n),function(t){return gw.call(n,t)}))}:vw,ud=fy?function(n){for(var t=[];n;)it(t,ap(n)),n=aa(n);return t}:vw,tf=rf;(ey&&tf(new ey(new ArrayBuffer(1)))!=at||ll&&tf(new ll)!=l||oy&&tf(oy.resolve())!=cu||ul&&tf(new ul)!=a||al&&tf(new al)!=ii)&&(tf=function(t){var i=rf(t),r=i==k?t.constructor:n,u=r?sc(r):"";if(u)switch(u){case oit:return at;case sit:return l;case hit:return cu;case cit:return a;case lit:return ii}return i});od=oa?sh:yw;var ad=yd(np),ia=gtt||function(n,t){return u.setTimeout(n,t)},wp=yd(gb);bp=tet(function(n){var t=[];return n.charCodeAt(0)===46&&t.push(""),n.replace(ts,function(n,i,r,u){t.push(r?u.replace(ss,"$1"):i||n)}),t});var cet=cr(function(n,t){return nu(n)?bl(n,gu(t,1,nu,!0)):[]}),aet=cr(function(t,i){var r=pf(i);return nu(r)&&(r=n),nu(t)?bl(t,gu(i,1,nu,!0),vt(r,2)):[]}),vet=cr(function(t,i){var r=pf(i);return nu(r)&&(r=n),nu(t)?bl(t,gu(i,1,nu,!0),n,r):[]});var rot=cr(function(n){var t=r(n,up);return t.length&&t[0]===n[0]?yy(t):[]}),uot=cr(function(t){var u=pf(t),i=r(t,up);return u===pf(i)?u=n:i.pop(),i.length&&i[0]===t[0]?yy(i,vt(u,2)):[]}),fot=cr(function(t){var i=pf(t),u=r(t,up);return i=typeof i=="function"?i:n,i&&u.pop(),u.length&&u[0]===t[0]?yy(u,n,i):[]});gd=cr(ng);tg=fh(function(n,t){var i=n==null?0:n.length,u=hy(n,t);return db(n,r(t,function(n){return eh(n,i)?+n:n}).sort(hk)),u});var fst=cr(function(n){return lh(gu(n,1,nu,!0))}),est=cr(function(t){var i=pf(t);return nu(i)&&(i=n),lh(gu(t,1,nu,!0),vt(i,2))}),ost=cr(function(t){var i=pf(t);return i=typeof i=="function"?i:n,lh(gu(t,1,nu,!0),n,i)});var lst=cr(function(n,t){return nu(n)?bl(n,t):[]}),ast=cr(function(n){return rp(tt(n,nu))}),vst=cr(function(t){var i=pf(t);return nu(i)&&(i=n),rp(tt(t,nu),vt(i,2))}),yst=cr(function(t){var i=pf(t);return i=typeof i=="function"?i:n,rp(tt(t,nu),n,i)}),pst=cr(dp);rg=cr(function(t){var r=t.length,i=r>1?t[r-1]:n;return i=typeof i=="function"?(t.pop(),i):n,ig(t,i)});fg=fh(function(t){var r=t.length,u=r?t[0]:0,i=this.__wrapped__,f=function(n){return hy(n,t)};return r>1||this.__actions__.length||!(i instanceof lr)||!eh(u)?this.thru(f):(i=i.slice(u,+u+(r?1:0)),i.__actions__.push({func:pv,args:[f],thisArg:n}),new af(i,this.__chain__).thru(function(t){return r&&!t.length&&t.push(n),t}))});eg=ev(function(n,t,i){vr.call(n,i)?++n[i]:ih(n,i,1)});og=pk(wd);sg=pk(bd);lg=ev(function(n,t,i){vr.call(n,i)?n[i].push(t):ih(n,i,[t])});ag=cr(function(n,t,i){var u=-1,e=typeof t=="function",r=ef(n)?bu(n.length):[];return rh(n,function(n){r[++u]=e?f(t,n,i):kl(n,t,i)}),r});vg=ev(function(n,t,i){ih(n,i,t)});yg=ev(function(n,t,i){n[i?0:1].push(t)},function(){return[[],[]]});pg=cr(function(n,t){if(n==null)return[];var i=t.length;return i>1&&uf(n,t[0],t[1])?t=[]:i>2&&uf(t[0],t[1],t[2])&&(t=[t[0]]),bb(n,gu(t,1),[])});ra=dtt||function(){return u.Date.now()};bv=cr(function(n,t,i){var r=s,u;return i.length&&(u=rt(i,sl(bv)),r|=p),uh(n,r,t,i,u)});gp=cr(function(n,t,i){var r=s|ut,u;return i.length&&(u=rt(i,sl(gp)),r|=p),uh(t,r,n,i,u)});nn=cr(function(n,t){return ob(n,1,t)});tn=cr(function(n,t,i){return ob(n,re(t)||0,i)});kv.Cache=th;var ict=fk(function(n,t){t=t.length==1&&vi(t[0])?r(t[0],e(vt())):r(gu(t,1),e(vt()));var i=t.length;return cr(function(r){for(var u=-1,e=nf(r.length,i);++u<e;)r[u]=t[u].call(this,r[u]);return f(n,this,r)})}),nw=cr(function(t,i){var r=rt(i,sl(nw));return uh(t,p,n,i,r)}),rn=cr(function(t,i){var r=rt(i,sl(rn));return uh(t,ct,n,i,r)}),rct=fh(function(t,i){return uh(t,bt,n,n,n,i)});var pct=cv(vy),wct=cv(function(n,t){return n>=t}),dc=cb(function(){return arguments}())?cb:function(n){return wr(n)&&vr.call(n,"callee")&&!gw.call(n,"callee")},vi=bu.isArray,bct=bf?e(bf):eut;oh=nit||yw;un=kf?e(kf):out;iw=df?e(df):hut;ny=gf?e(gf):cut;rw=ne?e(ne):lut;nl=te?e(te):aut;on=cv(by);sn=cv(function(n,t){return n<=t});var ylt=el(function(n,t){if(ta(t)||ef(t)){ds(t,du(t),n);return}for(var i in t)vr.call(t,i)&&wl(n,i,t[i])}),an=el(function(n,t){ds(t,of(t),n)}),iy=el(function(n,t,i,r){ds(t,of(t),n,r)}),plt=el(function(n,t,i,r){ds(t,du(t),n,r)}),wlt=fh(hy);vn=cr(function(t,i){var r,f;t=yr(t);var e=-1,u=i.length,o=u>2?i[2]:n;for(o&&uf(i[0],i[1],o)&&(u=1);++e<u;)for(var s=i[e],h=of(s),c=-1,l=h.length;++c<l;)r=h[c],f=t[r],(f===n||bs(f,rl[r])&&!vr.call(t,r))&&(t[r]=s[r]);return t});yn=cr(function(t){return t.push(n,id),f(pn,n,t)});var eat=bk(function(n,t,i){t!=null&&typeof t.toString!="function"&&(t=ha.call(t));n[t]=i},hw(sf)),oat=bk(function(n,t,i){t!=null&&typeof t.toString!="function"&&(t=ha.call(t));vr.call(n,t)?n[t].push(i):n[t]=[i]},vt),sat=cr(kl);var lat=el(function(n,t,i){rv(n,t,i)}),pn=el(function(n,t,i,r){rv(n,t,i,r)}),aat=fh(function(n,t){var i={},u,f;if(n==null)return i;for(u=!1,t=r(t,function(t){return t=yh(t,n),u||(u=t.length>1),t}),ds(n,cp(n),i),u&&(i=vf(i,g|eu|ot,cft)),f=t.length;f--;)ip(i,t[f]);return i});wn=fh(function(n,t){return n==null?{}:put(n,t)});ew=nd(du);ow=nd(of);kn=ol(function(n,t,i){return t=t.toLowerCase(),n+(i?dn(t):t)});var ovt=ol(function(n,t,i){return n+(i?"-":"")+t.toLowerCase()}),svt=ol(function(n,t,i){return n+(i?" ":"")+t.toLowerCase()}),hvt=yk("toLowerCase");ntt=ol(function(n,t,i){return n+(i?"_":"")+t.toLowerCase()});ttt=ol(function(n,t,i){return n+(i?" ":"")+ry(t)});itt=ol(function(n,t,i){return n+(i?" ":"")+t.toUpperCase()});ry=yk("toUpperCase");sw=cr(function(t,i){try{return f(t,n,i)}catch(r){return tw(r)?r:new pw(r)}});utt=fh(function(n,t){return c(t,function(t){t=gs(t);ih(n,t,bv(n[t],n))}),n});ftt=wk();ett=wk(!0);ott=cr(function(n,t){return function(i){return kl(i,n,t)}});stt=cr(function(n,t){return function(i){return kl(n,i,t)}});var ayt=op(r),vyt=op(ie),yyt=op(dr);ctt=kk();ltt=kk(!0);var tpt=sv(function(n,t){return n+t},0),ipt=sp("ceil"),rpt=sv(function(n,t){return n/t},1),upt=sp("floor");var lpt=sv(function(n,t){return n*t},1),apt=sp("round"),vpt=sv(function(n,t){return n-t},0);return et.after=ght,et.ary=wg,et.assign=ylt,et.assignIn=an,et.assignInWith=iy,et.assignWith=plt,et.at=wlt,et.before=bg,et.bind=bv,et.bindAll=utt,et.bindKey=gp,et.castArray=hct,et.chain=ug,et.chunk=oet,et.compact=set,et.concat=het,et.cond=fyt,et.conforms=eyt,et.constant=hw,et.countBy=eg,et.create=blt,et.curry=kg,et.curryRight=dg,et.debounce=gg,et.defaults=vn,et.defaultsDeep=yn,et.defer=nn,et.delay=tn,et.difference=cet,et.differenceBy=aet,et.differenceWith=vet,et.drop=yet,et.dropRight=pet,et.dropRightWhile=wet,et.dropWhile=bet,et.fill=ket,et.filter=eht,et.flatMap=oht,et.flatMapDeep=sht,et.flatMapDepth=hht,et.flatten=kd,et.flattenDeep=det,et.flattenDepth=get,et.flip=nct,et.flow=ftt,et.flowRight=ett,et.fromPairs=not,et.functions=rat,et.functionsIn=uat,et.groupBy=lg,et.initial=iot,et.intersection=rot,et.intersectionBy=uot,et.intersectionWith=fot,et.invert=eat,et.invertBy=oat,et.invokeMap=ag,et.iteratee=cw,et.keyBy=vg,et.keys=du,et.keysIn=of,et.map=wv,et.mapKeys=hat,et.mapValues=cat,et.matches=syt,et.matchesProperty=hyt,et.memoize=kv,et.merge=lat,et.mergeWith=pn,et.method=ott,et.methodOf=stt,et.mixin=lw,et.negate=dv,et.nthArg=lyt,et.omit=aat,et.omitBy=vat,et.once=tct,et.orderBy=lht,et.over=ayt,et.overArgs=ict,et.overEvery=vyt,et.overSome=yyt,et.partial=nw,et.partialRight=rn,et.partition=yg,et.pick=wn,et.pickBy=bn,et.property=htt,et.propertyOf=pyt,et.pull=gd,et.pullAll=ng,et.pullAllBy=hot,et.pullAllWith=cot,et.pullAt=tg,et.range=ctt,et.rangeRight=ltt,et.rearg=rct,et.reject=yht,et.remove=lot,et.rest=uct,et.reverse=kp,et.sampleSize=wht,et.set=pat,et.setWith=wat,et.shuffle=bht,et.slice=aot,et.sortBy=pg,et.sortedUniq=dot,et.sortedUniqBy=got,et.split=wvt,et.spread=fct,et.tail=nst,et.take=tst,et.takeRight=ist,et.takeRightWhile=rst,et.takeWhile=ust,et.tap=kst,et.throttle=ect,et.thru=pv,et.toArray=hn,et.toPairs=ew,et.toPairsIn=ow,et.toPath=gyt,et.toPlainObject=ln,et.transform=bat,et.unary=oct,et.union=fst,et.unionBy=est,et.unionWith=ost,et.uniq=sst,et.uniqBy=hst,et.uniqWith=cst,et.unset=kat,et.unzip=dp,et.unzipWith=ig,et.update=dat,et.updateWith=gat,et.values=hl,et.valuesIn=nvt,et.without=lst,et.words=rtt,et.wrap=sct,et.xor=ast,et.xorBy=vst,et.xorWith=yst,et.zip=pst,et.zipObject=wst,et.zipObjectDeep=bst,et.zipWith=rg,et.entries=ew,et.entriesIn=ow,et.extend=an,et.extendWith=iy,lw(et,et),et.add=tpt,et.attempt=sw,et.camelCase=kn,et.capitalize=dn,et.ceil=ipt,et.clamp=tvt,et.clone=cct,et.cloneDeep=act,et.cloneDeepWith=vct,et.cloneWith=lct,et.conformsTo=yct,et.deburr=gn,et.defaultTo=oyt,et.divide=rpt,et.endsWith=uvt,et.eq=bs,et.escape=fvt,et.escapeRegExp=evt,et.every=fht,et.find=og,et.findIndex=wd,et.findKey=klt,et.findLast=sg,et.findLastIndex=bd,et.findLastKey=dlt,et.floor=upt,et.forEach=hg,et.forEachRight=cg,et.forIn=glt,et.forInRight=nat,et.forOwn=tat,et.forOwnRight=iat,et.get=uw,et.gt=pct,et.gte=wct,et.has=fat,et.hasIn=fw,et.head=dd,et.identity=sf,et.includes=cht,et.indexOf=tot,et.inRange=ivt,et.invoke=sat,et.isArguments=dc,et.isArray=vi,et.isArrayBuffer=bct,et.isArrayLike=ef,et.isArrayLikeObject=nu,et.isBoolean=kct,et.isBuffer=oh,et.isDate=un,et.isElement=dct,et.isEmpty=gct,et.isEqual=nlt,et.isEqualWith=tlt,et.isError=tw,et.isFinite=ilt,et.isFunction=sh,et.isInteger=fn,et.isLength=gv,et.isMap=iw,et.isMatch=rlt,et.isMatchWith=ult,et.isNaN=flt,et.isNative=elt,et.isNil=slt,et.isNull=olt,et.isNumber=en,et.isObject=pr,et.isObjectLike=wr,et.isPlainObject=ua,et.isRegExp=ny,et.isSafeInteger=hlt,et.isSet=rw,et.isString=ty,et.isSymbol=cf,et.isTypedArray=nl,et.isUndefined=clt,et.isWeakMap=llt,et.isWeakSet=alt,et.join=eot,et.kebabCase=ovt,et.last=pf,et.lastIndexOf=oot,et.lowerCase=svt,et.lowerFirst=hvt,et.lt=on,et.lte=sn,et.max=fpt,et.maxBy=ept,et.mean=opt,et.meanBy=spt,et.min=hpt,et.minBy=cpt,et.stubArray=vw,et.stubFalse=yw,et.stubObject=wyt,et.stubString=byt,et.stubTrue=kyt,et.multiply=lpt,et.nth=sot,et.noConflict=cyt,et.noop=aw,et.now=ra,et.pad=cvt,et.padEnd=lvt,et.padStart=avt,et.parseInt=vvt,et.random=rvt,et.reduce=aht,et.reduceRight=vht,et.repeat=yvt,et.replace=pvt,et.result=yat,et.round=apt,et.runInContext=fu,et.sample=pht,et.size=kht,et.snakeCase=ntt,et.some=dht,et.sortedIndex=vot,et.sortedIndexBy=yot,et.sortedIndexOf=pot,et.sortedLastIndex=wot,et.sortedLastIndexBy=bot,et.sortedLastIndexOf=kot,et.startCase=ttt,et.startsWith=bvt,et.subtract=vpt,et.sum=ypt,et.sumBy=ppt,et.template=kvt,et.times=dyt,et.toFinite=hh,et.toInteger=yi,et.toLength=cn,et.toLower=dvt,et.toNumber=re,et.toSafeInteger=vlt,et.toString=ar,et.toUpper=gvt,et.trim=nyt,et.trimEnd=tyt,et.trimStart=iyt,et.truncate=ryt,et.unescape=uyt,et.uniqueId=npt,et.upperCase=itt,et.upperFirst=ry,et.each=hg,et.eachRight=cg,et.first=dd,lw(et,function(){var n={};return ks(et,function(t,i){vr.call(et.prototype,i)||(n[i]=t)}),n}(),{chain:!1}),et.VERSION=ye,c(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){et[n].placeholder=et}),c(["drop","take"],function(t,i){lr.prototype[t]=function(r){r=r===n?1:ku(yi(r),0);var u=this.__filtered__&&!i?new lr(this):this.clone();return u.__filtered__?u.__takeCount__=nf(r,u.__takeCount__):u.__views__.push({size:nf(r,w),type:t+(u.__dir__<0?"Right":"")}),u};lr.prototype[t+"Right"]=function(n){return this.reverse()[t](n).reverse()}}),c(["filter","map","takeWhile"],function(n,t){var i=t+1,r=i==su||i==to;lr.prototype[n]=function(n){var t=this.clone();return t.__iteratees__.push({iteratee:vt(n,3),type:i}),t.__filtered__=t.__filtered__||r,t}}),c(["head","last"],function(n,t){var i="take"+(t?"Right":"");lr.prototype[n]=function(){return this[i](1).value()[0]}}),c(["initial","tail"],function(n,t){var i="drop"+(t?"":"Right");lr.prototype[n]=function(){return this.__filtered__?new lr(this):this[i](1)}}),lr.prototype.compact=function(){return this.filter(sf)},lr.prototype.find=function(n){return this.filter(n).head()},lr.prototype.findLast=function(n){return this.reverse().find(n)},lr.prototype.invokeMap=cr(function(n,t){return typeof n=="function"?new lr(this):this.map(function(i){return kl(i,n,t)})}),lr.prototype.reject=function(n){return this.filter(dv(vt(n)))},lr.prototype.slice=function(t,i){t=yi(t);var r=this;return r.__filtered__&&(t>0||i<0)?new lr(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),i!==n&&(i=yi(i),r=i<0?r.dropRight(-i):r.take(i-t)),r)},lr.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},lr.prototype.toArray=function(){return this.take(w)},ks(lr.prototype,function(t,i){var e=/^(?:filter|find|map|reject)|While$/.test(i),r=/^(?:head|last)$/.test(i),u=et[r?"take"+(i=="last"?"Right":""):i],f=r||/^find/.test(i);u&&(et.prototype[i]=function(){var o=this.__wrapped__,s=r?[1]:arguments,h=o instanceof lr,a=s[0],c=h||vi(o),v=function(n){var t=u.apply(et,it([n],s));return r&&l?t[0]:t},i;c&&e&&typeof a=="function"&&a.length!=1&&(h=c=!1);var l=this.__chain__,w=!!this.__actions__.length,y=f&&!l,p=h&&!w;return!f&&c?(o=p?o:new lr(this),i=t.apply(o,s),i.__actions__.push({func:pv,args:[v],thisArg:n}),new af(i,l)):y&&p?t.apply(this,s):(i=this.thru(v),y?r?i.value()[0]:i.value():i)})}),c(["pop","push","shift","sort","splice","unshift"],function(n){var t=ea[n],i=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",r=/^(?:pop|shift)$/.test(n);et.prototype[n]=function(){var u=arguments,n;return r&&!this.__chain__?(n=this.value(),t.apply(vi(n)?n:[],u)):this[i](function(n){return t.apply(vi(n)?n:[],u)})}}),ks(lr.prototype,function(n,t){var i=et[t],r,u;i&&(r=i.name+"",u=yl[r]||(yl[r]=[]),u.push({name:t,func:i}))}),yl[ov(n,ut).name]=[{name:"wrapper",func:n}],lr.prototype.clone=ait,lr.prototype.reverse=vit,lr.prototype.value=yit,et.prototype.at=fg,et.prototype.chain=dst,et.prototype.commit=gst,et.prototype.next=nht,et.prototype.plant=iht,et.prototype.reverse=rht,et.prototype.toJSON=et.prototype.valueOf=et.prototype.value=uht,et.prototype.first=et.prototype.head,cl&&(et.prototype[cl]=tht),et};d=fu();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(u._=d,define(function(){return d})):et?((et.exports=d)._=d,pr._=d):u._=d}.call(this),function(n){var t=function(){function n(){}return n}();n.enums=t}(PivotData||(PivotData={}));!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.R={})}(this,function(n){"use strict";function f(n){return null!=n&&"object"==typeof n&&!0===n["@@functional/placeholder"]}function i(n){return function t(i){return 0===arguments.length||f(i)?t:n.apply(this,arguments)}}function t(n){return function t(r,u){switch(arguments.length){case 0:return t;case 1:return f(r)?t:i(function(t){return n(r,t)});default:return f(r)&&f(u)?t:f(r)?i(function(t){return n(t,u)}):f(u)?i(function(t){return n(r,t)}):n(r,u)}}}function y(n,t){n=n||[];t=t||[];for(var u=n.length,f=t.length,r=[],i=0;u>i;)r[r.length]=n[i],i+=1;for(i=0;f>i;)r[r.length]=t[i],i+=1;return r}function p(n,t){switch(n){case 0:return function(){return t.apply(this,arguments)};case 1:return function(n){return t.apply(this,arguments)};case 2:return function(n,i){return t.apply(this,arguments)};case 3:return function(n,i,r){return t.apply(this,arguments)};case 4:return function(n,i,r,u){return t.apply(this,arguments)};case 5:return function(n,i,r,u,f){return t.apply(this,arguments)};case 6:return function(n,i,r,u,f,e){return t.apply(this,arguments)};case 7:return function(n,i,r,u,f,e,o){return t.apply(this,arguments)};case 8:return function(n,i,r,u,f,e,o,s){return t.apply(this,arguments)};case 9:return function(n,i,r,u,f,e,o,s,h){return t.apply(this,arguments)};case 10:return function(n,i,r,u,f,e,o,s,h,c){return t.apply(this,arguments)};default:throw Error("First argument to _arity must be a non-negative integer no greater than ten");}}function ht(n,t,i){return function(){for(var e,o=[],u=0,s=n,r=0;t.length>r||arguments.length>u;)r>=t.length||f(t[r])&&arguments.length>u?(e=arguments[u],u+=1):e=t[r],o[r]=e,f(e)||(s-=1),r+=1;return s>0?p(s,ht(n,o,i)):i.apply(this,o)}}function r(n){return function r(u,e,o){switch(arguments.length){case 0:return r;case 1:return f(u)?r:t(function(t,i){return n(u,t,i)});case 2:return f(u)&&f(e)?r:f(u)?t(function(t,i){return n(t,e,i)}):f(e)?t(function(t,i){return n(u,t,i)}):i(function(t){return n(u,e,t)});default:return f(u)&&f(e)&&f(o)?r:f(u)&&f(e)?t(function(t,i){return n(t,i,o)}):f(u)&&f(o)?t(function(t,i){return n(t,e,i)}):f(e)&&f(o)?t(function(t,i){return n(u,t,i)}):f(u)?i(function(t){return n(t,e,o)}):f(e)?i(function(t){return n(u,t,o)}):f(o)?i(function(t){return n(u,e,t)}):n(u,e,o)}}}function hr(n){return"function"==typeof n["@@transducer/step"]}function e(n,t,i){return function(){var f,r,u;if(0===arguments.length)return i();if(f=Array.prototype.slice.call(arguments,0),r=f.pop(),!b(r)){for(u=0;n.length>u;){if("function"==typeof r[n[u]])return r[n[u]].apply(r,f);u+=1}if(hr(r))return t.apply(null,f)(r)}return i.apply(this,arguments)}}function k(n){return n&&n["@@transducer/reduced"]?n:{"@@transducer/value":n,"@@transducer/reduced":!0}}function gt(n,t){this.xf=t;this.f=n;this.all=!0}function nt(n,t){for(var i=0,r=t.length,u=Array(r);r>i;)u[i]=n(t[i]),i+=1;return u}function tt(n){return"[object String]"===Object.prototype.toString.call(n)}function ni(n){this.f=n}function au(n){return new ni(n)}function yo(n,t,i){for(var r=0,u=i.length;u>r;){if((t=n["@@transducer/step"](t,i[r]))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}r+=1}return n["@@transducer/result"](t)}function vu(n,t,i){for(var r=i.next();!r.done;){if((t=n["@@transducer/step"](t,r.value))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}r=i.next()}return n["@@transducer/result"](t)}function yu(n,t,i,r){return n["@@transducer/result"](i[r](wr(n["@@transducer/step"],n),t))}function h(n,t,i){if("function"==typeof n&&(n=au(n)),yt(i))return yo(n,t,i);if("function"==typeof i["fantasy-land/reduce"])return yu(n,t,i,"fantasy-land/reduce");if(null!=i[br])return vu(n,t,i[br]());if("function"==typeof i.next)return vu(n,t,i);if("function"==typeof i.reduce)return yu(n,t,i,"reduce");throw new TypeError("reduce: list must be array or iterable");}function ti(n,t){this.xf=t;this.f=n}function o(n,t){return Object.prototype.hasOwnProperty.call(t,n)}function ii(n,t){this.xf=t;this.f=n;this.any=!1}function it(n,t){this.xf=t;this.pos=0;this.full=!1;this.acc=Array(n)}function ct(n){return"[object Function]"===Object.prototype.toString.call(n)}function pu(n){return function t(i){for(var e,o,f,u=[],r=0,s=i.length;s>r;){if(yt(i[r]))for(f=0,o=(e=n?t(i[r]):i[r]).length;o>f;)u[u.length]=e[f],f+=1;else u[u.length]=i[r];r+=1}return u}}function po(n){return{"@@transducer/value":n,"@@transducer/reduced":!0}}function wu(n){return RegExp(n.source,(n.global?"g":"")+(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.sticky?"y":"")+(n.unicode?"u":""))}function cr(n,t,i,r){var u=function(u){for(var e,o=t.length,f=0;o>f;){if(n===t[f])return i[f];f+=1}t[f+1]=n;i[f+1]=u;for(e in n)u[e]=r?cr(n[e],t,i,!0):n[e];return u};switch(nr(n)){case"Object":return u({});case"Array":return u([]);case"Date":return new Date(n.valueOf());case"RegExp":return wu(n);default:return n}}function wo(n,t){return function(){return t.call(this,n.apply(this,arguments))}}function lt(n,t){return function(){var r=arguments.length,i;return 0===r?t():(i=arguments[r-1],b(i)||"function"!=typeof i[n]?t.apply(this,arguments):i[n].apply(i,Array.prototype.slice.call(arguments,0,r-1)))}}function bu(){if(0===arguments.length)throw Error("pipe requires at least one argument");return p(arguments[0].length,w(wo,arguments[0],tu(arguments)))}function ri(){if(0===arguments.length)throw Error("compose requires at least one argument");return bu.apply(this,tr(arguments))}function ku(){if(0===arguments.length)throw Error("composeK requires at least one argument");var n=Array.prototype.slice.call(arguments),t=n.pop();return ri(ri.apply(this,c(nu,n)),t)}function bo(n,t){return function(){var i=this;return n.apply(i,arguments).then(function(n){return t.call(i,n)})}}function du(){if(0===arguments.length)throw Error("pipeP requires at least one argument");return p(arguments[0].length,w(bo,arguments[0],tu(arguments)))}function gu(n){for(var t,i=[];!(t=n.next()).done;)i.push(t.value);return i}function rt(n,t,i){for(var r=0,u=i.length;u>r;){if(n(t,i[r]))return!0;r+=1}return!1}function ko(n){var t=(n+"").match(/^function (\w*)/);return null==t?"":t[1]}function nf(n,t,i,r){function u(n,t){return lr(n,t,i.slice(),r.slice())}var f=gu(n);return!rt(function(n,t){return!rt(u,t,n)},gu(t),f)}function lr(n,t,i,r){var f,u,e,h,c,s;if(ir(n,t))return!0;if((f=nr(n),f!==nr(t))||null==n||null==t)return!1;if("function"==typeof n["fantasy-land/equals"]||"function"==typeof t["fantasy-land/equals"])return"function"==typeof n["fantasy-land/equals"]&&n["fantasy-land/equals"](t)&&"function"==typeof t["fantasy-land/equals"]&&t["fantasy-land/equals"](n);if("function"==typeof n.equals||"function"==typeof t.equals)return"function"==typeof n.equals&&n.equals(t)&&"function"==typeof t.equals&&t.equals(n);switch(f){case"Arguments":case"Array":case"Object":if("function"==typeof n.constructor&&"Promise"===ko(n.constructor))return n===t;break;case"Boolean":case"Number":case"String":if(typeof n!=typeof t||!ir(n.valueOf(),t.valueOf()))return!1;break;case"Date":if(!ir(n.valueOf(),t.valueOf()))return!1;break;case"Error":return n.name===t.name&&n.message===t.message;case"RegExp":if(n.source!==t.source||n.global!==t.global||n.ignoreCase!==t.ignoreCase||n.multiline!==t.multiline||n.sticky!==t.sticky||n.unicode!==t.unicode)return!1}for(u=i.length-1;u>=0;){if(i[u]===n)return r[u]===t;u-=1}switch(f){case"Map":return n.size===t.size&&nf(n.entries(),t.entries(),i.concat([n]),r.concat([t]));case"Set":return n.size===t.size&&nf(n.values(),t.values(),i.concat([n]),r.concat([t]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}if(e=a(n),e.length!==a(t).length)return!1;for(h=i.concat([n]),c=r.concat([t]),u=e.length-1;u>=0;){if(s=e[u],!o(s,t)||!lr(t[s],n[s],h,c))return!1;u-=1}return!0}function tf(n,t,i){var u,r;if("function"==typeof n.indexOf)switch(typeof t){case"number":if(0===t){for(u=1/t;n.length>i;){if(0===(r=n[i])&&1/r===u)return i;i+=1}return-1}if(t!==t){for(;n.length>i;){if("number"==typeof(r=n[i])&&r!==r)return i;i+=1}return-1}return n.indexOf(t,i);case"string":case"boolean":case"function":case"undefined":return n.indexOf(t,i);case"object":if(null===t)return n.indexOf(t,i)}for(;n.length>i;){if(l(n[i],t))return i;i+=1}return-1}function d(n,t){return tf(t,n,0)>=0}function ar(n){return'"'+n.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0").replace(/"/g,'\\"')+'"'}function rf(n){return function(){return!n.apply(this,arguments)}}function vr(n,t){for(var i=0,u=t.length,r=[];u>i;)n(t[i])&&(r[r.length]=t[i]),i+=1;return r}function ui(n){return"[object Object]"===Object.prototype.toString.call(n)}function fi(n,t){this.xf=t;this.f=n}function uf(n,t){var i=function(i){var r=t.concat([n]);return d(i,r)?"<Circular>":uf(i,r)},u=function(n,t){return nt(function(t){return ar(t)+": "+i(n[t])},t.slice().sort())},r;switch(Object.prototype.toString.call(n)){case"[object Arguments]":return"(function() { return arguments; }("+nt(i,n).join(", ")+"))";case"[object Array]":return"["+nt(i,n).concat(u(n,rr(function(n){return/^\d+$/.test(n)},a(n)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof n?"new Boolean("+i(n.valueOf())+")":""+n;case"[object Date]":return"new Date("+(isNaN(n.valueOf())?i(NaN):ar(fh(n)))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof n?"new Number("+i(n.valueOf())+")":1/n==-1/0?"-0":n.toString(10);case"[object String]":return"object"==typeof n?"new String("+i(n.valueOf())+")":ar(n);case"[object Undefined]":return"undefined";default:return"function"==typeof n.toString&&(r=""+n,"[object Object]"!==r)?r:"{"+u(n,a(n)).join(", ")+"}"}}function ei(n,t,i,r){this.valueFn=n;this.valueAcc=t;this.keyFn=i;this.xf=r;this.inputs={}}function oi(n,t){this.xf=t;this.n=n}function si(n,t){this.xf=t;this.n=n;this.i=0}function at(n,t){this.xf=t;this.pos=0;this.full=!1;this.acc=Array(n)}function ut(n,t){this.f=n;this.retained=[];this.xf=t}function hi(n,t){this.xf=t;this.pred=n;this.lastValue=void 0;this.seenFirstValue=!1}function ci(n,t){this.xf=t;this.f=n}function li(n,t){this.xf=t;this.f=n;this.found=!1}function ai(n,t){this.xf=t;this.f=n;this.idx=-1;this.found=!1}function vi(n,t){this.xf=t;this.f=n}function yi(n,t){this.xf=t;this.f=n;this.idx=-1;this.lastIdx=-1}function vt(n){return n}function yr(){this._nativeSet="function"==typeof Set?new Set:null;this._items={}}function ff(n,t,i){var u,r=typeof n,f;switch(r){case"string":case"number":return 0===n&&1/n==-1/0?!!i._items["-0"]||(t&&(i._items["-0"]=!0),!1):null!==i._nativeSet?t?(u=i._nativeSet.size,i._nativeSet.add(n),i._nativeSet.size===u):i._nativeSet.has(n):r in i._items?n in i._items[r]||(t&&(i._items[r][n]=!0),!1):(t&&(i._items[r]={},i._items[r][n]=!0),!1);case"boolean":return r in i._items?(f=n?1:0,!!i._items[r][f]||(t&&(i._items[r][f]=!0),!1)):(t&&(i._items[r]=n?[!1,!0]:[!0,!1]),!1);case"function":return null!==i._nativeSet?t?(u=i._nativeSet.size,i._nativeSet.add(n),i._nativeSet.size===u):i._nativeSet.has(n):r in i._items?!!d(n,i._items[r])||(t&&i._items[r].push(n),!1):(t&&(i._items[r]=[n]),!1);case"undefined":return!!i._items[r]||(t&&(i._items[r]=!0),!1);case"object":if(null===n)return!!i._items.null||(t&&(i._items.null=!0),!1);default:return(r=Object.prototype.toString.call(n))in i._items?!!d(n,i._items[r])||(t&&i._items[r].push(n),!1):(t&&(i._items[r]=[n]),!1)}}function go(n){if(hr(n))return n;if(yt(n))return tl;if("string"==typeof n)return il;if("object"==typeof n)return rl;throw Error("Cannot create transformer for "+n);}function pr(n){return"[object Number]"===Object.prototype.toString.call(n)}function ef(n){return t(function(t,i){return p(Math.max(0,t.length-i.length),function(){return t.apply(this,n(i,arguments))})})}function pi(n,t){this.xf=t;this.f=n}function wi(n,t){this.xf=t;this.f=n}function ns(n){return"[object RegExp]"===Object.prototype.toString.call(n)}var ft=i(function(n){return function(){return n}}),ts=ft(!1),is=ft(!0),rs={"@@functional/placeholder":!0},bi=t(function(n,t){return+n+ +t}),s=t(function(n,t){return 1===n?i(t):p(n,ht(n,[],t))}),us=i(function(n){return s(n.length,function(){var t=0,r=arguments[0],u=arguments[arguments.length-1],i=Array.prototype.slice.call(arguments,0);return i[0]=function(){var n=r.apply(this,y(arguments,[t,u]));return t+=1,n},n.apply(this,i)})}),of=r(function(n,t,i){if(t>=i.length||-i.length>t)return i;var r=(0>t?i.length:0)+t,u=y(i);return u[r]=n(i[r]),u}),b=Array.isArray||function(n){return null!=n&&n.length>=0&&"[object Array]"===Object.prototype.toString.call(n)},u={init:function(){return this.xf["@@transducer/init"]()},result:function(n){return this.xf["@@transducer/result"](n)}},wr,br,ou,fr,ue,fe,ae,ve,ye,lo;gt.prototype["@@transducer/init"]=u.init;gt.prototype["@@transducer/result"]=function(n){return this.all&&(n=this.xf["@@transducer/step"](n,!0)),this.xf["@@transducer/result"](n)};gt.prototype["@@transducer/step"]=function(n,t){return this.f(t)||(this.all=!1,n=k(this.xf["@@transducer/step"](n,!1))),n};var fs=t(e(["all"],t(function(n,t){return new gt(n,t)}),function(n,t){for(var i=0;t.length>i;){if(!n(t[i]))return!1;i+=1}return!0})),et=t(function(n,t){return t>n?t:n}),yt=i(function(n){return!!b(n)||!!n&&"object"==typeof n&&!tt(n)&&(1===n.nodeType?!!n.length:0===n.length||n.length>0&&n.hasOwnProperty(0)&&n.hasOwnProperty(n.length-1))});ni.prototype["@@transducer/init"]=function(){throw Error("init not implemented on XWrap");};ni.prototype["@@transducer/result"]=function(n){return n};ni.prototype["@@transducer/step"]=function(n,t){return this.f(n,t)};wr=t(function(n,t){return p(n.length,function(){return n.apply(t,arguments)})});br="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";ti.prototype["@@transducer/init"]=u.init;ti.prototype["@@transducer/result"]=u.result;ti.prototype["@@transducer/step"]=function(n,t){return this.xf["@@transducer/step"](n,this.f(t))};var es=t(function(n,t){return new ti(n,t)}),sf=Object.prototype.toString,hf=function(){return"[object Arguments]"===sf.call(arguments)?function(n){return"[object Arguments]"===sf.call(n)}:function(n){return o("callee",n)}},os=!{toString:null}.propertyIsEnumerable("toString"),ss=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],cf=function(){return arguments.propertyIsEnumerable("length")}(),hs=function(n,t){for(var i=0;n.length>i;){if(n[i]===t)return!0;i+=1}return!1},a=i("function"!=typeof Object.keys||cf?function(n){if(Object(n)!==n)return[];var t,r,i=[],u=cf&&hf(n);for(t in n)!o(t,n)||u&&"length"===t||(i[i.length]=t);if(os)for(r=6;r>=0;)o(t=ss[r],n)&&!hs(i,t)&&(i[i.length]=t),r-=1;return i}:function(n){return Object(n)!==n?[]:Object.keys(n)}),c=t(e(["fantasy-land/map","map"],es,function(n,t){switch(Object.prototype.toString.call(t)){case"[object Function]":return s(t.length,function(){return n.call(this,t.apply(this,arguments))});case"[object Object]":return h(function(i,r){return i[r]=n(t[r]),i},{},a(t));default:return nt(n,t)}})),ot=t(function(n,t){for(var i=t,r=0;n.length>r;){if(null==i)return;i=i[n[r]];r+=1}return i}),kr=t(function(n,t){return ot([n],t)}),pt=t(function(n,t){return c(kr(n),t)}),w=r(h),cs=i(function(n){return s(w(et,0,pt("length",n)),function(){for(var t=0,i=n.length;i>t;){if(!n[t].apply(this,arguments))return!1;t+=1}return!0})}),lf=t(function(n,t){return n&&t});ii.prototype["@@transducer/init"]=u.init;ii.prototype["@@transducer/result"]=function(n){return this.any||(n=this.xf["@@transducer/step"](n,!1)),this.xf["@@transducer/result"](n)};ii.prototype["@@transducer/step"]=function(n,t){return this.f(t)&&(this.any=!0,n=k(this.xf["@@transducer/step"](n,!0))),n};var af=t(function(n,t){return new ii(n,t)}),vf=t(e(["any"],af,function(n,t){for(var i=0;t.length>i;){if(n(t[i]))return!0;i+=1}return!1})),ls=i(function(n){return s(w(et,0,pt("length",n)),function(){for(var t=0,i=n.length;i>t;){if(n[t].apply(this,arguments))return!0;t+=1}return!1})}),dr=t(function(n,t){return"function"==typeof t["fantasy-land/ap"]?t["fantasy-land/ap"](n):"function"==typeof n.ap?n.ap(t):"function"==typeof n?function(i){return n(i)(t(i))}:h(function(n,i){return y(n,c(i,t))},[],n)});it.prototype["@@transducer/init"]=u.init;it.prototype["@@transducer/result"]=function(n){return this.acc=null,this.xf["@@transducer/result"](n)};it.prototype["@@transducer/step"]=function(n,t){return this.store(t),this.full?this.xf["@@transducer/step"](n,this.getCopy()):n};it.prototype.store=function(n){this.acc[this.pos]=n;(this.pos+=1)===this.acc.length&&(this.pos=0,this.full=!0)};it.prototype.getCopy=function(){return y(Array.prototype.slice.call(this.acc,this.pos),Array.prototype.slice.call(this.acc,0,this.pos))};var as=t(e([],t(function(n,t){return new it(n,t)}),function(n,t){for(var i=0,r=t.length-(n-1),u=Array(0>r?0:r);r>i;)u[i]=Array.prototype.slice.call(t,i,i+n),i+=1;return u})),vs=t(function(n,t){return y(t,[n])}),yf=t(function(n,t){return n.apply(this,t)}),pf=i(function(n){for(var i=a(n),u=i.length,r=[],t=0;u>t;)r[t]=n[i[t]],t+=1;return r}),ys=i(function n(t){return t=c(function(t){return"function"==typeof t?t:n(t)},t),s(w(et,0,pt("length",pf(t))),function(){var n=arguments;return c(function(t){return yf(t,n)},t)})}),ps=t(function(n,t){return t(n)}),ws=r(function(n,t,i){var r=n(t),u=n(i);return u>r?-1:r>u?1:0}),ki=r(function(n,t,i){var r={};for(var u in i)r[u]=i[u];return r[n]=t,r}),st=Number.isInteger||function(n){return n<<0===n},wf=i(function(n){return null==n}),bf=r(function n(t,i,r){var u,e,f;return 0===t.length?i:(u=t[0],t.length>1&&(e=!wf(r)&&o(u,r)?r[u]:st(t[1])?[]:{},i=n(Array.prototype.slice.call(t,1),i,e)),st(u)&&b(r))?(f=[].concat(r),f[u]=i,f):ki(u,i,r)}),di=t(function(n,t){switch(n){case 0:return function(){return t.call(this)};case 1:return function(n){return t.call(this,n)};case 2:return function(n,i){return t.call(this,n,i)};case 3:return function(n,i,r){return t.call(this,n,i,r)};case 4:return function(n,i,r,u){return t.call(this,n,i,r,u)};case 5:return function(n,i,r,u,f){return t.call(this,n,i,r,u,f)};case 6:return function(n,i,r,u,f,e){return t.call(this,n,i,r,u,f,e)};case 7:return function(n,i,r,u,f,e,o){return t.call(this,n,i,r,u,f,e,o)};case 8:return function(n,i,r,u,f,e,o,s){return t.call(this,n,i,r,u,f,e,o,s)};case 9:return function(n,i,r,u,f,e,o,s,h){return t.call(this,n,i,r,u,f,e,o,s,h)};case 10:return function(n,i,r,u,f,e,o,s,h,c){return t.call(this,n,i,r,u,f,e,o,s,h,c)};default:throw Error("First argument to nAry must be a non-negative integer no greater than ten");}}),bs=i(function(n){return di(2,n)}),kf=t(function(n,t){var i=s(n,t);return s(n,function(){return h(dr,c(i,arguments[0]),Array.prototype.slice.call(arguments,1))})}),gi=i(function(n){return kf(n.length,n)}),ks=t(function(n,t){return ct(n)?function(){return n.apply(this,arguments)&&t.apply(this,arguments)}:gi(lf)(n,t)}),gr=i(function(n){return s(n.length,n)}),ds=gr(function(n){return n.apply(this,Array.prototype.slice.call(arguments,1))}),gs=function(n){return{"@@transducer/init":u.init,"@@transducer/result":function(t){return n["@@transducer/result"](t)},"@@transducer/step":function(t,i){var r=n["@@transducer/step"](t,i);return r["@@transducer/reduced"]?po(r):r}}},nh=function(n){var t=gs(n);return{"@@transducer/init":u.init,"@@transducer/result":function(n){return t["@@transducer/result"](n)},"@@transducer/step":function(n,i){return yt(i)?h(t,n,i):h(t,n,[i])}}},nu=t(e(["fantasy-land/chain","chain"],t(function(n,t){return c(n,nh(t))}),function(n,t){return"function"==typeof t?function(i){return n(t(i))(i)}:pu(!1)(c(n,t))})),th=r(function(n,t,i){if(n>t)throw Error("min must not be greater than max in clamp(min, max, value)");return n>i?n:i>t?t:i}),nr=i(function(n){return null===n?"Null":void 0===n?"Undefined":Object.prototype.toString.call(n).slice(8,-1)}),ih=i(function(n){return null!=n&&"function"==typeof n.clone?n.clone():cr(n,[],[],!0)}),rh=i(function(n){return function(t,i){return n(t,i)?-1:n(i,t)?1:0}}),df=i(function(n){return!n}),uh=gi(df),v=r(lt("slice",function(n,t,i){return Array.prototype.slice.call(i,n,t)})),tu=i(lt("tail",v(1,1/0))),tr=i(function(n){return tt(n)?n.split("").reverse().join(""):Array.prototype.slice.call(n,0).reverse()}),ir=t(function(n,t){return n===t?0!==n||1/n==1/t:n!==n&&t!==t}),l=t(function(n,t){return lr(n,t,[],[])}),wt=function(n){return(10>n?"0":"")+n},fh="function"==typeof Date.prototype.toISOString?function(n){return n.toISOString()}:function(n){return n.getUTCFullYear()+"-"+wt(n.getUTCMonth()+1)+"-"+wt(n.getUTCDate())+"T"+wt(n.getUTCHours())+":"+wt(n.getUTCMinutes())+":"+wt(n.getUTCSeconds())+"."+(n.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"};fi.prototype["@@transducer/init"]=u.init;fi.prototype["@@transducer/result"]=u.result;fi.prototype["@@transducer/step"]=function(n,t){return this.f(t)?this.xf["@@transducer/step"](n,t):n};var iu=t(e(["filter"],t(function(n,t){return new fi(n,t)}),function(n,t){return ui(t)?h(function(i,r){return n(t[r])&&(i[r]=t[r]),i},{},a(t)):vr(n,t)})),rr=t(function(n,t){return iu(rf(n),t)}),g=i(function(n){return uf(n,[])}),ru=t(function(n,t){if(b(n)){if(b(t))return n.concat(t);throw new TypeError(g(t)+" is not an array");}if(tt(n)){if(tt(t))return n+t;throw new TypeError(g(t)+" is not a string");}if(null!=n&&ct(n["fantasy-land/concat"]))return n["fantasy-land/concat"](t);if(null!=n&&ct(n.concat))return n.concat(t);throw new TypeError(g(n)+' does not have a method named "concat" or "fantasy-land/concat"');}),eh=i(function(n){return p(w(et,0,c(function(n){return n[0].length},n)),function(){for(var t=0;n.length>t;){if(n[t][0].apply(this,arguments))return n[t][1].apply(this,arguments);t+=1}})}),gf=t(function(n,t){if(n>10)throw Error("Constructor with greater than ten arguments");return 0===n?function(){return new t}:gr(di(n,function(n,i,r,u,f,e,o,s,h,c){switch(arguments.length){case 1:return new t(n);case 2:return new t(n,i);case 3:return new t(n,i,r);case 4:return new t(n,i,r,u);case 5:return new t(n,i,r,u,f);case 6:return new t(n,i,r,u,f,e);case 7:return new t(n,i,r,u,f,e,o);case 8:return new t(n,i,r,u,f,e,o,s);case 9:return new t(n,i,r,u,f,e,o,s,h);case 10:return new t(n,i,r,u,f,e,o,s,h,c)}}))}),oh=i(function(n){return gf(n.length,n)}),sh=t(d),ne=t(function(n,t){return s(w(et,0,pt("length",t)),function(){var r=arguments,i=this;return n.apply(i,nt(function(n){return n.apply(i,r)},t))})});ei.prototype["@@transducer/init"]=u.init;ei.prototype["@@transducer/result"]=function(n){for(var t in this.inputs)if(o(t,this.inputs)&&(n=this.xf["@@transducer/step"](n,this.inputs[t]))["@@transducer/reduced"]){n=n["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](n)};ei.prototype["@@transducer/step"]=function(n,t){var i=this.keyFn(t);return this.inputs[i]=this.inputs[i]||[i,this.valueAcc],this.inputs[i][1]=this.valueFn(this.inputs[i][1],t),n};var ur=ht(4,[],e([],ht(4,[],function(n,t,i,r){return new ei(n,t,i,r)}),function(n,t,i,r){return h(function(r,u){var f=i(u);return r[f]=n(o(f,r)?r[f]:t,u),r},{},r)})),hh=ur(function(n,t){return n+1},0),ch=bi(-1),te=t(function(n,t){return null==t||t!==t?n:t}),lh=r(function(n,t,i){var r=n(t),u=n(i);return r>u?-1:u>r?1:0}),uu=t(function(n,t){for(var r=[],i=0,u=n.length;u>i;)d(n[i],t)||d(n[i],r)||(r[r.length]=n[i]),i+=1;return r}),fu=r(function(n,t,i){for(var u=[],r=0,f=t.length;f>r;)rt(n,t[r],i)||rt(n,t[r],u)||u.push(t[r]),r+=1;return u}),ie=t(function(n,t){var i={};for(var r in t)i[r]=t[r];return delete i[n],i}),re=r(function(n,t,i){var r=Array.prototype.slice.call(i,0);return r.splice(n,t),r}),eu=r(function(n,t,i){return of(ft(t),n,i)}),ah=t(function n(t,i){switch(t.length){case 0:return i;case 1:return st(t[0])?re(t[0],1,i):ie(t[0],i);default:var r=t[0],u=Array.prototype.slice.call(t,1);return null==i[r]?i:st(t[0])?eu(r,n(u,i[r]),i):ki(r,n(u,i[r]),i)}}),vh=t(function(n,t){return n/t});oi.prototype["@@transducer/init"]=u.init;oi.prototype["@@transducer/result"]=u.result;oi.prototype["@@transducer/step"]=function(n,t){return this.n>0?(this.n-=1,n):this.xf["@@transducer/step"](n,t)};ou=t(e(["drop"],t(function(n,t){return new oi(n,t)}),function(n,t){return v(Math.max(0,n),1/0,t)}));si.prototype["@@transducer/init"]=u.init;si.prototype["@@transducer/result"]=u.result;si.prototype["@@transducer/step"]=function(n,t){this.i+=1;var i=0===this.n?n:this.xf["@@transducer/step"](n,t);return 0>this.n||this.n>this.i?i:k(i)};fr=t(e(["take"],t(function(n,t){return new si(n,t)}),function(n,t){return v(0,0>n?1/0:n,t)}));at.prototype["@@transducer/init"]=u.init;at.prototype["@@transducer/result"]=function(n){return this.acc=null,this.xf["@@transducer/result"](n)};at.prototype["@@transducer/step"]=function(n,t){return this.full&&(n=this.xf["@@transducer/step"](n,this.acc[this.pos])),this.store(t),n};at.prototype.store=function(n){this.acc[this.pos]=n;(this.pos+=1)===this.acc.length&&(this.pos=0,this.full=!0)};ue=t(e([],t(function(n,t){return new at(n,t)}),function(n,t){return fr(t.length>n?t.length-n:0,t)}));ut.prototype["@@transducer/init"]=u.init;ut.prototype["@@transducer/result"]=function(n){return this.retained=null,this.xf["@@transducer/result"](n)};ut.prototype["@@transducer/step"]=function(n,t){return this.f(t)?this.retain(n,t):this.flush(n,t)};ut.prototype.flush=function(n,t){return n=h(this.xf["@@transducer/step"],n,this.retained),this.retained=[],this.xf["@@transducer/step"](n,t)};ut.prototype.retain=function(n,t){return this.retained.push(t),n};fe=t(e([],t(function(n,t){return new ut(n,t)}),function(n,t){for(var i=t.length-1;i>=0&&n(t[i]);)i-=1;return v(0,i+1,t)}));hi.prototype["@@transducer/init"]=u.init;hi.prototype["@@transducer/result"]=u.result;hi.prototype["@@transducer/step"]=function(n,t){var i=!1;return this.seenFirstValue?this.pred(this.lastValue,t)&&(i=!0):this.seenFirstValue=!0,this.lastValue=t,i?n:this.xf["@@transducer/step"](n,t)};var ee=t(function(n,t){return new hi(n,t)}),bt=t(function(n,t){var i=0>n?t.length+n:n;return tt(t)?t.charAt(i):t[i]}),oe=bt(-1),se=t(e([],ee,function(n,t){var i=[],r=1,u=t.length;if(0!==u)for(i[0]=t[0];u>r;)n(oe(i),t[r])||(i[i.length]=t[r]),r+=1;return i})),yh=i(e([],ee(l),se(l)));ci.prototype["@@transducer/init"]=u.init;ci.prototype["@@transducer/result"]=u.result;ci.prototype["@@transducer/step"]=function(n,t){if(this.f){if(this.f(t))return n;this.f=null}return this.xf["@@transducer/step"](n,t)};var ph=t(e(["dropWhile"],t(function(n,t){return new ci(n,t)}),function(n,t){for(var i=0,r=t.length;r>i&&n(t[i]);)i+=1;return v(i,1/0,t)})),he=t(function(n,t){return n||t}),wh=t(function(n,t){return ct(n)?function(){return n.apply(this,arguments)||t.apply(this,arguments)}:gi(he)(n,t)}),ce=i(function(n){return null!=n&&"function"==typeof n["fantasy-land/empty"]?n["fantasy-land/empty"]():null!=n&&null!=n.constructor&&"function"==typeof n.constructor["fantasy-land/empty"]?n.constructor["fantasy-land/empty"]():null!=n&&"function"==typeof n.empty?n.empty():null!=n&&null!=n.constructor&&"function"==typeof n.constructor.empty?n.constructor.empty():b(n)?[]:tt(n)?"":ui(n)?{}:hf(n)?function(){return arguments}():void 0}),le=t(function(n,t){return ou(0>n?0:t.length-n,t)}),bh=t(function(n,t){return l(le(n.length,t),n)}),kh=r(function(n,t,i){return l(n(t),n(i))}),dh=r(function(n,t,i){return l(t[n],i[n])}),gh=t(function n(t,i){var u,r,f,e={};for(r in i)f=typeof(u=t[r]),e[r]="function"===f?u(i[r]):u&&"object"===f?n(u,i[r]):i[r];return e});li.prototype["@@transducer/init"]=u.init;li.prototype["@@transducer/result"]=function(n){return this.found||(n=this.xf["@@transducer/step"](n,void 0)),this.xf["@@transducer/result"](n)};li.prototype["@@transducer/step"]=function(n,t){return this.f(t)&&(this.found=!0,n=k(this.xf["@@transducer/step"](n,t))),n};ae=t(e(["find"],t(function(n,t){return new li(n,t)}),function(n,t){for(var i=0,r=t.length;r>i;){if(n(t[i]))return t[i];i+=1}}));ai.prototype["@@transducer/init"]=u.init;ai.prototype["@@transducer/result"]=function(n){return this.found||(n=this.xf["@@transducer/step"](n,-1)),this.xf["@@transducer/result"](n)};ai.prototype["@@transducer/step"]=function(n,t){return this.idx+=1,this.f(t)&&(this.found=!0,n=k(this.xf["@@transducer/step"](n,this.idx))),n};ve=t(e([],t(function(n,t){return new ai(n,t)}),function(n,t){for(var i=0,r=t.length;r>i;){if(n(t[i]))return i;i+=1}return-1}));vi.prototype["@@transducer/init"]=u.init;vi.prototype["@@transducer/result"]=function(n){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](n,this.last))};vi.prototype["@@transducer/step"]=function(n,t){return this.f(t)&&(this.last=t),n};ye=t(e([],t(function(n,t){return new vi(n,t)}),function(n,t){for(var i=t.length-1;i>=0;){if(n(t[i]))return t[i];i-=1}}));yi.prototype["@@transducer/init"]=u.init;yi.prototype["@@transducer/result"]=function(n){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](n,this.lastIdx))};yi.prototype["@@transducer/step"]=function(n,t){return this.idx+=1,this.f(t)&&(this.lastIdx=this.idx),n};var nc=t(e([],t(function(n,t){return new yi(n,t)}),function(n,t){for(var i=t.length-1;i>=0;){if(n(t[i]))return i;i-=1}return-1})),tc=i(pu(!0)),er=i(function(n){return s(n.length,function(t,i){var r=Array.prototype.slice.call(arguments,0);return r[0]=i,r[1]=t,n.apply(this,r)})}),ic=t(lt("forEach",function(n,t){for(var r=t.length,i=0;r>i;)n(t[i]),i+=1;return t})),rc=t(function(n,t){for(var u,r=a(t),i=0;r.length>i;)u=r[i],n(t[u],u,t),i+=1;return t}),uc=i(function(n){for(var i={},t=0;n.length>t;)i[n[t][0]]=n[t][1],t+=1;return i}),fc=t(lt("groupBy",ur(function(n,t){return null==n&&(n=[]),n.push(t),n},null))),ec=t(function(n,t){for(var i,u=[],r=0,f=t.length;f>r;){for(i=r+1;f>i&&n(t[i-1],t[i]);)i+=1;u.push(t.slice(r,i));r=i}return u}),oc=t(function(n,t){return n>t}),sc=t(function(n,t){return n>=t}),hc=t(o),cc=t(function(n,t){return n in t}),lc=bt(0),su=i(vt),ac=r(function(n,t,i){return s(Math.max(n.length,t.length,i.length),function(){return n.apply(this,arguments)?t.apply(this,arguments):i.apply(this,arguments)})}),vc=bi(1),yc=ur(function(n,t){return t},null),pc=t(function(n,t){return"function"!=typeof t.indexOf||b(t)?tf(t,n,0):t.indexOf(n)}),wc=v(0,-1),bc=r(function(n,t,i){return vr(function(t){return rt(n,t,i)},t)}),kc=r(function(n,t,i){n=i.length>n&&n>=0?n:i.length;var r=Array.prototype.slice.call(i,0);return r.splice(n,0,t),r}),dc=r(function(n,t,i){return n=i.length>n&&n>=0?n:i.length,[].concat(Array.prototype.slice.call(i,0,n),t,Array.prototype.slice.call(i,n))});yr.prototype.add=function(n){return!ff(n,!0,this)};yr.prototype.has=function(n){return ff(n,!1,this)};var pe=t(function(n,t){for(var r,u,e=new yr,f=[],i=0;t.length>i;)r=n(u=t[i]),e.add(r)&&f.push(u),i+=1;return f}),hu=pe(su),gc=t(function(n,t){var i,r;return n.length>t.length?(i=n,r=t):(i=t,r=n),hu(vr(er(d)(i),r))}),nl=t(lt("intersperse",function(n,t){for(var r=[],i=0,u=t.length;u>i;)i===u-1?r.push(t[i]):r.push(t[i],n),i+=1;return r})),cu="function"==typeof Object.assign?Object.assign:function(n){var t,i;if(null==n)throw new TypeError("Cannot convert undefined or null to object");for(var u=Object(n),r=1,f=arguments.length;f>r;){if(t=arguments[r],null!=t)for(i in t)o(i,t)&&(u[i]=t[i]);r+=1}return u},we=t(function(n,t){var i={};return i[n]=t,i}),tl={"@@transducer/init":Array,"@@transducer/step":function(n,t){return n.push(t),n},"@@transducer/result":vt},il={"@@transducer/init":String,"@@transducer/step":function(n,t){return n+t},"@@transducer/result":vt},rl={"@@transducer/init":Object,"@@transducer/step":function(n,t){return cu(n,yt(t)?we(t[0],t[1]):t)},"@@transducer/result":vt},ul=r(function(n,t,i){return hr(n)?h(t(n),n["@@transducer/init"](),i):h(t(go(n)),cr(n,[],[],!1),i)}),fl=i(function(n){for(var u=a(n),s=u.length,i=0,t={};s>i;){var f=u[i],r=n[f],e=o(r,t)?t[r]:t[r]=[];e[e.length]=f;i+=1}return t}),el=i(function(n){for(var i,r=a(n),f=r.length,t=0,u={};f>t;)i=r[t],u[n[i]]=i,t+=1;return u}),kt=t(function(n,t){return s(n+1,function(){var i=arguments[n];if(null!=i&&ct(i[t]))return i[t].apply(i,Array.prototype.slice.call(arguments,0,n));throw new TypeError(g(i)+' does not have a method named "'+t+'"');})}),be=t(function(n,t){return null!=t&&t.constructor===n||t instanceof n}),ol=i(function(n){return null!=n&&l(n,ce(n))}),sl=kt(1,"join"),ke=i(function(n){return ne(function(){return Array.prototype.slice.call(arguments,0)},n)}),hl=i(function(n){var i,t=[];for(i in n)t[t.length]=i;return t}),cl=t(function(n,t){if("function"!=typeof t.lastIndexOf||b(t)){for(var i=t.length-1;i>=0;){if(l(t[i],n))return i;i-=1}return-1}return t.lastIndexOf(n)}),de=i(function(n){return null!=n&&pr(n.length)?n.length:NaN}),or=t(function(n,t){return function(i){return function(r){return c(function(n){return t(n,r)},i(n(r)))}}}),ll=i(function(n){return or(bt(n),eu(n))}),al=i(function(n){return or(ot(n),bf(n))}),vl=i(function(n){return or(kr(n),ki(n))}),yl=t(function(n,t){return t>n}),pl=t(function(n,t){return t>=n}),wl=r(function(n,t,i){for(var r=0,e=i.length,f=[],u=[t];e>r;)u=n(u[0],i[r]),f[r]=u[1],r+=1;return[u[0],f]}),bl=r(function(n,t,i){for(var r=i.length-1,f=[],u=[t];r>=0;)u=n(i[r],u[0]),f[r]=u[1],r-=1;return[f,u[0]]}),kl=t(function(n,t){return h(function(i,r){return i[r]=n(t[r],r,t),i},{},a(t))}),dl=t(function(n,t){return t.match(n)||[]}),gl=t(function(n,t){return st(n)?!st(t)||1>t?NaN:(n%t+t)%t:NaN}),na=r(function(n,t,i){return n(i)>n(t)?i:t}),ge=w(bi,0),no=i(function(n){return ge(n)/n.length}),ta=i(function(n){var t=n.length,i,r;return 0===t?NaN:(i=2-t%2,r=(t-i)/2,no(Array.prototype.slice.call(n,0).sort(function(n,t){return t>n?-1:n>t?1:0}).slice(r,r+i)))}),to=t(function(n,t){var i={};return p(t.length,function(){var r=n.apply(this,arguments);return o(r,i)||(i[r]=t.apply(this,arguments)),i[r]})}),ia=to(function(){return g(arguments)}),ra=t(function(n,t){return cu({},n,t)}),ua=i(function(n){return cu.apply(null,[{}].concat(n))}),lu=r(function(n,t,i){var r,u={};for(r in t)o(r,t)&&(u[r]=o(r,i)?n(r,t[r],i[r]):t[r]);for(r in i)o(r,i)&&!o(r,u)&&(u[r]=i[r]);return u}),sr=r(function n(t,i,r){return lu(function(i,r,u){return ui(r)&&ui(u)?n(t,r,u):t(i,r,u)},i,r)}),fa=t(function(n,t){return sr(function(n,t,i){return t},n,t)}),ea=t(function(n,t){return sr(function(n,t,i){return i},n,t)}),oa=r(function(n,t,i){return sr(function(t,i,r){return n(i,r)},t,i)}),sa=r(function(n,t,i){return lu(function(t,i,r){return n(i,r)},t,i)}),ha=t(function(n,t){return n>t?t:n}),ca=r(function(n,t,i){return n(i)<n(t)?i:t}),la=t(function(n,t){return n%t}),io=t(function(n,t){return n*t}),aa=i(function(n){return-n}),va=t(rf(e(["any"],af,vf))),ya=i(function(n){return s(0>n?1:n+1,function(){return bt(n,arguments)})}),pa=r(function(n,t,i){return n(t(i))}),wa=i(function(n){return[n]}),ba=t(function(n,t){for(var i,u={},f={},r=0,e=n.length;e>r;)f[n[r]]=1,r+=1;for(i in t)f.hasOwnProperty(i)||(u[i]=t[i]);return u}),ka=i(function(n){var t,i=!1;return p(n.length,function(){return i?t:(i=!0,t=n.apply(this,arguments))})}),ro=function(n){return{value:n,map:function(t){return ro(t(n))}}},uo=r(function(n,t,i){return n(function(n){return ro(t(n))})(i).value}),da=t(function(n,t){return[n,t]}),ga=ef(y),nv=ef(er(y)),tv=ke([iu,rr]),iv=r(function(n,t,i){return l(ot(n,i),t)}),rv=r(function(n,t,i){return te(n,ot(t,i))}),uv=r(function(n,t,i){return t.length>0&&n(ot(t,i))}),fv=t(function(n,t){for(var r={},i=0;n.length>i;)n[i]in t&&(r[n[i]]=t[n[i]]),i+=1;return r}),fo=t(function(n,t){for(var r,u={},i=0,f=n.length;f>i;)r=n[i],u[r]=t[r],i+=1;return u}),ev=t(function(n,t){var r={};for(var i in t)n(t[i],i,t)&&(r[i]=t[i]);return r}),eo=t(function(n,t){return y([n],t)}),ov=w(io,1),oo=t(function(n,t){return s(t.length,function(){for(var r=[],i=0;t.length>i;)r.push(t[i].call(this,arguments[i])),i+=1;return n.apply(this,r.concat(Array.prototype.slice.call(arguments,t.length)))})}),sv=oo(nt,[fo,su]),hv=r(function(n,t,i){return l(t,i[n])}),cv=r(function(n,t,i){return be(n,i[t])}),lv=r(function(n,t,i){return null!=i&&o(t,i)?i[t]:n}),av=r(function(n,t,i){return n(i[t])}),vv=t(function(n,t){for(var u=n.length,r=[],i=0;u>i;)r[i]=t[n[i]],i+=1;return r}),yv=t(function(n,t){if(!pr(n)||!pr(t))throw new TypeError("Both arguments to range must be numbers");for(var r=[],i=n;t>i;)r.push(i),i+=1;return r}),so=r(function(n,t,i){for(var r=i.length-1;r>=0;)t=n(i[r],t),r-=1;return t}),pv=ht(4,[],function(n,t,i,r){return h(function(i,r){return n(i,r)?t(i,r):k(i)},i,r)}),wv=i(k),ho=t(function(n,t){var u,i=+t,r=0;if(0>i||isNaN(i))throw new RangeError("n must be a non-negative number");for(u=Array(i);i>r;)u[r]=n(r),r+=1;return u}),bv=t(function(n,t){return ho(ft(n),t)}),kv=r(function(n,t,i){return i.replace(n,t)}),dv=r(function(n,t,i){for(var r=0,f=i.length,u=[t];f>r;)t=n(t,i[r]),u[r+1]=t,r+=1;return u}),co=t(function(n,t){return"function"==typeof t.sequence?t.sequence(n):so(function(n,t){return dr(c(eo,n),t)},n([]),t)}),gv=r(function(n,t,i){return uo(n,ft(t),i)}),ny=t(function(n,t){return Array.prototype.slice.call(t,0).sort(n)}),ty=t(function(n,t){return Array.prototype.slice.call(t,0).sort(function(t,i){var r=n(t),u=n(i);return u>r?-1:r>u?1:0})}),iy=t(function(n,t){return Array.prototype.slice.call(t,0).sort(function(t,i){for(var r=0,u=0;0===r&&n.length>u;)r=n[u](t,i),u+=1;return r})}),ry=kt(1,"split"),uy=t(function(n,t){return[v(0,n,t),v(n,de(t),t)]}),fy=t(function(n,t){if(0>=n)throw Error("First argument to splitEvery must be a positive integer");for(var r=[],i=0;t.length>i;)r.push(v(i,i+=n,t));return r}),ey=t(function(n,t){for(var i=0,u=t.length,r=[];u>i&&!n(t[i]);)r.push(t[i]),i+=1;return[r,Array.prototype.slice.call(t,i)]}),oy=t(function(n,t){return l(fr(n.length,t),n)}),sy=t(function(n,t){return+n-+t}),hy=t(function(n,t){return ru(uu(n,t),uu(t,n))}),cy=r(function(n,t,i){return ru(fu(n,t,i),fu(n,i,t))}),ly=t(function(n,t){for(var i=t.length-1;i>=0&&n(t[i]);)i-=1;return v(i+1,1/0,t)});pi.prototype["@@transducer/init"]=u.init;pi.prototype["@@transducer/result"]=u.result;pi.prototype["@@transducer/step"]=function(n,t){return this.f(t)?this.xf["@@transducer/step"](n,t):k(n)};lo=t(e(["takeWhile"],t(function(n,t){return new pi(n,t)}),function(n,t){for(var i=0,r=t.length;r>i&&n(t[i]);)i+=1;return v(0,i,t)}));wi.prototype["@@transducer/init"]=u.init;wi.prototype["@@transducer/result"]=u.result;wi.prototype["@@transducer/step"]=function(n,t){return this.f(t),this.xf["@@transducer/step"](n,t)};var ay=t(e([],t(function(n,t){return new wi(n,t)}),function(n,t){return n(t),t})),vy=t(function(n,t){if(!ns(n))throw new TypeError("\u2018test\u2019 requires a value of type RegExp as its first argument; received "+g(n));return wu(n).test(t)}),yy=kt(0,"toLowerCase"),py=i(function(n){var t=[];for(var i in n)o(i,n)&&(t[t.length]=[i,n[i]]);return t}),wy=i(function(n){var t=[];for(var i in n)t[t.length]=[i,n[i]];return t}),by=kt(0,"toUpperCase"),ky=s(4,function(n,t,i,r){return h(n("function"==typeof t?au(t):t),i,r)}),dy=i(function(n){for(var u,t,r=0,i=[];n.length>r;){for(u=n[r],t=0;u.length>t;)void 0===i[t]&&(i[t]=[]),i[t].push(u[t]),t+=1;r+=1}return i}),gy=r(function(n,t,i){return"function"==typeof i["fantasy-land/traverse"]?i["fantasy-land/traverse"](t,n):co(n,c(t,i))}),dt="\t\n\v\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",np=i(!("function"==typeof String.prototype.trim)||dt.trim()?function(n){var t=RegExp("^["+dt+"]["+dt+"]*"),i=RegExp("["+dt+"]["+dt+"]*$");return n.replace(t,"").replace(i,"")}:function(n){return n.trim()}),tp=t(function(n,t){return p(n.length,function(){try{return n.apply(this,arguments)}catch(n){return t.apply(this,y([n],arguments))}})}),ip=i(function(n){return function(){return n(Array.prototype.slice.call(arguments,0))}}),rp=i(function(n){return di(1,n)}),up=t(function(n,t){return s(n,function(){for(var r,u=1,i=t,f=0;n>=u&&"function"==typeof i;)r=u===n?arguments.length:f+i.length,i=i.apply(this,Array.prototype.slice.call(arguments,f,r)),u+=1,f=r;return i})}),fp=t(function(n,t){for(var i=n(t),r=[];i&&i.length;)r[r.length]=i[0],i=n(i[1]);return r}),ep=t(ri(hu,y)),ao=t(function(n,t){for(var u,r=0,f=t.length,i=[];f>r;)rt(n,u=t[r],i)||(i[i.length]=u),r+=1;return i}),op=r(function(n,t,i){return ao(n,y(t,i))}),sp=r(function(n,t,i){return n(i)?i:t(i)}),hp=nu(vt),cp=r(function(n,t,i){for(var r=i;!n(r);)r=t(r);return r}),lp=i(function(n){var i,t=[];for(i in n)t[t.length]=n[i];return t}),ap=function(n){return{value:n,"fantasy-land/map":function(){return this}}},vp=t(function(n,t){return n(ap)(t).value}),yp=r(function(n,t,i){return n(i)?t(i):i}),vo=t(function(n,t){for(var i in n)if(o(i,n)&&!n[i](t[i]))return!1;return!0}),pp=t(function(n,t){return vo(c(l,n),t)}),wp=t(function(n,t){return rr(er(d)(n),t)}),bp=t(function(n,t){for(var i,r=0,f=n.length,e=t.length,u=[];f>r;){for(i=0;e>i;)u[u.length]=[n[r],t[i]],i+=1;r+=1}return u}),kp=t(function(n,t){for(var r=[],i=0,u=Math.min(n.length,t.length);u>i;)r[i]=[n[i],t[i]],i+=1;return r}),dp=t(function(n,t){for(var i=0,u=Math.min(n.length,t.length),r={};u>i;)r[n[i]]=t[i],i+=1;return r}),gp=r(function(n,t,i){for(var u=[],r=0,f=Math.min(t.length,i.length);f>r;)u[r]=n(t[r],i[r]),r+=1;return u});n.F=ts;n.T=is;n.__=rs;n.add=bi;n.addIndex=us;n.adjust=of;n.all=fs;n.allPass=cs;n.always=ft;n.and=lf;n.any=vf;n.anyPass=ls;n.ap=dr;n.aperture=as;n.append=vs;n.apply=yf;n.applySpec=ys;n.applyTo=ps;n.ascend=ws;n.assoc=ki;n.assocPath=bf;n.binary=bs;n.bind=wr;n.both=ks;n.call=ds;n.chain=nu;n.clamp=th;n.clone=ih;n.comparator=rh;n.complement=uh;n.compose=ri;n.composeK=ku;n.composeP=function(){if(0===arguments.length)throw Error("composeP requires at least one argument");return du.apply(this,tr(arguments))};n.concat=ru;n.cond=eh;n.construct=oh;n.constructN=gf;n.contains=sh;n.converge=ne;n.countBy=hh;n.curry=gr;n.curryN=s;n.dec=ch;n.defaultTo=te;n.descend=lh;n.difference=uu;n.differenceWith=fu;n.dissoc=ie;n.dissocPath=ah;n.divide=vh;n.drop=ou;n.dropLast=ue;n.dropLastWhile=fe;n.dropRepeats=yh;n.dropRepeatsWith=se;n.dropWhile=ph;n.either=wh;n.empty=ce;n.endsWith=bh;n.eqBy=kh;n.eqProps=dh;n.equals=l;n.evolve=gh;n.filter=iu;n.find=ae;n.findIndex=ve;n.findLast=ye;n.findLastIndex=nc;n.flatten=tc;n.flip=er;n.forEach=ic;n.forEachObjIndexed=rc;n.fromPairs=uc;n.groupBy=fc;n.groupWith=ec;n.gt=oc;n.gte=sc;n.has=hc;n.hasIn=cc;n.head=lc;n.identical=ir;n.identity=su;n.ifElse=ac;n.inc=vc;n.indexBy=yc;n.indexOf=pc;n.init=wc;n.innerJoin=bc;n.insert=kc;n.insertAll=dc;n.intersection=gc;n.intersperse=nl;n.into=ul;n.invert=fl;n.invertObj=el;n.invoker=kt;n.is=be;n.isEmpty=ol;n.isNil=wf;n.join=sl;n.juxt=ke;n.keys=a;n.keysIn=hl;n.last=oe;n.lastIndexOf=cl;n.length=de;n.lens=or;n.lensIndex=ll;n.lensPath=al;n.lensProp=vl;n.lift=gi;n.liftN=kf;n.lt=yl;n.lte=pl;n.map=c;n.mapAccum=wl;n.mapAccumRight=bl;n.mapObjIndexed=kl;n.match=dl;n.mathMod=gl;n.max=et;n.maxBy=na;n.mean=no;n.median=ta;n.memoize=ia;n.memoizeWith=to;n.merge=ra;n.mergeAll=ua;n.mergeDeepLeft=fa;n.mergeDeepRight=ea;n.mergeDeepWith=oa;n.mergeDeepWithKey=sr;n.mergeWith=sa;n.mergeWithKey=lu;n.min=ha;n.minBy=ca;n.modulo=la;n.multiply=io;n.nAry=di;n.negate=aa;n.none=va;n.not=df;n.nth=bt;n.nthArg=ya;n.o=pa;n.objOf=we;n.of=wa;n.omit=ba;n.once=ka;n.or=he;n.over=uo;n.pair=da;n.partial=ga;n.partialRight=nv;n.partition=tv;n.path=ot;n.pathEq=iv;n.pathOr=rv;n.pathSatisfies=uv;n.pick=fv;n.pickAll=fo;n.pickBy=ev;n.pipe=bu;n.pipeK=function(){if(0===arguments.length)throw Error("pipeK requires at least one argument");return ku.apply(this,tr(arguments))};n.pipeP=du;n.pluck=pt;n.prepend=eo;n.product=ov;n.project=sv;n.prop=kr;n.propEq=hv;n.propIs=cv;n.propOr=lv;n.propSatisfies=av;n.props=vv;n.range=yv;n.reduce=w;n.reduceBy=ur;n.reduceRight=so;n.reduceWhile=pv;n.reduced=wv;n.reject=rr;n.remove=re;n.repeat=bv;n.replace=kv;n.reverse=tr;n.scan=dv;n.sequence=co;n.set=gv;n.slice=v;n.sort=ny;n.sortBy=ty;n.sortWith=iy;n.split=ry;n.splitAt=uy;n.splitEvery=fy;n.splitWhen=ey;n.startsWith=oy;n.subtract=sy;n.sum=ge;n.symmetricDifference=hy;n.symmetricDifferenceWith=cy;n.tail=tu;n.take=fr;n.takeLast=le;n.takeLastWhile=ly;n.takeWhile=lo;n.tap=ay;n.test=vy;n.times=ho;n.toLower=yy;n.toPairs=py;n.toPairsIn=wy;n.toString=g;n.toUpper=by;n.transduce=ky;n.transpose=dy;n.traverse=gy;n.trim=np;n.tryCatch=tp;n.type=nr;n.unapply=ip;n.unary=rp;n.uncurryN=up;n.unfold=fp;n.union=ep;n.unionWith=op;n.uniq=hu;n.uniqBy=pe;n.uniqWith=ao;n.unless=sp;n.unnest=hp;n.until=cp;n.update=eu;n.useWith=oo;n.values=pf;n.valuesIn=lp;n.view=vp;n.when=yp;n.where=vo;n.whereEq=pp;n.without=wp;n.xprod=bp;n.zip=kp;n.zipObj=dp;n.zipWith=gp;Object.defineProperty(n,"__esModule",{value:!0})}),function(n){function t(t){n.SR=t==="CN"?Forguncy._PivotTableCNSR:t==="JA"?Forguncy._PivotTableJASR:t==="KR"?Forguncy._PivotTableKRSR:Forguncy._PivotTableENSR}n.SR=Forguncy._PivotTableENSR;n.setCulture=t}(PivotData||(PivotData={})),function(n){var t=function(){function t(){}return t.isNumberNeedRound=function(n){return n==null?!1:n!==_.round(n,2)},t.isEmpty=function(n){return n===undefined||n===null||n===""||Array.isArray(n)&&n.length===0},t.getGuid=function(n){return""+(n||"")+(new Date).getTime()+Math.floor(Math.random()*1e4)},t.valueCompare=function(n,t){var i=n==null,r=t==null;if(i&&r)return 0;else if(i)return 1;else if(r)return-1;return n=n.valueOf(),t=t.valueOf(),n>t?1:n<t?-1:0},t.entryKey=function(n){return n==null?'\0':""+(n instanceof Date?n.valueOf():n)},t.createEventHandler=function(n,t){return function(){return t.apply(n,arguments)}},t.getCulture=function(){var t=n.SR.cultureName;return t?t:"en-US"},t.getDefaultFormat=function(){return"General"},t.datetimeFromJSON=function(n){if(n==null)return null;var t;return n instanceof Date?n:(t=new Date(n),new Date(t.getTime()+t.getTimezoneOffset()*6e4))},t.datetimeToJSON=function(n){return n instanceof Date?new Date(n.getTime()-n.getTimezoneOffset()*6e4).toJSON():n},t.isValidFormat=function(n){return!!n},t.getRoundedFloatingNumber=function(n,t){return!n||!n.toPrecision?n:(t===undefined&&(t=15),Number(n.toPrecision(t)))},t.getFormatter=function(t){var i;if(t.type==="subDate")switch(t.subDatePart){case"year":case"fiscalYear":i=n.SR.datetime_year_format;break;default:i="@"}else i=t.format;return i},t.formatstring=function(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return arguments.length==0?null:(i=Array.prototype.slice.call(arguments,1),n.replace(/\{(\d+)\}/g,function(n,t){return i[t]}))},t.getLocaleDateFormat=function(n){var r=t.getCulture(),i="yyyy/M/d";return n&&(i=i+" HH:mm:ss"),i},t.bSearchBy=function(n){function t(t,i,r){while(i<r){var u=i+r>>>1;n(u)<t?i=u+1:r=u}return i}function i(t,i,r){while(i<r){var u=i+r>>>1;t<n(u)?r=u:i=u+1}return i}return{left:t,right:i}},t.intersectMapping=function(n,t){var e=[],i=0,r=0,u,f;if(n&&t&&n.length&&t.length)for(u=n.length,f=t.length;i<u&&r<f;){while(i<u&&n[i]<t[r])++i;if(i==u)break;while(r<f&&t[r]<n[i])++r;if(r==f)break;n[i]===t[r]&&(e.push(n[i]),++i,++r)}return e},t.getFiscalYear=function(n,t){var r=n.getMonth(),i=n.getFullYear();return r<t?i-1:i},t.getFiscalYearQuarter=function(n,t){return~~((n.getMonth()+12-t)%12/3)+1},t.getFiscalWeek=function(n,t){var i=new Date(n.valueOf());i.setHours(0,0,0,0);var r=new Date(i.getFullYear(),t,1,0,0,0,0),u=r.getDay(),f=((i.valueOf()-r.valueOf())/864e5+u)/7+(u?0:1);return Math.ceil(f)},t.IsIE=function(){var n=window.navigator.userAgent,t=n.indexOf("MSIE ")>0,i=n.indexOf("Trident/")>0;return t||i},t.trimExtraFloatNumber=function(n){return typeof n=="number"&&n%1!=0&&(n=Math.round(n*1e6)/1e6),n},t}(),i;n.utils=t;i=function(){function n(){this._eventData={}}return n.prototype.on=function(n,t){var i=this._eventData[n];i==null&&(i=this._eventData[n]=[]);i.push(t)},n.prototype.off=function(n,i){var r,u;if(t.isEmpty(n))this._eventData={};else{if(r=this._eventData[n],r==null)return;i?(u=r.indexOf(i),r.splice(u,1)):r=[];this._eventData[n]=r}},n.prototype.fire=function(n,t){var r=this,i=this._eventData[n];i!=null&&i.forEach(function(n){try{n.call(r,t)}catch(i){}})},n}();n.EventBase=i}(PivotData||(PivotData={}));String.prototype.format||(String.prototype.format=function(){var n=arguments;return this.replace(/{(\d+)}/g,function(t,i){return typeof n[i]!="undefined"?n[i]:t})});String.prototype.endsWith||(String.prototype.endsWith=function(n){return this.indexOf(n,this.length-n.length)!==-1});String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var u="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABGdBTUEAALGPC/xhBQAAADdJREFUKFNjSM8u/E8KBmt4/fYtURinhtyiCjBGF6ezBpgiXJhyDcgYWREyHkANuDBcA/G48D8Aamyz8N1rlfYAAAAASUVORK5CYII=",f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABGdBTUEAALGPC/xhBQAAACdJREFUKFNjSM8u/E8KBmt4/fYtUXiwawDR+DDlGojBg1kD8bjwPwC4WsPYCYUkkAAAAABJRU5ErkJggg==",i=5,t=12,e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.processMouseDown=function(n){var t=n.row,i=n.col;return t===0&&i===0&&n.sheet.setSelection(-1,-1,n.sheet.getRowCount(),n.sheet.getColumnCount()),!0},t.prototype.getHitInfo=function(n,t,i,r,u){return{x:n,y:t,row:u.row,col:u.col,cellRect:r,sheetArea:u.sheetArea}},t.prototype.paintValue=function(n,t,i,r,u,f,e,o){n.save();n.rect(i+1,r+1,u-2,f-2);n.clip();n.beginPath();GC.Spread.Sheets.CellTypes.Base.prototype.paintValue.call(this,n,t,i,r,u,f,e,o);n.restore()},t.prototype.paintContent=function(n,t,i,r,u,f,e,o){var h=o.sheetArea,a,s,l,c;(h===2||h===1)&&(a=o.visualState||0,s="columnHeader",h===2&&(s="rowHeader"),GC.Spread.Sheets._ThemeStyleHelper?(l=this.getThemeStyle(o.visualState,"gc-"+s+"-"+GC.Spread.Sheets._ThemeStyleHelper._getString(a)),GC.Spread.Sheets.CellTypes.Context._paintHeaderCellGridline(n,i,r,u,f,e,s,l,h)):(l=this.getThemeStyle(o.visualState,"gc-"+s+"-"+GC.Spread.Sheets.Im.Jm(a)),GC.Spread.Sheets.CellTypes.Context.gp(n,i,r,u,f,e,s,l,h)));o.cellOverflowLayout||(c=new GC.Spread.Sheets.Rect(i,r,u,f),this.paintValue(n,t,c.x,c.y,c.width,c.height,e,o))},t}(GC.Spread.Sheets.CellTypes.Base),r;n.NormalColumnHeaderCellType=e;r=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),r.prototype.paintContent=function(n,t,i,r,u,f,e,o){var h=o.sheetArea,a,s,l,c;(h===2||h===1)&&(a=o.visualState||0,s="columnHeader",h===2&&(s="rowHeader"),GC.Spread.Sheets._ThemeStyleHelper?(l=this.getThemeStyle(o.visualState,"gc-"+s+"-"+GC.Spread.Sheets._ThemeStyleHelper._getString(a)),GC.Spread.Sheets.CellTypes.Context._paintHeaderCellGridline(n,i,r,u,f,e,s,l,h)):(l=this.getThemeStyle(o.visualState,"gc-"+s+"-"+GC.Spread.Sheets.Im.Jm(a)),GC.Spread.Sheets.CellTypes.Context.gp(n,i,r,u,f,e,s,l,h)));o.cellOverflowLayout||(c=new GC.Spread.Sheets.Rect(i,r,u,f),this.paintValue(n,t,c.x,c.y,c.width,c.height,e,o))},r.prototype.paintValue=function(n,r,e,o,s,h,c,l){var y,p,v,a,w,b,k;if(n.save(),n.rect(e+1,o+1,s-2,h-2),n.clip(),n.beginPath(),y=l.sheet,p=y.getTag(l.row,l.col,l.sheetArea),p&&p.hide){n.restore();return}v=p.collapse?u:f;a=y._imageLoader;a?(w=a._getState(v),w?(b=a._getImage(v),n.drawImage(b,e+i,o+h*.5-t/2,t,t)):a._addImage(v)):(a=y.bt,w=a.ko(v),w?(b=a.lo(v),n.drawImage(b,e+i,o+h*.5-t/2,t,t)):a.fo(v));k={x:e+i+t,width:s-i-t};GC.Spread.Sheets.CellTypes.Base.prototype.paintValue.call(this,n,r,k.x,o,k.width,h,c,l);n.restore()},r.prototype.getHitInfo=function(n,t,i,r,u){return u?{x:n,y:t,row:u.row,col:u.col,cellRect:r,sheetArea:u.sheetArea,sheet:u&&u.sheet}:null},r.prototype.hitOnCollapseIcon=function(n){var r=n.cellRect,u=n.x,f=n.y,s=r.height,e=r.x+i,o=r.y+s*.5;return e<=u+10&&u<e+t&&f+10>=o&&f<o+t},r.prototype.processMouseUp=function(n){var r=n.sheet,u=n.row,f=n.col,e=n.sheetArea,t=r.getTag(u,f,e),i;return t||(t={}),i=this.hitOnCollapseIcon(n),i&&(t.collapse=!t.collapse),t.isHitOnCollapseIcon=i,r.setTag(u,f,t,e),!0},r.prototype.getAutoFitWidth=function(t,r,u,f,e){return n.prototype.getAutoFitWidth.call(this,t,r,u,f,e)+i+12+3},r}(GC.Spread.Sheets.CellTypes.Base);n.CollapseHeaderCellType=r}(PivotData||(PivotData={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var tt=function(){function n(){this.layout=3;this.subtotals=3;this.grandTotals=1;this.headerText=2;this.highlightOverwriteData=!0}return n}(),it,rt,ut,a,ft,et,ot,st,r,s,at,vt,y,yt,u,h,c,b,k,d,bt,l;n.PivotLayoutSetting=tt;it=function(){function n(){}return n.String="String",n.Number="Number",n.Date="Date",n.DateTime="DateTime",n.Boolean="Boolean",n}();n.DataType=it;rt=function(){function n(){this.measures=[];this.dimensions=[];this.columns={};this.startMonth=0}return n}();n.DataSetDataType=rt;ut=function(){function n(){this.lookUps=[];this.backgroundLookUps=[];this.values=[];this.startMonth=0}return n}();n.DataSetDataColumn=ut;a=function(){function n(n,t){this.name=n;this.display=t}return n}();n.PivotSettingConfigItem=a;ft=function(){function n(){this.addressing=[];this.partitioning=[]}return n}();n.PivotSettingValueAdvance=ft;et=function(){function n(){}return n}();n.PivotSettingValueAlong=et;ot=function(){function n(n,t){this.name=n;this.display=t}return n}();n.PivotSettingConfigValue=ot;st=function(){function n(){this.columns=[];this.rows=[];this.values=[]}return n}();n.PivotSettingConfig=st;var o=function(t){function i(n,r){var u=t.call(this)||this,f,e;if(Object.setPrototypeOf(u,i.prototype),u._column=n,r)for(f=!1;!f;)e=r.splice(0,1e4),u.push.apply(u,e),e.length<1e4&&(f=!0);return u}return __extends(i,t),i.prototype.getPos=function(t){var u=this._column.dataType==="datetime"||this._column.dataType==="date",i,r;return i=u?function(n){return n==null?'\0':n.valueOf()}:n.utils.entryKey,r=this._column.lookUps.reduce(function(n,t,r){return n[i(t)]=r,n},{}),r[i(t)]},i}(Array),ht=function(){function n(){this.funcType=4}return n}(),ct=function(t){function i(n){var r=t.call(this)||this,u,f;for(r.lookUps=new o(r),r.backgroundLookUps=new o(r),r.startMonth=0,Object.setPrototypeOf(r,i.prototype),u=!1;!u;)f=n.splice(0,1e4),r.push.apply(r,f),f.length<1e4&&(u=!0);return r}return __extends(i,t),i.prototype.setDefaultMapping=function(n){this._defaultMapping=n},i.prototype.getSortFunction=function(){var t=this.getSortInfo();return t&&t.func||n.utils.valueCompare},i.prototype.getSortInfo=function(){return this._sortInfo},i.prototype.setSortInfo=function(n){n.func=s.buildSortFunction(n.funcType,n.setting);this._sortInfo=n;delete this._orderedIndexes;delete this._sortedEntries},i.prototype.getOrderedIndexes=function(){return this._orderedIndexes||(this._orderedIndexes=s.buildOrderedIndexes(this,this._defaultMapping.slice(0))),this._orderedIndexes},i.prototype.getEntries=function(){var t,i,n,r;if(!this._entries){if(t=this.lookUps?this.lookUps.slice(0):[],!t.length){for(i={},n=0;n<this.length;++n)i[this[n]]=this[n];for(r in i)t.push(i[r])}this._entries=t}return this._entries.slice(0)},i.prototype.getSortedEntries=function(){if(!this._sortedEntries){var n=this.getEntries(),t=this.getSortFunction();this._sortedEntries=n.sort(t)}return this._sortedEntries.slice(0)},i.prototype.getEntriesMapping=function(){var r,i,u,e,t,f;if(!this._entriesMapping){var o=this.getSortedEntries(),s=this.getOrderedIndexes(),c=!!this.lookUps,h={},a=0,l=this.getSortFunction();for(r=0,i=0;r<o.length;++r){for(u=o[r],e={value:u,start:i,end:i},h[n.utils.entryKey(u)]=e,t=i;t<s.length;){if(f=this[s[t]],c&&(f=this.lookUps[f]),l(u,f)<0){i=t;break}t++}e.end=t-1}this._entriesMapping=h}return this._entriesMapping},i}(Array),hi=function(n){function t(i){var r=n.call(this)||this;return r.$br={},Object.setPrototypeOf(r,t.prototype),r._dataSet=i,r}return __extends(t,n),t.prototype.getColumn=function(n){var t,i;return n==null?null:(t=typeof n=="number"?this[n]:this.$br[n],i=t&&t.dataType,(i==="date"||i==="datetime")&&this._dataSet._createSubDateColumns(t,i),t)},t.prototype.getColumnByDisplay=function(n){var i=this.$br,r,t;for(r in i)if(t=i[r],t.displayName===n)return t;return null},t.prototype.getColumns=function(){var n=[],t=this.$br;for(var i in t)n.push(t[i]);return n},t}(Array),v=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.$br={},t}return __extends(t,n),t}(Array),ci=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.$br={},t}return __extends(t,n),t}(Array),li=function(){function n(){}return n}(),lt=function(){function n(){}return n}();n.TableDataCell=lt;r=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.visible=!0,t}return __extends(t,n),t}(lt);s=function(t){function i(n){var i=t.call(this)||this;return i._init(n),i}return __extends(i,t),i.getDataType=function(n){switch(n){case"Date":return"date";case"DateTime":return"datetime";case"String":return"string";case"SByte":case"Int16":case"Int64":case"Int32":case"Byte":case"UInt16":case"UInt32":case"UInt64":case"Single":case"Double":case"Decimal":case"Number":return"number";case"Boolean":return"boolean";default:return"unknown"}},i.buildLookUps=function(t){var r,u,i;if(t)for(r={},u=t.lookUps=[],i=0;i<t.length;++i){var e=t[i],o=n.utils.entryKey(e),f=r[o];f===undefined&&(r[o]=f=u.length,u.push(e));t[i]=f}},i.buildOrderedIndexes=function(n,t){if(n&&n.length){var r=!!n.lookUps,u=n.getSortFunction(),i=[];t.forEach(function(t){var u=r?n.lookUps[n[t]]:n[t];i.push({index:t,value:u})});i.sort(function(n,t){return u(n.value,t.value)});t=i.map(function(n){return n.index})}return t},i.buildSortFunction=function(t,i){var u,f,r;switch(t){case 1:for(u={},f=i,r=0;r<12;r++)u[(r+f)%12||12]=r;return function(n,t){return u[n]-u[t]};case 3:default:return n.utils.valueCompare}},i.synchronizeSubDate=function(t,i,r,u,f){for(var o,c,l=["year","fiscalYear","month","quarter","week","day","hour","minute","second","millisecond"],a=l.map(function(n){return r+"("+n+")"}),s=0;s<a.length;s++){var h=a[s],v=l[s],e=void 0;switch(v){case"year":e=n.SR.directives_scenariodimension_datadimensions_year;break;case"fiscalYear":e=n.SR.directives_scenariodimension_datadimensions_fiscalyear;break;case"quarter":e=n.SR.directives_scenariodimension_datadimensions_quarter;break;case"month":e=n.SR.directives_scenariodimension_datadimensions_month;break;case"week":e=n.SR.directives_scenariodimension_datadimensions_week;break;case"day":e=n.SR.directives_scenariodimension_datadimensions_day;break;case"hour":e=n.SR.directives_scenariodimension_datadimensions_hour;break;case"minute":e=n.SR.directives_scenariodimension_datadimensions_minute;break;case"second":e=n.SR.directives_scenariodimension_datadimensions_second;break;case"millisecond":e=n.SR.directives_scenariodimension_datadimensions_millisecond;break;default:e=v}o=t.table.getColumn(h);o&&(c=i.content.nameMappings[h],c?o.displayName=c:(o.displayName=e+"("+u+")",f?t.fire("columnRenamedAndChanged",{columnName:h,newDisplayName:o.displayName,newColumnLookUps:o.lookUps}):t.fire("columnRenamed",{columnName:h,newDisplayName:o.displayName})))}},i.prototype._init=function(t){var u=this,a=new hi(this),l=new ci,y=new v,f,s,r,c,h,e,p;if(u.table=a,u._fields=l,u._columnTypes=y,u._views={},u.count=0,u.startMonth=0,t){if(t.columns)for(f in t.columns)if(s=t.columns[f],r=new ct(s.values||[]),r.name=f,r.lookUps=new o(r,s.lookUps),r.backgroundLookUps=new o(r,s.backgroundLookUps),r.startMonth=s.startMonth,c=r.dataType=i.getDataType(s.dataType),y.push(c),y.$br[f]=c,l.$br[f]=l.length,l.push(f),a.$br[f]=r,a.push(r),!u.count&&r.length&&(u.count=r.length),r.setDefaultMapping(this.getDefaultMapping()),c==="date"||c==="datetime")for(h=r.lookUps,e=0,p=h.length;e<p;++e)h[e]=h[e]===""||h[e]===null?null:n.utils.datetimeFromJSON(h[e]);u.startMonth=t.startMonth}},i.prototype.getColumns=function(){return this._fields.slice(0)},i.prototype.getColumnTypes=function(){return this._columnTypes.slice(0)},i.prototype._createSubDateColumns=function(n,t){var u=this,a=n.name,y=n.displayName||n.name,e={year:[],fiscalYear:[],quarter:[],month:[],week:[],day:[]},c,v,o,r,l,f,h,s;if(t==="datetime"&&$.extend(e,{hour:[],minute:[],second:[]}),n.dateSubFields!==undefined&&n.dateSubFields!==null)return!0;else n.dateSubFields=31,t==="datetime"&&(n.dateSubFields=n.dateSubFields|224);c=n.startMonth;this.buildSubData(n,e,u.count,t,c);v="number";for(f in e)o=a+"\x1d"+f+"\x1d",r=new ct(e[f]),r.name=o,l=v,r.dataType=l,r.type="subDate",r.subDatePart=f,r.displayName=u.getSubDateDefaultDisplayName(f,y),u.table.$br[o]&&(r.displayName=u.table.$br[o].displayName),u.table.$br[o]=r,u._columnTypes.$br[o]=l,i.buildLookUps(r);for(f in e)h=new ht,h.columnName=e[f].name,h.funcType=3,u.setColumnSortInfo(h);return s=new ht,s.columnName=a+"\x1dmonth\x1d",s.funcType=1,s.setting=c+1,u.setColumnSortInfo(s),!0},i.prototype.buildSubData=function(t,i,r,u,f){for(var s,o,e=0;e<r;++e)s=t.lookUps[t[e]],o=undefined,s&&(o=new Date(s)),o===undefined?(i.year[e]=null,i.fiscalYear[e]=null,i.quarter[e]=null,i.month[e]=null,i.week[e]=null,i.day[e]=null,u==="datetime"&&(i.hour[e]=null,i.minute[e]=null,i.second[e]=null)):(i.year[e]=o.getFullYear(),i.fiscalYear[e]=n.utils.getFiscalYear(o,f),i.quarter[e]=n.utils.getFiscalYearQuarter(o,f),i.month[e]=o.getMonth()+1,i.week[e]=n.utils.getFiscalWeek(o,f),i.day[e]=o.getDate(),u==="datetime"&&(i.hour[e]=o.getHours(),i.minute[e]=o.getMinutes(),i.second[e]=o.getSeconds()))},i.prototype.getSubDateDefaultDisplayName=function(t,i){var r;switch(t){case"year":r=n.SR.directives_scenariodimension_datadimensions_year+"("+i+")";break;case"fiscalYear":r=n.SR.directives_scenariodimension_datadimensions_fiscalyear+"("+i+")";break;case"quarter":r=n.SR.directives_scenariodimension_datadimensions_quarter+"("+i+")";break;case"month":r=n.SR.directives_scenariodimension_datadimensions_month+"("+i+")";break;case"week":r=n.SR.directives_scenariodimension_datadimensions_week+"("+i+")";break;case"day":r=n.SR.directives_scenariodimension_datadimensions_day+"("+i+")";break;case"hour":r=n.SR.directives_scenariodimension_datadimensions_hour+"("+i+")";break;case"minute":r=n.SR.directives_scenariodimension_datadimensions_minute+"("+i+")";break;case"second":r=n.SR.directives_scenariodimension_datadimensions_second+"("+i+")";break;case"millisecond":r=n.SR.directives_scenariodimension_datadimensions_millisecond+"("+i+")";break;default:r=i}return r},i.prototype.getColumnSortInfo=function(n){var t=this,i;if(t.table.$br.hasOwnProperty(n))return i=t.table.$br[n],i.getSortInfo()},i.prototype.setColumnSortInfo=function(n){var t=this,i;t.table.$br.hasOwnProperty(n.columnName)&&(i=t.table.$br[n.columnName],i.setSortInfo(n))},i.prototype.getDefaultMapping=function(){var t,n,i;if(!this._defaultMapping){for(t=[],n=0,i=this.count;n<i;++n)t[n]=n;this._defaultMapping=t}return this._defaultMapping},i.prototype.getDefaultMapSet=function(){var t,n,i;if(!this._defaultMapSet){for(t=[],n=0,i=this.count;n<i;++n)t[n]=0;this._defaultMapSet=t}return this._defaultMapSet},i.prototype.addView=function(){var t=n.utils.getGuid("view"),i=this._views[t]=new yt(this);return i.id=t,i},i.prototype.columnRename=function(n,t){this.fire("columnDisplayChanged",{columnName:n,newDisplayName:t})},i.prototype.getColumnFormat=function(n){return this.table.getColumn(n).format},i.prototype.changeColumnFormat=function(n,t){this.table.getColumn(n).format=t;this.fire("columnFormatChanged")},i}(n.EventBase);n.DataSet=s;at=function(){function n(){this.choice={}}return n}();n.SlicerSetting=at;vt=function(){function n(){}return n}();n.SlicerChioce=vt;y=function(t){function i(n,i){var r=t.call(this)||this;return r._init(n,i),r}return __extends(i,t),i.prototype.onChoiceChange=function(n){var u=this,r,f={added:[],removed:[]},i,t;switch(this._type){case 10:i=n.items;t=this.changeExact;break;case 20:case 21:case 22:i={min:n.min,max:n.max,minIncluded:n.minIncluded,maxIncluded:n.maxIncluded};t=this.changeRange;break;case 30:case 31:case 32:i=n.value;t=this.changeStr;break}return t&&(r=t.call(u,i,f)),r&&u._onChange(f),r},i.prototype.fillChangeSet=function(t,i){var r=this,u=this._column.getOrderedIndexes(),f=this._column.getEntriesMapping();i.added&&i.added.forEach(function(i){r.fillArray(f[n.utils.entryKey(i)],t.added,u)});i.removed&&i.removed.forEach(function(i){r.fillArray(f[n.utils.entryKey(i)],t.removed,u)})},i.prototype.fillArray=function(n,t,i){if(n&&t)for(var r=n.start;r<=n.end;++r)t.push(i[r])},i.prototype.getFieldsItems=function(t){var i=[];return t.forEach(function(t){typeof t=="string"&&t.indexOf("\x1d")!=-1?i.push(t.split("\x1d")):i.push(n.utils.entryKey(t))}),i},i.prototype.changeExact=function(t,i){var l,s,h,a;t||(t=[]);var r=this,u=r._choices,f=[],c,e=[],o=[];for(f.mapping={},l=function(i){var o=t[i],r=n.utils.entryKey(o),c=s.getFieldsItems(s._fieldValues),h=c.filter(function(n){return Array.isArray(n)?n.indexOf(r)!=-1:n===r});if(h.length<=0)return"continue";c=s.getFieldsItems(u);h=c.filter(function(n){return Array.isArray(n)?n.indexOf(r)!=-1:n===r}).map(function(n){return Array.isArray(n)?n.join("\x1d"):n});h.length>0?h.forEach(function(n){delete u.mapping[n]}):e.push(o);f.push(o);f.mapping[r]=o},s=this,h=0;h<t.length;++h)l(h);r._choices=f;for(a in u.mapping)o.push(u.mapping[a]);return c=!!(e.length||o.length),c&&this.fillChangeSet.call(r,i,r._exclude?{added:o,removed:e}:{added:e,removed:o}),c},i.prototype.changeRange=function(t,i){var r=this,tt=!!t.minIncluded,it=!!t.maxIncluded,b,k,rt,ut,u,o=r._column.getSortedEntries(),s=o.length,f,ft=r._column.getEntriesMapping(),et=r._dataSet.count,st=et-1,ht=0,c=n.utils.bSearchBy(function(n){return o[n]}),d,g,e,p,h,w,ot;t.min===undefined||isNaN(t.min)?(ut=0,k=0):(d=tt?c.left(t.min,0,s-1):c.right(t.min,0,s-1),u=o[d],f=ft[n.utils.entryKey(u)],e=n.utils.valueCompare(u,t.min),e<0||e===0&&!tt?(++d,k=f.end+1):k=f.start);t.max===undefined||isNaN(t.max)?(rt=s-1,b=et-1):(g=it?c.right(t.max,0,s-1):c.left(t.max,0,s-1),u=o[g],f=ft[n.utils.entryKey(u)],e=n.utils.valueCompare(u,t.max),e<0||e===0&&it?b=f.end:(--g,b=f.start-1));var l=r._choices,a=[],v=[],y=[],nt;for(a.mapping={},p=ut;p<=rt;++p)h=o[p],w=n.utils.entryKey(h),l.mapping.hasOwnProperty(w)?delete l.mapping[w]:v.push(h),a.push(h),a.mapping[w]=h;r._choices=a;for(ot in l.mapping)y.push(l.mapping[ot]);return nt=!!(v.length||y.length),nt&&this.fillChangeSet.call(r,i,r._exclude?{added:y,removed:v}:{added:v,removed:y}),nt},i.prototype.changeStr=function(t,i){var r=this,b=r._type,k=r._column.dataType==="string",w=r._fieldValues,d=r._column.getEntriesMapping(),v,h=[],e=[],y=r._choices,c=[],o,l,s;if(c.mapping={},t||t===0)for(o=""+t,l=0;l<w.length;++l){var u=w[l],p=n.utils.entryKey(u),f=void 0,a=void 0;if(u!=null){s=k?u:""+u;switch(b){case 30:f=s.indexOf(o);a=!f;break;case 31:f=s.lastIndexOf(o);a=f===s.length-o.length;break;case 32:f=s.indexOf(o);a=f!==-1;break}}a?(c.push(u),c.mapping[p]=u,y.mapping.hasOwnProperty(p)||h.push(u)):y.mapping.hasOwnProperty(p)&&e.push(u)}else e=y.slice(0);return r._choices=c,v=!!(h.length||e.length),v&&this.fillChangeSet.call(r,i,r._exclude?{added:e,removed:h}:{added:h,removed:e}),v},i.prototype._init=function(t,i){var r=this;r.id=t.id;r._dataView=i;r._dataSet=i.getDataSet();r._column=r._dataSet.table.getColumn(t.field);r._type=t.type||10;r._exclude=!!t.exclude;r._field=t.field;r._fieldValues=r._column.getEntries();r._choices=r._fieldValues.slice(0);r._fieldValues.mapping={};r._choices.mapping={};r._fieldValues.forEach(function(t){var i=n.utils.entryKey(t);r._fieldValues.mapping[i]=t;r._choices.mapping[i]=t})},i.prototype.getColumnName=function(){return this._field},i.prototype.choiceChange=function(n){this._lastChoice=n;this.onChoiceChange.call(this,n)},i.prototype.checkActiveEntry=function(t,i){return t!==this._field?!0:!!(this._choices.mapping.hasOwnProperty(n.utils.entryKey(i))^this._exclude)},i.prototype._onChange=function(n){this.fire("change",{slicer:this,changes:n})},i}(n.EventBase);n.Slicer=y;yt=function(t){function i(n){var i=t.call(this)||this;return i._init(n),i}return __extends(i,t),i.prototype._init=function(n){this._dataSet=n;this._slicers=[];this._defaultMapping=n.getDefaultMapping();this._mapCache=n.getDefaultMapSet().slice(0);this._itemStates={}},i.prototype.getDataSet=function(){return this._dataSet},i.prototype.getMapping=function(){return this._mapping||this._defaultMapping},i.prototype.isEntryActive=function(n){return!this._mapCache[n]},i.prototype.addSlicer=function(t,i){var e,u;if(!t||!t.field)return null;var r=this,o=i||n.utils.getGuid("slicer"),f=r._slicers[o]=new y(t,this);if(r._slicers.push(f),f.id=o,e=!1,u=r._dataSet.table.getColumn(t.field),(!u||u.disable)&&(e=!0),!e&&r._itemStates&&!r._itemStates[t.field]){var s={},h=u.getOrderedIndexes(),c=u.getEntriesMapping(),l=u.getEntries();l.forEach(function(t){var f=s[n.utils.entryKey(t)]={activeCount:0,indexes:[],entryStates:[]},e=c[n.utils.entryKey(t)],i,u;if(e)for(i=e.start;i<=e.end;++i)u=h[i],f.indexes.push(u),(f.entryStates[u]=r.isEntryActive(u))&&++f.activeCount});r._itemStates[t.field]=s}f.on("change",function(n){r._onSlicerChange(n)});return f},i.prototype._onSlicerChange=function(t){var i=this,u,f;if(i._itemStates){var r=[],e=t.slicer,o=e.getColumnName(),s=function(n){n!==o&&r.push({field:n,states:i._itemStates[n],column:i._dataSet.table.getColumn(n),slicer:_.find(i._slicers,function(t){return t.getColumnName()===n})})};for(f in i._itemStates)s(f);u=function(t,i){for(var u=0;u<r.length;u++){var f=r[u],e=f.column,h=e.lookUps?e.lookUps[e[t]]:e[t],o=f.states[n.utils.entryKey(h)],s=i-(f.slicer.checkActiveEntry(f.field,h)?0:1)==0;s!=o.entryStates[t]&&(o.entryStates[t]=s,o.activeCount+=s?1:-1)}}}i._updateMapping(t.changes,u)},i.prototype._updateMapping=function(n,t){function f(n,i){n.forEach(function(n){r[n]+=i;t&&t(n,r[n])})}var r=this._mapCache,u,i,e;for(f(n.added,-1),f(n.removed,1),u=[],i=0,e=r.length;i<e;++i)r[i]||u.push(i);this._mapping=u;this._onMappingChange()},i.prototype._onMappingChange=function(){this._onChange(this._mapping)},i.prototype._onChange=function(n){this.fire("change",{mapping:n})},i.prototype.addPivot=function(){return this._pivot=new u(this),this._pivot},i}(n.EventBase);u=function(i){function r(n){var t=i.call(this)||this;return t._init(n),t}return __extends(r,i),r.getColumnsCache=function(t,i){var r={};return t&&t.dimensions.forEach(function(t){var u=i.getColumn(t),o=u.dataType==="datetime"||u.dataType==="date",f,e;f=o?function(n){return n==null?'\0':n.valueOf()}:n.utils.entryKey;e=u.lookUps.reduce(function(n,t,i){return n[f(t)]=i,n},{});u.lookUps.getPos=function(n){return e[f(n)]};r[t]=u}),r},r.prototype._init=function(n){var t=this;t._aggregateData=null;t._setting=new h;t._privateView=n;t._setting.onChanged=function(){t._aggregate.call(t)};t._setting.on(h.FilterAddedEvent,function(n){var i=t._privateView.addSlicer(n.data);n.slicer=i});t._aggregate()},r.prototype.getSetting=function(){return this._setting},r.prototype._getDummyColumn=function(){var n=this._cachedDummyColumn,t;if(!n){n=[];var r=this._privateView.getDataSet(),i=r.table,u=i[0]&&i[0].length;for(t=0;t<u;t++)n.push(t);this._cachedDummyColumn=n}return n},r.prototype._aggregate=function(){try{this._aggregateCore()}catch(n){}this.fire("change",{pivot:this});$(document).trigger("pivotChange",this)},r.prototype._aggregateCore=function(){var kt=this._privateView.getDataSet(),dt=kt.table,ft,gt,ht,yt,e,st,pt,pi,wt,bt;if(kt){var a=this._setting.getDimensions(),ut=[],o=[];if(a.length)for(o=[],ft=0;ft<a.length;++ft)gt=a[ft],ht=dt.getColumn(gt),ut.push(ht),o.push(ht.lookUps.length);for(var ct=this._setting.getMeasures(),et=this._setting.getTotalMeasures(),ni=this._privateView.getMapping(),wi=ni.length,y,s,f,i,bi,p,w,b,k,d,g,nt,tt,it,lt,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,r=new li,ot={},h=[],u=0,rt=0,c=0,ki=0,l=0,n=0,ai=[],vi={},yi,at=o.length,vt=!1,u=0;u<ct.length;++u)e=ct[u],e.getAggregatorType()===t.NONE&&(vt=!0),st=e.getMetas(),i=e.getColumnName(),st.forEach(function(n){r[n+"_"+i]={}}),ot[i]||(ot[i]=!0,h.push(i));for(yt=0,et&&(yt=et.length),u=0;u<yt;++u)e=et[u],e.getAggregatorType()===t.NONE&&(vt=!0),st=e.getMetas(),i=e.getColumnName(),st.forEach(function(n){r[n+"_"+i]={}}),ot[i]||(ot[i]=!0,h.push(i));for(vt&&(pt=this._getDummyColumn(),ut.push(pt),o.push(pt.length),at=o.length),u=0,y=[1];u<at;++u)y.push(y[u]*o[u]);for(rt=0,yi=h.length;rt<yi;++rt)if(i=h[rt],p=r[t.CNT+"_"+i],ti=p!==undefined,w=r[t.SUM+"_"+i],ii=w!==undefined,b=r[t.SSQ+"_"+i],ri=b!==undefined,k=r[t.MIN+"_"+i],ui=k!==undefined,d=r[t.MAX+"_"+i],fi=d!==undefined,g=r[t.DST+"_"+i],ei=g!==undefined,nt=r[t.FIRST+"_"+i],oi=nt!==undefined,tt=r[t.LAST+"_"+i],si=tt!==undefined,it=r[t.CUSTOM+"_"+i],hi=it!==undefined,lt=r[t.NONE+"_"+i],ci=lt!==undefined,s=dt.getColumn(i),pi=!!s.lookUps,s)for(u=0;u<wi;++u){if(l=ni[u],rt)n=ai[u];else{for(n=0,c=0;c<at;++c)if(n=ut[c][l]<0?-1:n+y[c]*ut[c][l],n===-1)break;ai[u]=n;n>=0&&(vi[n]=!0)}n<0||(f=pi?s.lookUps[s[l]]:s[l],f!=null&&(ti&&(p[n]===undefined&&(p[n]=0),p[n]+=1),ii&&(w[n]===undefined&&(w[n]=0),w[n]+=f),ri&&(b[n]===undefined&&(b[l]=0),b[n]+=f*f),ui&&(k[n]===undefined||f<k[n])&&(k[n]=f),fi&&(d[n]===undefined||f>d[n])&&(d[n]=f),ei&&(g[n]===undefined&&(g[n]={}),g[n][f]=!0),oi&&(nt[n]===undefined&&(nt[n]=[]),nt[n].push({v:f,i:u})),si&&(tt[n]===undefined&&(tt[n]=[]),tt[n].push({v:f,i:u})),hi&&(it[n]===undefined&&(it[n]=[]),it[n].push(f)),ci&&(lt[n]=f)))}r.vectors=vi;wt=new v;a.forEach(function(n){wt.push(n)});r.dimensions=wt;r.dimensions.$br=a.reduce(function(n,t,i){return n[t]=i,n},{});bt=new v;h.forEach(function(n){bt.push(n)});r.measures=bt;r.measures.$br=h.reduce(function(n,t,i){return n[t]=i,n},{});r.values=ct;r.totalValues=et;r.dimSize=o;r.weights=y;this._aggregateData=r}},r.prototype.hasData=function(n){var r=this._aggregateData,t,e,i,u,f;if(!r||(t=this._setting.getAllValues(!1,n),t.length===0))return!1;for(e=function(n,i){var u=t[n],f=_.find(r.values,function(n){return n.getAggregatorType()===u.getAggregatorType()&&n.getColumnName()===u.getColumnName()});if(f&&Object.keys(r[f.getMetas()[0]+"_"+u.getColumnName()]||[]).length>0)return{value:!0}},i=0,u=t.length;i<u;i++)if(f=e(i,u),typeof f=="object")return f.value;return!1},r.prototype.getData=function(n,i){var u,s,r,h;if(n===18)return i||(i=new tt),u=new ai(this,n,i),u.buildPivotSheetData();else if(n===16){var c=this._setting._values[0][0].getColumnName(),l=t.NONE+"_"+c,f=this._aggregateData[l],e=[],o={};for(s in f)r=f[s],o[r]||(e.push(r),o[r]=!0);return e}else return h=new d(this,n),h.buildChartData()},r.prototype.getDataset=function(){return this._privateView.getDataSet()},r}(n.EventBase);n.Pivot=u;h=function(t){function i(){var i=t.call(this)||this;return i._rowDimensions=[],i._columnDimensions=[],i._values=[],i.id=n.utils.getGuid("pivot"),i.onChanged=null,i}return __extends(i,t),i.getRealColumnNames=function(n){var t=[];return n instanceof Array&&n.forEach(function(n){if(n)if(n.method)t.push(n.name);else if(n.type==="hierarchy")for(var i=0,r=n.activePath.length;i<=r;i++)t.push(n.subDims[i].name);else if(n.name)t.push(n.name);else if(typeof n=="string")t.push(n);else throw"PivotSetting: this is not a good column object.";}),t},i.getRevisedItems=function(n,t){return _.reduce(n,function(n,i){if(i.type==="hierarchy"){var u=_.cloneDeep(i),r=u.activePath,f=u.subDims;_.eachRight(i.subDims,function(n,t){r.length>t&&r.splice(t,1);f.splice(t,1);f.length===r.length&&r.length>0&&(r.length=r.length-1)});f.length===0||(n[n.length]=t?u:u.name)}else n[n.length]=t?i:i.name;return n},[])},i.prototype.addFilter=function(n){var t=this;n.forEach(function(n){var u=$.extend({},n),f={data:u,slicer:null},r;t.fire(i.FilterAddedEvent,f);r=f.slicer;r||console.debug("addFilter() should be called after event binding.");r.choiceChange(u.choice)});this._trigger("change")},i.prototype.getRows=function(n,t){return i.getRevisedItems(this._rowDimensions,n)},i.prototype.getColumns=function(n,t){return i.getRevisedItems(this._columnDimensions,n)},i.prototype._updateValue=function(n){for(var r=this,u=function(t,i){var u=n[t];u.forEach(function(n,t){u[t]=n.valueType===2?new ki(r,n):new f(n)})},t=0,i=n.length;t<i;t++)u(t,i);this._values=n},i.prototype.getValues=function(n){return this._values.map(function(t){for(var r,f,u=[],i=0,o=t.length;i<o;i++)(r=t[i],f=r instanceof e,n||!f)&&u.push(r);return u})},i.prototype.getAllValues=function(n,t){var r=_.flatten(this._values),i=[];return _.each(r,function(n){var r,u;(t||!n.invalid)&&(n instanceof e?(r=n.getMeasure(),i[i.length]=new f(r)):(u=n,i[i.length]=u))}),_.uniq(i,function(t){return n?t.getId():t.getName()})},i.prototype.getDimensions=function(n,t){function u(n,t){t&&t.forEach(function(t){if(t.type==="hierarchy"){var i=t.subDims.slice(0);i.length=t.activePath.length+1;u(n,i)}else n[t.name]=!0})}function e(n){var t=[];for(var i in n)t.push(i);return t}function f(n,t){t&&t.forEach(function(t){if(t.type==="hierarchy"){var i=t.subDims.slice(0);f(n,i)}else n.push(new a(t.name,t.display))})}var i,r;return n?(i=[],f(i,this.getRows(!0,t)),f(i,this.getColumns(!0,t)),i):(r={},u(r,this.getRows(!0,t)),u(r,this.getColumns(!0,t)),e(r))},i.prototype.getMeasures=function(){var n=this.getAllValues();return n.map(function(n){var t;switch(n.getAggregatorType()){case"sum":t=new gt(n);break;case"cnt":t=new ni(n);break;case"max":t=new ti(n);break;case"min":t=new ii(n);break;case"avg":t=new ri(n);break;case"dst":t=new ui(n);break;case"first":t=new fi(n);break;case"last":t=new ei(n);break;case"custom":t=new oi(n);break;case"none":t=new si(n);break}return t})},i.prototype.getTotalMeasures=function(){var n=this.getAllValues();return n.map(function(n){var t;switch(n.getTotalAggregatorType()){case"sum":t=new gt(n);break;case"cnt":t=new ni(n);break;case"max":t=new ti(n);break;case"min":t=new ii(n);break;case"avg":t=new ri(n);break;case"dst":t=new ui(n);break;case"first":t=new fi(n);break;case"last":t=new ei(n);break;case"custom":t=new oi(n);break;case"none":t=new si(n);break}return t})},i.prototype.getSchema=function(n,t,r){var u=[];return t||u.push("%%"),n===1&&i.getRealColumnNames(this.getRows(!1,r)).forEach(function(n){u.push(n)}),t||u.push("%%"),n===2&&i.getRealColumnNames(this.getColumns(!1,r)).forEach(function(n){u.push(n)}),t||u.push("%%"),n===4&&this.getValues(!1).forEach(function(n){i.getRealColumnNames(n).forEach(function(n){u.push(n)})}),t||u.push("%%"),n===32,u},i.prototype.setSortInfo=function(n){this._sortInfo=n;this._trigger("change")},i.prototype.getSortInfo=function(t){function f(n){return n?n.method+"$"+n.name+"$"+n.idx:""}function h(n){for(var i=!1,t=0;t<3;t++)if(n[t]instanceof Date){i=!0;break}return i}var e;if(!this._sortInfo)return e;var i=t,o=this.getAllValues(!0,i),s=o.reduce(function(n,t){return n[f(t.toJSON(i))]=!0,n},{}),r={},u=this._sortInfo;return this.getDimensions(!1,i).forEach(function(i){var e=u[i],o;e&&(t&&e.manual&&h(e.manual)&&(e.manual=e.manual.map(function(t){return t==null?null:n.utils.datetimeToJSON(t)})),e.type!==4||(o=f(e.sortBy.measure),s[o]))&&(r[i]=u[i])}),r},i.prototype.update=function(n){n.rows&&(this._rowDimensions=n.rows);n.columns&&(this._columnDimensions=n.columns);n.values&&this._updateValue(n.values);this._trigger("change")},i.prototype._trigger=function(n){switch(n){case"change":typeof this.onChanged=="function"&&this.onChanged();this.fire("change");break;default:}},i.FilterAddedEvent="filteradded",i}(n.EventBase);n.PivotSetting=h;var pt=function(){function n(n,t){this.formatterCache={};this.scenarioType=t;this.pivot=n;this.setting=n._setting;this.vp=new kt(n);var i=n._setting.getSortInfo();this.sortManager=new bi(n,i);this.columns=u.getColumnsCache(n._aggregateData,n._privateView.getDataSet().table)}return Object.defineProperty(n.prototype,"table",{get:function(){return this.pivot._privateView.getDataSet().table},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"series",{get:function(){return this.setting.getSchema(2,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"axes",{get:function(){return this.setting.getSchema(1,!0)},enumerable:!0,configurable:!0}),n.prototype.mergeAllVectors=function(){var n=$.extend({},this.pivot._aggregateData.vectors);return new nt(Object.keys(n))},n.prototype.buildAllValues=function(n){var i=this,t=[],r=this.setting.getValues(!0);return r.forEach(function(r,u){r.length>0?r.forEach(function(r){if(r.getValueType()===1)i.pivot._aggregateData.values.filter(function(n){return r.isMatchAggregator(n)}).forEach(function(n){t.push(new p(n,r))});else{var u=r;u.update();t.push(new p(u.getAggregator(n,i.vp,i.sortManager),u))}}):t[u]=undefined}),t},n.prototype.buildAllTotalValues=function(n){var i=this,t=[],r=this.setting.getValues(!0);return r.forEach(function(n,r){n.length>0?n.forEach(function(n){n.getValueType()===1&&i.pivot._aggregateData.totalValues.filter(function(t){return n.isMatchTotalAggregator(t)}).forEach(function(i){t.push(new p(i,n))})}):t[r]=undefined}),t},n}(),p=function(){function n(n,t){this.aggregator=n;this.value=t}return n}(),ai=function(t){function u(n,i,r){var u=t.call(this,n,i)||this;return u.startIndex=0,u.subtotalMapping={},u.option=r,u}return __extends(u,t),u.prototype.buildPivotSheetData=function(){if(!this.pivot||!this.pivot._aggregateData)return null;var n=this.mergeAllVectors(),o=this.buildAllValues(n),v=this.buildAllTotalValues(n),r=o.filter(function(n){return!!n}),f=this.series,t=this.axes,y=f.concat(t),i=r.length>1||t.length===0,e=this.buildHeader(n,f,"rowHeader"),u=this.buildHeader(n,t,"colHeader");this.addValueHeaderTo(u,r,1,t.length);var s=this.generateHeaderMapping(e),h=this.generateHeaderMapping(u,i),p=this.vp.getPartitionedVectors(n,y),w=f.length,b=t.length,c=this.transformRowHeader(e,w),l=this.transformColHeader(u,b,i),a=this.generateData(s,h,p,i,r);return this.addSubtotalToData(a,s,h,e.subtotal,u.subtotal,c,l,v,i),{data:{data:a,rowHeader:c,colHeader:l},valueIdentifications:o.map(function(n){return n?n.value.getId():n}),schema:{tableRowLevel:this.series.length,tableColLevel:this.axes.length,valueLevel:i?1:0,measureLength:r.length,rowDim:this.setting.getColumns(!0,!0),colDim:this.setting.getRows(!0,!0)}}},u.prototype.generateData=function(n,t,u,f,e){var o=this,h=this.series,s=h.length;return u.reduce(function(u,h){var a=h.path.slice(0,s),c=h.path.slice(s),v=""+a,l=n[v];return u[l]||(u[l]=[]),e.forEach(function(n,e){var y=n.aggregator,p=n.value,s=new r,w=h[0],b=""+(f?c.concat(e):c),d=t[b],k;s.rowPath=a;s.colPath=c;s.rowStr=v;s.colStr=b;s.vector=w;s.aggratator=y;s.pivotValue=p;s.displayName=p.getDisplay();s.format=p.getFormat(o.table);y instanceof i?(k=p.getId(),s.value=y.getValue(y.getMetaValue(o.pivot._aggregateData,w,k))):s.value=y.getValue(w);u[l][d]=s}),u},[])},u.prototype.addSubtotalToData=function(n,t,i,r,u,f,e,o,s){var h=this,c;f.map(function(n){var t=_.filter(n,function(n){return n.type===32||n.type===64})[0];return t?t:_.last(n)}).forEach(function(r,f){var l;if(r){var c=r.path,a=c+"",e=t[r.path],v=function(t){var f=u[t];o&&o.forEach(function(t,u){var y=t.aggregator,l=t.value,p=s?f.path.concat(u):f.path,w=p+"",b=i[w],o,v;n[e]||(n[e]=[]);o={};v=h.intersection(r.vectors,f.vectors);o.type=r.type?r.type===64?64:32:undefined;o.rowPath=c;o.colPath=p;o.rowStr=a;o.colStr=w;o.vector=v;o.aggratator=y;o.pivotValue=l;o.displayName=l.getDisplay();o.format=l.getFormat(h.table);v.length>0&&(o.value=h.getValue(y,v,l));n[e][b]=o})};for(l in u)v(l)}});c=_.last(e);c&&c.forEach(function(u,f){var e,a,c,l;if(u&&u.type)for(e=0;e<n.length;e++)a=n[e],n[e][f]&&(n[e][f].type=u.type);c=function(f){var c=r[f],l=c.path,a=l+"",e=t[a];o&&o.forEach(function(t,r){var p=t.aggregator,o=t.value,f,y;if(!s||u.path[u.path.length-1]===r){var w=u.path,b=w+"",v=i[b];n[e]||(n[e]=[]);f={};y=h.intersection(c.vectors,u.vectors);f.type=c.type===64?64:32;f.rowPath=l;f.colPath=w;f.rowStr=a;f.colStr=b;f.vector=y;f.aggratator=p;f.pivotValue=o;f.displayName=o.getDisplay();f.format=o.getFormat(h.table);y.length>0&&(f.value=h.getValue(p,y,o));n[e][v]?n[e][v].type=n[e][v].type|f.type:n[e][v]=f}})};for(l in r)c(l)})},u.prototype.getValue=function(n,t,r){var f=this.pivot._aggregateData,u;return n instanceof i?(u=t.reduce(function(t,i){var u=n.getMetaValue(f,i,r.getId());return n.mergeMetaValues(u,t),u},{}),n.getValue(u)):t.reduce(function(t,i){return t+n.getValue(i)},0)},u.prototype.intersection=function(n,t){for(var r,u,e,f={},i=0,o=n.length;i<o;i++)f[n[i]]=!0;for(r=[],i=0,e=t.length;i<e;i++)u=t[i],f[u]&&r.push(u);return r},u.prototype.transformRowHeader=function(n,t){return this.header=[],this.transformRowHeaderTree(n,[],t),this.header},u.prototype.transformRowHeaderTree=function(n,t,i){var s=this,f,e,u,o;if(n.length===0){if(f=[],n.type===32)for(e=0;e<i;e++)u=new r,e===t.length-1&&(u.format=n.format,u.level=t.length+1-1,u.path=n.path,u.value=n.key,u.backgroundValue=n.backgroundValue,u.type=n.type,u.display=n.display,u.vectors=n.vectors),f.push(u);else u=new r,u.format=n.format,u.level=t.length+1,u.path=n.path,u.value=n.key,u.backgroundValue=n.backgroundValue,u.type=n.type,f=t.concat(u),u.vectors=n.vectors,o=!0,f=f.reverse().map(function(n){return o=o&&n.visible,o?n:{}}).reverse();this.header.push(f)}else n instanceof Array&&n.forEach(function(u,f){var o=t,e;n.key!==undefined&&(e=new r,e.format=n.format,e.level=t.length+1,e.value=n.key,e.backgroundValue=n.backgroundValue,e.visible=s.option.headerText===1?!0:f===0,o=t.concat(e));s.transformRowHeaderTree(u,o,i)})},u.prototype.transformColHeader=function(n,t,i){return this.header=[],this.transformColHeaderTree(n,[],0,t,i),this.header},u.prototype.transformColHeaderTree=function(n,t,i,u,f,e,o){var v=this,l,a,s,y,h;if(n.length===0){var p=n.index,w=f?n.path.concat(n.valueId):n.path,b=f?u+1:u,c=new r;for(c.format=n.format,c.path=n.path,c.value=n.key,c.type=n.type,c.display=n.display,c.vectors=n.vectors,c.backgroundValue=n.backgroundValue,t.push(c),l=!0,a=void 0,s=b-1;s>=0;s--)t[s]&&(l=l&&t[s].visible,a=l?t[s].value:undefined),this.header[s]||(this.header[s]=[]),y=this.header[s],h=new r,h.format=t[s]&&t[s].format,h.path=w,h.value=a,h.backgroundValue=t[s]&&t[s].backgroundValue,h.type=n.type,h.display=t[s]?t[s].display:undefined,h.level=s+1,h.displayName=n.displayName,h.vectors=n.vectors,h.aggregator=n.aggregator,(e===32&&h.level>=o||e===64)&&(h.level=o,h.type=e),y[p]=h}else n instanceof Array&&n.forEach(function(s,h){var l=t.slice(0),a=i+1,c;n.key!==undefined&&(c=new r,c.format=n.format,c.value=n.key,c.visible=v.option.headerText===1?!0:h===0,c.display=n.display,c.backgroundValue=n.backgroundValue,l=t.concat(c));e===undefined&&(n.type===32&&(e=n.type,o=i-1),n.type===64&&(e=n.type,o=1));v.transformColHeaderTree(s,l,a,u,f,e,o)})},u.prototype.generateHeaderMapping=function(n,t){return this.mapping={},this.generateHeaderMappingTree(n,t),this.mapping},u.prototype.generateHeaderMappingTree=function(n,t){var r=this,i;n.length===0?(i=t?n.path.concat(n.valueId):n.path,this.mapping[i.toString()]=n.index):n instanceof Array&&n.forEach(function(n){r.generateHeaderMappingTree(n,t)})},u.prototype.getColumnFormatter=function(t){var i=this.table.getColumn(t);return n.utils.getFormatter(i)},u.prototype.getColumnValue=function(t,i){if(n.utils.isEmpty(i))return i;var u=this.table.getColumn(t),r=i;if(u.type==="subDate")switch(u.subDatePart){case"quarter":r=n.SR["datetime_quarter_q"+i];break;case"month":r=n.SR["datetime_month_m"+i];break;default:r=i;break}return r},u.prototype.buildHeader=function(n,t,i){this.startIndex=0;this.subtotalMapping={};var r=this.buildHeaderTree(n,t,i,0,[]);return r.subtotal=this.subtotalMapping,r},u.prototype.buildHeaderTree=function(t,i,r,u,f){var a=this,h,s,l,e;if(u===i.length)return h=new w,h.path=f,h.vectors=t,h.index=this.startIndex++,h;else{var c=new w,tt=[],o=i[u],b=this.sortManager.getCmpFunc(o),k=this.columns[o].lookUps.getPos,y=this.vp.filteredLookUps(o,t),d=this.columns[o].backgroundLookUps,p=this.pivot._aggregateData.dimensions.$br[o],g=this.pivot._aggregateData.weights[p+1],nt=this.pivot._aggregateData.weights[p],v={};if(t.forEach(function(n){var t=~~(parseInt(n)%g/nt),i=v[t]||[];i.push(n);v[t]=i}),y.sort(b).forEach(function(n,t){var s=k(n),h=v[s],e;h&&h.length&&(e=a.buildHeaderTree(h,i,r,u+1,f.concat(s)),e.key=a.getColumnValue(o,n),e.format=a.getColumnFormatter(o),e.backgroundValue=d[s],c[t]=e,c.path=f)}),c.length=y.length,s=!1,l=u===0,l){if(r==="colHeader")switch(this.option.grandTotals){case 3:case 1:s=!0}else if(r==="rowHeader")switch(this.option.grandTotals){case 4:case 1:s=!0}}else this.option.subtotals!==1&&(s=!0);return e=[],e.path=f,e.vectors=t,e.index=this.startIndex,e.type=l?64:32,e.level=u,e.display=!0,e.key=l?n.SR.spread_pivot_table_grand_total:n.SR.spread_pivot_table_subtotal,s||(e.display=!1),(!l||s)&&(this.subtotalMapping[f.toString()]={vectors:t,index:this.startIndex,path:f,type:e.type},c.push(e),this.startIndex++),c}},u.prototype.addValueHeaderTo=function(n,t,i,r){this.addValueHeaderToTree(t,n,0)},u.prototype.addValueHeaderToTree=function(n,t,i){var r=this;t.length===0?n&&n.forEach(function(i,r){var u=new w,e=i.aggregator,f=i.value;u.displayName=f.getDisplay();u.key=f.getDisplay();u.path=t.path;u.vectors=t.vectors;u.valueId=r;u.index=t.index*n.length+r;u.aggregator=e;t.push(u)}):t instanceof Array&&t.forEach(function(t){r.addValueHeaderToTree(n,t)})},u}(pt),nr=function(){function n(){}return n}(),w=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(Array),wt=function(){function n(){}return n}();n.SeriesListItem=wt;c=function(n){function t(t){var i=n.call(this)||this,r,u;if(t)for(r=!1;!r;)u=t.splice(0,1e4),i.push.apply(i,u),u.length<1e4&&(r=!0);return i}return __extends(t,n),t}(Array);b=function(){function n(){}return n}();n.PivotChartOption=b;k=function(){function n(){}return n}();n.PivotChartSchemaOption=k;d=function(t){function r(){var n=t!==null&&t.apply(this,arguments)||this;return n.seriesVectsCache={},n.axisLookUpsCache={},n}return __extends(r,t),Object.defineProperty(r.prototype,"series",{get:function(){return this.setting.getSchema(1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"axes",{get:function(){return this.setting.getSchema(2,!0)},enumerable:!0,configurable:!0}),r.prototype.buildChartData=function(){var i=this.mergeAllVectors(),r=this.buildAllValues(i),n,t;return this.sortedSeriesKeyArray=this.buildSeriesList(i,r,this.sortManager),n=new b,n.data=this.buildTrellis(i,r,0,[]),t=new k,t.values=this.setting.getValues(!0),t.series=this.series.slice(0),t.axes=this.axes.slice(0),n.shema=t,n.series=this.sortedSeriesKeyArray,n},Object.defineProperty(r.prototype,"isScatterValues",{get:function(){return this.scenarioType===23||this.scenarioType===24},enumerable:!0,configurable:!0}),r.prototype.buildSeriesList=function(n,t,i){var r=this,f,u,s;if(this.series.length===0)return f=new c(t.map(function(n){return[r.toValueObj(n)]})),this.bindBackReference(f);var h=this.series.length,e=this.series.map(function(n,t){return i.getPosCmpFunc(n)}),l=this.vp.getPartitionedVectors(n,this.series).filter(function(n){return n.length>0}).sort(function(n,t){for(var r,i=0;i<h;){if(r=e[i]&&e[i](n.path[i],t.path[i]),r!==0)return r;i++}return r}),o=new c(l.map(function(n){return n.path.map(function(n,t){return r.columns[r.series[t]].lookUps[n]})}));return t.length<2?this.bindBackReference(o):(u=[],o.forEach(function(n,i){r.isScatterValues?u.push(n):t.forEach(function(t){u.push(n.concat(r.toValueObj(t)))})}),s=new c(u),this.bindBackReference(s))},r.prototype.toValueObj=function(n){var t=null;return n!==null&&(t=new wt,t.display=n.value.getDisplay(),t.name=n.value.getName(),t.idx=n.value.getIndex(),t.id=n.value.getId()),t},r.prototype.bindBackReference=function(n){var t=this;if(!n)throw"getData error.";return n.$br=n.reduce(function(n,i,r){var u=t.getSeriesAndValueArrayHashkey(i);return n[u]=r,n},{}),n},r.prototype.buildTrellis=function(n,t,i,r){return this.buildCellData(n,i+1,t,r)},r.prototype.buildCellData=function(n,t,i,r){var u=this.getAxisLookUps(r,n),e=this.buildSeriesVectsList(n,i),o=this.buildSeriesValues(e,u),f=new vi(o);return f.axes=u,f},r.prototype.buildSeriesVectsList=function(n,t){var i=this,f=this.pivot._aggregateData,s;n.forEach(function(n){var t=i.series.reduce(function(t,r){var u=f.dimensions.$br[r],e=Math.floor(parseInt(n)%f.weights[u+1]/f.weights[u]);return t.key+="d"+u+"r"+e,t.entries.push(i.columns[r].lookUps[e]),t},new pi);i.seriesVectsCache.hasOwnProperty(t.key)||(i.seriesVectsCache[t.key]=new yi,i.seriesVectsCache[t.key].vectors=[],i.seriesVectsCache[t.key].entries=t.entries);i.seriesVectsCache[t.key].vectors.push(n)});var r=[],e=t.length,u=0,h=function(n){var h=o.seriesVectsCache[n],s,f;e>1||n===""?o.isScatterValues?(f=new g,f.vectors=h.vectors,f.entryKey=h.entries,s=r[u]=f,t.forEach(function(n){n?(s.valueFormats.push(n.value.getFormat(i.table)),s.values.push(n.value),s.aggregators.push(n.aggregator)):(s.valueFormats.push(undefined),s.values.push(undefined),s.aggregators.push(undefined))})):t.forEach(function(n,t){if(n){var f=new g;f.vectors=h.vectors;f.valueFormats.push(undefined);f.valueFormats.push(n.value.getFormat(i.table));f.values.push(undefined);f.values.push(n.value);f.aggregators.push(undefined);f.aggregators.push(n.aggregator);f.entryKey=h.entries.concat({display:n.value.getDisplay(),name:n.value.getName(),idx:n.value.getIndex()});r[t+u*e]=f}else r[t+u*e]=undefined}):(f=new g,f.vectors=h.vectors,f.valueFormats.push(undefined),f.valueFormats.push(t[0].value.getFormat(o.table)),f.values.push(undefined),f.values.push(t[0].value),f.aggregators.push(undefined),f.aggregators.push(t[0].aggregator),f.entryKey=h.entries,r[u]=f);u++},o=this;for(s in this.seriesVectsCache)h(s);return r},r.prototype.buildSeriesValues=function(n,t){var i=this,r=this.pivot._aggregateData;return n.map(function(n){if(n){var f=n.vectors.map(function(u){var e=i.axes.map(function(n){var t=r.dimensions.$br[n],f=Math.floor(parseInt(u)%r.weights[t+1]/r.weights[t]);return i.columns[n].lookUps[f]}),f=new bt;return f.id=u,f.axis=e,f.axisId=t.getIndexById(u),n.aggregators[0]&&(f.x=i.getValue(n.aggregators[0],n.values[0],u)),n.aggregators[1]&&(f.y=i.getValue(n.aggregators[1],n.values[1],u)),n.aggregators[2]&&(f.z=i.getValue(n.aggregators[2],n.values[2],u)),f}),e=i.getSeriesAndValueArrayHashkey(n.entryKey),u=new l;return u.id=i.sortedSeriesKeyArray.$br[e],u.values=f,u.key=n.entryKey,u.valueFormats=n.valueFormats,u}return new l})},r.prototype.getValue=function(t,r,u){var f,e;return t instanceof i?(f=t.getValue(t.getMetaValue(this.pivot._aggregateData,u,r.getId())),n.utils.getRoundedFloatingNumber(f)):(e=t,f=e.getValue(u),n.utils.getRoundedFloatingNumber(f))},r.prototype.getAxisLookUps=function(n,t){var i=this,r,u,f;return this.axes.length===0?(r=[[]],r.getIndexById=function(){return 0},r):(n=[],u=n.reduce(function(n,t){return n+t},"p"),this.axisLookUpsCache[u]||(f=this.vp.getPartitionedVectors(t,[]),f.forEach(function(n){var f=n.path.reduce(function(n,t){return n+t},"p"),t=0,e=i.vp.getPartitionedVectors(n,i.axes.slice(t,t+1)),r={index:0},u=i.buildSortedAxis(e,t,r);u.getIndexById=function(n){return r[n]};i.axisLookUpsCache[f]=u})),this.axisLookUpsCache[u])},r.prototype.buildSortedAxis=function(n,t,i){var r=this,u=[],f=0,e={},o=this.sortManager.getPosCmpFunc(this.axes[t]),s=n.map(function(n){var t=n.path[0];return e[t]=n,t}),h=o==null?s.sort():s.sort(o);return t<this.axes.length?h.forEach(function(n){var c=e[n],s=t+1,l=r.vp.getPartitionedVectors(c,r.axes.slice(s,s+1)),a=i.index,o=r.buildSortedAxis(l,s,i),h;o.count>0&&(h=c.path[0],o.key=r.columns[r.axes[t]].lookUps[h],o.entryPos=h,o.axisId=a,u.push(o));f+=o.count}):(n.reduce(function(n,t){return t.forEach(function(t){n.push(t);i[t]=i.index}),f++,n},u),i.index++),u.count=f,u},r.prototype.getSeriesAndValueArrayHashkey=function(n){if(!n)return"";var t="\x1d,\x1d",i="\x1d_\x1d";return n.reduce(function(n,r){var u;return u=r==null?'\0':r.display?[r.idx,r.name].join(i):r.valueOf(),n+t+u},"")},r}(pt);n.PivotChartDataBuilder=d;bt=function(){function n(){}return n}();l=function(){function n(){}return n}();n.SeriesList=l;var vi=function(n){function t(t){for(var i=n.call(this)||this,u=!1,r;!u;)r=t.splice(0,1e4),i.push.apply(i,r),r.length<1e4&&(u=!0);return i}return __extends(t,n),t}(Array),yi=function(){function n(){}return n}(),g=function(){function n(){this.valueFormats=[];this.values=[];this.aggregators=[]}return n}(),pi=function(){function n(){this.key="";this.entries=[]}return n}(),tr=function(){function n(){this.index=0}return n}(),wi=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.getIndexById=function(n){return 0},t}return __extends(t,n),t}(Array);n.SortedAxisList=wi;var kt=function(){function n(n){this._pivot=n;this._pivotSetting=n.getSetting();var t=this._pivot._aggregateData,i=this._pivot._privateView.getDataSet().table;this._columns=u.getColumnsCache(t,i);this._aggregated=t}return n.prototype.getVectors=function(){return Object.keys($.extend({},this._aggregated.vectors))},n.prototype.getValue=function(n,t,i){return n.getValue(n.getMetaValue(this._aggregated,t,i))},n.prototype.getPartitionedVectors=function(n,t){var s=this,u=this._aggregated,i=[],e=new nt(n.slice(0)),o,r,f;for(e.path=[],i.push(e),o=function(n,r){for(var h=[],c=u.dimensions.$br[t[n]],l=u.weights[c+1],a=u.weights[c],f,e,o,s;i.length>0;){f=i.shift();e=f.reduce(function(n,t){var i=~~(parseInt(t)%l/a);return(n[i]=n[i]||[]).push(t),n},{});for(o in e)s=new nt(e[o]),s.path=f.path.concat(parseInt(o,10)),h.push(s)}i=h},r=0,f=t.length;r<f;r++)o(r,f);return i},n.prototype.getWeight=function(n){var t=this._aggregated,i=t.dimensions.$br[n];return{ceil:t.weights[i+1],floor:t.weights[i]}},n.prototype.getMeasureAggregator=function(n){return this._aggregated.values.filter(function(t){return t.getColumnName()===n.name&&t.getAggregatorType()===n.method})[0]},n.prototype.buildWeightsByDimension=function(n,t,i){var f=[],r=this._aggregated,h=this.getVectors(),e=r.dimensions.$br[n],c=r.weights[e+1],l=r.weights[e],a=this._columns[n]&&this._columns[n].lookUps,u={},o,s;h.forEach(function(n){var t=~~(n%c/l),i=u[t]||[];i.push(n);u[t]=i});o=function(n){var e={},s=a[n],o=u[n];o.forEach(function(n){var u=t.getMetaValue(r,n,i);t.mergeMetaValues(u,e);e=u});f.push({entry:s,value:t.getValue(e),subVectors:o,pos:n})};for(s in u)o(s);return f},n.prototype.filteredLookUps=function(n,t){var r=this._columns[n].lookUps,u=this._aggregated.dimensions.$br[n],o=this._aggregated.weights[u+1],s=this._aggregated.weights[u],f,i,e;if(r){f=t.reduce(function(n,t){return n[~~(t%o/s)]=!0,n},{});i=[];for(e in f)i.push(r[e]);return i.$br=r.$br,i}else return[]},n.prototype._getValueId=function(n,t){var r=n.getSetting(),u,i;return r&&(u=r.getAllValues(!0),i=_.find(u,function(n){return n.getColumnName()===t.name&&n.getAggregatorType()===t.method&&n.getIndex()===t.idx}),i)?i.getId():null},n}(),nt=function(n){function t(t){for(var i=n.call(this)||this,u=!1,r;!u;)r=t.splice(0,1e4),i.push.apply(i,r),r.length<1e4&&(u=!0);return i}return __extends(t,n),t}(Array),dt=function(t){function i(n,i,r){var u=t.call(this,n)||this;return u._dimName=i,u.fromJSON(r),u}return __extends(i,t),i.decendingCmpFunc=function(t,i){return n.utils.valueCompare(i,t)},i.prototype._init=function(){this.type=2;this.order=1;this.manual=[];var n=this._columns[this._dimName];this._useBareValue=n.dataType==="datetime"||n.dataType==="date"?!0:!1},i.prototype.setType=function(n){this.type=n},i.prototype.getType=function(){return this.type},i.prototype.setOrder=function(n){this.order=n},i.prototype.getOrder=function(){return this.order},i.prototype.setManual=function(n){this.manual=n},i.prototype.getManual=function(){return this.manual},i.prototype._getDataSourceCmpFunc=function(){var t=this._columns[this._dimName],n=t.getSortInfo();this._dataSourceCmpFunc=n&&n.func?n.func:this._getCmpFuncByManaualArray(t.lookUps)},i.prototype._getNumericalCmpFunc=function(){this._numericalCmpFunc=this.order===1?i.ascendingCmpFunc:i.decendingCmpFunc},i.prototype._getChronologicalCmpFunc=function(){this._chronologicalCmpFunc=this.order===1?i.ascendingCmpFunc:i.decendingCmpFunc},i.prototype._getAlphabeticCmpFunc=function(){var r,t,u;try{r=Intl}catch(f){}r&&r.Collator?(t=n.SR.cultureName,t==="ja-JP"&&(t="en-US"),u=new Intl.Collator(t),this._alphabeticCmpFunc=this.order===1?function(n,t){return typeof n=="string"&&typeof t=="string"?u.compare(n,t):i.ascendingCmpFunc(n,t)}:function(n,t){return typeof n=="string"&&typeof t=="string"?u.compare(t,n):i.decendingCmpFunc(n,t)}):this._alphabeticCmpFunc=this.order===1?i.ascendingCmpFunc:i.decendingCmpFunc},i.prototype._getCmpFuncByManaualArray=function(t){if(!t||t.length===0)return n.utils.valueCompare;var i={},r=this._useBareValue;return t.forEach(function(t,u){var f=r?n.utils.entryKey(t).valueOf():n.utils.entryKey(t);i[f]=u}),r?function(t,r){var u=n.utils.entryKey(t).valueOf(),f=n.utils.entryKey(r).valueOf();return i.hasOwnProperty(u)?i.hasOwnProperty(f)?i[u]-i[f]:-1:1}:function(t,r){var u=n.utils.entryKey(t),f=n.utils.entryKey(r);return i.hasOwnProperty(u)?i.hasOwnProperty(f)?i[u]-i[f]:-1:1}},i.prototype._getManualCmpFunc=function(){var t=this._useBareValue?this.manual.map(function(t){return t instanceof Date?t:n.utils.datetimeFromJSON(t)}):this.manual;this._manualCmpFunc=this._getCmpFuncByManaualArray(t)},i.prototype._getValueCmpFunc=function(){function i(n,t){return n>=t&&n<=t?0:n>t?1:n<t?-1:n==null?-1:1}var n,r=this.sortBy.measure.name,u=this.sortBy.measure.method,f=this._aggregated.values.filter(function(n){return n.getColumnName()===r&&n.getAggregatorType()===u})[0],e=this._getValueId(this._pivot,this.sortBy.measure),t=this.buildWeightsByDimension(this._dimName,f,e);n=this.order===1?t.sort(function(n,t){return i(n.value,t.value)}).map(function(n){return n.entry}):t.sort(function(n,t){return i(t.value,n.value)}).map(function(n){return n.entry});this._valueCmpFunc=this._getCmpFuncByManaualArray(n)},i.prototype.getCmpFunc=function(){var t,n;switch(this.type){case 4:return this._valueCmpFunc;case 3:return this._manualCmpFunc;case 2:t=this._columns[this._dimName];switch(t.dataType){case"number":return this._numericalCmpFunc;case"date":case"datetime":return this._chronologicalCmpFunc;case"string":default:return this._alphabeticCmpFunc}case 1:return this._dataSourceCmpFunc;default:return n=this._columns[this._dimName].getSortInfo(),n&&n.func?n.func:this._alphabeticCmpFunc}},i.prototype.getPosCmpFunc=function(){var t=this._columns[this._dimName].lookUps,n={};return t.slice(0).sort(this.getCmpFunc()).forEach(function(i,r){n[t.getPos(i)]=r}),function(t,i){return n[t]-n[i]}},i.prototype.toJSON=function(){return{type:this.type,order:this.order,manual:this.manual}},i.prototype.fromJSON=function(n){if(this._init(),n!=null){this.type=n.type;this.order=n.order;this.manual=n.manual;this.sortBy=n.sortBy;switch(this.type){case 4:this._getValueCmpFunc();break;case 3:this._getManualCmpFunc();break;case 2:var t=this._columns[this._dimName];switch(t.dataType){case"number":this._getNumericalCmpFunc();break;case"date":case"datetime":this._getChronologicalCmpFunc();break;case"string":default:this._getAlphabeticCmpFunc();break}break;case 1:default:this._getDataSourceCmpFunc();break}}},i.ascendingCmpFunc=n.utils.valueCompare,i}(kt),bi=function(){function n(n,t){this._pivot=n;this.fromJSON(t)}return n.prototype._init=function(){this.sortInfoes={}},n.prototype.addSortInfo=function(n,t){this.sortInfoes[n]=t},n.prototype.getCmpFunc=function(n){return this.sortInfoes.hasOwnProperty(n)?this.sortInfoes[n].getCmpFunc():null},n.prototype.getPosCmpFunc=function(n){return this.sortInfoes.hasOwnProperty(n)?this.sortInfoes[n].getPosCmpFunc():null},n.prototype.toJSON=function(){var n={};for(var t in this.sortInfoes)n[t]=this.sortInfoes[t].toJSON();return n},n.prototype.fromJSON=function(n){var t=this;this._init();n==null&&(n={});this._pivot.getSetting().getDimensions().forEach(function(i){if(n[i])t.sortInfoes[i]=new dt(t._pivot,i,n[i]);else{var u=t._pivot.getDataset().table.getColumn(i).dataType,r=void 0;r=u==="date"?{type:2,order:1}:{type:1,order:1};t.sortInfoes[i]=new dt(t._pivot,i,r)}})},n}(),t={CNT:"cnt",SUM:"sum",MAX:"max",MIN:"min",SSQ:"ssq",AVG:"avg",STDEV:"stdev",VAR:"var",DST:"dst",FIRST:"first",LAST:"last",CUSTOM:"custom",NONE:"none"},i=function(){function n(n){this._metas=[];this._columnName=n.getColumnName();this._display=n.getColumnDisplay()}return n.prototype.getAggregatorType=function(){return t.CNT},n.prototype.getMetaValues=function(n){return{}},n.prototype.getMetas=function(){return this._metas},n.prototype.getColumnName=function(){return this._columnName},n.prototype.mergeMetaValues=function(n,t){},n.prototype.getValue=function(n){},n.prototype.getMetaValue=function(n,t,i){},n}(),gt=function(i){function r(n){var r=i.call(this,n)||this;return r._metas=[t.SUM],r}return __extends(r,i),r.prototype.getAggregatorType=function(){return t.SUM},r.prototype.getMetaValues=function(n){var i=t.SUM,r={};return r[i]=n[i+"_"+this._columnName],r},r.prototype.mergeMetaValues=function(n,i){if(n){var r=t.SUM,f=n[r],u=i&&i[r];n[r]=isNaN(f)?u:f+(isNaN(u)?0:u)}},r.prototype.getValue=function(i){var r=i&&i[t.SUM];return r===+r?n.utils.trimExtraFloatNumber(r):null},r.prototype.getMetaValue=function(n,i,r){var u=t.SUM,f={},e=r;return f[u]=n[u+"_"+this._columnName][i],f},r}(i),ni=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.CNT],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.CNT},i.prototype.getMetaValues=function(n){var i=t.CNT,r={};return r[i]=n[i+"_"+this._columnName],r},i.prototype.mergeMetaValues=function(n,i){if(n){var r=t.CNT,f=n[r],u=i&&i[r];n[r]=isNaN(f)?u:f+(isNaN(u)?0:u)}},i.prototype.getValue=function(n){return n&&n[t.CNT]},i.prototype.getMetaValue=function(n,i,r){var u=t.CNT,f={},e=r;return f[u]=n[u+"_"+this._columnName][i],f},i}(i),ti=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.MAX],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.MAX},i.prototype.getMetaValues=function(n){var i=t.MAX,r={};return r[i]=n[i+"_"+this._columnName],r},i.prototype.mergeMetaValues=function(n,i){if(n){var f=t.MAX,r=n[f],u=i&&i[f];n[f]=r===undefined?u:u===undefined?r:r>u?r:u}},i.prototype.getValue=function(n){return n&&n[t.MAX]},i.prototype.getMetaValue=function(n,i,r){var u=t.MAX,f={},e=r;return f[u]=n[u+"_"+this._columnName][i],f},i}(i),ii=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.MIN],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.MIN},i.prototype.getMetaValues=function(n){var i=t.MIN,r={};return r[i]=n[i+"_"+this._columnName],r},i.prototype.mergeMetaValues=function(n,i){if(n){var f=t.MIN,r=n[f],u=i&&i[f];n[f]=r===undefined?u:u===undefined?r:r<u?r:u}},i.prototype.getValue=function(n){return n&&n[t.MIN]},i.prototype.getMetaValue=function(n,i,r){var u=t.MIN,f={},e=r;return f[u]=n[u+"_"+this._columnName][i],f},i}(i),ri=function(i){function r(n){var r=i.call(this,n)||this;return r._metas=[t.CNT,t.SUM],r}return __extends(r,i),r.prototype.getAggregatorType=function(){return t.AVG},r.prototype.getMetaValues=function(n){var i={};return i[t.CNT]=n[t.CNT+"_"+this._columnName],i[t.SUM]=n[t.SUM+"_"+this._columnName],i},r.prototype.mergeMetaValues=function(n,i){if(n){var r=t.CNT,u=t.SUM,o=n[r],f=i&&i[r],s=n[u],e=i&&i[u];n[r]=isNaN(o)?f:o+(isNaN(f)?0:f);n[u]=isNaN(s)?e:s+(isNaN(e)?0:e)}},r.prototype.getValue=function(i){return i&&i[t.SUM]!=null&&i[t.CNT]!=null?n.utils.trimExtraFloatNumber(i[t.SUM]/i[t.CNT]):null},r.prototype.getMetaValue=function(n,i,r){var u={};return u[t.SUM]=n[t.SUM+"_"+this._columnName][i],u[t.CNT]=n[t.CNT+"_"+this._columnName][i],u},r}(i),ui=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.DST],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.DST},i.prototype.getMetaValues=function(n){var i={};return i[t.DST]=n[t.DST+"_"+this._columnName],i},i.prototype.mergeMetaValues=function(n,i){function e(n,t){var i={};for(var r in n)i[r]=!0;for(r in t)i[r]=!0;return i}if(n){var r=t.DST,u=n[r],f=i&&i[r];n[r]=e(u,f)}},i.prototype.getValue=function(n){return n&&n[t.DST]?Object.keys(n[t.DST]).length:0},i.prototype.getMetaValue=function(n,i,r){var u={};return u[t.DST]=n[t.DST+"_"+this._columnName][i],u},i}(i),fi=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.FIRST],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.FIRST},i.prototype.getMetaValues=function(n){var i=t.FIRST,r={};return r[i]=n[i+"_"+this._columnName],r},i.prototype.mergeMetaValues=function(n,i){if(n){var r=t.FIRST,f=n[r],u=i&&i[r];return f?n[r]=u?f.concat(u):f:u?n[r]=u:null}},i.prototype.getValue=function(n){return n&&n[t.FIRST]&&n[t.FIRST].length>0?n[t.FIRST].sort(function(n,t){return n.i-t.i})[0].v:null},i.prototype.getMetaValue=function(n,i,r){var u=t.FIRST,f={};return f[u]=n[u+"_"+this._columnName][i],f},i}(i),ei=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.LAST],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.LAST},i.prototype.getMetaValues=function(n){var i=t.LAST,r={};return r[i]=n[i+"_"+this._columnName],r},i.prototype.mergeMetaValues=function(n,i){if(n){var r=t.LAST,f=n[r],u=i&&i[r];return f?n[r]=u?f.concat(u):f:u?n[r]=u:null}},i.prototype.getValue=function(n){return n&&n[t.LAST]&&n[t.LAST].length>0?n[t.LAST].sort(function(n,t){return t.i-n.i})[0].v:null},i.prototype.getMetaValue=function(n,i,r){var u=t.LAST,f={},e=r;return f[u]=n[u+"_"+this._columnName][i],f},i}(i),oi=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.CUSTOM],r._customAggregator=i._customAggregator,r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.CUSTOM},i.prototype.getMetaValues=function(n){var i=t.CUSTOM,r={};return r[i]=n[i+"_"+this._columnName],r},i.prototype.mergeMetaValues=function(n,i){if(n){var u=t.CUSTOM,f=n[u],r=i&&i[u];return n[u]=f?r?f.concat(r):f:r?r:[]}},i.prototype.getValue=function(n){return this._customAggregator(n&&n[t.CUSTOM],this._columnName)},i.prototype.getMetaValue=function(n,i,r){var u=t.CUSTOM,f={},e=r;return f[u]=n[u+"_"+this._columnName][i],f},i}(i),si=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.NONE],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.NONE},i.prototype.getMetaValues=function(n){var i={},r=t.NONE;return i[r]=n[r+"_"+this._columnName],i},i.prototype.mergeMetaValues=function(n,i){if(n){var r=t.NONE,u=n[r],f=i&&i[r];n[r]=isNaN(u)?f:u}},i.prototype.getValue=function(n){return n&&n[t.NONE]},i.prototype.getMetaValue=function(n,i,r){var u={},f=t.NONE;return u[f]=n[f+"_"+this._columnName][i],u},i}(i),f=function(){function t(n){this.customValueName="";this._valueColumnName=n.name;this._valueColumnDisplayName=n.display;this._index=n.idx;this._method=n.method;this._totalMethod=n.totalMethod;this._format=n.format;this.invalid=n.invalid;this.customValueName=n.customValueName;this._customAggregator=n.customAggregator}return t.prototype.getValueType=function(){return 1},t.prototype.getAggregatorType=function(){return this._method},t.prototype.getTotalAggregatorType=function(){return this._totalMethod},t.prototype.getId=function(){return t.getValueId(this.getAggregatorType(),this._index,this._valueColumnName,this.getIsCalculate())},t.prototype.getName=function(){return t.getValueName(this.getAggregatorType(),this._index,this._valueColumnName,this.getIsCalculate())},t.prototype.getDisplay=function(){return t.getValueDisplay(this.customValueName,this._index,this._valueColumnDisplayName,this.getAggregatorType(),this.getIsCalculate())},t.prototype.setIndex=function(n){this._index=n},t.prototype.getIndex=function(){return this._index},t.prototype.getFormat=function(t){return n.utils.isValidFormat(this._format)?this._format:t&&t.getColumn(this._valueColumnName).format},t.prototype.toJSON=function(n){var t={name:this._valueColumnName,method:this._method,display:this._valueColumnDisplayName,format:this._format,idx:this._index,valueType:1};return n&&(t.invalid=this.invalid),t},t.prototype.isMatchAggregator=function(n){return n.getAggregatorType()===this.getAggregatorType()&&n.getColumnName()===this.getColumnName()},t.prototype.isMatchTotalAggregator=function(n){return n.getAggregatorType()===this.getTotalAggregatorType()&&n.getColumnName()===this.getColumnName()},t.prototype.getColumnName=function(){return this._valueColumnName},t.prototype.getColumnDisplay=function(){return this._valueColumnDisplayName},t.prototype.setColumnDisplay=function(n){this._valueColumnDisplayName=n},t.prototype.getIsCalculate=function(){return!1},t.getValueDisplay=function(t,i,r,u,f){var e,o,h,s;if(!n.utils.isEmpty(t))return t;o=n.SR.dashboard_scenario_value_running_sum;switch(u){case"sum":e=n.SR.dashboard_scenario_value_sumof;o=n.SR.dashboard_scenario_value_running_sum;break;case"cnt":e=n.SR.dashboard_scenario_value_cntof;o=n.SR.dashboard_scenario_value_running_cnt;break;case"avg":e=n.SR.dashboard_scenario_value_avgof;o=n.SR.dashboard_scenario_value_running_avg;break;case"max":e=n.SR.dashboard_scenario_value_maxof;o=n.SR.dashboard_scenario_value_running_max;break;case"min":e=n.SR.dashboard_scenario_value_minof;o=n.SR.dashboard_scenario_value_running_min;break;case"dst":e=n.SR.dashboard_scenario_value_dstof;break;case"first":e=n.SR.dashboard_scenario_value_firstof;break;case"last":e=n.SR.dashboard_scenario_value_lastof;break;case"none":e="";break;default:break}return h=!n.utils.isEmpty(i)&&i!=0?"("+i+")":"",s=n.utils.formatstring(e,r)+h,u=="none"&&(s=r+h),f&&(s=o+" "+s),s},t.getValueName=function(n,t,i,r){if(r){var u=t?'\0('+t+")":"";return"running_"+n+"_"+n+"_of_"+i+u}else return n+"_of_"+i},t.getValueId=function(n,i,r,u){var f=t.getValueName(n,i,r,u);return u||(f=f+t.SubDateSymbol+i),f},t.SubDateSymbol="\x1d",t}();n.PivotValue=f;var e=function(t){function i(n,i){var r=t.call(this,i)||this;return r._pivotSetting=n,r.fromJSON(i),r}return __extends(i,t),i.prototype.getValueType=function(){return 2},i.prototype.getAggregatorType=function(){return this._method},i.prototype.getIsCalculate=function(){return!0},i.prototype.getType=function(){return this._type},i.prototype.getMethod=function(){return this._method},i.prototype.getMeasure=function(){return this._measure},i.prototype.getColumnName=function(){return this._measure&&this._measure.name},i.prototype.setColumnDisplay=function(n){this._measure&&(this._measure.display=n)},i.prototype.getAlong=function(){return this.update(),this._along},i.prototype.getFormat=function(t){if(n.utils.isValidFormat(this._format))return this._format;if(this._method==="cnt")return n.utils.getDefaultFormat();if(n.utils.isValidFormat(this._measure.format))return this._measure.format;var i=this._measure.method==="cnt";return i||!t?"General":t.getColumn(this.getColumnName()).format},i.prototype.fromJSON=function(n){n&&(this._index=n.idx,this._type=n.type,this._method=n.method,this._along=n.along,this._measure=n.measure,this._format=n.format,this.invalid=n.invalid)},i.prototype.update=function(){var t,n,i,r;if(this._along){t=[];n=[];switch(this._along.name){case"table":t=this._pivotSetting.getSeriesByType(this._type);n=this._pivotSetting.getRowsByType().concat(this._pivotSetting.getColumnsByType().concat(this._pivotSetting.getAxisByType()));break;case"row":t=this._pivotSetting.getSeriesByType(this._type).concat(this._pivotSetting.getRowsByType());n=this._pivotSetting.getColumnsByType().concat(this._pivotSetting.getAxisByType());break;case"column":t=this._pivotSetting.getSeriesByType(this._type).concat(this._pivotSetting.getColumnsByType());n=this._pivotSetting.getRowsByType().concat(this._pivotSetting.getAxisByType());break;case"cell":t=this._pivotSetting.getSeriesByType(this._type).concat(this._pivotSetting.getRowsByType().concat(this._pivotSetting.getColumnsByType()));n=this._pivotSetting.getAxisByType();break;default:i=this._pivotSetting.getDimensions().reduce(function(n,t){return n[t]=!0,n},{});this._along.advance.partitioning.forEach(function(n){i[n]&&(t.push(n),i[n]=!1)});this._along.advance.addressing.forEach(function(t){i[t]&&(n.push(t),i[t]=!1)});for(r in i)i[r]&&n.push(r)}this._along.advance={partitioning:t,addressing:n}}},i.prototype.toJSON=function(n){var t={idx:this._index,type:this._type,method:this._method,along:this._along,measure:this._measure,format:this._format,valueType:2};return n&&(t.invalid=this.invalid),t},i}(f),ki=function(n){function t(t,i){return n.call(this,t,i)||this}return __extends(t,n),t.prototype.getOption=function(){return{restartOn:this._restartOn}},t.prototype.getAggregator=function(n,t,i){function p(n,t){for(var r,f,e,i=0;i<y;i++)if(f=Math.floor(n%u[i].ceil/u[i].floor),e=Math.floor(t%u[i].ceil/u[i].floor),r=v[i](f,e),r!==0)return r;return r}var r=t,h=this._along.advance.partitioning,e=this._along.advance.addressing,o={},c=this._method,s,l=r.getMeasureAggregator(this._measure),a=new f(this._measure);s=r.getPartitionedVectors(n,h);var v=e.map(function(n){return i.getPosCmpFunc(n)}),u=e.map(function(n){return r.getWeight(n)}),y=e.length;return s.forEach(function(n){n.sort(p);var t=new gi(c);n.forEach(function(n){o[n]=t.addUp(r.getValue(l,n,a.getId()))})}),this._latestAggregator=new di(o),this._latestAggregator},t.prototype.fromJSON=function(n){n&&(e.prototype.fromJSON.call(this,n),this._restartOn=n.option&&n.option.restartOn)},t.prototype.toJSON=function(n){var t=e.prototype.toJSON.call(this,n);return t.option={restartOn:this._restartOn},t},t}(e),di=function(){function n(n){this._cache=n}return n.prototype.getValue=function(n){return this._cache[n]},n}(),gi=function(){function n(n){this._method=n;this._counter=0;this._addedVal=null}return n.prototype.addUp=function(n){this._addedVal===null&&this._method!=="min"&&(this._addedVal=0);var t=0,i=n;n===undefined?i=0:this._counter++;switch(this._method){case"sum":t=this._addedVal+i;this._addedVal=t;break;case"max":t=Math.max(this._addedVal,i);this._addedVal=t;break;case"min":t=this._addedVal===null?i:Math.min(this._addedVal,i);this._addedVal=t;break;case"cnt":t=this._counter;this._addedVal=t;break;case"avg":this._addedVal=this._addedVal+i;t=this._addedVal/this._counter;break;default:}return t},n}()}(PivotData||(PivotData={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var c=Forguncy.ColorHelper,i=function(){function t(n,t){this._colHeaderName="colHeader";this._rowHeaderName="rowHeader";this._dataCellName="df_pt_dataCell";this._grandTotalColumnsName="grandTotalsColumn";this._grandTotalRowsName="grandTotalsRow";this._firstLevelSubtotalForRowsName="subTotalForRow1";this._firstLevelSubtotalForColumnsName="subTotalForCol1";this._secondLevelSubtotalForRowsName="subTotalForRow2";this._secondLevelSubtotalForColumnsName="subTotalForCol2";this._thirdLevelSubtotalForRowsName="subTotalForRow3";this._thirdLevelSubtotalForColumnsName="subTotalForCol3";this._init(n,t)}return t.prototype._init=function(i,r){for(var v,y,s=i.schema.tableRowLevel,h=f.getColLevel(i),c=f.getRowCount(i),l=f.getColCount(i),u={},o=0,e=0,p,a,o=0;o<c;o++)for(u[o]={},e=0;e<l;e++)p=new GC.Spread.Sheets.Style,p.formatter=this.getFormat(i.data,o,e,s,h),u[o][e]=p;for(o=0;o<c;o++)for(e=0;e<s;e++)u[o][e]=t._compose(u[o][e],t._getSpreadJSStyleFromPivotAreaStyle(r.rowHeader,r.font));for(s>1&&i.data.rowHeader.forEach(function(n,i){for(var o,e=i+h,f=0;f<n.length-1;f++)o=n[f],o.type!==64&&o.type!==32&&(o.level===1?u[e][f]=t._compose(u[e][f],t._getSpreadJSStyleFromPivotAreaStyle(r.rowSubheading1,r.font)):o.level%2==0?u[e][f]=t._compose(u[e][f],t._getSpreadJSStyleFromPivotAreaStyle(r.rowSubheading2,r.font)):o.level%2==1&&(u[e][f]=t._compose(u[e][f],t._getSpreadJSStyleFromPivotAreaStyle(r.rowSubheading3,r.font))))}),o=0;o<h;o++)for(e=0;e<l;e++)u[o][e]=t._compose(u[o][e],t._getSpreadJSStyleFromPivotAreaStyle(r.colHeader,r.font));if(i.data.colHeader.forEach(function(n,i){n.forEach(function(n,f){if(n.type!==64){var e=f+s;n.level===1?u[i][e]=t._compose(u[i][e],t._getSpreadJSStyleFromPivotAreaStyle(r.colSubheading1,r.font)):n.level%2==0?u[i][e]=t._compose(u[i][e],t._getSpreadJSStyleFromPivotAreaStyle(r.colSubheading2,r.font)):n.level%2==1&&(u[i][e]=t._compose(u[i][e],t._getSpreadJSStyleFromPivotAreaStyle(r.colSubheading3,r.font)))}})}),((v=i.data.colHeader)===null||v===void 0?void 0:v.length)>0&&_.last(i.data.colHeader).forEach(function(n,i){var e,f;if(n.type===32)for(e=i+s,f=h;f<c;f++)n.level===1?u[f][e]=t._compose(u[f][e],t._getSpreadJSStyleFromPivotAreaStyle(r.subTotalForCol1,r.font)):n.level%2==0?u[f][e]=t._compose(u[f][e],t._getSpreadJSStyleFromPivotAreaStyle(r.subTotalForCol2,r.font)):n.level%2==1&&(u[f][e]=t._compose(u[f][e],t._getSpreadJSStyleFromPivotAreaStyle(r.subTotalForCol3,r.font)))}),i.data.rowHeader&&i.data.rowHeader.map(function(t){var i=_.filter(t,function(n){return n.type===32})[0];return i?i:new n.TableDataCell}).forEach(function(n,i){var e,f;if(n.type===32)for(e=i+h,f=0;f<l;f++)n.level===1?u[e][f]=t._compose(u[e][f],t._getSpreadJSStyleFromPivotAreaStyle(r.subTotalForRow1,r.font)):n.level%2==0?u[e][f]=t._compose(u[e][f],t._getSpreadJSStyleFromPivotAreaStyle(r.subTotalForRow2,r.font)):n.level%2==1&&(u[e][f]=t._compose(u[e][f],t._getSpreadJSStyleFromPivotAreaStyle(r.subTotalForRow3,r.font)))}),((y=i.data.colHeader)===null||y===void 0?void 0:y.length)>0&&(a=l-s-i.schema.measureLength,i.data.colHeader[0][a]&&i.data.colHeader[0][a].type===64))for(o=0;o<c;o++)for(e=a+s;e<l;e++)u[o][e]=t._compose(u[o][e],t._getSpreadJSStyleFromPivotAreaStyle(r.grandTotalsColumn,r.font));if(i.data.rowHeader[c-h-1][0]&&i.data.rowHeader[c-h-1][0].type===64)for(o=c-1,e=0;e<l;e++)u[o][e]=t._compose(u[o][e],t._getSpreadJSStyleFromPivotAreaStyle(r.grandTotalsRow,r.font));this._styleNameCache=u},t.prototype.getFormat=function(n,t,i,r,u){var f=null,e,o;return(t<u&&i<r?f=null:t<u?(f=n.colHeader,i-=r):i<r?(f=n.rowHeader,t-=u):(f=n.data,t-=u,i-=r),f&&(e=f[t],e&&(o=e[i],o)))?o.format:undefined},t._compose=function(n,t){if(!n)return t?t.clone():new GC.Spread.Sheets.Style;if(!t)return n.clone();var i=n.clone(),r=undefined;return t.backColor&&(i.backColor=t.backColor),t.foreColor&&(i.foreColor=t.foreColor),Forguncy.Common.IsEmpty(t.hAlign)||(i.hAlign=t.hAlign),Forguncy.Common.IsEmpty(t.vAlign)||(i.vAlign=t.vAlign),t.font&&(i.font=this._composeFont(i.font,t.font)),t.formatter&&(i.formatter=t.formatter),t.borderLeft&&(i.borderLeft=t.borderLeft),t.borderTop&&(i.borderTop=t.borderTop),t.borderRight&&(i.borderRight=t.borderRight),t.borderBottom&&(i.borderBottom=t.borderBottom),t.diagonalDown&&(i.diagonalDown=t.diagonalDown),t.diagonalUp&&(i.diagonalUp=t.diagonalUp),t.textIndent&&(i.textIndent=t.textIndent),t.wordWrap!==r&&(i.wordWrap=t.wordWrap),t.shrinkToFit!==r&&(i.shrinkToFit=t.shrinkToFit),t.cellType&&(i.cellType=t.cellType),t.tabStop!==r&&(i.tabStop=t.tabStop),t.textDecoration&&(i.textDecoration=t.textDecoration),t.name&&(i.name=t.name),t.parentName&&(i.parentName=t.parentName),t.watermark&&(i.watermark=t.watermark),t.cellPadding&&(i.cellPadding=t.cellPadding),t.labelOptions&&(i.labelOptions=t.labelOptions),t.quotePrefix&&(i.quotePrefix=t.quotePrefix),t.isVerticalText!==r&&(i.isVerticalText=t.isVerticalText),i},t._composeFont=function(n,t){if(!n||!t)return n||t;var i=this._getFontProperties(n),r=this._getFontProperties(t);return this._composeFontProps(i,r)},t._composeFontProps=function(n,t){var i=[],r;return(n.bold||t.bold)&&i.push("bold"),(n.italic||t.italic)&&i.push("italic"),(n.fontSize||t.fontSize)&&i.push(t.fontSize||n.fontSize),(n.fontFamily||t.fontFamily)&&(r=t.fontFamily||n.fontFamily,r&&r!="undefined"?i.push(r):i.push(Forguncy.ForguncyData.GlobalSettings.ThemeFont)),i.join(" ")},t._getFontProperties=function(n){if(this._fontCache[n])return this._fontCache[n];this._span.style.font=n;var t=this._span.style,i={fontFamily:t.fontFamily,fontSize:t.fontSize,bold:t.fontWeight=="bold",italic:t.fontStyle=="italic"};return this._fontCache[n]=i,i},t._getSpreadJSStyleFromPivotAreaStyle=function(n,i){var r=new GC.Spread.Sheets.Style;return t._applyStyle(r,n,i),r},t._getSpreadJSVAlign=function(n){switch(n){case"Top":return GC.Spread.Sheets.VerticalAlign.top;case"Center":return GC.Spread.Sheets.VerticalAlign.center;default:return GC.Spread.Sheets.VerticalAlign.bottom}},t._getSpreadJSHAlign=function(n){switch(n){case"Left":return GC.Spread.Sheets.HorizontalAlign.left;case"Center":return GC.Spread.Sheets.HorizontalAlign.center;case"Right":return GC.Spread.Sheets.HorizontalAlign.right;default:return GC.Spread.Sheets.HorizontalAlign.general}},t.prototype._getBaseStyle=function(n){var i=new GC.Spread.Sheets.Style;return t._applyStyle(i,n.wholeTable,n.font),i},t.prototype._getDataCellStyles=function(n){var t=this._getBaseStyle(n);return t.name=this._dataCellName,[t]},t._applyStyle=function(n,i,r){i.foreColor&&(n.foreColor=i.foreColor);i.backColor&&(n.backColor=i.backColor);i.CellVerticalAligment&&(n.vAlign=t._getSpreadJSVAlign(i.CellVerticalAligment));i.CellHorizontalAlignment&&(n.hAlign=t._getSpreadJSHAlign(i.CellHorizontalAlignment));n.font=t._getFontStr(i,r)},t._getFontStr=function(n,t){var i={},r;return n.Bold&&(i.bold=!0),n.Italic&&(i.italic=!0),r=this._getFontProperties(t),this._composeFontProps(i,r)},t.prototype._getRowHeaderStyles=function(n){var i=this._getBaseStyle(n);return t._applyStyle(i,n.rowHeader,n.font),i.name=this._rowHeaderName,[i]},t.prototype._getColHeaderStyles=function(n){var i=this._getBaseStyle(n);return i.name=this._colHeaderName,t._applyStyle(i,n.colHeader,n.font),[i]},t.prototype._getGrandTotalStyles=function(n){var i=this._getBaseStyle(n),r;return i.name=this._grandTotalColumnsName,t._applyStyle(i,n.grandTotalsColumn,n.font),r=this._getBaseStyle(n),r.name=this._grandTotalRowsName,t._applyStyle(i,n.grandTotalsRow,n.font),[r,i]},t.prototype._getSubtotalStyles=function(n){var o=this._getBaseStyle(n),i,r,u,f,e;return o.name=this._firstLevelSubtotalForColumnsName,t._applyStyle(o,n.subTotalForCol1,n.font),i=this._getBaseStyle(n),i.name=this._secondLevelSubtotalForColumnsName,t._applyStyle(i,n.subTotalForCol2,n.font),r=this._getBaseStyle(n),r.name=this._thirdLevelSubtotalForColumnsName,t._applyStyle(r,n.subTotalForCol3,n.font),u=this._getBaseStyle(n),u.name=this._firstLevelSubtotalForRowsName,t._applyStyle(u,n.subTotalForRow1,n.font),f=this._getBaseStyle(n),f.name=this._secondLevelSubtotalForRowsName,t._applyStyle(f,n.subTotalForRow2,n.font),e=this._getBaseStyle(n),e.name=this._thirdLevelSubtotalForRowsName,t._applyStyle(e,n.subTotalForRow3,n.font),[o,i,r,u,f,e]},t.prototype.getAllNamedStyle=function(n){var t=[],e=this._getDataCellStyles(n),i,r,u,f;return t=t.concat(e),i=this._getRowHeaderStyles(n),t=t.concat(i),r=this._getColHeaderStyles(n),t=t.concat(r),u=this._getGrandTotalStyles(n),t=t.concat(u),f=this._getSubtotalStyles(n),t.concat(f)},t.prototype.getSpreadJSStyle=function(n,t){return this._styleNameCache&&this._styleNameCache[n]&&this._styleNameCache[n][t]?this._styleNameCache[n][t]&&this._styleNameCache[n][t].clone():null},t.defaultFontSize="14px",t.defaultFontFamily="Calibri",t._fontCache={},t._span=document.createElement("span"),t}(),l=function(){function n(){this.data=[];this.rowHeader=[];this.colHeader=[]}return n}(),a=function(){function n(){this.tableRowLevel=0;this.tableColLevel=0;this.valueLevel=0;this.measureLength=0;this.rowDim=[];this.colDim=[]}return n}(),p=function(){function n(){}return n}(),v=function(){function n(){this.data=new l;this.schema=new a}return n}(),t,u,h,r;n.TableData=v;t=function(){function n(n,t){this.backColor=n;this.foreColor=t}return n}();n.PivotAreaStyle=t;var y=function(){function n(){this.colHeader=new t("","");this.rowHeader=new t("","");this.subTotalForRow1=new t("","");this.subTotalForRow2=new t("","");this.subTotalForRow3=new t("","");this.subTotalForCol1=new t("","");this.subTotalForCol2=new t("","");this.subTotalForCol3=new t("","");this.grandTotalsColumn=new t("","");this.grandTotalsRow=new t("","");this.firstColStripe=new t("","");this.secondColStripe=new t("","");this.firstRowStripe=new t("","");this.secondRowStripe=new t("","");this.colSubheading1=new t("","");this.colSubheading2=new t("","");this.colSubheading3=new t("","");this.rowSubheading1=new t("","");this.rowSubheading2=new t("","");this.rowSubheading3=new t("","");this.wholeTable=new t("transparent","#333333");this.gridLine="";this.rowHeight=21;this.font=i.defaultFontSize+" "+i.defaultFontFamily;this.isColumnHeader=!0;this.isRowHeader=!0;this.showPlus=!0;this.showFieldHeader=!0;this.isAutofitColumn=!0;this.columnWidth=62;this.showBandedRows=!1;this.showBandedCols=!1}return n}(),o=function(){function n(){this[32]=[];this[64]=[]}return n}(),s=function(){function n(n,t){this.row=n;this.col=t}return n}(),e=function(){function n(n,t,i){this.row=n;this.col=t;this.value=i;this.rowCount=1;this.colCount=1}return n}(),f=function(){function t(){this._sheet=null;this._theme=null;this._mergeRangeRowCount={};this._collapsedRange={};this._stylesSetByInspector=new y;this._totalsRegion=new o;this._colHiddenMap={};this._rowHiddenMap={};this._colSubtotalMap=[];this._rowSubtotalMap=[];this._colSelectCellMap={};this._colHeaderCollapseRange={}}return t.prototype.init=function(n){this._pivotData=n;this._colHiddenMap={};this._rowHiddenMap={};this._colSubtotalMap=[];this._rowSubtotalMap=[]},t.prototype.render=function(n,t){this.init(t);this.setTheme(new i(t,this._stylesSetByInspector));this._theme.getAllNamedStyle(this._stylesSetByInspector).forEach(function(t){n.addNamedStyle(t)});this._sheet=n;this._renderTable(n,t)},t.prototype._renderTable=function(n,i){n.suspendPaint();n.suspendEvent();try{var r=t.getRowCount(i)-t.getColLevel(i),u=t.getColCount(i);n&&(n.setRowCount(r),n.setColumnCount(u));this._setDefaultStyle(n);this._renderCornerPortion(n,i);this._renderRowHeaderPortion(n,i);this._renderColHeaderPortion(n,i);this._renderDataPortion(n,i);this._expandCollapseHeader(n);this.autoResizeColumn(n,i);this._renderStripe(n,i);this._renderBorder(n,i)}finally{n.resumeEvent();n.resumePaint()}},t.prototype._renderBorder=function(n,i){var r=this,nt,tt,it,s=n.getRowCount(),y=n.getColumnCount(),rt=t.getColLevel(i),h=i.schema.tableRowLevel,p=GC.Spread.Sheets.SheetArea.colHeader,ut=new GC.Spread.Sheets.LineBorder("",GC.Spread.Sheets.LineStyle.empty),k,ft,u,w,et,ot,lt,v,c,at,vt,b,l,yt,e,pt,wt,bt,kt,d,a,g,f,st,dt,gt,ni;if(this._stylesSetByInspector.gridLine&&(ut=new GC.Spread.Sheets.LineBorder(this._stylesSetByInspector.gridLine,GC.Spread.Sheets.LineStyle.thin)),k=n.getRange(0,0,rt,y,p),ft=n.getRange(0,0,s,y),k.setBorder(ut,{all:!0}),ft.setBorder(ut,{all:!0}),u=this._stylesSetByInspector,w=u.wholeTable,this._hasBorder(w)&&(et=__assign({},w),et.borderBottomString=w.insideHorizontalBorderString,this._renderRangeBorder(k,et),ot=__assign({},w),ot.borderTopString=w.insideHorizontalBorderString,this._renderRangeBorder(ft,ot)),u.showBandedCols){if(this._hasBorder(u.firstColStripe))for(v=0,c=h;c<y;c++)n.getColumnVisible(c)&&(v%2==0&&(lt=n.getRange(-1,c,-1,1),this._renderRangeBorder(lt,u.firstColStripe)),v++);if(this._hasBorder(u.secondColStripe))for(v=0,c=h;c<y;c++)n.getColumnVisible(c)&&(v%2==1&&(at=n.getRange(-1,c,-1,1),this._renderRangeBorder(at,u.secondColStripe)),v++)}if(u.showBandedRows){if(this._hasBorder(u.firstRowStripe))for(b=0,l=0;l<s;l++)n.getRowVisible(l)&&(b%2==0&&(vt=n.getRange(l,-1,1,-1),this._renderRangeBorder(vt,u.firstRowStripe)),b++);if(this._hasBorder(u.secondRowStripe))for(b=0,l=0;l<s;l++)n.getRowVisible(l)&&(b%2==1&&(yt=n.getRange(l,-1,1,-1),this._renderRangeBorder(yt,u.secondRowStripe)),b++)}if(e=u.rowHeader,this._hasBorder(e)&&(pt={borderTopString:e.borderTopString,borderBottomString:e.insideHorizontalBorderString,borderLeftString:e.borderLeftString,borderRightString:e.borderRightString,insideHorizontalBorderString:e.insideHorizontalBorderString,insideVerticalBorderString:e.insideVerticalBorderString},wt=n.getRange(0,0,rt,h,p),this._renderRangeBorder(wt,pt),bt={borderTopString:e.insideHorizontalBorderString,borderBottomString:e.borderBottomString,borderLeftString:e.borderLeftString,borderRightString:e.borderRightString,insideHorizontalBorderString:e.insideHorizontalBorderString,insideVerticalBorderString:e.insideVerticalBorderString},kt=n.getRange(0,0,s,h),this._renderRangeBorder(kt,bt)),h>1)for(d=this.getMergeRowHeader(i,n),a=0;a<i.schema.tableRowLevel-1;a++)if(d[a])for(g=0;g<d[a].length;g++)f=d[a][g],f.type!==64&&f.type!==32&&(a===0?this._renderRangeBorder(n.getRange(f.row,f.col,f.rowCount,f.colCount),this._stylesSetByInspector.rowSubheading1):a%2==1?this._renderRangeBorder(n.getRange(f.row,f.col,f.rowCount,f.colCount),this._stylesSetByInspector.rowSubheading2):a%2==0&&this._renderRangeBorder(n.getRange(f.row,f.col,f.rowCount,f.colCount),this._stylesSetByInspector.rowSubheading3));st=u.colHeader;this._hasBorder(st)&&this._renderRangeBorder(k,st);i.data.colHeader.forEach(function(t,i){t.forEach(function(t,u){if(t.type!==64){var f=u+h;t.level===1?r._renderRangeBorder(n.getCell(i,f,p),r._stylesSetByInspector.colSubheading1):t.level%2==0?r._renderRangeBorder(n.getCell(i,f,p),r._stylesSetByInspector.colSubheading2):t.level%2==1&&r._renderRangeBorder(n.getCell(i,f,p),r._stylesSetByInspector.colSubheading3)}})});((nt=i.data.colHeader)===null||nt===void 0?void 0:nt.length)>0&&_.last(i.data.colHeader).forEach(function(t,i){if(t.type===32){var u=i+h;t.level===1&&r._renderRangeBorder(n.getRange(0,u,s,1),r._stylesSetByInspector.subTotalForCol1)}});((tt=i.data.colHeader)===null||tt===void 0?void 0:tt.length)>0&&_.last(i.data.colHeader).forEach(function(t,i){if(t.type===32){var u=i+h;t.level>1&&t.level%2==0&&r._renderRangeBorder(n.getRange(0,u,s,1),r._stylesSetByInspector.subTotalForCol2)}});((it=i.data.colHeader)===null||it===void 0?void 0:it.length)>0&&_.last(i.data.colHeader).forEach(function(t,i){if(t.type===32){var u=i+h;t.level>1&&t.level%2==1&&r._renderRangeBorder(n.getRange(0,u,s,1),r._stylesSetByInspector.subTotalForCol3)}});i.data.rowHeader.forEach(function(t,i){t.forEach(function(t,u){t.type===32&&t.level===1&&r._renderRangeBorder(n.getRange(i,u,1,n.getColumnCount()-u),r._stylesSetByInspector.subTotalForRow1)})});i.data.rowHeader.forEach(function(t,i){t.forEach(function(t,u){t.type===32&&t.level>1&&t.level%2==0&&r._renderRangeBorder(n.getRange(i,u,1,n.getColumnCount()-u),r._stylesSetByInspector.subTotalForRow2)})});i.data.rowHeader.forEach(function(t,i){t.forEach(function(t,u){t.type===32&&t.level>1&&t.level%2==1&&r._renderRangeBorder(n.getRange(i,u,1,n.getColumnCount()-u),r._stylesSetByInspector.subTotalForRow3)})});var o=u.grandTotalsColumn,ht=i.schema.measureLength,ct=y-h-ht;if(this._hasBorder(o)&&i.data.colHeader[0][ct]&&i.data.colHeader[0][ct].type===64){var v=ct+h,ti={borderTopString:o.borderTopString,borderBottomString:o.insideHorizontalBorderString,borderLeftString:o.borderLeftString,borderRightString:o.borderRightString,insideHorizontalBorderString:o.insideHorizontalBorderString,insideVerticalBorderString:o.insideVerticalBorderString},ii=n.getRange(0,v,rt,ht,p);this._renderRangeBorder(ii,ti);dt={borderTopString:o.insideHorizontalBorderString,borderBottomString:o.borderBottomString,borderLeftString:o.borderLeftString,borderRightString:o.borderRightString,insideHorizontalBorderString:o.insideHorizontalBorderString,insideVerticalBorderString:o.insideVerticalBorderString};gt=n.getRange(0,v,s,ht);this._renderRangeBorder(gt,dt)}this._hasBorder(u.grandTotalsRow)&&i.data.rowHeader[s-1][0]&&i.data.rowHeader[s-1][0].type===64&&(ni=n.getRange(s-1,0,1,y),this._renderRangeBorder(ni,u.grandTotalsRow))},t.prototype.getMergeRowHeader=function(n,i){for(var r,a,u,v,b,k,y,p=t._getDataRowCount(n),h=n.schema.tableRowLevel,s={},c=h-1,l=0;l<c;++l)s[l]=[];for(r=0;r<p;r++)if(a=n.data.rowHeader[r],a)for(u=0;u<h;u++){var f=a[u],w=r,o=u;f&&f.value!==undefined?(k=f.value,h>=2&&u<c&&(y=new e(w,o,k),y.type=f.type?f.type:undefined,s[u].push(y))):w<p-1+t.getColLevel(n)&&o<c&&s[o].length>0&&(n.data.rowHeader[r][o-1]&&n.data.rowHeader[r][o-1].type||f&&f.type||(v=s[o],b=v[v.length-1],++b.rowCount))}return s},t.prototype._hasBorder=function(n){return n.borderBottomString||n.borderTopString||n.borderLeftString||n.borderRightString||n.insideHorizontalBorderString||n.insideVerticalBorderString?!0:!1},t.prototype._renderRangeBorder=function(n,t){var f=new GC.Spread.Sheets.LineBorder("",GC.Spread.Sheets.LineStyle.empty),r=this._sheet,h,s,e,o,i;t.borderBottomString&&(n.row>=0&&n.row+n.rowCount<this._sheet.getRowCount()&&(h=r.getRange(n.row+n.rowCount,n.col,1,n.colCount,n.sheetArea),h.setBorder(f,{top:!0})),i=u.ConvertCssRuleToBorderLine(t.borderBottomString),n.setBorder(i,{bottom:!0}));t.borderTopString&&(n.row>0&&(e=r.getRange(n.row-1,n.col,1,n.colCount,n.sheetArea),e.setBorder(f,{bottom:!0})),i=u.ConvertCssRuleToBorderLine(t.borderTopString),n.row===0&&n.sheetArea===GC.Spread.Sheets.SheetArea.viewport&&(s=GC.Spread.Sheets.SheetArea.colHeader,e=r.getRange(r.getRowCount(s)-1,n.col,1,n.colCount,s),e.setBorder(i,{bottom:!0})),n.setBorder(i,{top:!0}));t.borderLeftString&&(n.col>0&&(o=r.getRange(n.row,n.col-1,n.rowCount,1,n.sheetArea),o.setBorder(f,{right:!0})),i=u.ConvertCssRuleToBorderLine(t.borderLeftString),n.setBorder(i,{left:!0}));t.borderRightString&&(n.col>=0&&n.col+n.colCount<r.getColumnCount()&&(o=r.getRange(n.row,n.col+n.colCount,n.rowCount,1,n.sheetArea),o.setBorder(f,{left:!0})),i=u.ConvertCssRuleToBorderLine(t.borderRightString),n.setBorder(i,{right:!0}));t.insideHorizontalBorderString&&(i=u.ConvertCssRuleToBorderLine(t.insideHorizontalBorderString),n.setBorder(i,{innerHorizontal:!0}));t.insideVerticalBorderString&&(i=u.ConvertCssRuleToBorderLine(t.insideVerticalBorderString),n.setBorder(i,{innerVertical:!0}))},t.prototype._renderStripe=function(n,t){var h=n.getRowCount(),c=n.getColumnCount(),l=t.schema.rowDim.length,o,r,f,s,u,e;if(this._stylesSetByInspector.showBandedRows){for(o=0,r=0;r<h;r++)n.getRowVisible(r)&&(o%2==0&&(f=n.getStyle(r,-1),f||(f=new GC.Spread.Sheets.Style),i._applyStyle(f,this._stylesSetByInspector.firstRowStripe,this._stylesSetByInspector.font),n.setStyle(r,-1,f)),o++);for(o=0,r=0;r<h;r++)n.getRowVisible(r)&&(o%2==1&&(f=n.getStyle(r,-1),f||(f=new GC.Spread.Sheets.Style),i._applyStyle(f,this._stylesSetByInspector.secondRowStripe,this._stylesSetByInspector.font),n.setStyle(r,-1,f)),o++)}if(this._stylesSetByInspector.showBandedCols){for(s=0,u=l;u<c;u++)n.getColumnVisible(u)&&(s%2==0&&(e=n.getStyle(-1,u),e||(e=new GC.Spread.Sheets.Style),i._applyStyle(e,this._stylesSetByInspector.firstColStripe,this._stylesSetByInspector.font),n.setStyle(-1,u,e)),s++);for(s=0,u=l;u<c;u++)n.getColumnVisible(u)&&(s%2==1&&(e=n.getStyle(-1,u),e||(e=new GC.Spread.Sheets.Style),i._applyStyle(e,this._stylesSetByInspector.secondColStripe,this._stylesSetByInspector.font),n.setStyle(-1,u,e)),s++)}},t.prototype._setDefaultStyle=function(n){var t=n.getDefaultStyle();t.textIndent=0;t.vAlign=GC.Spread.Sheets.VerticalAlign.center;delete t.themeFont;i._applyStyle(t,this._stylesSetByInspector.wholeTable,this._stylesSetByInspector.font);n.setDefaultStyle(t,GC.Spread.Sheets.SheetArea.viewport);n.setDefaultStyle(t,GC.Spread.Sheets.SheetArea.colHeader)},t.prototype._copyColumnHeader=function(n){for(var i,e,o,s,r=GC.Spread.Sheets.SheetArea.colHeader,u=n.getRowCount(r),f=n.getColumnCount(r),t=0;t<u;t++){for(i=0;i<f;i++)e=n.getValue(t,i,GC.Spread.Sheets.SheetArea.colHeader),n.setValue(t,i,e),o=n.getStyle(t,i,GC.Spread.Sheets.SheetArea.colHeader),n.setStyle(t,i,o);n.setRowVisible(t,!1)}s=n.getSpans(new GC.Spread.Sheets.Range(0,0,u,f),r);s.forEach(function(t){n.addSpan(t.row,t.col,t.rowCount,t.colCount)})},t.prototype._renderCornerPortion=function(i,r){var l=0,a=0,h=t.getColLevel(r),v=r.schema.tableRowLevel,f=GC.Spread.Sheets.SheetArea.colHeader,p=this._theme,o,s,c;for(i.setRowCount(h,f),o=0;o<v;o++){var u=a+o,e=l+0,y=this._getHeaderStyle(e,u);this.mergeCells(i,0,u,h,1,f);s="";this._stylesSetByInspector.showFieldHeader&&(s=r.schema.rowDim[u].display);i.setStyle(e,u,y,f);c=new n.NormalColumnHeaderCellType;i.setCellType(e,u,c,f);i.setValue(e,u,s,f);this._setRowHeight(e,u,f)}},t.prototype._renderColHeaderPortion=function(i,r){for(var h,f,v,u,c,g,ht,nt,y,tt,it,rt,ut,ft,p=this,ct=0,et=r.schema.tableRowLevel,a=t.getColLevel(r),b=t._getDataColCount(r),wt=this._theme,s=GC.Spread.Sheets.SheetArea.colHeader,w=r.schema.measureLength,lt=n.SR.spread_pivot_table_grand_total,at=n.SR.spread_pivot_table_subtotal,ot=this.mergeTotals(r),st=ot[0],k=ot[1],l=0;l<a;l++)for(v=r.data.colHeader[l],c=0;c<b;c++)h=v[c],h&&h.display===!1&&(this._colHiddenMap[c+et]=!0);for(l=0;l<a;l++)if(f=l+ct,v=r.data.colHeader[l],v){for(u=null,c=0;c<b;c++){var h=v[c],o=c+et,d=h&&h.value!==undefined;if(f<a-1&&(g=st[f]&&st[f][o],(d||g||this._colHiddenMap[o])&&u&&(ht=o-u.col,ht>1&&(nt=u.col,f<a-(w>1?1:0)-1&&this._stylesSetByInspector.showPlus?i.setCellType(u&&u.row,u&&u.col,new n.CollapseHeaderCellType,s):i.setCellType(u&&u.row,u&&u.col,new n.NormalColumnHeaderCellType,s),k.push({row:f,col:nt,colCount:o-nt,rowCount:1}))),g?u=null:d&&(u=new e(f,o,h.value),u.path=h.path||[])),h!==undefined){y=h.value;y===null&&(y=n.SR.nullvalue_display);d||(y=i.getValue(f,o-1,s));i.setValue(f,o,y,s);this._setRowHeight(f,o,s);tt=i.getTag(f,o,s)||{collapse:!1};tt.backgroundValue=h.backgroundValue;i.setTag(f,o,tt,s);var vt=f,yt=o,pt=this._getHeaderStyle(vt,yt);i.setStyle(f,o,pt,s);it=new n.NormalColumnHeaderCellType;rt=h.value===lt||h.value===at;h.type!==undefined||rt?(ut=it,rt&&f<a-1&&(ut=new n.NormalColumnHeaderCellType),i.setCellType(f,o,ut,s)):i.setCellType(f,o,it,s);this._colHiddenMap[o]&&i.setColumnVisible(o,!1,s)}}ft=b+r.schema.tableRowLevel;u&&u.col<ft-1&&k.push({row:f,col:u.col,colCount:ft-u.col,rowCount:1});f<a-(w>1?1:0)-1&&this._stylesSetByInspector.showPlus&&u&&i.setCellType(u&&u.row,u&&u.col,new n.CollapseHeaderCellType,s)}this._colHeaderCollapseRange={};k.forEach(function(n){p.mergeCells(i,n.row,n.col,n.rowCount,n.colCount,s);n.row<a-(w>1?1:0)-1&&(p._colHeaderCollapseRange[n.row]===undefined&&(p._colHeaderCollapseRange[n.row]={}),p._colHeaderCollapseRange[n.row][n.col]=n.colCount-w)})},t.prototype.mergeTotals=function(n){for(var r,y,o,s,u,p,c,f,l,i={},a=[],v=t.getColLevel(n),w=t._getDataColCount(n),b=0,k=n.schema.tableRowLevel,h=n.schema.measureLength,e=0;e<v-1;++e)if(r=e+b,y=this._pivotData.data.colHeader[e],y)for(o=0;o<w;++o)if(s=y[o],u=o+k,s&&s.value&&s.path&&s.path.length<t.getColLevel(n)&&!(i[r]&&i[r][u])){if(h>1&&a.push({row:r,col:u,rowCount:1,colCount:h}),p=v-e-1,p>1)for(c=0;c<h;++c)a.push({row:r+1,col:u+c,rowCount:p,colCount:1});for(f=r;f<v;++f)for(i[f]||(i[f]={}),l=u;l<u+h;++l)i[f][l]=!0}return[i,a]},t.prototype._renderRowHeaderPortion=function(i,r){var a=0,p=0,v=t._getDataRowCount(r),c=r.schema.tableRowLevel,w=this._theme,f={},l=c-1,s,y,u,h;for(this._totalsRegion=new o,s=0;s<l;++s)f[s]=[];for(y=function(o){var b=r.data.rowHeader[o],d,rt,w,g,ut,nt,ft,k,tt,et,it;if(!b)return"continue";for(d=!0,b.forEach(function(n){n&&n.display===!1&&(d=!1)}),d||(u._rowHiddenMap[o+a]=!0),rt=!1,b[0]&&b[0].type===64&&(rt=!0),w=0;w<c;w++){var y=b[w],h=o+a,s=w+p;i.setValue(h,s,undefined);y&&y.value!==undefined?(k=y.value,k===null&&(k=n.SR.nullvalue_display),i.setValue(h,s,k),c>=2&&w<l&&(tt=new e(h,s,k),tt.type=y.type?y.type:undefined,f[w].push(tt))):h<v-1+t.getColLevel(r)&&s<l&&f[s].length>0&&(r.data.rowHeader[o][s-1]&&r.data.rowHeader[o][s-1].type||y&&y.type||(g=f[s],ut=g[g.length-1],++ut.rowCount,nt=r.data.rowHeader[o][s+1],nt&&nt.type||(ft=i.getValue(h-1,s),i.setValue(h,s,ft))));et=u._getDataStyle(h,s);i.setStyle(h,s,et);u._setRowHeight(h,s);u._getTotalsRegion(y,h);u._rowHiddenMap[h]&&i.setRowVisible(h,!1,GC.Spread.Sheets.SheetArea.viewport);y&&y.backgroundValue!==undefined&&(it=i.getTag(h,s,GC.Spread.Sheets.SheetArea.viewport)||{},it.backgroundValue=y.backgroundValue,i.setTag(h,s,it,GC.Spread.Sheets.SheetArea.viewport))}},u=this,h=0;h<v;h++)y(h);this.addMergeForRowHeader(f,i)},t.prototype.addMergeForRowHeader=function(t,i){var r=this;Object.keys(t).map(function(n){return t[n]}).forEach(function(t,u){t.forEach(function(t){var u=t.row,f=t.col,c=t.rowCount,l=t.colCount,e,h;if(t.type){r._mergeRangeRowCount[[u]+"_"+[f]]=1;return}var o=i.getSpans(t),a=o&&o.length>0,v=[n.SR.spread_pivot_table_subtotal,n.SR.spread_pivot_table_grand_total],y=r._getFontSize(),s=new n.NormalColumnHeaderCellType;r._stylesSetByInspector.showPlus&&(s=new n.CollapseHeaderCellType);e=c;v.indexOf(t.text)===-1?(i.setValue(u,f,t.value),i.setCellType(u,f,s,GC.Spread.Sheets.SheetArea.viewport)):e=1;r._mergeRangeRowCount[[u]+"_"+[f]]=e;a||(i.addSpan(u,f,e,l),h=i.getTag(u,f)||{collapse:!1},i.setTag(u,f,h))})})},t.prototype._renderDataPortion=function(n,i){for(var s,r,h,u,f,o,c=0,l=i.schema.tableRowLevel,a=t._getDataRowCount(i),v=t._getDataColCount(i),b=this._theme,e=0;e<a;e++)if(s=i.data.data[e],s){for(r=e+c,h=0,u=0;u<v;u++){f=s[u];o=u+l;f&&(typeof f.value=="number"&&isNaN(f.value)||n.setValue(r,o,f.value));var y=r,p=o,w=this._getDataStyle(y,p);n.setStyle(r,o,w)}this._setRowHeight(r,h)}},t.prototype._renderTotalsRegionStyle=function(n,i){var r=this,u=t.getColCount(n);Object.keys(this._totalsRegion).forEach(function(f){var e=parseInt(f,10)===32,o=e&&i.subtotals!==1,s=!e&&(i.grandTotals===4||i.grandTotals===1);(o||!e)&&(s||e)&&r._totalsRegion[f].forEach(function(i){for(var f=0;f<u;++f)r._renderInspectorStyle2Table(i+t.getColLevel(n),f)})})},t.prototype._renderInspectorStyle2Table=function(n,t){var r=this,i;if(this._sheet){if(i=this._theme.getSpreadJSStyle(n,t),!i)return;Object.keys(i).forEach(function(u){var f=r._sheet.getStyle(n,t)||new GC.Spread.Sheets.Style;f[u]=i[u];r._sheet.setStyle(n,t,f)})}},t.prototype._expandCollapseHeader=function(t){if(t.getParent().unbind(GC.Spread.Sheets.Events.CellClick),this._stylesSetByInspector.showPlus){var i=this;t.getParent().bind(GC.Spread.Sheets.Events.CellClick,function(t,r){if(i._isHitOnCollapseIcon(r)){var u=r.sheet,f=r.row,e=r.col,o=r.sheetArea,c=u.getCellType(f,e,o),s=o===GC.Spread.Sheets.SheetArea.viewport&&c instanceof n.CollapseHeaderCellType,h=o===GC.Spread.Sheets.SheetArea.colHeader;if(s||h){u.suspendPaint();u.suspendEvent();try{s&&i._expandCollapseRowHeader(u,f,e);h&&i._expandCollapseColHeader(u,f,e)}finally{u.resumeEvent();u.resumePaint()}}}})}},t.prototype._isHitOnCollapseIcon=function(n){var o=this,f=n.sheet,i=n.row,r=n.col,e=n.sheetArea,u={isHitOnCollapseIcon:!1},t;return e===GC.Spread.Sheets.SheetArea.colHeader?(t=Object.keys(this._colHeaderCollapseRange[i]||{}).filter(function(n){return r>=parseInt(n,10)&&parseInt(n,10)+o._colHeaderCollapseRange[i][n]>=r})[0],t!==undefined&&(t=parseInt(t,10),u=f.getTag(i,t,e))):r<this._pivotData.schema.tableRowLevel&&(u=f.getTag(i,r)),u&&u.isHitOnCollapseIcon},t.prototype._expandCollapseRowHeader=function(n,t,i){var r=this,u=r._mergeRangeRowCount[[t]+"_"+[i]],s,f,l,e,o,h,c;if(!isNaN(u)){if(s=n.getTag(t,i),!s)return;for(f=!s.collapse,l=i+1,e=t;e<t+u-1;++e)for(o=l;o<r._pivotData.schema.tableRowLevel-1;++o)h=n.getTag(e,o)||{},h.collapse=!1,n.setTag(e,o,h);for(r._collapsedRange[t]=u;u;)c=t+u-1,r._rowHiddenMap[c]&&f||n.setRowVisible(c,f,GC.Spread.Sheets.SheetArea.viewport),u-=1;if(r._expandRowHeader(n,f,t,i),f){var a=n.getViewportTopRow(1),y=n.getViewportBottomRow(1),v=a;t+r._collapsedRange[t]===a&&(v=t);n.showRow(v,GC.Spread.Sheets.VerticalPosition.top)}r._showScrollBarOrNot(r._pivotData)}},t.prototype._expandCollapseColHeader=function(n,i,r){var f=this,k=GC.Spread.Sheets.SheetArea.colHeader,u=Object.keys(f._colHeaderCollapseRange[i]||{}).filter(function(n){return r>=parseInt(n,10)&&parseInt(n,10)+f._colHeaderCollapseRange[i][n]>=r})[0],e=f._colHeaderCollapseRange[i]&&f._colHeaderCollapseRange[i][u],l,o,a,s,h,v,y,p,w,b,c;if(e!==undefined){if(u=parseInt(u,10),l=n.getTag(i,u,k),!l)return;if(o=!0,l&&(o=!l.collapse),a=t.getColLevel(f._pivotData),a>2)for(s=i+1;s<a-1;++s)for(h=u;h<u+e;++h)v=n.getTag(s,h)||{collapse:!1},v.collapse=!1,n.setTag(s,h,v,GC.Spread.Sheets.SheetArea.colHeader);for(y=e;e;)p=u+e-1,this._colHiddenMap[p]&&o||n.setColumnVisible(p,o,GC.Spread.Sheets.SheetArea.colHeader),e-=1;this._expandColHeader(n,o,u,y,i);o?(w=n.getViewportLeftColumn(1),b=w,parseInt(u,10)+y===w&&(b=parseInt(u,10)),n.showColumn(b,GC.Spread.Sheets.HorizontalPosition.left),f._colSelectCellMap[u]&&(c=f._colSelectCellMap[u],n.setSelection(c.row,c.col,c.rowCount,c.colCount))):f._colSelectCellMap[u]=n.getSelections()[0]}f._showScrollBarOrNot(f._pivotData)},t.prototype._getAllHeaderValue=function(n,t,i,r){for(var c,s,l,e,h,f,o={},a=this._pivotData.data.rowHeader[n],u=0;u<i;u++){if(c=this._pivotData.schema.rowDim[u],e=a[u],e&&!e.type&&e.value!==undefined){o[c.name]=e.value;continue}for(s=n-1,f=undefined;s>=0&&f===undefined;)f=this._pivotData.data.rowHeader[s][u].value,s--;if(f!==undefined){o[c.name]=f;continue}}for(u=0;u<r;u++){if(l=this._pivotData.schema.colDim[u],e=this._pivotData.data.colHeader[u][t],e&&e.value!==undefined){o[l.name]=e.value;continue}for(h=t-1,f=undefined;h>=0&&f===undefined;)f=this._pivotData.data.colHeader[u][h].value,h--;if(f!==undefined){o[l.name]=f;continue}}return o},t.prototype._expandRowHeader=function(n,t,i,r){var h=i+this._collapsedRange[i],c,e,a,l,o,v,y,u,p,f;if(t){for(c=this._rowSubtotalMap.length-1;c>=0;c--)if(e=this._rowSubtotalMap[c],e.row>=i&&e.row<=h){for(u=n.getSpan(e.row,e.col),u&&(n.removeSpan(u.row,u.col),u.rowCount-=1,n.addSpan(u.row,u.col,u.rowCount,u.colCount)),this._rowHiddenMap[e.subTotalRow]&&n.setRowVisible(e.subTotalRow,!1,GC.Spread.Sheets.SheetArea.viewport),f=r;f<n.getColumnCount();f++){for(a=this._getDataStyle(e.subTotalRow,f),l=0;l<this._colSubtotalMap.length;l++)o=this._colSubtotalMap[l],f>=o.col+o.firstCol&&f<o.col+o.firstCol+o.measuresLength&&(a=this._getDataStyle(e.subTotalRow,o.col));v=n.getStyle(e.subTotalRow,f);y=this.copyStyleBorder(v,a);n.setStyle(e.subTotalRow,f,y)}this._rowSubtotalMap.splice(c,1)}}else{for(u=n.getSpan(i,r),u?n.removeSpan(u.row,u.col):u=new GC.Spread.Sheets.Range(i,r,1,1),u.rowCount+=1,p=new s(i,r),p.subTotalRow=h,this._rowHiddenMap[h]&&n.setRowVisible(h,!0,GC.Spread.Sheets.SheetArea.viewport),f=r+1;f<n.getColumnCount();f++){var v=n.getStyle(h,f),w=f<this._pivotData.schema.tableRowLevel?n.getStyle(i,this._pivotData.schema.tableRowLevel-1):n.getStyle(i,f),y=this.copyStyleBorder(v,w);n.setStyle(h,f,y)}this._rowSubtotalMap.push(p);n.addSpan(u.row,u.col,u.rowCount,u.colCount)}},t.prototype._expandColHeader=function(t,i,r,u,f){var d=r+u,l=this._pivotData.schema.measureLength,tt=t.getRowCount(),it=GC.Spread.Sheets.SheetArea.colHeader,a,h,y,p,nt,v,e,o,w,b,k;if(i){for(a=this._colSubtotalMap.length-1;a>=0;a--)if(h=this._colSubtotalMap[a],h.col>=r&&h.col<r+u+l-1){if(this._colHiddenMap[d])for(e=0;e<h.measuresLength;e++)v=h.col+h.firstCol+e,t.setColumnVisible(v,!1,GC.Spread.Sheets.SheetArea.colHeader);for(e=0;e<l;e++)for(o=0;o<tt;o++){var c=h.col+h.firstCol+e,rt=t.getStyle(o,c),g=this._getDataStyle(o,c);for(y=0;y<this._rowSubtotalMap.length;y++)p=this._rowSubtotalMap[y],o===p.row+p.subTotalRow&&(g=this._getDataStyle(p.row,c));nt=this.copyStyleBorder(rt,g);t.setStyle(o,c,nt)}w=h.row+1;b=h.col+h.firstCol;t.setText(w,b,n.SR.spread_pivot_table_subtotal,it);this._colSubtotalMap.splice(a,1)}}else{if(this._colHiddenMap[d])for(e=0;e<l;e++)v=d+e,t.setColumnVisible(v,!0,GC.Spread.Sheets.SheetArea.colHeader);for(e=0;e<l;e++)for(o=0;o<tt;o++){var c=r+u+e,rt=t.getStyle(o,c),g=t.getStyle(o,r+e),nt=this.copyStyleBorder(rt,g);t.setStyle(o,c,nt)}w=f+1;b=r+u;t.setText(w,b,"",it);k=new s(f,r);k.firstCol=u;k.measuresLength=l;this._colSubtotalMap.push(k)}},t.prototype.copyStyleBorder=function(n,t){return t=t?t.clone():new GC.Spread.Sheets.Style,n&&(t.borderLeft=this.cloneBorder(n.borderLeft),t.borderRight=this.cloneBorder(n.borderRight),t.borderTop=this.cloneBorder(n.borderTop),t.borderBottom=this.cloneBorder(n.borderBottom)),t},t.prototype.cloneBorder=function(n){return n?new GC.Spread.Sheets.LineBorder(n.color,n.style):undefined},t.prototype.mergeCells=function(n,t,i,r,u,f){var e=n.getSpans(new GC.Spread.Sheets.Range(t,i,r,u),f);e.forEach(function(t){n.removeSpan(t.row,t.col,f)});(r>1||u>1)&&n.addSpan(t,i,r,u,f)},t.prototype.getTableWidth=function(n){for(var u=this._sheet,r=0,f=t.getColCount(n),e=GC.Spread.Sheets.SheetArea.viewport,i=0;i<f;++i)r+=u.getColumnWidth(i,e);return r},t.prototype.getTableHeight=function(n){for(var e,i,f=this._sheet,r=0,o=t.getRowCount(n),s=t.getColLevel(n),u=0;u<s;++u)r+=f.getRowHeight(u,GC.Spread.Sheets.SheetArea.colHeader);for(e=GC.Spread.Sheets.SheetArea.viewport,i=0;i<o;++i)r+=f.getRowHeight(i,e);return r},t.prototype._getTotalsRegion=function(n,t){if(n){var i=[32,64,96];i.indexOf(n.type)>-1&&this._totalsRegion[n.type].indexOf(t)===-1&&this._totalsRegion[n.type].push(t)}},t.prototype._setRowHeight=function(n,t,i){isNaN(this._stylesSetByInspector.rowHeight)||this._sheet.setRowHeight(n,this._stylesSetByInspector.rowHeight,i)},t.prototype._getFontSize=function(){var n=this._stylesSetByInspector.font.split(" "),t=i.defaultFontSize;return n&&!isNaN(parseInt(n[0],10))&&(t=n[0]),t},t.prototype.autoResizeColumn=function(n,i){var s=this,r;n.suspendEvent();try{var e=n.getParent(),u=[],o=t.getColCount(i),f=0;for(r=0;r<o;r++)this._stylesSetByInspector.isAutofitColumn?u.push({col:r+f}):n.setColumnWidth(r+f,this._stylesSetByInspector.columnWidth);u.length>0&&e.commandManager().execute({cmd:"autoFitColumn",sheetName:n.name()||"Sheet1",columns:u,isRowHeader:!0,autoFitType:GC.Spread.Sheets.AutoFitType.cellWithHeader})}finally{n.resumeEvent()}},t.prototype._getPivotRanges=function(i,r){for(var f,s,l,a=0,v=i.schema.tableRowLevel,y=t._getDataRowCount(i),p=t._getDataColCount(i),o={},e=0;e<p;++e)for(f=0;f<y;++f)if(s=i.data.data[f],s){var u=s[e],h=f+a,c=e+v;u||(l=this._getCellPositionInPivotTable(h,c,i),l&&(u=new n.TableDataCell,u.displayName=l.displayName));u&&(r===undefined&&u.type===undefined?this._getPivotRangesCore(u,h,c,o):(u.type&r)>0&&this._getPivotRangesCore(u,h,c,o))}return o},t.prototype.getCurrentGroupLastCelRowIndex=function(n){return n.row+n.rowCount-1},t.prototype._getPivotRangesCore=function(n,t,i,r){var u=n.displayName,f,e;r[u]===undefined?r[u]=[new GC.Spread.Sheets.Range(t,i,1,1)]:(f=r[u][r[u].length-1],e=this.getCurrentGroupLastCelRowIndex(f),t-e==1?f.rowCount+=1:r[u].push(new GC.Spread.Sheets.Range(t,i,1,1)))},t.prototype._getCellPositionInPivotTable=function(n,t,i){var e=n,o=t-i.schema.tableRowLevel,f,r,u;return i.data.rowHeader&&i.data.rowHeader[e]&&(r=i.data.rowHeader[e].slice(-1)[0]),i.data.colHeader&&(u=i.data.colHeader.map(function(n){return n[o]}).slice(-1)[0]),u?f={path:u.path,displayName:u.displayName}:r&&(f={path:r.path,displayName:r.displayName}),f},t._getDataRowCount=function(n){var t=n.data.data.length,i=n.data.rowHeader.length;return Math.max(t,i)},t._getDataColCount=function(n){var t=n.data.data.reduce(function(n,t){return Math.max(n,t.length)},0),i=n.data.colHeader.reduce(function(n,t){return Math.max(n,t.length)},0);return Math.max(t,i)},t.prototype.setTheme=function(n){this._theme=n},t.getRowCount=function(n){return this._getDataRowCount(n)+t.getColLevel(n)},t.getColCount=function(n){return n.schema.tableRowLevel+this._getDataColCount(n)},t.getColLevel=function(n){return n.schema.tableColLevel+n.schema.valueLevel},t.prototype.getPivotValueRanges=function(n){return this._pivotValueRanges||(this._pivotValueRanges=this._getPivotRanges(this._pivotData,undefined)),this._pivotValueRanges[n]},t.prototype.getPivotSubtotalRanges=function(n){return this._pivotSubtotalRanges||(this._pivotSubtotalRanges=this._getPivotRanges(this._pivotData,32)),this._pivotSubtotalRanges[n]},t.prototype.getPivotGrandtotalRanges=function(n){return this._pivotGrandtotalRanges||(this._pivotGrandtotalRanges=this._getPivotRanges(this._pivotData,64)),this._pivotGrandtotalRanges[n]},t.prototype._showScrollBarOrNot=function(n){if(this._sheet){var t=this._sheet.getParent(),u=t.getHost(),f=u.offsetWidth||this._sheet.getViewportWidth(1),e=u.offsetHeight||this._sheet.getViewportHeight(1),o=this.getTableWidth(n),s=this.getTableHeight(n),i=o>f,r=s>e;i&&(r=s+15>e);r&&(i=o+15>f);t.options.showHorizontalScrollbar=i;t.options.showVerticalScrollbar=r}},t.prototype._getHeaderStyle=function(n,t){return this._theme.getSpreadJSStyle(n,t)},t.prototype._getDataStyle=function(n,i){return this._theme.getSpreadJSStyle(n+t.getColLevel(this._pivotData),i)},t.prototype.setInspectorStyles=function(n){this._stylesSetByInspector=n;this._stylesSetByInspector.font=i._getFontStr(this._stylesSetByInspector.wholeTable,this._stylesSetByInspector.font)},t.prototype.getInspectorStyles=function(){return this._stylesSetByInspector},t}();n.PivotTable=f;u=function(){function n(){}return n.ConvertCssRuleToBorderLine=function(n){var t=this.ConvertCssRuleToBorderProps(n),i;return t?(i=GC.Spread.Sheets.LineStyle.empty,t.BorderWidth==1?t.BorderStyle==r.solid?i=GC.Spread.Sheets.LineStyle.thin:t.BorderStyle==r.dashed?i=GC.Spread.Sheets.LineStyle.dashed:t.BorderStyle==r.dotted&&(i=GC.Spread.Sheets.LineStyle.dotted):t.BorderWidth==2?t.BorderStyle==r.solid?i=GC.Spread.Sheets.LineStyle.medium:t.BorderStyle==r.dashed&&(i=GC.Spread.Sheets.LineStyle.mediumDashed):t.BorderWidth>=3&&(t.BorderStyle==r.solid?i=GC.Spread.Sheets.LineStyle.thick:t.BorderStyle==r.double&&(i=GC.Spread.Sheets.LineStyle.double)),new GC.Spread.Sheets.LineBorder(t.BorderColor,i)):null},n.ConvertCssRuleToBorderProps=function(n){var i=this,u,t;if(n)return u=n.trim().split(" "),t=new h,u.forEach(function(n){var u=n.toLowerCase(),f,e,o;i.IsWidthString(u)?u.endsWith("px")&&(f=parseFloat(u.substr(0,u.length-2)),isNaN(f)||(t.BorderWidth=f)):i.IsBorderStyleString(u)?(e=r[u],e!==undefined&&(t.BorderStyle=e)):(o=n,o!=null&&(t.BorderColor=c.Convert(o.replace(/_/g," "))))}),t},n.IsWidthString=function(n){return this._matchWidthString.test(n)||this._matchWidthKeywordString.test(n)},n.IsBorderStyleString=function(n){return this._matchBorderStyleString.test(n)},n._matchBorderStyleString=new RegExp("^(none|hidden|dotted||solid|dashed|double|groove|ridge|inset|outset)$","g"),n._matchWidthString=new RegExp("^([1-9][0-9]*)+(.[0-9]{1,2})?(px|cm|mm|in|pc|pt|em|rem|ch|ex|vh|vw|vmin|vmax)$","g"),n._matchWidthKeywordString=new RegExp("^(thin|medium|thick|inherit|initial|unset)$","g"),n}();h=function(){function n(){}return n}(),function(n){n[n.none=0]="none";n[n.double=1]="double";n[n.hidden=2]="hidden";n[n.dotted=3]="dotted";n[n.solid=4]="solid";n[n.dashed=5]="dashed";n[n.groove=6]="groove";n[n.ridge=7]="ridge";n[n.inset=8]="inset";n[n.outset=9]="outset"}(r||(r={}))}(PivotData||(PivotData={})),function(n){var t=function(){function n(n,t,i,r,u,f){this.label=n;this.header=t;this.columnIndex=i;this.backgroundLabel=r;this.backgroundValue=u;this.backgroundValueColumnIndex=f}return n}(),i,r;n.PivotTableHeaderInfo=t;i=function(){function n(n,t,i,r,u,f){this.dataType=n;this.row=t;this.col=i;this.value=r;this.colHeaders=u;this.rowHeaders=f}return n}();n.PivotTableEventParameter=i;r=function(){function r(n,t,i){this._sheet=n;this._cellTypeMetaData=t;this._pivotTableSetting=t.PivotTableSetting;this._listview=i;this._rowHeaderOffset=0;i.isRowHeaderVisible()&&this._rowHeaderOffset++;i.isRowHeaderCheckBoxVisible()&&this._rowHeaderOffset++}return r.prototype.bindingPivotTableClickEvent=function(t,r,u){var s=this._sheet,f=this.getClickCellAreaType(t,u),e=this,o=new i(f,t.row,this.getColForClickEvent(t.col,f),s.getValue(t.row,t.col,t.sheetArea),e.getColHeaders(t.col),e.getRowHeaders(t.row,n.PivotTableClickCell[f]));r.trigger(n.Events.PivottableClick,o);r.trigger(n.Events.PivottableCommandEvent,o)},r.prototype.getClickCellAreaType=function(t,i){var e=this._cellTypeMetaData,u=this._pivotTableSetting,o=u.Rows?u.Rows.length:0,s=1;u.Values&&(s=u.Values.length);var c=e.ShowRowsTotal,h=e.ShowColsTotal,f=this._sheet,r=n.PivotTableClickCell.Data;return i&&(r=n.PivotTableClickCell.Subtotal),t.sheetArea===GC.Spread.Sheets.SheetArea.colHeader?(r=n.PivotTableClickCell.ColHeader,t.col<=o-1&&(r=n.PivotTableClickCell.FirstCell)):t.col<=o-1?r=n.PivotTableClickCell.RowHeader:c&&t.col>=f.getColumnCount()-s?r=h&&t.row>=f.getRowCount()-1?n.PivotTableClickCell.GrandTotal:n.PivotTableClickCell.RowTotal:h&&t.row>=f.getRowCount()-1&&(r=n.PivotTableClickCell.ColTotal),r},r.prototype.getColForClickEvent=function(t,i){if(i!==n.PivotTableClickCell.FirstCell&&i!==n.PivotTableClickCell.RowHeader){var r=this._cellTypeMetaData.PivotTableSetting,u=r.Rows?r.Rows.length:0;return t-u}return t},r.prototype.writeDataToSpreadView=function(n){this.writeData(n.row,n.col,n.oldValue,n.newValue)},r.prototype.clearCellByDeleteKey=function(n){var t,i;if(n.action===GC.Spread.Sheets.RangeChangedAction.clear&&n.changedCells.length>0){for(t=0;t<n.changedCells.length;t++)i=n.changedCells[t],this.writeData(i.row,i.col,null,null,!1);return!0}return!1},r.prototype.writeData=function(t,i,r,u,f){var s,l;f===void 0&&(f=!0);var e=this.getColHeaders(i),h=this.getRowHeaders(t),a=this.getHeaderDataIndexs(e,h),c=this.getValueColumnIndex(e),o=this._listview.getMergedColumnInfos()[c];u&&o&&(o.ColumnDataType===n.ColumnDataType.Date||o.ColumnDataType===n.ColumnDataType.Time)&&(s=this.tryConvertOADateToDate(u),s instanceof Date&&(u=n.ConvertDateToOADate(s)));l=this.createNewData(e,h,u);this.writeDataToListView(l,a,c,r,u,f)},r.prototype.tryConvertOADateToDate=function(t){var i,u;return typeof t=="string"&&t.charAt(0)==="/"&&(i=void 0,r._jsonOADateRegExp.test(t)?(i=t.match(r._jsonOADateRegExp),t=n.ConvertOADateToDate(parseFloat(i[1]))):r._jsonDateRegExp.test(t)&&(i=t.match(r._jsonDateRegExp),t=new Date(parseFloat(i[1])))),typeof t=="string"&&(u=new Date(t),isNaN(u.valueOf())||(t=u)),t},r.prototype.writeDataToListView=function(n,t,i,r,u,f){var e,o;f===void 0&&(f=!0);e=n.slice();e[i]=r;o=this.indexOfListView(e,t);o===-1?f&&(this._listview.addNewRow(n),this._listview.selectRow(this._listview.getRowCount()-1)):this._listview.setValue(o,i,u);this._listview.getDataCommitMode()===0&&this._listview.commitEditChange()},r.prototype.getHeaderDataIndexs=function(n,t){var i=[];return t.forEach(function(n){i.push(n.columnIndex);n.backgroundValueColumnIndex>=0&&i.push(n.backgroundValueColumnIndex)}),n.forEach(function(n){n.columnIndex>=0&&i.push(n.columnIndex);n.backgroundValueColumnIndex>=0&&i.push(n.backgroundValueColumnIndex)}),i},r.prototype.createNewData=function(n,t,i){var r=[],f,u;if(t.forEach(function(n){r[n.columnIndex]=n.header;n.backgroundValueColumnIndex!==undefined&&(r[n.backgroundValueColumnIndex]=n.backgroundValue)}),f=this._pivotTableSetting.Values,f.length>1){for(u=0;u<n.length-1;u++)r[n[u].columnIndex]=n[u].header,n[u].backgroundValueColumnIndex!==undefined&&(r[n[u].backgroundValueColumnIndex]=n[u].backgroundValue);f.forEach(function(t){t.DatabaseColumnName===n[n.length-1].header&&(r[t.ListViewColumnIndex]=i)})}else n.forEach(function(n){r[n.columnIndex]=n.header;n.backgroundValueColumnIndex!==undefined&&(r[n.backgroundValueColumnIndex]=n.backgroundValue)}),r[f[0].ListViewColumnIndex]=i;return r},r.prototype.getValueColumnIndex=function(n){var t=-1,i=this._pivotTableSetting.Values;return i.length>1?i.forEach(function(i){i.DatabaseColumnName===n[n.length-1].header&&(t=i.ListViewColumnIndex)}):t=i[0].ListViewColumnIndex,t},r.prototype.indexOfListView=function(n,t){for(var u,i,f=this._listview.getRowCount(),r=0;r<f;r++){for(u=!0,i=0;i<t.length;i++)if(this._listview.getValue(r,t[i])!=n[t[i]]){u=!1;break}if(u)return r}return-1},r.prototype.updateListViewSelection=function(n){var t=n.newSelections[0],i=this.getColHeaders(t.col),u=this.getRowHeaders(t.row),e=this.createNewData(i,u,this._sheet.getValue(t.row,t.col)),o=this.getHeaderDataIndexs(i,u),f=this.getValueColumnIndex(i),r=this.indexOfListView(e,o);r!==-1&&f!==-1&&(this._listview.selectRow(r),this._listview.setSelection(r,f-this._rowHeaderOffset))},r.prototype.getColHeaders=function(n){var e=this._sheet,u=this._pivotTableSetting.Cols,o=[],s=0,i,h,f,c;if(u&&u.length>0)for(s=u.length,i=0;i<s;i++){var r=u[i],l=void 0,a=void 0,v=void 0;r.BackgroundValue&&(l=r.BackgroundValue.DatabaseColumnName,h=this.getTagFromSheet(this._sheet,i,n,GC.Spread.Sheets.SheetArea.colHeader),a=h&&h.backgroundValue,v=r.BackgroundValue.ListViewColumnIndex);f=this.getValueFromSheet(e,i,n,GC.Spread.Sheets.SheetArea.colHeader);f===PivotData.SR.nullvalue_display&&(f=null);o.push(new t(r.DatabaseColumnName,f,r.ListViewColumnIndex,l,a,v))}return c=e.getRowCount(GC.Spread.Sheets.SheetArea.colHeader),c>s&&o.push(new t("ValueHeader",this.getValueFromSheet(e,c-1,n,GC.Spread.Sheets.SheetArea.colHeader),-1)),o},r.prototype.getRowHeaders=function(i,r){var p=this._sheet,e=this._pivotTableSetting.Rows,h=[],o,l,u,c,s;if(!e||e.length===0)return h;for(o=GC.Spread.Sheets.SheetArea.viewport,r===n.PivotTableClickCell.ColHeader&&(o=GC.Spread.Sheets.SheetArea.colHeader),l=e.length,u=0;u<l;u++){var f=e[u],a=void 0,v=void 0,y=void 0;f.BackgroundValue&&(a=f.BackgroundValue.DatabaseColumnName,c=this.getTagFromSheet(this._sheet,i,u,o),v=c&&c.backgroundValue,y=f.BackgroundValue.ListViewColumnIndex);s=this.getValueFromSheet(p,i,u,o);s===PivotData.SR.nullvalue_display&&(s=null);h.push(new t(f.DatabaseColumnName,s,f.ListViewColumnIndex,a,v,y))}return h},r.prototype.getValueFromSheet=function(n,t,i,r){var u=n.getSpans(new GC.Spread.Sheets.Range(t,i,1,1),r);return u&&u.length>0?n.getValue(u[0].row,u[0].col,r):n.getValue(t,i,r)},r.prototype.getTagFromSheet=function(n,t,i,r){var u=n.getSpans(new GC.Spread.Sheets.Range(t,i,1,1),r);return u&&u.length>0?n.getTag(u[0].row,u[0].col,r):n.getTag(t,i,r)},r._jsonDateRegExp=new RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),r._jsonOADateRegExp=new RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),r}();n.PivotTableEventHandler=r}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){function s(n){return typeof n=="number"&&(n=Math.round(n*1e6)/1e6),n}function u(n){var t;return t=typeof n=="string"?parseFloat(n):n,t*o}var i,r,t,e,f,o;(function(n){n[n.Other=0]="Other";n[n.Number=1]="Number";n[n.Bool=2]="Bool";n[n.Date=3]="Date";n[n.Time=4]="Time";n[n.String=5]="String";n[n.Image=6]="Image";n[n.Attachment=7]="Attachment";n[n.User=8]="User"})(i||(i={})),function(n){n.FirstCell="FirstCell";n.ColHeader="ColHeader";n.RowHeader="RowHeader";n.Data="Data";n.Subtotal="Subtotal";n.ColTotal="ColTotal";n.RowTotal="RowTotal";n.GrandTotal="GrandTotal"}(r=n.PivotTableClickCell||(n.PivotTableClickCell={})),function(n){n[n.sum=0]="sum";n[n.avg=1]="avg";n[n.cnt=2]="cnt";n[n.dst=3]="dst";n[n.max=4]="max";n[n.min=5]="min";n[n.first=6]="first";n[n.last=7]="last";n[n.custom=8]="custom";n[n.none=9]="none"}(t||(t={}));e=0;f=function(f){function o(t,i,r,u){var o=f.call(this,t,i,r,u)||this;return o._pivotTableCalcSourceIndex=0,o._isFillHandlerTriggerValueChange=!1,o.loadingIndicator=null,o.cover=null,o._pivotTableCalcSourceIndex=e++,PivotData.setCulture(n.RS.Culture),o.supportedEvents=[n.Events.PivottableClick,n.Events.PivottableCommandEvent],o}return __extends(o,f),o.prototype._canStretch=function(){var n=this._getPageStretchInfo();return n&&n.StretchMode!==0?!0:!1},o.prototype._getPageStretchInfo=function(){return n.ForguncyData.pageInfo.pageStretchInfos[this.runTimePageName]},o.prototype.createContent=function(){var i,r,u,f,t;return this.bounds={height:this.CellElement.Height,top:this.CellElement.Top,width:this.CellElement.Width,left:this.CellElement.Left},this._canStretch()?(i="100%",r="100%",u=this._getPageStretchInfo(),this.isRightMost=this.bounds.left+this.bounds.width===u.MainPartWidth,this.isBottomMost=this.bounds.top+this.bounds.height===u.MainPartHeight):(i=this.CellElement.Width+"px",r=this.CellElement.Height+"px"),f=$('<div id="'+this.ID+'" pivottableid="'+this.getPivotTableID()+'" style="width:'+i+";height:"+r+'" ><\/div>'),t=this.CellElement.CellType,t&&t.TabIndex&&n.ForguncyData.pageInfo.enableTabIndex&&f.attr("tabindex",t.TabIndex),f},o.prototype.getPivotTableID=function(){return n.Page.getPageName()+"_"+this.ID},o.prototype.onWindowResized=function(){this._canStretch()&&this._spread&&this._sheet&&(this._spread.refresh(),this.showScrollBarOrNot())},o.prototype.onLoad=function(){var i=this,r=this.getContainer(),u,f,e;r.css("overflow","");this.isRightMost&&r.css("overflow-x","hidden");var o=this.CellElement,s=o.CellType,t=s.PivotTableSetting;n.Common.IsEmpty(t)||(u=t.SelectedListViewName,this._listview=this.getListView(u),this._listview)&&(this._listview.bind(n.Events.ValueChanged,function(){i.paintPivotTable()}),t.ColumnMaster&&(f=this.getListView(t.ColumnMaster),f.bind(n.Events.ValueChanged,function(){i.paintPivotTable()})),t.RowMaster&&(e=this.getListView(t.RowMaster),e.bind(n.Events.ValueChanged,function(){i.paintPivotTable()})))},o.prototype._pivotTableDomCssSelector=function(){return"#"+this.ID+'[pivottableid="'+this.getPivotTableID()+'"]'},o.prototype.paintPivotTable=function(){var t=this,u=this.CellElement,r=u.CellType,i=r.PivotTableSetting,f;if(!i.Values||i.Values.length===0){t.destroySpreadJS();return}f=u.StyleTemplate&&u.StyleTemplate.Styles;t._isFillHandlerTriggerValueChange||t.showLoadingIndicator();n.DelayRefresh.Push(null,function(){var c,e,o,l,n,u,a,s,h;if(t._isFillHandlerTriggerValueChange){t._isFillHandlerTriggerValueChange=!1;t.hiddenLoadingIndicator();return}if(c=i.SelectedListViewName,e=t.getListView(c),t.preprocessColumnInfo(e,i),o=t.getTableData(e,i),t.isDataSetEmpty(o)){t.hiddenLoadingIndicator();t.destroySpreadJS();return}if(l=t.updateSetting(o,i,e),t.createSpreadJS(i),n=t._sheet,n.suspendPaint(),n.suspendCalcService(),n.suspendDirty(),n.suspendEvent(),u=new PivotData.PivotTable,a=t.setTableOptions(u,r),t.applyStyle(u,r,f),s=l.getData(18,a),!s){t.hiddenLoadingIndicator();t.destroySpreadJS();return}try{t.setFormatterForHeader(i,n);u.render(n,s);h=t.getConditionalFormatHandler().applyConditionalFormat(u);h&&t.addDependenceHandler(h);t.autofitColumn(r.PivotTableStyle);t.bindEventInSheet(n,u,i)}finally{t.showScrollBarOrNot();n.resumePaint();n.resumeCalcService();n.resumeDirty();n.resumeEvent();t.hiddenLoadingIndicator()}t.executeClickCommand(r.PivotTableClickCommand,u,i)},"paintPivotTable"+this.ID)},o.prototype.getPivot=function(){var n=this.getPivotTableSetting(),u=this.getSelectedListViewName(),t=this.getListView(u),i,r;return this.preprocessColumnInfo(t,n),i=this.getTableData(t,n),r=this.updateSetting(i,n,t),r},o.prototype.getSelectedListViewName=function(){var n=this.getPivotTableSetting();return n.SelectedListViewName},o.prototype.getPivotTableSetting=function(){var n=this.CellElement,t=n.CellType;return t.PivotTableSetting},o.prototype.showScrollBarOrNot=function(){if(this._sheet){var n=this._sheet.getParent(),r=n.getHost(),u=r.offsetWidth||this._sheet.getViewportWidth(1),f=r.offsetHeight||this._sheet.getViewportHeight(1),e=this.getTableWidth(),o=this.getTableHeight(),t=e>u,i=o>f;t&&(i=o+15>f);i&&(t=e+15>u);n.options.showHorizontalScrollbar=t;n.options.showVerticalScrollbar=i}},o.prototype.getTableWidth=function(){for(var t=this._sheet,i=0,r=t.getColumnCount(),u=GC.Spread.Sheets.SheetArea.viewport,n=0;n<r;++n)i+=t.getColumnWidth(n,u);return i},o.prototype.getTableHeight=function(){for(var t,n=this._sheet,i=0,u=n.getRowCount(),f=n.getRowCount(GC.Spread.Sheets.SheetArea.colHeader),r=0;r<f;++r)i+=n.getRowHeight(r,GC.Spread.Sheets.SheetArea.colHeader);for(t=0;t<u;++t)i+=n.getRowHeight(t);return i},o.prototype.getConditionalFormatHandler=function(){var t=this.CellElement.CellType;return new n.PivotTableConditionalFormat(t,this.CellElement.StyleInfo,this._sheet,this.getPivotTableCalcSourceName(),this.runTimePageName)},o.prototype.getPivotTableFillHandler=function(){var t=this.CellElement.CellType;return new n.PivotTableEventHandler(this._sheet,t,this._listview)},o.prototype.bindEventInSheet=function(n,t,i){var r=this,u,f;n.unbind(GC.Spread.Sheets.Events.ColumnWidthChanged);n.bind(GC.Spread.Sheets.Events.ColumnWidthChanged,function(){r.showScrollBarOrNot()});n.unbind(GC.Spread.Sheets.Events.RowHeightChanged);n.bind(GC.Spread.Sheets.Events.RowHeightChanged,function(){r.showScrollBarOrNot()});n.bind(GC.Spread.Sheets.Events.CellClick,function(n,u){var f=r.getPivotTableSubtotalAreaRanges(t,i),e=r.isCellInValueArea(f,u.row,u.col);r.getPivotTableFillHandler().bindingPivotTableClickEvent(u,r,e)});u=i;f=r.getPivotTableValueAreaRanges(t,u);n.unbind(GC.Spread.Sheets.Events.EditStarting);n.bind(GC.Spread.Sheets.Events.EditStarting,function(n,t){r.canCellEnterEditMode(u,t.row,t.col)||(t.cancel=!0);r.isCellInValueArea(f,t.row,t.col)||(t.cancel=!0)});n.unbind(GC.Spread.Sheets.Events.EditStarted);n.bind(GC.Spread.Sheets.Events.EditStarted,function(n,t){$("[gcuielement=gcEditingInput]").parent().parent().css("background-color","white")});n.unbind(GC.Spread.Sheets.Events.ValueChanged);n.bind(GC.Spread.Sheets.Events.ValueChanged,function(n,t){r._isFillHandlerTriggerValueChange=!0;r.getPivotTableFillHandler().writeDataToSpreadView(t)});n.unbind(GC.Spread.Sheets.Events.RangeChanged);n.bind(GC.Spread.Sheets.Events.RangeChanged,function(n,t){r.getPivotTableFillHandler().clearCellByDeleteKey(t)&&(r._isFillHandlerTriggerValueChange=!0)});i.IsFillFormMode&&(n.unbind(GC.Spread.Sheets.Events.SelectionChanged),n.bind(GC.Spread.Sheets.Events.SelectionChanged,function(n,t){r.getPivotTableFillHandler().updateListViewSelection(t)}))},o.prototype.canCellEnterEditMode=function(n,t,i){var r=0;return n.Rows&&n.Rows.length&&(r=n.Rows.length),i>=r},o.prototype.autofitColumn=function(n){var t,i;if(n&&n.IsAutoFitWidth){for(t=[],i=0;i<this._sheet.getColumnCount();i++)t.push({col:i});t.length>0&&this._spread.commandManager().execute({cmd:"autoFitColumn",sheetName:this._sheet.name()||"Sheet1",columns:t,isRowHeader:!1,autoFitType:GC.Spread.Sheets.AutoFitType.cellWithHeader})}},o.prototype.isDataSetEmpty=function(n){var i=!1;for(var t in n.columns)if(n.columns[t]&&n.columns[t].values&&n.columns[t].values.length>0){i=!0;break}return!i},o.prototype.setFormatterForHeader=function(t,r){t.Rows&&t.Rows.forEach(function(t,u){t.Format?r.setFormatter(-1,u,t.Format,GC.Spread.Sheets.SheetArea.viewport):t.ColumnDataType===i.Date?r.setFormatter(-1,u,n.StaticFormatString.dateTimeDefaultFormattingString,GC.Spread.Sheets.SheetArea.viewport):t.ColumnDataType===i.Time&&r.setFormatter(-1,u,n.StaticFormatString.timeDefaultFormattingString,GC.Spread.Sheets.SheetArea.viewport)});t.Cols&&(t.Cols.length>1&&r.setRowCount(t.Cols.length,GC.Spread.Sheets.SheetArea.colHeader),t.Cols.forEach(function(t,u){t.Format?r.setFormatter(u,-1,t.Format,GC.Spread.Sheets.SheetArea.colHeader):t.ColumnDataType===i.Date?r.setFormatter(u,-1,n.StaticFormatString.dateTimeDefaultFormattingString,GC.Spread.Sheets.SheetArea.colHeader):t.ColumnDataType===i.Time&&r.setFormatter(u,-1,n.StaticFormatString.timeDefaultFormattingString,GC.Spread.Sheets.SheetArea.colHeader)}))},o.prototype.addDependenceHandler=function(t){var r=this,i=t.getDependences();i&&i.length>0&&n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(i,function(){r.paintPivotTable()},r.runTimePageName)},o.prototype.createSpreadJS=function(t){var u,r,i;if(this._spread&&this._sheet){this.initWorksheet(this._sheet,t);return}u=document.body.querySelector(this._pivotTableDomCssSelector());r=this._spread=new GC.Spread.Sheets.Workbook(u,{showHorizontalScrollbar:!1,showVerticalScrollbar:!1});this.initWorkbook(r);i=this._sheet=r.getActiveSheet();this.initWorksheet(i,t);n.ForguncyData.pageInfo.formulaManager.removeCalcSource(this.getPivotTableCalcSourceName());n.ForguncyData.pageInfo.formulaManager.addCalcSource(new n.PivotTableCalcSource(n.ForguncyData.pageInfo.formulaManager.getCalcService(),this.getPivotTableCalcSourceName(),i));i.setCalc(n.ForguncyData.pageInfo.formulaManager.getCalcService(),null)},o.prototype.initWorksheet=function(n,t){var r=n.getSelections(),i;n.reset();n.options.rowHeaderVisible=!1;n.options.allowCellOverflow=!1;n.options.clipBoardOptions=GC.Spread.Sheets.ClipboardPasteOptions.values;n.autoGenerateColumns=!1;n.options.isProtected=!0;t.IsFillFormMode&&(n.options.isProtected=!1);n.options.protectionOptions.allowResizeColumns=!0;n.options.protectionOptions.allowResizeRows=!0;n.options.protectionOptions.allowSort=!1;n.options.protectionOptions.allowDeleteColumns=!1;n.options.protectionOptions.allowDeleteRows=!1;n.options.sheetAreaOffset={top:3,left:3};n.selectionUnit(GC.Spread.Sheets.SelectionUnit.cell);n.selectionPolicy(GC.Spread.Sheets.SelectionPolicy.single);r&&r.length>0&&(i=r[0],i.row<n.getRowCount()&&i.col<n.getColumnCount()&&n.setSelection(i.row,i.col,i.rowCount,i.colCount))},o.prototype.initWorkbook=function(n){n.options.tabStripVisible=!1;n.options.allowUserEditFormula=!1;n.options.scrollbarMaxAlign=!0;n.options.backColor="transparent";n.options.tabStripVisible=!1;n.options.allowUserDragDrop=!1;n.options.allowUserDragFill=!1;n.options.showHorizontalScrollbar=!1;n.options.showVerticalScrollbar=!1;n.options.showDragFillSmartTag=!1;n.options.autoFitType=GC.Spread.Sheets.AutoFitType.cellWithHeader;n.options.defaultDragFillType=GC.Spread.Sheets.Fill.AutoFillType.fillWithoutFormatting;n.options.allowUserZoom=!1;n.options.allowExtendPasteRange=!0;n.options.copyPasteHeaderOptions=GC.Spread.Sheets.CopyPasteHeaderOptions.noHeaders;n.options.allowCopyPasteExcelStyle=!1;n.options.allowUndo=!1;n.options.showDragDropTip=!1;n.options.showDragFillSmartTag=!1;n.options.showDragFillTip=!1;n.options.allowContextMenu=!1;var t=n.commandManager();t.register("moveToNextCellThenControl",GC.Spread.Sheets.Commands.moveToNextCellThenControl,GC.Spread.Commands.Key.tab,!1,!1,!1,!1);t.register("moveToPreviousCellThenControl",GC.Spread.Sheets.Commands.moveToPreviousCellThenControl,GC.Spread.Commands.Key.tab,!1,!0,!1,!1);t.setShortcutKey(null,GC.Spread.Commands.Key.v,!0,!1,!1,!1)},o.prototype.setTableOptions=function(n,t){var u=t.ShowColsTotal,r=t.ShowRowsTotal,i=new PivotData.PivotLayoutSetting;return i.grandTotals=u?r?1:4:r?3:2,i.subtotals=t.ShowSubtotal?3:1,i},o.prototype.updateSetting=function(r,u,f){var s=this.getListViewColumnName(u.Rows),h=this.getListViewColumnName(u.Cols),a=new PivotData.DataSet(r),v=a.addView(),c=v.addPivot(),y=c.getSetting(),p=$("#"+this.ID).parent().attr("fgcname"),l=o.customFunctions[p],e=new PivotData.PivotSettingConfig;return e.values.push([]),u.Values&&u.Values.forEach(function(r,u){var f=new PivotData.PivotSettingConfigValue(r.DatabaseColumnName,r.DatabaseColumnName);l?(f.customAggregator=l,f.method=t[t.custom]):f.method=t[r.Aggregator]||t[t.cnt];f.totalMethod=r.KeepTotalAggregatorSameWithValue?f.method:t[r.TotalAggregator];f.format="General";r.Format?f.format=r.Format:r.ColumnDataType===i.Date?(f.method===t[t.first]||f.method===t[t.last]||f.method===t[t.max]||f.method===t[t.min]||f.method===t[t.avg]||f.method===t[t.sum])&&(f.format=n.StaticFormatString.dateTimeDefaultFormattingString):r.ColumnDataType===i.Time&&(f.method===t[t.first]||f.method===t[t.last]||f.method===t[t.max]||f.method===t[t.min]||f.method===t[t.avg]||f.method===t[t.sum])&&(f.format=n.StaticFormatString.timeDefaultFormattingString);f.customValueName=r.DisplayName?r.DisplayName:"";f.idx=u;e.values[0].push(f)}),s&&s.forEach(function(n){var t=new PivotData.PivotSettingConfigItem(n,n);e.columns.push(t)}),h&&h.forEach(function(n){var t=new PivotData.PivotSettingConfigItem(n,n);e.rows.push(t)}),y.update(e),c},o.prototype.executeClickCommand=function(t,i,u){if(!n.Common.IsEmpty(t)){var f=this,e=f.getPivotTableValueAreaRanges(i,u);f.unbind(n.Events.PivottableCommandEvent);f.bind(n.Events.PivottableCommandEvent,function(n,i){if(f.clearOldValue(t),i.dataType!==r.ColHeader&&i.dataType!==r.RowHeader){var o=f.convertColFromClickEvent(i.col,r[i.dataType],u);f.isCellInValueArea(e,i.row,o)&&(f.setBindingCellValue(t.RowHeaderList,i.rowHeaders),f.setBindingCellValue(t.ColumnHeaderList,i.colHeaders),t.CellValueList&&t.CellValueList.length>0&&(t.CellValueList.length>1?(f.setValueToCell(t.CellValueList[0].CellLocation,i.colHeaders[i.colHeaders.length-1].header),f.setValueToCell(t.CellValueList[1].CellLocation,i.value)):f.setValueToCell(t.CellValueList[0].CellLocation,i.value)),f.executeCommand(t.CommandList))}})}},o.prototype.convertColFromClickEvent=function(n,t,i){if(t!==r.FirstCell&&t!==r.RowHeader){var u=i.Rows?i.Rows.length:0;return n+u}return n},o.prototype.clearOldValue=function(n){var t=this;n.RowHeaderList&&n.RowHeaderList.forEach(function(n){return t.setValueToCell(n.CellLocation,"")});n.ColumnHeaderList&&n.ColumnHeaderList.forEach(function(n){return t.setValueToCell(n.CellLocation,"")});n.CellValueList&&n.CellValueList.forEach(function(n){return t.setValueToCell(n.CellLocation,"")})},o.prototype.getPivotTableValueAreaRanges=function(n,t){var i=[];return t.Values&&t.Values.forEach(function(t){var r=n.getPivotValueRanges(t.DisplayName);r&&r.length>0&&(i=i.concat(r))}),i},o.prototype.getPivotTableSubtotalAreaRanges=function(n,t){var i=[];return t.Values&&t.Values.forEach(function(t){var r=n.getPivotSubtotalRanges(t.DisplayName);r&&r.length>0&&(i=i.concat(r))}),i},o.prototype.isCellInValueArea=function(n,t,i){return n.length>0?n.some(function(n){return t>=n.row&&t<n.row+n.rowCount&&i>=n.col&&i<n.col+n.colCount}):!1},o.prototype.setBindingCellValue=function(n,t){for(var r=Math.min(n.length,t.length),i=0;i<r;i++)this.setValueToCell(n[i].CellLocation,t[i].header)},o.prototype.setValueToCell=function(t,i){if(t){var r=this.getCellID(t,this.runTimePageName);r&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(r,{newValue:i},5)}},o.prototype.getCellID=function(t,i){if(t.Name){var r=n.ForguncyData.pageInfo.pageElementManager.cells.getCellsByName(t.Name,!1);return r&&r.length>0?r[0].id:null}else return n.Common.getIdStr(t.Row,t.Column,i)},o.prototype.getListView=function(t){if(t){var r=this.getFormulaCalcContext().PageID,i=n.Page.getSubPageInfoByPageID(r);return i?i.getListView(t):n.Page.getListView(t,!1)}},o.prototype.applyStyle=function(t,i,r){var e;if(!r){this.applyStyle_Old(t,i.PivotTableStyle);return}e=i.PivotTableStyle||{ColumnWidth:undefined,IsAutoFitWidth:!1,RowHeight:undefined,GrayAreaColor:"transparent"};r||(r={});var o=this.CellElement.StyleInfo,s=o.FontSize+"px "+o.FontFamily||n.LocaleFonts.default,f=t.getInspectorStyles();f.font=s;o.Foreground&&o.Foreground!=="#000000"&&(f.wholeTable.foreColor=n.ColorHelper.Convert(o.Foreground));this._spread.options.grayAreaBackColor=e.GrayAreaColor?n.ColorHelper.Convert(e.GrayAreaColor):"transparent";this.applyPartStyle(f.wholeTable,r.WholeTable&&r.WholeTable.NormalStyle);this.applyPartStyle(f.firstColStripe,r.FirstColStripe&&r.FirstColStripe.NormalStyle);this.applyPartStyle(f.secondColStripe,r.SecondColStripe&&r.SecondColStripe.NormalStyle);this.applyPartStyle(f.firstRowStripe,r.FirstRowStripe&&r.FirstRowStripe.NormalStyle);this.applyPartStyle(f.secondRowStripe,r.SecondRowStripe&&r.SecondRowStripe.NormalStyle);this.applyPartStyle(f.colHeader,r.HeaderRow&&r.HeaderRow.NormalStyle);this.applyPartStyle(f.rowHeader,r.FirstColumn&&r.FirstColumn.NormalStyle);this.applyPartStyle(f.subTotalForRow1,r.SubtotalRow1&&r.SubtotalRow1.NormalStyle);this.applyPartStyle(f.subTotalForRow2,r.SubtotalRow2&&r.SubtotalRow2.NormalStyle);this.applyPartStyle(f.subTotalForRow3,r.SubtotalRow3&&r.SubtotalRow3.NormalStyle);this.applyPartStyle(f.subTotalForCol1,r.SubtotalCol1&&r.SubtotalCol1.NormalStyle);this.applyPartStyle(f.subTotalForCol2,r.SubtotalCol2&&r.SubtotalCol2.NormalStyle);this.applyPartStyle(f.subTotalForCol3,r.SubtotalCol3&&r.SubtotalCol3.NormalStyle);this.applyPartStyle(f.rowSubheading1,r.RowSubheading1&&r.RowSubheading1.NormalStyle);this.applyPartStyle(f.rowSubheading2,r.RowSubheading2&&r.RowSubheading2.NormalStyle);this.applyPartStyle(f.rowSubheading3,r.RowSubheading3&&r.RowSubheading3.NormalStyle);this.applyPartStyle(f.colSubheading1,r.ColSubheading1&&r.ColSubheading1.NormalStyle);this.applyPartStyle(f.colSubheading2,r.ColSubheading2&&r.ColSubheading2.NormalStyle);this.applyPartStyle(f.colSubheading3,r.ColSubheading3&&r.ColSubheading3.NormalStyle);this.applyPartStyle(f.grandTotalsRow,r.GrandTotalRow&&r.GrandTotalRow.NormalStyle);this.applyPartStyle(f.grandTotalsColumn,r.GrandTotalColumn&&r.GrandTotalColumn.NormalStyle);f.isAutofitColumn=!1;e.ColumnWidth&&(f.columnWidth=u(e.ColumnWidth));e.RowHeight&&(f.rowHeight=u(e.RowHeight));i.ShowRowsTotal!==undefined&&(f.showBandedRows=i.ShowBandedRows);i.ShowColsTotal!==undefined&&(f.showBandedCols=i.ShowBandedCols);t.setInspectorStyles(f)},o.prototype.applyPartStyle=function(t,i){i&&(i.Background&&(t.backColor=n.ColorHelper.Convert(i.Background)),i.FontColor&&(t.foreColor=n.ColorHelper.Convert(i.FontColor)),i.CellHorizontalAlignment&&(t.CellHorizontalAlignment=i.CellHorizontalAlignment),i.CellVerticalAligment&&(t.CellVerticalAligment=i.CellVerticalAligment),i.Bold!==undefined&&i.Bold!==null&&(t.Bold=i.Bold),i.Italic!==undefined&&i.Italic!==null&&(t.Italic=i.Italic),this.applyBorderStyle(t,i))},o.prototype.applyBorderStyle=function(n,t){t.BorderString?(n.borderTopString=t.BorderString,n.borderBottomString=t.BorderString,n.borderLeftString=t.BorderString,n.borderRightString=t.BorderString):(t.BorderTopString&&(n.borderTopString=t.BorderTopString),t.BorderBottomString&&(n.borderBottomString=t.BorderBottomString),t.BorderLeftString&&(n.borderLeftString=t.BorderLeftString),t.BorderRightString&&(n.borderRightString=t.BorderRightString));t.InsideHorizontalBorderString&&(n.insideHorizontalBorderString=t.InsideHorizontalBorderString);t.InsideVerticalBorderString&&(n.insideVerticalBorderString=t.InsideVerticalBorderString)},o.prototype.applyStyle_Old=function(t,i){var o,h,f,s;i=i||{HeaderStyle:{BackColor:"#5B9BD5",ForeColor:"#FFFFFF"},SubtotalStyle:{BackColor:"#5B9BD5",ForeColor:"#FFFFFF"},TotalStyle:{BackColor:"#2F75B5",ForeColor:"#FFFFFF"},ColumnWidth:undefined,IsAutoFitWidth:!1,RowHeight:undefined,GrayAreaColor:"transparent"};var e=this.CellElement.StyleInfo,c=e.FontSize+"px "+e.FontFamily,r=t.getInspectorStyles();r.font=c;e.Foreground&&e.Foreground!=="#000000"&&(r.colHeader.foreColor=n.ColorHelper.Convert(e.Foreground),r.rowHeader.foreColor=n.ColorHelper.Convert(e.Foreground),r.wholeTable.foreColor=n.ColorHelper.Convert(e.Foreground),r.grandTotalsColumn.foreColor=n.ColorHelper.Convert(e.Foreground),r.grandTotalsRow.foreColor=n.ColorHelper.Convert(e.Foreground),r.subTotalForRow1.foreColor=n.ColorHelper.Convert(e.Foreground),r.subTotalForRow2.foreColor=n.ColorHelper.Convert(e.Foreground),r.subTotalForRow3.foreColor=n.ColorHelper.Convert(e.Foreground),r.subTotalForCol1.foreColor=n.ColorHelper.Convert(e.Foreground),r.subTotalForCol2.foreColor=n.ColorHelper.Convert(e.Foreground),r.subTotalForCol3.foreColor=n.ColorHelper.Convert(e.Foreground));this._spread.options.grayAreaBackColor=i.GrayAreaColor?n.ColorHelper.Convert(i.GrayAreaColor):"transparent";o=i.HeaderStyle;o&&(o.BackColor&&(r.colHeader.backColor=n.ColorHelper.Convert(o.BackColor),r.rowHeader.backColor=n.ColorHelper.Convert(o.BackColor)),o.ForeColor&&(r.colHeader.foreColor=n.ColorHelper.Convert(o.ForeColor),r.rowHeader.foreColor=n.ColorHelper.Convert(o.ForeColor)));h=i.BodyStyle;h&&(h.BackColor&&(r.wholeTable.backColor=n.ColorHelper.Convert(h.BackColor)),h.ForeColor&&(r.wholeTable.foreColor=n.ColorHelper.Convert(h.ForeColor)));f=i.SubtotalStyle;f&&(f.BackColor&&(r.subTotalForRow1.backColor=n.ColorHelper.Convert(f.BackColor),r.subTotalForRow2.backColor=n.ColorHelper.Convert(f.BackColor),r.subTotalForRow3.backColor=n.ColorHelper.Convert(f.BackColor),r.subTotalForCol1.backColor=n.ColorHelper.Convert(f.BackColor),r.subTotalForCol2.backColor=n.ColorHelper.Convert(f.BackColor),r.subTotalForCol3.backColor=n.ColorHelper.Convert(f.BackColor)),f.ForeColor&&(r.subTotalForRow1.foreColor=n.ColorHelper.Convert(f.ForeColor),r.subTotalForRow2.foreColor=n.ColorHelper.Convert(f.ForeColor),r.subTotalForRow3.foreColor=n.ColorHelper.Convert(f.ForeColor),r.subTotalForCol1.foreColor=n.ColorHelper.Convert(f.ForeColor),r.subTotalForCol2.foreColor=n.ColorHelper.Convert(f.ForeColor),r.subTotalForCol3.foreColor=n.ColorHelper.Convert(f.ForeColor)));s=i.TotalStyle;s&&(s.BackColor&&(r.grandTotalsColumn.backColor=n.ColorHelper.Convert(s.BackColor),r.grandTotalsRow.backColor=n.ColorHelper.Convert(s.BackColor)),s.ForeColor&&(r.grandTotalsColumn.foreColor=n.ColorHelper.Convert(s.ForeColor),r.grandTotalsRow.foreColor=n.ColorHelper.Convert(s.ForeColor)));r.isAutofitColumn=!1;i.ColumnWidth&&(r.columnWidth=u(i.ColumnWidth));i.RowHeight&&(r.rowHeight=u(i.RowHeight));r.gridLine="#dfe8e8";t.setInspectorStyles(r)},o.prototype.getListViewColumnName=function(n){for(var i=[],r=n?n.length:0,t=0;t<r;t++)i.push(n[t].DatabaseColumnName);return i},o.prototype.convertDesignerColumnToListViewColum=function(n,t){for(var o,e,r=n.getMergedColumnInfos(),s=t?t.length:0,u=0;u<s;u++){var i=t[u],h=this.getDesignerColumnIndex(i.ColumnCell),f=this.getListViewIndex(r,h);f!=-1&&(i.ListViewColumnIndex=f,i.ColumnDataType=r[f].ColumnDataType);i.BackgroundValue&&i.BackgroundValue.ColumnCell&&(o=this.getDesignerColumnIndex(i.BackgroundValue.ColumnCell),e=this.getListViewIndex(r,o),e!=-1&&(i.BackgroundValue.ListViewColumnIndex=e))}},o.prototype.getListviewColumnIndexByHeaderText=function(t,i){var r=n.ListviewBase.getListviewByCalcSheetName(t._getUniqueID()),f,e,u,o;if(!r||(f=r.getColumnHeaderRowCount()-1,f<0))return-1;for(e=r.getMergedColumnInfos().length,u=0;u<e;u++)if(o=r.getDataColIndexByMergedColIndex(u),r.getColumnHeaderText(f,o)==i)return u;return-1},o.prototype.convertDesignerColumnToListViewColumForMaster=function(n,t){for(var r,u,f=t?t.length:0,i=0;i<f;i++)r=t[i],u=this.getListviewColumnIndexByHeaderText(n,r.DatabaseColumnName),u!=-1&&(r.ListViewColumnIndexForMaster=u)},o.prototype.getDesignerColumnIndex=function(n){var t=/([A-Za-z]+)(\d*)/.exec(n);return t.length>1?this.convertNum(t[1])-1:-1},o.prototype.convertNum=function(n){for(var t,r=0,f=n.match(/./g),i=n.length-1,u=1;i>=0;i--,u*=26){if(t=f[i].toUpperCase(),t<"A"||t>"Z")return 0;r+=(t.charCodeAt(0)-64)*u}return r},o.prototype.getListViewIndex=function(n,t){if(t===-1)return-1;for(var i=0;i<n.length;i++)if(t===n[i].DesignerColumnIndex)return i;return-1},o.prototype.preprocessColumnInfo=function(n,t){var i,r;this.convertDesignerColumnToListViewColum(n,t.Rows);this.convertDesignerColumnToListViewColum(n,t.Cols);this.convertDesignerColumnToListViewColum(n,t.Values);t.IsFillFormMode&&(t.RowMaster&&(i=this.getListView(t.RowMaster),this.convertDesignerColumnToListViewColumForMaster(i,t.Rows)),t.ColumnMaster&&(r=this.getListView(t.ColumnMaster),this.convertDesignerColumnToListViewColumForMaster(r,t.Cols)))},o.prototype.getTableData=function(n,t){var i={measures:[],dimensions:[],columns:{},startMonth:0};return this.appendMasterData(i,t),this.appendTableData(i,n,t),i},o.prototype.appendTableData=function(n,t,i){var r=this;i.Rows&&i.Rows.forEach(function(i){r.getColumnData(t,i,n.columns)});i.Cols&&i.Cols.forEach(function(i){r.getColumnData(t,i,n.columns)});i.Values&&i.Values.forEach(function(i){r.getColumnData(t,i,n.columns)})},o.prototype.getColumnData=function(t,r,u){var h=this.getColumnOjbect(u,r.DatabaseColumnName),a=this.createIndexCache(h),c=r.ListViewColumnIndex,l,f,o,s,e;if(!n.Common.IsEmpty(c))for(l=t.getRowCount(),f=0;f<l;f++)o=r.BackgroundValue&&r.BackgroundValue.ListViewColumnIndex,s=void 0,n.Common.IsEmpty(o)||(s=this.getListViewValue(t,f,o)),e=this.getListViewValue(t,f,c),e&&(r.ColumnDataType===i.Date||r.ColumnDataType===i.Time)&&(e=n.Convertor.fromOADateToDate(e)),this.addToDataSet(h,e,a,s)},o.prototype.getColumnDataForMaster=function(n,t,i){var e=this.getColumnOjbect(i,t.DatabaseColumnName),o=this.createIndexCache(e),s=this.getListviewColumnIndexByHeaderText(n,t.DatabaseColumnName),h,r,u,f;if(!(s<0)){for(h=n.getRowCount(),r=0;r<h;r++)u=this.getListviewColumnIndexByHeaderText(n,t.BackgroundValue&&t.BackgroundValue.DatabaseColumnName),f=void 0,u>=0&&(f=this.getListViewValue(n,r,u)),this.addToDataSet(e,this.getListViewValue(n,r,s),o,f);o=undefined}},o.prototype.getColumnOjbect=function(n,t){return n[t]||(n[t]={lookUps:[],values:[],startMonth:0,dataType:"String",backgroundLookUps:[]}),n[t]},o.prototype.appendMasterData=function(n,t){var i=this,r=0,u=0,f,e,o;t.ColumnMaster&&(f=this.getListView(t.ColumnMaster),t.Cols&&t.Cols.forEach(function(t){i.getColumnDataForMaster(f,t,n.columns)}),r=f.getRowCount(),t.Rows&&t.Rows.forEach(function(t){for(var f=i.getColumnOjbect(n.columns,t.DatabaseColumnName),u=0;u<r;u++)f.values.push(0)}));t.RowMaster&&(e=this.getListView(t.RowMaster),t.Rows&&t.Rows.forEach(function(t){i.getColumnDataForMaster(e,t,n.columns)}),u=e.getRowCount(),t.Cols&&t.Cols.forEach(function(t){for(var f=i.getColumnOjbect(n.columns,t.DatabaseColumnName),r=0;r<u;r++)f.values.push(0)}));o=r+u;o>0&&t.Values&&t.Values.forEach(function(t){var r=i.getColumnOjbect(n.columns,t.DatabaseColumnName),u;for(r.lookUps=[null],r.values=[],u=0;u<o;u++)r.values.push(0)})},o.prototype.createIndexCache=function(n){var t={};return n.lookUps.forEach(function(n,i){return t[n]=i}),t},o.prototype.addToDataSet=function(n,t,i,r){var u=i[t];u===undefined&&(u=n.lookUps.length,n.lookUps.push(t),n.backgroundLookUps.push(r),i[t]=u);n.values.push(u)},o.prototype.getListViewValue=function(n,t,i){return t<0||i<0?null:n.getValue(t,i)},o.prototype.getPivotTableCalcSourceName=function(){return this._pivotTableCalcSourceIndex>0?"pvt"+this._pivotTableCalcSourceIndex:"pvt"},o.prototype.destroySpreadJS=function(){var r,t,i;if(this._sheet){for(n.ForguncyData.pageInfo.formulaManager.removeCalcSource(this.getPivotTableCalcSourceName()),this.removeSheetSource(),this._sheet.setCalc(new GC.Spread.CalcEngine.CalcService,null),r=this._sheet.getColumnCount(),t=0;t<r;t++)i=this._sheet.getCellType(-1,t),i instanceof n.SpreadJSEditCellType&&i.destroy();this._sheet.unbindAll();this._sheet=null}this._spread&&(this._spread.unbindAll(),this._spread.focus(!1),this._spread.destroy(),this._spread=null)},o.prototype.removeSheetSource=function(){var i=n.ForguncyData.pageInfo.formulaManager.getCalcService(),r=i.getAllSourceModels(),u,t;for(u in r)if(t=r[u].getSource(),t.getSheet&&t.getSheet()===this._sheet){i.removeSource(t);break}},o.prototype.destroy=function(){this.destroySpreadJS();f.prototype.destroy.call(this)},o.prototype.enterPrintMode=function(){this._spread.options.hideSelection=!0;this._oldShowHorizontalScrollbar=this._spread.options.showHorizontalScrollbar;this._spread.options.showHorizontalScrollbar=!1;this._oldShowVerticalScrollbar=this._spread.options.showVerticalScrollbar;this._spread.options.showVerticalScrollbar=!1},o.prototype.quitPrintMode=function(){this._spread.options.hideSelection=!1;this._spread.options.showHorizontalScrollbar=this._oldShowHorizontalScrollbar;this._spread.options.showVerticalScrollbar=this._oldShowVerticalScrollbar},o.prototype.showLoadingIndicator=function(){var r,c,l;if(this.loadingIndicator===null){if(r=$(this._pivotTableDomCssSelector()).parent().parent(),!r||r.length===0)return;var o=!1,s=!1,u=-1,f=-1,e=this._getPageStretchInfo();e&&(o=n.Stretch.Common.canHorizontallyStretch(e.StretchMode),u=e.MainPartWidth,s=n.Stretch.Common.canVerticallyStretch(e.StretchMode),f=e.MainPartHeight);var h=999,i=17,t=this.bounds;this.cover=n.Common.getCover("transparent",1).css("position","absolute").css("zIndex",h).appendTo(r);this.loadingIndicator=$("<img class='loading-indicator'><\/img>").attr("src",n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/loading.gif").css("position","absolute").css("width",i).css("height",i).css("zIndex",h).appendTo(r);o&&u>0?(this.cover.css("left",100*t.left/u+"%"),this.cover.css("width",100*t.width/u+"%"),c=100*(t.left+t.width/2)/u,this.loadingIndicator.css("left","calc("+c+"% - "+i/2+"px)")):(this.cover.css("left",t.left).css("width",t.width),this.loadingIndicator.css("left",t.left+t.width/2-i/2));s&&f>0?(this.cover.css("top",100*t.top/f+"%"),this.cover.css("height",100*t.height/f+"%"),l=100*(t.top+t.height/2)/f,this.loadingIndicator.css("top","calc("+l+"% - "+i/2+"px)")):(this.cover.css("top",t.top).css("height",t.height),this.loadingIndicator.css("top",t.top+t.height/2-i/2))}this.cover.show();this.loadingIndicator.show()},o.prototype.hiddenLoadingIndicator=function(t){t===void 0&&(t=!1);this.loadingIndicator&&(t||!n.DelayRefresh.NeedDelayRun?(this.cover.hide(),this.loadingIndicator.hide()):(this.cover.hide(),this.loadingIndicator.hide()))},o.customFunctions={},o.setCustomFunction=function(n,t){o.customFunctions[n]=t},o}(n.CellTypeBase);n.PivotTableCellType=f;o=1.3333333333333333;n.CellTypeHelper.registerCellType("Forguncy.PivotTableCellType, Forguncy",f)}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(n,t,i,r,u){this._cellTypeMetaData=n;this._defaultStyle=t;this._sheet=i;this._pivotTableCalcSourceName=r;this._runTimePageName=u}return t.prototype.applyConditionalFormat=function(t){var r=this._cellTypeMetaData.PivotTableConditionalFormatSetting,f,i,e,o,s;if(r&&r.Conditions){var h={FontFamily:this._defaultStyle.FontFamily,FontSize:this._defaultStyle.FontSize,Foreground:n.ColorHelper.Convert(this._defaultStyle.Foreground)},a=this._sheet,l=[],u=new n.ConditionFormatFormulaHelper(this._runTimePageName),c=new n.ConditionFormatRuleHelper;for(f=0;f<r.Conditions.length;f++)i=r.Conditions[f],e=this.getPivotValueRanges(t,i),this.removeInvisibleCell(e),o=this.getPivotSubtotalRanges(t,i),this.removeInvisibleCell(o),s=this.getPivotGrandtotalRanges(t,i),this.removeInvisibleCell(s),l=l.concat(e).concat(o).concat(s),this.handleFormulaInConditionFormat(i.DataConditionalFormattingMetadata,u),this.convertToSpreadJSRule(i.DataConditionalFormattingMetadata,e,c,h),this.handleFormulaInConditionFormat(i.SubtotalConditionalFormattingMetadata,u),this.convertToSpreadJSRule(i.SubtotalConditionalFormattingMetadata,o,c,h),this.handleFormulaInConditionFormat(i.GrandtotalConditionalFormattingMetadata,u),this.convertToSpreadJSRule(i.GrandtotalConditionalFormattingMetadata,s,c,h);return u}},t.prototype.removeInvisibleCell=function(n){var u,t,i,r;if(n&&n.length>0)for(u=n.length-1;u>=0;u--){if(t=n[u],!this._sheet.getColumnVisible(t.col)){n.splice(u,1);continue}if(t.rowCount===1)this._sheet.getRowVisible(t.row)||n.splice(u,1);else{for(i=t.row-1,r=t.row;r<t.row+t.rowCount;r++)this._sheet.getRowVisible(r)||(r>t.row&&r<t.row+t.rowCount&&n.push(new GC.Spread.Sheets.Range(i+1,t.col,r-i-1,t.colCount)),i=r);i!==t.row-1&&(i<t.row+t.rowCount-1&&n.push(new GC.Spread.Sheets.Range(i+1,t.col,t.row+t.rowCount-1-i,t.colCount)),n.splice(u,1))}}return n},t.prototype.getPivotGrandtotalRanges=function(n,t){for(var i,r=n.getPivotGrandtotalRanges(t.Label),f=[],e=r?r.length:0,u=0;u<e;u++)i=r[u],f.push(new GC.Spread.Sheets.Range(i.row,i.col,i.rowCount,i.colCount));return f},t.prototype.getPivotSubtotalRanges=function(n,t){for(var i,r=n.getPivotSubtotalRanges(t.Label),f=[],e=r?r.length:0,u=0;u<e;u++)i=r[u],f.push(new GC.Spread.Sheets.Range(i.row,i.col,i.rowCount,i.colCount));return f},t.prototype.getPivotValueRanges=function(n,t){for(var i,r=n.getPivotValueRanges(t.Label),f=[],e=r?r.length:0,u=0;u<e;u++)i=r[u],f.push(new GC.Spread.Sheets.Range(i.row,i.col,i.rowCount,i.colCount));return f},t.prototype.convertToSpreadJSRule=function(n,t,i,r){var u,f,s,e,o,h,c;if(n&&(u=n.Rules,u))for(f=u.length-1;f>=0;f--)if(s=i.ConvertConditionRuleToSpreadJSByRanges(r,u[f],t),e=s.ranges(),u[f].RuleType===10&&e&&e.length>0)for(o=0;o<e.length;o++)h=e[o],c=i.ConvertConditionRuleToSpreadJSByRanges(r,u[f],[h]),this.convertFormulaRule(c,h);else this._sheet.conditionalFormats.addRule(s)},t.prototype.convertFormulaRule=function(t,i){var r=t.formula(),u;r&&r.indexOf("=ISBLANK('"+this._runTimePageName+"'!")===0&&(u=n.Common.getA1ReferenceString(i.row,i.col,!0,!0),r="=ISBLANK('"+this._pivotTableCalcSourceName+"'!"+u+")",t.formula(r));r&&r.indexOf("=NOT(ISBLANK('"+this._runTimePageName+"'!")===0&&(u=n.Common.getA1ReferenceString(i.row,i.col,!0,!0),r="=NOT(ISBLANK('"+this._pivotTableCalcSourceName+"'!"+u+")",t.formula(r));r&&r.indexOf("=ISERROR('"+this._runTimePageName+"'!")===0&&(u=n.Common.getA1ReferenceString(i.row,i.col,!0,!0),r="=ISERROR('"+this._pivotTableCalcSourceName+"'!"+u+")",t.formula(r));r&&r.indexOf("=NOT(ISERROR('"+this._runTimePageName+"'!")===0&&(u=n.Common.getA1ReferenceString(i.row,i.col,!0,!0),r="=NOT(ISERROR('"+this._pivotTableCalcSourceName+"'!"+u+")",t.formula(r));this._sheet.conditionalFormats.addRule(t)},t.prototype.handleFormulaInConditionFormat=function(n,t){var i,r;if(n&&(i=n.Rules,i))for(r=0;r<i.length;r++)t.HandleFormulaInConditionFormat(i[r])},t}();n.PivotTableConditionalFormat=t}(Forguncy||(Forguncy={})),function(n){var r=function(){function t(){}return t.prototype.getCurrentRowInfoCollection=function(){return n.ForguncyData.pageInfo.currentRowInfoCollection},t.prototype.getBindingValueVersions=function(){return n.ForguncyData.pageInfo.normalCellBindingManager.bindingValueVersions},t}(),u,i,t;n.CommandExecuteInfo=r;u=function(){function u(){this.middleClick=!1;this.commandFactor=new n.CommandFactory;var t=this;t._waitingQueque=[];$(document).on("mousedown mouseup",function(i){if(i.which===2&&i.target.tagName==="A")return i.type=="mousedown"&&(t.__swcp__||(t.__swcp__=$('<div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;display:block;z-index:9999;opacity:0.01;filter:alpha(opacity:1);" />').appendTo("body")),n.DelayRefresh.setTimeout(function(){try{t.middleClick=!0;$(i.target).trigger("click","middleButton")}finally{t.middleClick=!1}},50),t.__swcp__.show(),n.DelayRefresh.setTimeout(function(){t.__swcp__.hide()},1e3)),!1});this.createFileInputElementForImportExcelToListViewCommand()}return u.prototype.init=function(){this._commandExecuteInfo=undefined;this._waitingQueque=[];this._clickCommandsEndTime={}},u.prototype.createFileInputElementForImportExcelToListViewCommand=function(){var t=n.DomUtilities.createJqueryDomElement("input"),i;t.attr("type","file");t.attr("id","forguncy_FileInput");i=".xlsx";n.Platform.isAndroid()&&n.Platform.isWeChatOrQQBrowser()&&(i=null);t.attr("accept",i);t.css("display","none");t.appendTo("body")},u.prototype.ajustCurrentRowInfo=function(t,i,r){var u=this.getAjustedRowInfo(i,r),f;u&&(f=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(u.currentTable),(n.Common.IsEmpty(f)||f.listviewLocation!==u.listviewLocation||!n.Common.isQueryEqual(f.query,u.query))&&n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfo(u,!0),n.DeleteRecordCommand.prepareRowInfo(t,u))},u.prototype.getAjustedRowInfo=function(t,i){if(i instanceof n.ListviewBase)return i.getRowInfo();else{var r=n.PageManager.getContainerCell(t);if(r&&r.cellType instanceof n.RepeaterCellType)return r.cellType.getAdditionalRowInfo(t)}return null},u.prototype.alertRepeatMessage=function(t,i){t===n.Events.Click&&(new Date).valueOf()-i.valueOf()>1e3&&alert(n.RS.Commit_ExecutingMessage)},u.prototype.excuteCommand=function(t,i,r,u,f,e){var h,o,s;if(this._commandExecuteInfo&&this._commandExecuteInfo.commandId===u&&this._commandExecuteInfo.eventType===f){this.alertRepeatMessage(f,this._commandExecuteInfo.startTime);return}for(h=this._waitingQueque.length,o=0;o<h;o++)if(this._waitingQueque[o].commandID===u&&this._waitingQueque[o].eventType===f){this.alertRepeatMessage(f,this._waitingQueque[o].startTime);return}(n.ForguncyData.IsAutoTest||f!==n.Events.Click||n.Common.IsEmpty(u)||(s=this._clickCommandsEndTime[u],n.Common.IsEmpty(s)||!((new Date).valueOf()-s.valueOf()<300)))&&(this.ajustCurrentRowInfo(t,i,r),this._waitingQueque.push({commandID:u,commands:t,runTimePageName:i,eventType:f,commandTrigger:r,isMiddelClick:this.isMiddleClick(t,f),callbackOnCommandCompleted:e,startTime:new Date}),this.excuteCommandFromWaitingQueque())},u.prototype.excuteCommandFromWaitingQueque=function(){if(this._waitingQueque.length!==0&&!this._commandExecuteInfo){var n=this._waitingQueque.shift();this._commandExecuteInfo=this._createCommandExecuteInfo(n);this._executeCommand()}},u.prototype.isMiddleClick=function(t,i){return i!==n.Events.Click||t.length>1?!1:this.middleClick},u.prototype._createCommandExecuteInfo=function(n){var t=new r,f,u;for(t.isFirstCommand=!0,t.commandId=n.commandID,t.validateResult=!1,t.currentCommandList=[],f=n.commands.length,u=0;u<f;u++)n.commands[u]!=null&&t.currentCommandList.push(n.commands[u]);return t.commandTrigger=n.commandTrigger,t.runTimePageName=n.runTimePageName,t.haveCommitListView=!1,t.eventType=n.eventType,t.isMiddelClick=this.isMiddleClick(n.commands,n.eventType),t.callbackOnCommandCompleted=n.callbackOnCommandCompleted,t.cacheDataHelper=new i,t.startTime=n.startTime,t},u.prototype._executeCommand=function(){var t=this,i=this._commandExecuteInfo;if(i&&i.suspend){setTimeout(function(){t._executeCommand()},10);return}i&&i.currentCommandList&&n.DelayOperateHelper.Push(t,function(){var n=t._commandExecuteInfo;if(n&&n.suspend){t._executeCommand();return}t._executeFirstCommandInList()},0)},u.prototype._executeFirstCommandInList=function(){var n=this._commandExecuteInfo,r,i,u,o,h,f,e,s;if(n&&n.currentCommandList){if(n.isFirstCommand&&n.commandTrigger&&(n.isFirstCommand=!1,n.commandTrigger.shouldCancelCommand(n.commandId,n.eventType))){this.stopExecuteCommandList(!0);return}if(r=n.currentCommandList,r.length===0){this.stopExecuteCommandList(!0);return}if(i=r[0],u=i.$type,!i.Disabled&&!n.haveCommitListView&&(u===t.NavigateCommand||u===t.ShowPopupCommand||u===t.ClosePopupCommand))if(n.haveCommitListView=!0,o=this.addCommitAllEditedTableCommand(r,u),o===!0){this._executeCommand();return}else if(o===0){this.stopExecuteCommandList(!0);return}h=i;r.shift();f=0;try{i.Disabled?f=1:(e=this.commandFactor.CreateCommand(i),e.CommandExecutingInfo=this._commandExecuteInfo,e.CommandExecutor=this,f=e.execute())}finally{s=!0;f===0?s=this.stopExecuteCommandList(!0):f===2&&r.unshift(i);s&&this._executeCommand()}}},u.prototype.stopExecuteCommandList=function(t){var f=this,i=this._commandExecuteInfo,u,r;return i===undefined?!1:(u=new n.CommandFactory,r=this._commandExecuteInfo.currentCommandList.filter(function(n){try{var t=u.CreateCommand(n);return t.EnableProtect}catch(i){return!1}}),r&&r.length>0)?(this._commandExecuteInfo.currentCommandList=r,!0):(this._commandExecuteInfo=undefined,i.callbackOnCommandCompleted&&i.callbackOnCommandCompleted(),i.eventType!==n.Events.Click||n.Common.IsEmpty(i.commandId)||(this._clickCommandsEndTime[i.commandId]=new Date),n.DelayRefresh.NeedDelayRun?n.DelayRefresh.setTimeout(function(){f.excuteCommandFromWaitingQueque()}):this.excuteCommandFromWaitingQueque(),n.ShareCommandParamsContext.ParamStack=[],!1)},u.prototype.addCommitAllEditedTableCommand=function(i,r){for(var u,h,e=n.ListviewBase.getAllListviews(),o=r===t.ShowPopupCommand?1:0,s=!1,c=e.length,f=0;f<c;f++){if(u=e[f],h=u.commitCurrentEdit(!0),!h)return o===0?0:!1;if(u.isMasterTable()&&u.needCommit()){i.unshift({$type:t.CommitEditTableCommand,listView:u,failOptions:o});s=!0;break}}return s===!1?!1:!0},u}();n.CommandExcutor=u;i=function(){function t(){t._id++;this._cachedData=[]}return t.prototype.cacheData=function(n){var i=this._cachedData.length;return this._cachedData.push(n),{id:t._id,index:i}},t.prototype.getCachedData=function(i){return n.Common.IsEmpty(i)?null:t._id!==i.id?null:this.cacheData.length<=i.index||0>i.index?null:this._cachedData[i.index]},t._id=0,t}();n.CacheDataHelper=i;t=function(){function n(){}return n.NavigateCommand="Forguncy.Model.NavigateCommand, Forguncy",n.ShowPopupCommand="Forguncy.Model.ShowPopupCommand, Forguncy",n.ClosePopupCommand="Forguncy.Model.ClosePopupCommand, Forguncy",n.CommitEditTableCommand="Forguncy.Model.commitEditTableCommand, Forguncy",n}();n.CommandTypeStr=t}(Forguncy||(Forguncy={})),function(n){var i=function(){function t(){this.CommandExecutingInfo=new n.CommandExecuteInfo;this.CommandExecutingInfo.currentCommandList=[]}return t.prototype.stopExecuteCommandList=function(n){this.CommandExecutor&&this.CommandExecutor.stopExecuteCommandList&&this.CommandExecutor.stopExecuteCommandList(n)},t.prototype.addToCommandList=function(t,i,r,u){var f,e,o;if(!n.Common.IsEmpty(t)&&!(t.length<=0)){for(i=n.Common.IsEmpty(i)?this.CommandParam.rowOffset:i,r=n.Common.IsEmpty(r)?this.CommandParam.columnOffset:r,u=n.Common.IsEmpty(u)?this.CommandParam.formulaListRowInfo:u,f=n.Common.clone(t),e=0;e<f.length;e++)o=f[e],o.rowOffset=n.Common.IsEmpty(i)?0:i,o.columnOffset=n.Common.IsEmpty(r)?0:r,o.formulaListRowInfo=n.Common.IsEmpty(u)?null:n.Common.clone(u);this.CommandExecutingInfo.currentCommandList&&(this.CommandExecutingInfo.currentCommandList=f.concat(this.CommandExecutingInfo.currentCommandList))}},t.prototype.getCellLocation=function(t){return n.FormulaHelper.getCellLocation(t,this.CommandExecutingInfo.runTimePageName)},t.getCellID=function(i,r,u){var s=[],v,h,f,e,o;if(i.ParamReferObject&&i.ParamReferObject.ParamID&&(v=n.ShareCommandParamsContext.Update(i.ParamReferObject.ParamID),h=n.Common.parseCellReferenceFormulaToCellLocation(v),h.length>0&&(i=h[0])),n.Common.IsEmpty(i.Name)){i=t.offsetFormulaCellLocation(i,r.rowOffset,r.columnOffset);var c=i.Row,l=i.Column,a=r.runTimePageName;u||(f=n.Common.getLocatedListview(a,c,l),f&&(c=0,l-=f.getRangeInfo().Column,a=f.getCalcSheetName()));s.push(n.Common.getIdStr(c,l,a))}else if(e=n.ForguncyData.pageInfo.pageElementManager.cells.getCellsByName(i.Name,!1),e)for(o=0;o<e.length;o++)s.push(e[o].id);return s},t.offsetFormulaCellLocation=function(t,i,r){var e,f,u;return(t&&t.ParamReferObject&&t.ParamReferObject.ParamID&&(e=n.ShareCommandParamsContext.Update(t.ParamReferObject.ParamID),f=n.Common.parseCellReferenceFormulaToCellLocation(e),f&&f.length>0&&(t=f[0])),n.Common.IsEmpty(t)||!n.Common.IsEmpty(t.Name)||!t.RowRelative&&!t.ColumnRelative)?t:(n.Common.IsEmpty(i)&&(i=0),n.Common.IsEmpty(r)&&(r=0),i===0&&r===0)?t:(u=n.Common.clone(t),u.RowRelative&&(u.Row+=i),u.ColumnRelative&&(u.Column+=r),u)},t.prototype.evaluateFormula=function(t){return n.ForguncyData.pageInfo.formulaManager.evaluateFormula(t,this.getDefaultFormulaCalcInfo())},t.prototype.getFormulaCalcContext=function(){var t=this.CommandExecutingInfo.runTimePageName;return{IsInMasterPage:n.PageManager.isMasterPageName(t),PageID:t}},t.prototype.getDefaultFormulaCalcInfo=function(){return{runTimePageName:this.CommandExecutingInfo.runTimePageName,supportReferToListview:!0,nullAsException:!1,listInfo:this.CommandParam.formulaListRowInfo,rowOffset:this.CommandParam.rowOffset,columnOffset:this.CommandParam.columnOffset}},t.prototype.commandPost=function(t,i,r,u){var f=this;n.Common.forguncyPost(t,i,r,u,function(){alert(n.RS.Command_postFail_ErrorMessage);f.stopExecuteCommandList(!0)})},t}(),t;n.CommandBase=i;t=function(){function t(){}return t.prototype.CreateCommand=function(n){var t=this._createCommandInstance(n);return t.CommandParam=n,t},t.prototype._createCommandInstance=function(i){var r,u;if(i.$type==="Forguncy.Model.ImportExcelToListViewCommand, Forguncy"&&(n.ImportExcelToListViewCommand||(r=document.createElement("script"),r.type="text/javascript",r.src=n.ForguncyData.ForguncyRoot+"Resources/ImportExcel.js?v="+n.StaticData.JSVersion,$("head").append(r))),u=t._registedCommands[i.$type],u)return new u;else throw"Not Support This Type";},t.registerCommand=function(n,i){t._registedCommands[n]=i},t._registedCommands={},t}();n.CommandFactory=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t,u=(t={},t[0]="",t[1]="Question",t[2]="Information",t[3]="Error",t[4]="Warning",t),i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var n=this.CommandParam;return this.ExecuteConditionCommand(n)},i.prototype.ExecuteConditionCommand=function(t){var u,f,e,i,s;if(!t||!t.ConditionAndCommandPairList)return 1;u=t.ConditionAndCommandPairList;f=t.FunctionNameForGenerate;try{return e=this.getNoValueBindingInfos(u),this._ifConditionParamCalculator=new r(this.getDefaultFormulaCalcInfo(),e),e.length>0?(i=this,i.commandPost("Home/GetConditionParamResult",{bindingInfos:e,currentRowInfos:i.CommandExecutingInfo.getCurrentRowInfoCollection().list},function(n,t){if(n===""||n===null||n===undefined||n==="null")return i.stopExecuteCommandList(!0),0;var r=typeof n=="string"?JSON.parse(n):n;i._ifConditionParamCalculator.tableValues=r;i.excuteCommandIfConditionIsRight(u,f)})):s=this.excuteCommandIfConditionIsRight(u,f),1}catch(o){o.stack.indexOf(f)?n.ErrorHelper.printError(o):alert(o)}},i.prototype.getNoValueBindingInfos=function(n){for(var i=[],t=0;t<n.length;t++)this.getNoValueBindingInfoUsedInCondition(n[t].Condition,i);return i},i.prototype.getNoValueBindingInfoUsedInCondition=function(t,i){for(var r,e,u,o=n.ConditionHelper.enumAllConditions(t),f=0;f<o.length;f++)if(r=o[f],!n.Common.IsEmpty(r.param)&&!n.Common.IsEmpty(r.param.tableData)){for(e=!1,u=i.length-1;u>=0;u--)if(n.Common.isBindingInfoEquals(r.param.tableData,i[u])){e=!0;break}e||i.push(r.param.tableData)}},i.prototype.excuteCommandIfConditionIsRight=function(t,i,r){var e,o;r===void 0&&(r=0);var f=this,s=function(r){if(t[r].ConfirmDialogSettings)return u.showConfirmBox(t[r],function(){f.addToCommandList(t[r].CommandList)},function(){f.excuteCommandIfConditionIsRight(t,i,r+1)}),{value:!1};else if(t[r].JSText){var e=u.getJSFunction(t[r].FunctionNameForJS),o=!0;return e&&(o=e()),o==!0?(f.addToCommandList(t[r].CommandList),{value:!0}):(f.excuteCommandIfConditionIsRight(t,i,r+1),{value:!1})}else if(n.ConditionHelper.getCondtionResult(t[r].Condition,u._ifConditionParamCalculator.formulaCalcInfo,u._ifConditionParamCalculator))return u.addToCommandList(t[r].CommandList),"break"},u=this;for(e=r;e<t.length;e++){if(o=s(e),typeof o=="object")return o.value;if(o==="break")break}return!0},i.prototype.getJSFunction=function(t){var i=n.RunJavaScriptCommandFunctions;if(i)return i[t]},i.prototype.showConfirmBox=function(t,i,r){var l=this,o=document.activeElement,h;this.CommandExecutingInfo.suspend=!0;var f=t.ConfirmDialogSettings,a=n.PageBuilder.pagesContainer,s=function(){o&&o.tagName==="BUTTON"&&($(o).hide(),$(o).show());l.CommandExecutingInfo.suspend=!1},e,c="";f.ConfirmIcon!==0&&(c=n.ForguncyData.ForguncyRoot+"Resources/Images/ConfirmDialog/"+u[f.ConfirmIcon]+".png");e=n.PopupHelper.createConfirmPopupDom(a,f.Title,c,f.Text,!n.ForguncyData.GlobalSettings.HidePopUpCloseButton);e.zIndex=n.ForguncyData.pageInfoStack.length;h=e.target.footerButtonGroup.items;h[0].text=f.YesButtonText;h[1].text=f.NoButtonText;e.target.on("Confirm",function(){s();i()});e.target.on("Cancel",function(){s();r()});e.target.on("Close",function(){s()})},i}(n.CommandBase),r;n.ConditionCommand=i;r=function(){function t(n,t){this.formulaCalcInfo=n;this.bindingInfoList=t}return t.prototype.calc=function(t){if(n.Common.IsEmpty(t)||n.Common.IsEmpty(t.param))return null;var i=t.param;return typeof i.result=="undefined"&&(i.result=this.getParamResult(t.param)),i.result},t.prototype.getParamResult=function(t){var i,o,s,f,u,e,r;if(typeof t.cellLocations!="undefined")return(i=t.cellLocations,i===null||i===undefined||i.length!==1)?null:(i[0].ParamReferObject&&i[0].ParamReferObject.ParamID&&(o=n.ShareCommandParamsContext.Update(i[0].ParamReferObject.ParamID),i=n.Common.parseCellReferenceFormulaToCellLocation(o)),i===null||i===undefined||i.length!==1)?null:n.Common.IsEmpty(i[0].Name)?(s=n.CommandBase.offsetFormulaCellLocation(i[0],this.formulaCalcInfo.rowOffset,this.formulaCalcInfo.columnOffset),n.ForguncyData.pageInfo.formulaManager.getValue(s,this.formulaCalcInfo)):n.ForguncyData.pageInfo.formulaManager.evaluateFormula("="+i[0].Name,this.formulaCalcInfo);else if(typeof t.tableData!="undefined"){for(f=n.ListviewBase.getAllListviews(),r=0;r<f.length;r++)if((u=f[r],u.getDataTableName()===t.tableData.TableName&&!u.isGroupMode())&&(e=u.getColIndexOfBindingColumn(t.tableData),e!==-1))return u.getListDataModel().getValue(u.getSelectedRowIndex(),e);for(r=0;r<this.bindingInfoList.length;r++)if(n.Common.isBindingInfoEquals(this.bindingInfoList[r],t.tableData))return this.tableValues[r]}else return typeof t.currentUserProperty!="undefined"?n.UserInfoHelper.getUserInfo(t.currentUserProperty):null},t.prototype.needUnparseValue2=function(t){if(typeof t.param.cellLocations!="undefined"){if(t.param.cellLocations===null||t.param.cellLocations===undefined||t.param.cellLocations.length!==1)return!0;var i=n.CommandBase.getCellID(t.param.cellLocations[0],this.formulaCalcInfo,!1);return!i||i.length!==1?!0:n.SetCellPropertyCommand.shouldUnparseText(i[0])}else return typeof t.param.tableData!="undefined"?!0:typeof t.param.currentUserProperty!="undefined"?!1:!0},t}();n.CommandFactory.registerCommand("Forguncy.Model.ConditionCommand, Forguncy",i)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.commitEditedTable(this.CommandParam)},i.prototype.commitEditedTable=function(t){var i,r;try{return(i=t.listView,typeof i=="undefined")?1:(r=i.commitEditChange(),t.failOptions===0&&(r==="cancel"||n.ValidationMananger.validateRepeaterCells(i,!0)===1))?0:1}catch(u){alert(u)}},i}(n.CommandBase);n.commitEditTableCommand=t;n.CommandFactory.registerCommand(n.CommandTypeStr.CommitEditTableCommand,t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.Export(this.CommandParam)},i.prototype.Export=function(t){var a=this,ut,y,p,w,b,e,k,o,u,s,d,ft,i,h,g,nt,c,tt,it,l,et;if(n.Common.IsEmpty(t))return 1;if(n.Platform.isWeChatOrQQBrowser()&&!this.IsPdf)return alert(n.ChineseStaticValues.WeChartBrowser_CantDownloadFileWarning),1;this.CommandExecutingInfo.suspend=!0;try{var f=t.ListViewName,ot=t.ExportTableOverFlowMode,v=t.ExportExcelPageNameMode,st=t.NewOtherName,ht=t.ExportExcelListviewNameMode,ct=this.CommandExecutingInfo.runTimePageName,r=n.PageManager.getRunTimeNormalPageName(ct),rt=n.ListviewBase.getAllListviews([r]);if(!n.Common.IsEmpty(f)&&(ut=rt.some(function(n){return n.getListviewName()===f}),!ut))return alert(n.RS.listviewNotExisted),this.CommandExecutingInfo.suspend=!1,1;y={};for(p in n.ForguncyData.pageInfo.commandQuerys)y[p]=JSON.stringify(n.ForguncyData.pageInfo.commandQuerys[p]);if(w={},rt.forEach(function(n){var t=n.GetQueryConditionFormulaValues();t&&(w[n.getListviewName()]=t)}),b={},n.ForguncyData.pageInfo.sortInfoCache)for(e in n.ForguncyData.pageInfo.sortInfoCache)n.ForguncyData.pageInfo.sortInfoCache[e]&&(k=n.ForguncyData.pageInfo.sortInfoCache[e].sortInfo,k)&&(o=n.ListviewBase.getListviewByLocationString(e),o&&o.runTimePageName===r)&&(b[o.getFullListviewName()]=k);if(u=this.evaluateFormula(st),u instanceof GC.Spread.CalcEngine.CalcError)if(this.IsPdf)throw n.RS.ExprotToPDFCalFormulaError;else throw n.RS.ExprotToExcelCalFormulaError;if(n.Common.IsEmpty(t.TargetPageName)&&v!==2&&n.Common.IsEmpty(u)&&(s=n.PageManager.getContainerCell(this.CommandExecutingInfo.runTimePageName),s&&s.cellType instanceof n.RepeaterCellType&&(d=s.cellType,ft=d.getListview().getListviewName(),u=ft+"-"+(d.getTabIndex(this.CommandExecutingInfo.runTimePageName)+1),v=2)),i=void 0,t.ListViewName&&(i=n.ListviewBase.getListview(t.ListViewName,r)),g="",!n.Common.IsEmpty(t.RowsToExport)&&i)if(h=[],g=i.getDataTableName(),nt=i.getListDataModel(),t.RowsToExport===0)for(c=0;c<nt.getRowCount();c++)tt=nt.getRowQuery(c),tt&&h.push(tt);else{if(it=i.getSelectedRowsData(),it.length===0){alert(n.RS.NoSelectedRowError);this.CommandExecutingInfo.suspend=!1;return}it.forEach(function(n){n.query&&h.push(n.query)})}if(l={pageName:t.TargetPageName?t.TargetPageName:n.PageManager.getDesignerPageName(r,!0),runTimePageName:r,tableName:f,currentRowInfoList:this.CommandExecutingInfo.getCurrentRowInfoCollection().list,exportTableMode:ot,exportExcelPageNameMode:v,otherName:u,exportExcelListviewNameMode:ht,isOnlyExportValue:t.TargetPageName?!1:!!t.IsOnlyExportValue,dataModel:t.TargetPageName?null:n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getAllExportDatas(),queryCondition:y,sortInfoCache:b,columnFilterQueries:i&&i.getColumnFilterQueries(),viewQueryConditionFormulaValues:t.TargetPageName?null:w,isPdf:this.IsPdf,repeatQureys:h,repeatTableName:g,AutoFitRowHeight:t.AutoFitRowHeight,ListviewColumns:this.getListviewColumnInfos(i)},!this.IsPdf&&f&&l.ListviewColumns.length==0)return alert(n.RS.ExportListviewNoColumnError),this.CommandExecutingInfo.suspend=!1,1;if(et=n.ForguncyData.ForguncyRoot+"Home/ExportToExcel",this.IsPdf)n.Common.forguncyPostSync("Home/GivePDFParam",{exportParam:l},function(t){try{return n.Common.openWindow(n.ForguncyData.ForguncyRoot+"Home/ExportPdf?key="+t),1}finally{a.CommandExecutingInfo.suspend=!1}},function(){a.CommandExecutingInfo.suspend=!1});else return n.Common.postInHiddenFormAndDownloadFile(et,l,function(){a.CommandExecutingInfo.suspend=!1}),1}catch(lt){this.CommandExecutingInfo.suspend=!1;alert(lt)}},i.prototype.getListviewColumnInfos=function(t){if(!t)return null;var i=t instanceof n.SpreadJSView,r=t.getExportColmnMetadatas();return r.map(function(n,r){return{index:n.Index,name:n.IsExternal?n.TemplateCell.Element.Name[0]:null,width:i?t.getColumnWidth(r):n.Width,commandID:n.ColumnOptionsCommandID}}).filter(function(n){return n.width!=0})},i}(n.CommandBase),i;n.ExportCommand=t;i=function(n){function t(){var t=n.call(this)||this;return t.IsPdf=!0,t}return __extends(t,n),t}(t);n.ExportCommandPDF=i;n.CommandFactory.registerCommand("Forguncy.Model.ExportListViewToExcelCommand, Forguncy",t);n.CommandFactory.registerCommand("Forguncy.Model.ExportPageToExcelCommand, Forguncy",t);n.CommandFactory.registerCommand("Forguncy.Model.ExportPageToPdfCommand, Forguncy",i)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.Goto(this.CommandParam)},i.prototype.Goto=function(t){var u,e,f,o,r;try{if(n.Common.IsEmpty(t))return 1;u=t.TableName;u||(e=this.CommandExecutingInfo.getCurrentRowInfoCollection(),e.list.length>0&&(u=e.list[0].currentTable));var i=t.TargetRecord,h=n.ListviewBase.getAllListviews(),a=h.length;for(f=0;f<a;f++)if(o=h[f],o.getDataTableName()===u)return this._goToListviewRecord(o,i),1;if((r=this.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(u),r===null)||r.recordID===0&&(i===0||i===2))return this.stopExecuteCommandList(!0),0;var c=n.ForguncyData.pageInfo.sortInfoCache[r.listviewLocation],v=n.ForguncyData.columnFilterQueryCache[r.listviewLocation],s=r.currentTable,l=n.ForguncyData.pageInfo.normalCellBindingManager.getBindingInfos(s),y=this;return n.Common.forguncyPost("Home/GetTargetRecordData",{bindingInfos:l,targetRecord:i,currentRowInfo:r,queryCommandInfo:n.ForguncyData.pageInfo.commandQuerys[s],sortInfo:c?c.sortInfo:null,columnFilterQueries:v},function(t,r){var f=t,u;f&&f.data&&(u=y.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(s),u!==null&&(u.query=f.query,i===0?u.recordID=Number(u.recordID)-1:i===1?u.recordID=Number(u.recordID)+1:i===2&&(u.recordID=0),i===3&&(u.recordID=Number(f.recordCount)-1),u.recordID>=Number(f.recordCount)?u.recordID=Number(f.recordCount)-1:u.recordID<0&&(u.recordID=0),n.ForguncyData.pageInfo.normalCellBindingManager.updateBindingValues(f.data,u.currentTable,l),n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfo(u,!1)))}),1}catch(p){alert(p)}},i.prototype._goToListviewRecord=function(n,t){var r=n.getActualDataLength(),i,u;r<=0||(i=-1,t===2?i=0:t===3?i=r-1:(u=n.getSelectedRowIndex(),t===0?i=u-1:t===1&&(i=u+1)),i>=0&&i<r&&n.selectRow(i))},i}(n.CommandBase);n.GoToRecordCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.GoToRecordCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.goto(this.CommandParam)},i.prototype.goto=function(t){try{return n.Common.IsEmpty(t)?void 0:this.isParamsValid(t)?(this.updateInfo(t),1):void 0}catch(i){alert(i)}},i.prototype.updateInfo=function(t){var i=t.TargetPageIndex,r=t.Limit,u=n.ListviewBase.getListview(t.ListviewName,this.CommandExecutingInfo.runTimePageName).getLocationString(),f=n.ForguncyData.pageingInfoList.GetRowCount(u);i=this.ensureIndexByTargetPageKind(i,r,t.targetPageKind,f);n.ForguncyData.pageingInfoList.SetPageingInfo(u,i,r)},i.prototype.ensureIndexByTargetPageKind=function(n,t,i,r){switch(i){case 0:n=1;break;case 1:n--;break;case 2:n++;break;case 3:n=Math.ceil(r/t);break;case 4:break}return n=Math.min(n,Math.ceil(r/t)),Math.max(n,1)},i.prototype.isParamsValid=function(n){return isNaN(n.TargetPageIndex)?!1:isNaN(n.Limit)?!1:!0},i}(n.CommandBase);n.GoToPageCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.GoToPageCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.navigateToPage=function(t,i,r,u,f){var o,e,h,c,s,l;return this.CommandExecutingInfo.isMiddelClick?(this.stopExecuteCommandList(!0),0):(o=t.PageName,t.DeleteCachedQuery&&n.ForguncyData.pageInfo.pageElementManager.cleanQuaryCookie(o),e={},this.commandID&&(e.commandID=this.commandID),(t.LoadBindingDataOption===1||t.LoadBindingDataOption===2)&&(e.loadBindingDataOption=t.LoadBindingDataOption),h=null,t&&t.PassValues&&t.PassValues&&t.PassValues.length>0&&(h=t.PassValues),c=this.getPassValues(h,i,r,u),c&&(e.passValues=c),this.addCurrentInfosToPageContext(e,o),this.addCrossPageQueryToPageContext(e,o,t.DeleteCachedQuery),this.addCrossSortCommandInfoToPageContext(e,o,t.DeleteCachedQuery),s="",s=e.currentRowInfoList===undefined&&e.querys===undefined&&e.sortInfoCache===undefined&&e.passValues===undefined&&e.loadBindingDataOption===undefined&&e.commandID===undefined?this.generateUrlWhenQueryIsNull(o):this.generateUrlWhenQueryIsNotNull(o,e,f),t.IsOpenInNewTab)?(n.Common.openWindow(s),1):(window.history.replaceState?(l=n.ForguncyData.pageInfo.pageName,this.navigateByLoadMetadata(l,o,e,s,h)):window.open(s,"_self"),this.stopExecuteCommandList(!0),0)},i.prototype.generateUrlWhenQueryIsNull=function(t){t===void 0&&(t="");var i="";return i=n.ForguncyData.ForguncyRoot+t,n.ForguncyData.forceMobileChild&&(i=i+"?mobileChild=true"),i},i.prototype.generateUrlWhenQueryIsNotNull=function(t,i,r){t===void 0&&(t="");var u="",f=n.Common.JsonUrlSwitch(JSON.stringify(i));return n.ForguncyData.GlobalSettings.ReserveUrlQuery||n.SessionStorageManager.isInIframe?(u=n.ForguncyData.ForguncyRoot+t+"?pageContext="+encodeURIComponent(f),n.ForguncyData.forceMobileChild&&(u=u+"&mobileChild=true")):(u=n.ForguncyData.ForguncyRoot+t,n.ForguncyData.forceMobileChild&&(u=u+"?mobileChild=true"),r||(n.SessionStorageManager.pageContext=f)),u},i.prototype.getPassValues=function(t,i,r,u){var e,f,o;if(t){for(e=[],f=0;f<t.length;f++)if(o=t[f].Source,o){var a=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(o,{runTimePageName:this.CommandExecutingInfo.runTimePageName,supportReferToListview:!0,nullAsException:!1,listInfo:u,rowOffset:i,columnOffset:r}),s=t[f].TargetCell?n.CommandBase.offsetFormulaCellLocation(t[f].TargetCell,i,r):{Name:t[f].CellName},h={Row:s.Row,Column:s.Column,Name:s.Name},c=n.Common.IsEmpty(h.Name)?n.Common.IsEmpty(t[f].TargetRunTimePageName)?n.StaticValues.RunTimeNormalPage:t[f].TargetRunTimePageName:null,l={Source:a,TargetCell:h,TargetRunTimePageName:c};c===n.StaticValues.RunTimeNormalPage&&delete l.TargetRunTimePageName;e.push(l)}return e}},i.prototype.addCurrentInfosToPageContext=function(t,i){var r=this.CommandExecutingInfo.getCurrentRowInfoCollection().list.filter(function(t){return n.Common.isPageContainsTableBinding(i,t.currentTable)});r&&r.length>0&&(t.currentRowInfoList=r)},i.prototype.addCrossPageQueryToPageContext=function(t,i,r){var u,f,e,o;if(!r)for(u in n.ForguncyData.pageInfo.commandQuerys)n.Common.isPageContainsTableBinding(i,u)&&(t.querys||(t.querys={}),t.querys[u]=n.ForguncyData.pageInfo.commandQuerys[u]);if(this.CommandExecutingInfo.currentCommandList.length>0)for(f=0;f<this.CommandExecutingInfo.currentCommandList.length;f++)(e=this.CommandExecutingInfo.currentCommandList[f],e.Disabled)||e.$type==="Forguncy.Model.QueryCommand, Forguncy"&&(t.querys||(t.querys={}),o=e,t.querys[o.TargetTableName]=n.QueryCommand.getQueryData(o,this.CommandExecutingInfo.runTimePageName))},i.prototype.addCrossSortCommandInfoToPageContext=function(t,i,r){var u,f;if(!r)for(u in n.ForguncyData.pageInfo.sortInfoCache)(f=n.ListviewBase.getListviewByLocationString(u),f)&&n.Common.isPageContainsTableBinding(i,f.getDataTableName())&&(t.sortInfoCache||(t.sortInfoCache={}),t.sortInfoCache[u]=n.ForguncyData.pageInfo.sortInfoCache[u])},i.prototype.navigateByLoadMetadata=function(n,t,i,r,u){throw"Need implement";},i}(n.CommandBase),t,i;n.NavigateCommandBase=r;t=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.execute=function(){return this.navigate(this.CommandParam)},r.prototype.navigate=function(t){var e,u,f;try{if(n.Common.IsEmpty(t))return 1;if(e=t.ValidUrl,u=t.NavigateType,u===i.back)return this.navigateToBack();else if(u===i.normal||u===null||u===undefined){if(t.ValueFormula){var r=this.evaluateFormula(t.ValueFormula),o=!1,s={};s.PageName=r;n.Common.forguncyPostSync("Home/PageNameExisted",s,function(n){o=n});o?t.PageName=r:(t.PageName=null,r!=null&&(f=r+"",e=f.toLowerCase().indexOf("servercommand")===0?n.ForguncyData.ForguncyRoot+r:f.indexOf("http://")!==0&&f.indexOf("https://")!==0&&f.indexOf("file://")!==0?"http://"+r:r))}return e?this.navigateToUrl(e,t.IsOpenInNewTab):t.PageName?this.navigateToPage(t,this.CommandParam.rowOffset,this.CommandParam.columnOffset,this.CommandParam.formulaListRowInfo,!1):1}}catch(h){alert(h)}},r.prototype.navigateToBack=function(){return n.Common.back(),this.stopExecuteCommandList(!1),0},r.prototype.navigateToUrl=function(n,t){return t?window.open(n):window.open(n,"_self"),this.stopExecuteCommandList(!0),0},r.prototype.navigateByLoadMetadata=function(t,i,r,u,f){n.ForguncyData.pageInfoStack.length>0&&(t=n.ForguncyData.pageInfoStack[0].pageName);var e={pageName:t,pageContext:r},o={pageName:i,pageContext:r};history.replaceState(e,t);u||(u=n.ForguncyData.ForguncyRoot+i);history.pushState(o,i,u);n.PageBuilder.loadPage(i,r)},r}(r);n.NavigateCommand=t;i=function(){function n(){}return n.back="back",n.normal="normal",n}();n.CommandFactory.registerCommand(n.CommandTypeStr.NavigateCommand,t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.queryCommand(this.CommandExecutingInfo.eventType===n.Events.PageLoaded,this.CommandParam)},i.prototype.queryCommand=function(t,r){var e,o,f,u;if(n.ForguncyData.pageInfo.commandQuerys[r.TargetTableName]&&t)return 1;if(e=n.ListviewBase.getAllListviews(),e.length===0)return n.ForguncyData.pageInfo.commandQuerys[r.TargetTableName]=i.getQueryData(r,this.CommandExecutingInfo.runTimePageName),1;for(o=[],f=0;f<e.length;f++)if(u=e[f],u.getDataTableName()===r.TargetTableName){if(u.commitCurrentEdit(!0)){if(u.commitEditChange()==="cancel")return u.scrollToView(),0}else return 0;if(!u.allowSortOrQuery())return alert(n.RS.ErrorInfo_Uncommited),0;o.push(u)}for(n.ForguncyData.pageInfo.commandQuerys[r.TargetTableName]=i.getQueryData(r,this.CommandExecutingInfo.runTimePageName),f=0;f<o.length;f++)u=o[f],u.resetToFirstPage(),u.fillData();return $(window).trigger("ForguncyRowCountChanged"),1},i.getQueryData=function(n,t){return{id:n.ID,paramList:this.getCommandQarams(n.Params,t,n)}},i.getCommandQarams=function(t,i,r){var e={},u,f;if(t)for(u=0;u<t.length;u++)f=t[u],e[f]=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(f,{runTimePageName:i,supportReferToListview:!0,nullAsException:!0,listInfo:r.formulaListRowInfo,rowOffset:r.rowOffset,columnOffset:r.columnOffset});return e},i}(n.CommandBase);n.QueryCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.QueryCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var u=this.CommandParam,t=n.ListviewBase.getListview(u.ListViewName,this.CommandExecutingInfo.runTimePageName),i,r;if(!t||(i=t.getLocationString(),r=n.ForguncyData.pageInfo.sortInfoCache,r[i]&&r[i].sortCommandID&&this.CommandExecutingInfo.eventType===n.Events.PageLoaded))return 1;if(t.commitCurrentEdit(!0)){if(t.commitEditChange()==="cancel")return t.scrollToView(),0}else return 0;return t.allowSortOrQuery()?(r[i]||(r[i]={}),r[i].sortCommandID=u.ID,t.fillData(u.ID),1):(alert(n.RS.ErrorInfo_Uncommited),0)},i}(n.CommandBase);n.SortCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.SortCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.sendMailCommand(this.CommandParam)},i.prototype.sendMailCommand=function(n){for(var f=n.From,r=n.Recipient.split(";"),u=[],t=0;t<r.length;t++)u.push(this.covertTheAddress(r[t]));return i.sendMailInternal(this.evaluateFormula(n.From),u.toString().replace(/\,/g,";"),this.evaluateFormula(n.Subject),this.evaluateFormula(n.Content),n.TableName,this.CommandExecutingInfo.getCurrentRowInfoCollection(),function(){},function(n){alert(n)}),1},i.prototype.covertTheAddress=function(t){var i=this.evaluateFormula(t);return n.KeyWords.GetKeyWordValue(i,this.CommandExecutingInfo.runTimePageName)},i.sendMail=function(t,r,u,f,e,o,s){i.sendMailInternal(t,r,u,f,e,n.ForguncyData.pageInfo.currentRowInfoCollection,o,s)},i.sendMailInternal=function(t,i,r,u,f,e,o,s){n.Common.forguncyPost("Home/SendMail",{from:t,to:i,title:r,content:u,tableName:f,currentRowInfoListStr:e.list},function(n){n?s&&s(n):o&&o()})},i}(n.CommandBase);n.SendMailCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.SendMailCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.runJavascriptCommand(this.CommandParam)},i.prototype.runJavascriptCommand=function(t){var f=n.Common.IsEmpty(t)?null:t.FunctionNameForGenerate,i,r,u;return n.Common.IsEmpty(f)?1:(i=null,r=n.RunJavaScriptCommandFunctions,r&&(i=r[f]),u=!1,i&&(u=i()),u===!1?0:1)},i}(n.CommandBase);n.RunJavaScriptCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.RunJavaScriptCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.showMessageCommand(this.CommandParam)},i.prototype.showMessageCommand=function(n){try{var t=this.getMessage(n);return alert(t),1}catch(i){alert(i)}},i.prototype.getMessage=function(t){if(n.Common.IsEmpty(t))return"";var i=this.evaluateFormula(t.MessageFormula);return n.Common.IsEmpty(i)?"":i},i}(n.CommandBase);n.ShowMessageCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.ShowMessageCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.SubscribeCommand(this.CommandParam)},i.prototype.SubscribeCommand=function(t){var i,r;try{return i=new n.NavigateCommand,i.commandID=t.ID,r={},r.PageName=n.BuiltInPageManager.builtInPages[n.BuiltInPageType.MailSubscriptPage],i.CommandParam=r,i.execute(),0}catch(u){alert(u)}return 1},i}(n.CommandBase);n.SubscribeCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.SubscribeCommand, Forguncy",t)}(Forguncy||(Forguncy={})),function(n){var h=function(){function r(){}return r.prototype.checkCanUpdate=function(n){i.checkCanUpdate(n)},r.prototype.buildRequestData=function(t){var u=t.CommandParam,r={},e,o,f;return r.updateType=n.UpdateType.add,e=i.getMasterTableData(t),o=i.getDetailTableData(u),r.editedValues=e,o!=null&&(r.detailTableValues=o),r.tableName=u.TableName,r.bindingInfos=n.ForguncyData.pageInfo.normalCellBindingManager.getBindingInfos(u.TableName),f=this.getAutoIDInfo(u.TableName,e),f&&f.length>0&&(r.editedIDColumns=f),r},r.prototype.checkRequestDataValid=function(i,r){if(n.Common.IsEmpty(i.editedValues)||n.Common.isObjEmpty(i.editedValues)){alert(n.Common.format(n.RS.noFieldErrorInfo,r.TableName));throw 0;}t.checkMasterDetailValues(r.TableName,i.editedValues,i.detailTableValues)},r.prototype.prepareBeforePostServer=function(n){i.preparePostServer(n)},r.prototype.completeAfterPostServer=function(n,t,r){i.postProcessing(n,t,r,r.detailTableValues)},r.prototype.getAutoIDInfo=function(t,i){var u,f,r,e,o;if(i){if(u=[],n.ForguncyData.pageInfo.autoGeneratedIDs&&n.ForguncyData.pageInfo.autoGeneratedIDs[t]){f=n.ForguncyData.pageInfo.autoGeneratedIDs[t];for(r in f)i.hasOwnProperty(r)&&((e=i[r],o=f[r],n.Common.IsEmpty(e)&&n.Common.IsEmpty(o)||e===o)||u.push(r))}return u}},r}(),u,f,e,o,s,t,i,r;n.AddRecordCommandExecutor=h;u=function(){function r(){}return r.prototype.checkCanUpdate=function(n){i.checkCanUpdate(n)},r.prototype.buildRequestData=function(r){var u=r.CommandParam,f={},h,e,o,s;return f.updateType=n.UpdateType.edit,h=i.getMasterTableData(r),e=i.getDetailTableData(u),f.editedValues=h,e!=null&&(f.detailTableValues=e),f.bindingInfos=n.ForguncyData.pageInfo.normalCellBindingManager.getBindingInfos(u.TableName),f.tableName=u.TableName,o=r.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(u.TableName),o&&(f.query=o.query),f.rowVersion=r.CommandExecutingInfo.getBindingValueVersions()[u.TableName],f.rowsToUpdate=u.RowsToUpdate,u.RowsToUpdate===1?f.rowsToUpdateCondition=n.ConditionHelper.getComputedSqlConditionFormula(u.RowsToUpdateCondition,r.CommandExecutingInfo.runTimePageName,n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull,u.rowOffset,u.columnOffset,u.formulaListRowInfo):u.RowsToUpdate===2&&(f.rowsToUpdateListViewQuery=t.getRowsToUpdateListViewQuery(u,r.CommandExecutingInfo.runTimePageName),s=t.getUpdateSpecialRecordsRowVersion(u,r.CommandExecutingInfo.runTimePageName),s.length>0&&(f.rowsToUpdateListViewRowVersion=s)),f},r.prototype.checkRequestDataValid=function(i,r){if((n.Common.IsEmpty(i.editedValues)||n.Common.isObjEmpty(i.editedValues))&&(n.Common.IsEmpty(i.detailTableValues)||i.detailTableValues.length===0))throw 1;if(!i.tableName||!i.query&&!i.rowsToUpdateCondition&&!i.rowsToUpdateListViewQuery)throw 1;t.checkMasterDetailValues(r.TableName,i.editedValues,i.detailTableValues)},r.prototype.prepareBeforePostServer=function(n){i.preparePostServer(n)},r.prototype.completeAfterPostServer=function(n,t,r){i.postProcessing(n,t,r,r.detailTableValues)},r}();n.EditRecordCommandExecutor=u;f=function(){function r(){}return r.prototype.checkCanUpdate=function(n){var t=n.CommandParam;if(t.ActualShowConfirm&&!confirm(t.ConfirmText))throw 0;if(!t.TableName)throw 0;},r.prototype.buildRequestData=function(i){var u={},r,f;return u.updateType=n.UpdateType.DELETE,r=i.CommandParam,u.rowsToUpdate=r.RowsToUpdate,r.RowsToUpdate===1?u.rowsToUpdateCondition=n.ConditionHelper.getComputedSqlConditionFormula(r.RowsToUpdateCondition,i.CommandExecutingInfo.runTimePageName,n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull,r.rowOffset,r.columnOffset,r.formulaListRowInfo):r.RowsToUpdate===2&&(u.rowsToUpdateListViewQuery=t.getRowsToUpdateListViewQuery(r,i.CommandExecutingInfo.runTimePageName)),f=i.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(r.TableName),f&&(u.query=f.query),u.tableName=r.TableName,u},r.prototype.checkRequestDataValid=function(n,t){if(!n.query&&!n.rowsToUpdateCondition&&!n.rowsToUpdateListViewQuery)throw 1;},r.prototype.prepareBeforePostServer=function(n){i.preparePostServer(n)},r.prototype.completeAfterPostServer=function(t,r,u){var f,e;i.postProcessing(t,r,u,null);f=r.CommandParam;t.Success&&f.RowsToUpdate===2&&(e=n.ListviewBase.getListview(f.RowsToUpdateListViewName,r.CommandExecutingInfo.runTimePageName),e&&e.clearSelectionOutOfCurrentRow())},r}();n.DeleteRecordCommandExecutor=f;e=function(){function i(){}return i.prototype.checkCanUpdate=function(n){r.checkCanUpdate(n)},i.prototype.buildRequestData=function(t,i){var f=t.CommandParam,u={},o,s,e;return u.updateType=n.UpdateType.add,o=r.getMasterTableData(f,i),s=r.getDetailTableData(f),u.editedValues=o,s!=null&&(u.detailTableValues=s),u.tableName=f.currentTable,u.bindingInfos=f.columnBindingInfos,f.viewName&&(u.listViewName=f.viewName,u.masterQuery=f.masterQuery),e=this.getAutoIDInfo(o),e&&e.length>0&&(u.editedIDColumns=e),u},i.prototype.checkRequestDataValid=function(i,r){if(n.Common.IsEmpty(i.editedValues)||n.Common.isObjEmpty(i.editedValues)){alert(n.Common.format(n.RS.noFieldErrorInfo,r.currentTable));throw 0;}t.checkMasterDetailValues(r.currentTable,i.editedValues,i.detailTableValues)},i.prototype.prepareBeforePostServer=function(){},i.prototype.completeAfterPostServer=function(n,t,i,u){r.postProcessing(n,t,i,u,i.detailTableValues)},i.prototype.getAutoIDInfo=function(n){var t,i;if(n){t=[];for(i in n)t.push(i);return t}},i}();n.AddRecordListviewExecutor=e;o=function(){function i(){}return i.prototype.checkCanUpdate=function(n){r.checkCanUpdate(n)},i.prototype.buildRequestData=function(t,i){var f=t.CommandParam,u={},o,e;return u.updateType=n.UpdateType.edit,o=r.getMasterTableData(f,i),e=r.getDetailTableData(f),u.editedValues=o,e!=null&&(u.detailTableValues=e),u.tableName=f.currentTable,u.query=f.query,u.rowVersion=f.rowVersion,u.bindingInfos=f.columnBindingInfos,u.rowsToUpdate=f.RowsToUpdate,u},i.prototype.checkRequestDataValid=function(i,r){if((n.Common.IsEmpty(i.editedValues)||n.Common.isObjEmpty(i.editedValues))&&(n.Common.IsEmpty(i.detailTableValues)||i.detailTableValues.length>0))throw 1;if(!i.tableName||!i.query)throw 0;t.checkMasterDetailValues(r.currentTable,i.editedValues,i.detailTableValues)},i.prototype.prepareBeforePostServer=function(){},i.prototype.completeAfterPostServer=function(t,i,u,f){var s,e,o;if(r.postProcessing(t,i,u,f,u.detailTableValues),s=i.CommandParam,e=n.ListviewBase.getDetailListviews(f.getDataTableName()),e)for(o=0;o<e.length;o++)e[o].hasCommitingRow()&&n.Common.isQueryEqual(s.query,e[o].getMasterQuery())&&e[o].fillData()},i}();n.EditRecordListviewExecutor=o;s=function(){function t(){}return t.prototype.checkCanUpdate=function(n){r.checkCanUpdate(n);var t=n.CommandParam;if(t.ActualShowConfirm&&!confirm(t.ConfirmText))throw 0;},t.prototype.buildRequestData=function(t){var i={},r;return i.updateType=n.UpdateType.DELETE,r=t.CommandParam,i.query=r.query,i.tableName=r.currentTable,i},t.prototype.checkRequestDataValid=function(n){if(!n.query)throw 1;},t.prototype.prepareBeforePostServer=function(){},t.prototype.completeAfterPostServer=function(n,t,i,u){r.postProcessing(n,t,i,u,null)},t}();n.DeleteRecordListviewExecutor=s;t=function(){function t(){}return t.checkCanUpdate=function(t){if(n.Common.isBuiltInDataBaseView(t)){alert(n.RS.UpdateViewFail_Error);throw 0;}},t.checkMasterDetailValues=function(t,i,r){var u=n.UpdateDataTableCommand.checkCalcErrorValue(t,i,r);if(!n.Common.IsEmpty(u)){alert(u);throw 0;}},t.getDetailTableData=function(n,t){var i,r,u;if(n.length===0)return null;for(i=[],r=0;r<n.length;r++)u=n[r].buildDetailListviewValues(!0,t),u!=null&&i.push(u);return i.length===0?null:i},t.getRowsToUpdateListViewQuery=function(t,i){var u,r,f;return t.RowsToUpdate!==2?null:(u=n.ListviewBase.getListview(t.RowsToUpdateListViewName,i),!u)?null:(r=[],f=u.getSelectedRowsData(),f.forEach(function(t){n.Common.IsEmpty(t.query)||r.push(t.query)}),r.length===0?null:r)},t.getUpdateSpecialRecordsRowVersion=function(t,i){var r=[],u,f;return t.RowsToUpdate!==2?r:(u=n.ListviewBase.getListview(t.RowsToUpdateListViewName,i),!u)?r:(f=u.getSelectedRowsData(),f.forEach(function(t){n.Common.IsEmpty(t.query)||r.push(t.rowVersion)}),r)},t.postProcessing=function(t,i,r,u){i.removeCommitingRowForDetailListivew(u);t.Success&&(n.ForguncyData.getRelatedTableWithForeignKey(r.tableName).forEach(function(t){n.NormalCellBindingManager.reloadData(t,!0)}),n.ForguncyData.pageInfo.ViewInfoList.map(function(n){return n.ViewName}).forEach(function(t){n.NormalCellBindingManager.reloadData(t,!0)}));$(window).trigger("ForguncyRowCountChanged")},t}();n.UpdateTableHelper=t;i=function(){function i(){}return i.checkCanUpdate=function(i){var r,u;if(n.Common.IsEmpty(i)||n.Common.IsEmpty(i.CommandParam))throw 0;if(r=i.CommandParam,t.checkCanUpdate(r.TableName),!(i.CommandExecutingInfo.commandTrigger instanceof n.ListviewBase)){if(!n.ListviewBase.commitDetailListviewsEdit(r.TableName,!0))throw 0;if(!i.CommandExecutingInfo.validateResult){u=n.ValidationMananger.validateAllCells();switch(u){case 2:throw 2;case 1:throw 0;case 0:i.CommandExecutingInfo.validateResult=!0;break}}}if(r.ActualShowConfirm&&!confirm(r.ConfirmText))throw 0;},i.getMasterTableData=function(t){var u={},i=t.CommandParam,r,f,e;if(i.RowsToUpdate===0&&(u=n.ForguncyData.pageInfo.normalCellBindingManager.getEditedBindingValues(i.TableName)),!n.Common.IsEmpty(i.UpdateValues))for(r=0;r<i.UpdateValues.length;r++)f=i.UpdateValues[r],e=t.evaluateFormula(f.Value),u[f.ColumnName]=e===undefined?null:e;return u},i.getDetailTableData=function(i){var r=n.ListviewBase.getAllListviews().filter(function(n){return n.getMasterDataTableName()===i.TableName});return t.getDetailTableData(r,i.UpdateType)},i.preparePostServer=function(t){var u=n.ForguncyData.getRelatedTableWithForeignKey(t.TableName),i=n.ListviewBase.getListviewsRelatedWithTable(t.TableName),r;for(u.forEach(function(t){i=i.concat(n.ListviewBase.getListviewsRelatedWithTable(t))}),r=0;r<i.length;r++)i[r].showLoadingIndicator()},i.postProcessing=function(r,u,f,e){var o=u.CommandParam,w=n.ForguncyData.getRelatedTableWithForeignKey(o.TableName),l,h,v,y,a,p,c,s;r.AutoIDConflictErrorInfo&&(l=r.AutoIDConflictErrorInfo,l.NewID?(n.ForguncyData.pageInfo.normalCellBindingManager.setValueToBindingCell(l.BindingInfo,l.NewID),r.Message=n.RS.AutoGeneratedID_Conflict_Error):r.Message=n.RS.AutoGeneratedID_Generate_Error);try{if(r.NothingDid)return;if(r.Success){for(r.JustInsertedRowInfo&&o.RowsToUpdate===0&&(h=u.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(o.TableName),h?h.query=r.JustInsertedRowInfo.query:h=r.JustInsertedRowInfo,n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfo(h,!1)),(r.RowData||r.UpdatedRowResults instanceof Array)&&(v=n.ForguncyData.pageInfo.normalCellBindingManager.getBindingInfos(o.TableName),r.RowData?n.ForguncyData.pageInfo.normalCellBindingManager.updateBindingValues(r.RowData,o.TableName,v):(y=u.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(o.TableName),y&&r.UpdatedRowResults.forEach(function(t){if(t.JustInsertedRowInfo&&n.Common.isQueryEqual(t.JustInsertedRowInfo.query,y.query)){n.ForguncyData.pageInfo.normalCellBindingManager.updateBindingValues(t.RowData,o.TableName,v);return}}))),a=n.ListviewBase.getListviewsRelatedWithTable(o.TableName),s=0;s<a.length;s++)i.RemoveSelectionOfDeletedRows(o,f,a[s]),a[s].fillData();for(n.NormalCellBindingManager.updateTableDataCacheForCombo(o.TableName,!0),n.clearGetTableDataByConditionCache(),n.NormalCellBindingManager.reloadItemsCellType(o.TableName,!1,!0),n.CustomFunction.ODataFunction.clearCache(o.TableName),p=n.ListviewBase.getAllListviews().filter(function(n){return n.getMasterDataTableName()===o.TableName}),s=0;s<p.length;s++)n.CustomFunction.ODataFunction.clearCache(p[s].getDataTableName())}else{n.Common.IsEmpty(r.Message)||alert(r.Message);throw 0;}}catch(b){throw b;}finally{for(c=n.ListviewBase.getListviewsRelatedWithTable(o.TableName),w.forEach(function(t){c=c.concat(n.ListviewBase.getListviewsRelatedWithTable(t))}),s=0;s<c.length;s++)c[s].hiddenLoadingIndicator();t.postProcessing(r,u,f,e)}},i.RemoveSelectionOfDeletedRows=function(t,i,r){var u,f;if(t.UpdateType===n.UpdateType.DELETE){switch(t.RowsToUpdate){case 0:i.query&&(f=[i.query]);break;case 2:f=i.rowsToUpdateListViewQuery;default:break}(u=f)===null||u===void 0?void 0:u.forEach(function(n){return r.clearSelectedRowByQuery(n)})}},i}();n.UpdateTableByCommandHelper=i;r=function(){function i(){}return i.checkCanUpdate=function(i){if(n.Common.IsEmpty(i)||n.Common.IsEmpty(i.CommandParam))throw 0;t.checkCanUpdate(i.CommandParam.currentTable)},i.getMasterTableData=function(t,i){var r={};return n.Common.IsEmpty(t)||n.Common.IsEmpty(i)?r:i.buildEditedRowValue(t.rowIndex)},i.getDetailTableData=function(i){var r=n.ListviewBase.getAllListviews().filter(function(n){return n.getMasterDataTableName()===i.currentTable&&n.GetDataCommitMode()===0});return t.getDetailTableData(r,i.UpdateType)},i.postProcessing=function(i,r,u,f,e){var s=r.CommandParam,h=n.ForguncyData.getRelatedTableWithForeignKey(s.currentTable),o;i.AutoIDConflictErrorInfo&&(o=i.AutoIDConflictErrorInfo,o.NewID?(n.ForguncyData.pageInfo.normalCellBindingManager.setValueToBindingCell(o.BindingInfo,o.NewID),i.Message=n.Common.format(n.RS.AutoGeneratedID_Conflict_Listview_Error,o.BindingInfo.ColumnName)):i.Message=n.RS.AutoGeneratedID_Generate_Error);f.handleAfterUpdateDataChange(s.rowIndex,s.UpdateType,i);f.refreshOtherListViewsBindingToSameTable();t.postProcessing(i,r,u,e)},i}();n.UpdateTableByListviewHelper=r}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return __extends(r,i),r.prototype.execute=function(){return this.UpdateDataTableCommand(this.CommandParam)},r.prototype.UpdateDataTableCommand=function(n,t,i){var o,l,u,a,v;if(t===void 0&&(t=null),i===void 0&&(i=null),n===undefined)return 0;var f=r.enumAllUpdateDataTableCommand(this),c=[],e=[],h=[];for(u=0;u<f.length;u++)try{o=f[u].getUpdateDataTableExecutor(t);o.checkCanUpdate(f[u]);l=o.buildRequestData(f[u],t);o.checkRequestDataValid(l,f[u].CommandParam);c.push(f[u]);e.push(o);h.push(l)}catch(s){if(s===0)return this.stopExecuteCommandList(!0),0;else if(s===2)return s;else if(s===1)continue;else return alert(s),this.stopExecuteCommandList(!0),0}if(h.length===0)return 1;for(u=0;u<e.length;u++)e[u].prepareBeforePostServer(c[u].CommandParam);return a=this,v={},v.requestDataList=h,a.commandPost("Home/UpdateMultiDataTable",v,function(n,r,u){var o,f;if(n.length===1&&!n[0].Success)for(f=0;f<e.length-1;f++)n.push({Success:!1,ConcurrentError:!1,Message:""});for(o=!1,f=0;f<e.length;f++)try{e[f].completeAfterPostServer(n[f],c[f],h[f],t)}catch(s){if(s===0){o=!0;continue}}o&&a.stopExecuteCommandList(!0);i&&i()}),1},r.prototype.getUpdateDataTableExecutor=function(i){i===void 0&&(i=null);var r=this.CommandParam;return i===null?r.UpdateType===t.add?new n.AddRecordCommandExecutor:r.UpdateType===t.edit?new n.EditRecordCommandExecutor:new n.DeleteRecordCommandExecutor:r.UpdateType===t.add?new n.AddRecordListviewExecutor:r.UpdateType===t.edit?new n.EditRecordListviewExecutor:new n.DeleteRecordListviewExecutor},r.checkCalcErrorValue=function(t,i,u){var c,l,e,a,s,h,f,o;if(i)for(c in i)if(l=i[c],l instanceof GC.Spread.CalcEngine.CalcError)return n.Common.format(n.RS.InvalidValueErrorMessage,l.toString(),c,t);if(u)for(e=0;e<u.length;e++){if(a=u[e].TableName,s=u[e].AddValues,s)for(f=0;f<s.length;f++)if(o=r.checkCalcErrorValue(a,s[f].values,null),!n.Common.IsEmpty(o))return o;if(h=u[e].EditValues,h)for(f=0;f<h.length;f++)if(o=r.checkCalcErrorValue(a,h[f].values,null),!n.Common.IsEmpty(o))return o}},r.prototype.removeCommitingRowForDetailListivew=function(t){var r,u,f,e,i;if(t)for(r=0;r<t.length;r++)if(u=n.ListviewBase.getListviewByCalcSheetName(t[r].calcSheetName),u){if(f=t[r].EditValues,f)for(i=0;i<f.length;i++)u.removeFromCommitingRow(f[i].rowIndex);if(e=t[r].AddValues,e)for(i=0;i<e.length;i++)u.removeFromCommitingRow(e[i].rowIndex)}},r.enumAllUpdateDataTableCommand=function(t){var f=[],i,u;if(n.Common.IsEmpty(t)||n.Common.IsEmpty(t.CommandParam))return f;else f.push(t);for(i=t.CommandParam.NextUpdateDataTableCommand;!n.Common.IsEmpty(i);)u=new r,u.CommandExecutingInfo=t.CommandExecutingInfo,u.CommandExecutor=t.CommandExecutor,u.CommandParam=i,i.rowOffset=t.CommandParam.rowOffset,i.columnOffset=t.CommandParam.columnOffset,i.formulaListRowInfo=t.CommandParam.formulaListRowInfo,f.push(u),i=i.NextUpdateDataTableCommand;return f},r}(n.CommandBase),r,u,t;n.UpdateDataTableCommand=i;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var t=this.getOperatedListview(),n=this.CommandParam;if(n.TableName=n.currentTable,n.query)if(t&&t.GetDataCommitMode()!==0){if(t)return n.ActualShowConfirm&&!confirm(n.ConfirmText)||!n.currentTable?0:(t.deletedRowQuerys.push(n.query),t.deleteRow(n.rowIndex,!1))}else return this.UpdateDataTableCommand(n);else if(t)return n.ActualShowConfirm&&!confirm(n.ConfirmText)||!n.currentTable?0:t.deleteRow(n.rowIndex,!0)},i.prototype.getOperatedListview=function(){var i=this.CommandExecutingInfo,u=i.runTimePageName,r=i.commandTrigger,t;if(r instanceof n.ListviewBase)return r;else if(t=n.PageManager.getContainerCell(u),t&&t.cellType instanceof n.RepeaterCellType)return t.cellType.getListview();return null},i.prepareRowInfo=function(n,t){n&&n.forEach(function(n){if(n.$type==="Forguncy.Model.DeleteRecordCommand, Forguncy"){var r=n;r.currentTable=t.currentTable;r.query=t.query}else n.$type==="Forguncy.Model.ConditionCommand, Forguncy"&&n.ConditionAndCommandPairList.forEach(function(n){return i.prepareRowInfo(n.CommandList,t)})})},i}(i);n.DeleteRecordCommand=r;u=function(){function n(){}return n}();n.UpdateValueItem=u;t=function(){function n(){}return n.edit="edit",n.add="add",n.DELETE="delete",n}();n.UpdateType=t;n.CommandFactory.registerCommand("Forguncy.Model.UpdateDataTableCommand, Forguncy",i);n.CommandFactory.registerCommand("Forguncy.Model.DeleteRecordCommand, Forguncy",r)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){try{if(!this._isPopupPage())return alert(n.RS.ClosePopupCommand_NotPopup),0;var r=this._getNavigateCommandParam(),t=this.getPassValueOffset(),e=n.Page.getPageName(),u=this.navigateToPage(r,t.Row,t.Column,null,!0);return i._popupPassValueInfo.splice(i._popupPassValueInfo.length-1,1),u}catch(f){alert(f)}},i.prototype._isPopupPage=function(){return n.ForguncyData.pageInfoStack.length>0},i.prototype.getParentPagePassValueInfo=function(){return i._popupPassValueInfo[i._popupPassValueInfo.length-1]},i.prototype.getPassValueOffset=function(){var t={Row:0,Column:0},i=this.getParentPagePassValueInfo();return n.Common.IsEmpty(i)||(t.Row=i.rowOffset,t.Column=i.columnOffset),t},i.prototype._getNavigateCommandParam=function(){var o={},s,r,u,f,t,i,e;if(this.CommandParam.PassValueBack&&(s=this.getParentPagePassValueInfo(),r=n.Common.IsEmpty(s)?null:s.items,r)){for(u=[],f=0;f<r.length;f++)if(t=r[f],t&&t.CellName&&!t.TargetCell&&(t.TargetCell={Name:t.CellName}),t&&t.Source&&t.Source.length!==0&&t.Source[0]==="="&&t.TargetCell){if(i={},t.TargetCell.Row>=0&&t.TargetCell.Column>=0)i.Source="="+n.Common.getA1ReferenceString(t.TargetCell.Row,t.TargetCell.Column,t.TargetCell.RowRelative,t.TargetCell.ColumnRelative);else if(t.TargetCell.Name)i.Source="="+t.TargetCell.Name;else continue;(i.TargetCell=this.translateSourceToTarget(t.Source),i.TargetCell)&&(i.TargetRunTimePageName=t.SourceRunTimePageName,u.push(i))}u.length>0&&(o.PassValues=u)}return e=n.ForguncyData.pageInfoStack,e.length>0&&(o.PageName=e[e.length-1].pageName),o},i.prototype.translateSourceToTarget=function(t){var r,i;if(n.Common.IsEmpty(t))return null;if(r=n.FormulaHelper.parse(t),r.type===GC.Spread.CalcEngine.ExpressionType.name)return{Row:-1,Column:-1,Name:r.value};else if(r.type===GC.Spread.CalcEngine.ExpressionType.reference&&(i=r,n.FormulaHelper.isCellExpression(i)))return{Row:i.row,Column:i.column,RowRelative:i.rowRelative,ColumnRelative:i.columnRelative};return null},i.prototype.navigateByLoadMetadata=function(t,i,r,u,f){var e=this.CommandParam;n.PageBuilder.closePopup(r,e.ReloadData,e.PassQueryCondition)},i.addPopupPassValueInfo=function(n,t,r,u){i._popupPassValueInfo.push({items:t,rowOffset:r,columnOffset:u})},i._popupPassValueInfo=[],i}(n.NavigateCommandBase);n.ClosePopupCommand=t;n.CommandFactory.registerCommand(n.CommandTypeStr.ClosePopupCommand,t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var t;try{if(t=this.CommandParam,t.ValueFormula){var i=this.evaluateFormula(t.ValueFormula),u={PageName:i},r=!1;if(n.Common.forguncyPostSync("Home/PageNameExisted",u,function(n){r=n}),r)t.PageName=i;else return 1}return t.PageName?this.navigateToPage(t,this.CommandParam.rowOffset,this.CommandParam.columnOffset,this.CommandParam.formulaListRowInfo,!0):1}catch(f){alert(f)}},i.prototype.navigateByLoadMetadata=function(t,i,r,u,f){var e=null,o,v,s,l,h,c,a,y;if(f&&f.length>0)for(e=n.Common.clone(f),o=0;o<e.length;o++)e[o].Source=n.ShareCommandParamsContext.Update(e[o].Source),e[o].TargetCell=n.CommandBase.offsetFormulaCellLocation(e[o].TargetCell,0,0),this.CommandExecutingInfo.runTimePageName!==n.StaticValues.RunTimeNormalPage&&(e[o].SourceRunTimePageName=this.CommandExecutingInfo.runTimePageName);n.ClosePopupCommand.addPopupPassValueInfo(n.ForguncyData.pageInfo.pageID.toString(),e,this.CommandParam.rowOffset,this.CommandParam.columnOffset);l=this.CommandParam.Placement;l&&(h=n.CommandBase.getCellID(l,this.getDefaultFormulaCalcInfo(),!0),h&&h.length>0&&(c=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(h[0]),c&&c.cellType&&(s=c.cellType.getContainer())));s||(a=this.CommandExecutingInfo.commandTrigger,a instanceof n.CellTypeBase&&(s=a.getContainer()));s&&(v=new n.UI.Anchor(s));y={isShowAsPopup:!0,popupDisplayMode:this.CommandParam.PopupDisplayMode,anchor:v};this.stopExecuteCommandList(!0);n.PageBuilder.loadPage(i,r,y)},i}(n.NavigateCommandBase);n.ShowPopupCommand=t;n.CommandFactory.registerCommand(n.CommandTypeStr.ShowPopupCommand,t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){for(var t,e,i,u,r,o=this.CommandParam,f=0;f<o.PropertyItemsList.length;f++)if(t=o.PropertyItemsList[f],t)for(e=n.CommandBase.getCellID(t.Cell,this.getDefaultFormulaCalcInfo(),!0),i=t.PropertyType===4?t.Value:this.evaluateFormula(t.Value),t.PropertyType===undefined&&(t.PropertyType=0),u=0;u<e.length;u++){r=e[u];switch(t.PropertyType){case 2:this.setBackColor(i,r);break;case 3:this.setForeColor(i,r);break;case 0:this.setIsEnabled(i,r);break;case 1:this.setIsVisible(i,r);break;case 4:this.setValue(i,r);break;case 5:this.setReadOnly(i,r)}}return 1},i.shouldUnparseText=function(t){var i,f,r,u;return n.PageManager.isNormalCellID(t)?(i=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(t),!i)?!1:(f=!i.cellType||i.cellType.allowFormatValue(),i.formatString!="@"&&f?!0:!1):(r=n.Common.parseIDStr(t),u=n.ListviewBase.getListviewByCalcSheetName(r.suffix),u)?!u.isTextFormat(r.col):!0},i.prototype.setValue=function(t,r){var f,u;t===i.AUTO_GENERATED_ID_VALUE?(f=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(r),f&&(u=f.bindingInfo,u&&!u.RelationBinding&&(t=this.getAutoGeneratedID(f),n.ForguncyData.pageInfo.autoGeneratedIDs[u.TableName]&&n.ForguncyData.pageInfo.autoGeneratedIDs[u.TableName][u.ColumnName]&&(n.ForguncyData.pageInfo.autoGeneratedIDs[u.TableName][u.ColumnName]=t)))):t=n.ConditionHelper.calcValue(t,this.getDefaultFormulaCalcInfo(),i.shouldUnparseText(r));n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(r,{newValue:t},5)},i.prototype.getAutoGeneratedID=function(t){var i,u,r;return t?(i=t.bindingInfo,!i||i.RelationBinding)?null:(u={bindingInfo:i},r=null,n.Common.forguncyPostSync("Home/GetAutoGeneratedID",u,function(n){r=n}),r):null},i.prototype.setIsEnabled=function(n,t){n&&(n+"").toLowerCase()==="false"&&(n=!1);var i=this.getCell(t);i&&(n?i.enable():i.disable())},i.prototype.setIsVisible=function(n,t){var i=this.getCell(t);i&&i.setVisible(n)},i.prototype.setReadOnly=function(n,t){var i=this.getCell(t);i&&i.setReadOnly(n)},i.prototype.setBackColor=function(n,t){var i=this.getCell(t);i&&i.setBackColor(n)},i.prototype.setForeColor=function(n,t){var i=this.getCell(t);i&&i.setForeColor(n)},i.prototype.getCell=function(t){var i=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(t);return i?i:null},i.AUTO_GENERATED_ID_VALUE="%AutoGeneratedID%",i}(n.CommandBase);n.SetCellPropertyCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.SetCellPropertyCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.CommandExecutingInfo.eventType===n.Events.PageLoaded?this.DelayPrint(function(){return n.PageBuilder.pageCover.css("display")==="none"}):this.PrintImmediatly(),1},i.prototype.DelayPrint=function(n){var t=this;setTimeout(function(){n()?t.PrintImmediatly():t.DelayPrint(n)},50)},i.prototype.PrintImmediatly=function(){var t,r,u;n.DelayRefresh.RunNow();i.IsPrinting=!0;try{return this.Print()}finally{if(i.IsPrinting=!1,t=n.ListviewBase.getAllListviews(),t)for(r=0;r<t.length;r++)t[r]instanceof n.SpreadJSView&&(u=t[r],u.refresh())}},i.prototype.Print=function(){var h=[],c=[],r=n.ListviewBase.getAllListviews(),u,o,i,e,t,f;if(r)for(t=0;t<r.length;t++)u={ShowHorizontal:!1,ShowVertical:!1},o=!1,r[t]instanceof n.SpreadJSView&&(i=r[t],o=i.hideSelection(),o||i.hideSelection(!0),i.showHorizontalScrollBar()&&(i.showHorizontalScrollBar(!1),u.ShowHorizontal=!0),i.showVerticalScrollBar()&&(i.showVerticalScrollBar(!1),u.ShowVertical=!0),i.refresh()),c.push(o),h.push(u),r[t].hiddenLoadingIndicator(!0);for(e=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(),t=0;t<e.length;t++)f=e[t].cellType,f&&f.enterPrintMode();var l=this.CommandParam,s=this.CommandExecutingInfo.commandTrigger,a=!1;if(l.HiddenPrintElement===!0&&s&&(s.setVisible(!1),a=!0),window.print(),r)for(t=0;t<r.length;t++)if(r[t]instanceof n.SpreadJSView){var u=h[t],v=c[t],i=r[t];u.ShowHorizontal&&i.showHorizontalScrollBar(!0);u.ShowVertical&&i.showVerticalScrollBar(!0);v||i.hideSelection(!1);i.refresh()}for(t=0;t<e.length;t++)f=e[t].cellType,f&&f.quitPrintMode();return l.HiddenPrintElement===!0&&s&&a&&s.setVisible(!0),1},i}(n.CommandBase),i;n.PrintCommand=t;i=function(){function n(){}return n}();n.CommandFactory.registerCommand("Forguncy.Model.PrintCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var t=this;switch(this.CommandParam.operation){case 0:return t.logIn();case 4:return t.ForgotPassword();case 7:return t.ChangeUserProfile();case 5:return t.ChangePassword();case 6:return t.ResetPassword();case 1:return t.Logout();case 2:return t.Logout(!0);case 3:return n.ForguncyData.SecurityProviderValidateType==2||n.ForguncyData.AuthenticationType===1?t.WindowsChangeUser():t.Logout();case 8:return t.SubscribeMeByMail();default:return 1}},i.prototype.SubscribeMeByMail=function(){if(n.ValidationMananger.validateAllCells()!==0)return 0;var i=n.Common.getPageContext(),t={};return t.commandID=i.commandID,t.setting=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("MailSubscription_Choice"),n.Common.forguncyPost("Home/AddSubscription",t,function(t,i){t!=null&&n.Common.back()}),1},i.prototype._forceCommitValue=function(t){var i=n.ForguncyData.pageInfo.pageElementManager.cells.getForguncyattrCell(t);i&&i.cellType&&i.cellType.commitValue()},i.prototype.logIn=function(){if(n.ValidationMananger.validateAllCells()!==0)return 0;n.Platform.isMobile()&&(this._forceCommitValue("LogIn_Username"),this._forceCommitValue("LogIn_Password"));var i=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("LogIn_Username"),r=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("LogIn_Password"),t=$("[forguncyattr=LogIn_RememberMe]")[0],u=t&&t.checked;return this.loginByRSA(i,r,u,function(t){if(t!=null&&t.Result){var i=void 0;i=t.Properties&&t.Properties.willNoticeChangePassword&&window.confirm(n.RS.ForSafetyReasonPleaseChangeYourPassword)?n.BuiltInPageManager.builtInPages[n.BuiltInPageType.ChangePassword]:n.ForguncyData.pageInfo.ReturnUrl?n.ForguncyData.pageInfo.ReturnUrl:n.Common.GetUrlQuery("ReturnUrl");location.search="";location.pathname=i?n.ForguncyData.ForguncyRoot+i:n.ForguncyData.ForguncyRoot}},function(t){var i=JSON.parse(t.responseText);n.Common.IsEmpty(i.Message)?alert(n.RS.UserNameOrPasswordIsIncorrect):alert(i.Message)}),1},i.prototype.Logout=function(t){return n.Common.forguncyPost("Account/Logout",null,function(i,r){t?location.href=location.origin+n.ForguncyData.ForguncyRoot:location.reload()}),1},i.prototype.WindowsChangeUser=function(){var t=n.ForguncyData.pageInfo.noPermissionPage?n.ForguncyData.pageInfo.noPermissionPage:n.ForguncyData.pageInfo.ReturnUrl;if(t)return n.Common.forguncyPost("Home/LoginByOtherWindowsUser",{pageName:t},function(t,i){location.pathname=n.ForguncyData.ForguncyRoot+n.ForguncyData.pageInfo.ReturnUrl}),1},i.prototype.ForgotPassword=function(){if(n.ValidationMananger.validateAllCells()!==0)return 0;var t=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ForgotPassword_UserOrEmail");return n.Common.forguncyPost("Account/ForgotPassword",{userNameOrEmail:t},function(t,i){t!=null&&t.Result?n.PageBuilder.loadPage(n.BuiltInPageManager.builtInPages[n.BuiltInPageType.ResetPasswordMailSended]):t.Message?alert(t.Message):alert(n.RS.Failed)}),1},i.prototype.ChangeUserProfile=function(){if(n.ValidationMananger.validateAllCells()!==0)return 0;var t=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ChangeProfile_Picture"),i=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ChangeProfile_FullName"),r=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ChangeProfile_Email");return n.Common.forguncyPost("Account/ChangeUserProfile",{email:r,fullName:i,image:t},function(t,i){t!=null&&t.Result?(alert(n.RS.Success),n.ForguncyData.doNotCacheUserProfileAvator=!0,n.Common.back()):t.Message?alert(t.Message):alert(n.RS.Failed)}),1},i.prototype.ChangePassword=function(){if(n.ValidationMananger.validateAllCells()!==0)return 0;var r=$("[forguncyattr=ChangePassword_ConfirmPassword]"),u=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ChangePassword_OldPassword"),t=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ChangePassword_NewPassword"),i=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ChangePassword_ConfirmPassword");if(t!=i){n.ValidationTooltipHelper.showTooltip(r[0],n.RS.PasswordIsNotSame);return}return this.changePasswordByRSA(t,u,i,function(t,i){t!=null&&t.Result?(alert(n.RS.Success),n.Common.back()):t.Message?alert(t.Message):alert(n.RS.Failed)}),1},i.prototype.ResetPassword=function(){var t;if(n.ValidationMananger.validateAllCells()!==0)return 0;var u=$("[forguncyattr=ResetPassword_ConfirmPassword]"),i=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ResetPassword_NewPassword"),r=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ResetPassword_ConfirmPassword");if(i!=r){n.ValidationTooltipHelper.showTooltip(u[0],n.RS.PasswordIsNotSame);return}if(t=n.Common.GetUrlQuery("token"),!t){alert(n.RS.TokenIsInvalid);return}return this.resetPasswordByRSA(t,i,r,function(t,i){t!=null&&t.Result?(alert(n.RS.ResetPasswordSuccess),n.PageBuilder.loadPage(n.BuiltInPageManager.builtInPages[n.BuiltInPageType.Login])):t.Message?alert(t.Message):alert(n.RS.Failed)}),1},i.prototype.loginByRSA=function(t,i,r,u,f){n.Security.SecurityManager.requestRSAPublicKey(function(e){var o=n.Security.Encrypter.encrypt(i.toString(),e.Value);n.Common.forguncyPost("Account/Login",{userName:t,password:o,rememberMe:r,keyId:e.Id},u,null,f)})},i.prototype.resetPasswordByRSA=function(t,i,r,u){n.Security.SecurityManager.requestRSAPublicKey(function(f){var e=n.Security.Encrypter.encrypt(i.toString(),f.Value),o=n.Security.Encrypter.encrypt(r.toString(),f.Value);n.Common.forguncyPost("Account/ResetPassword",{token:t,newPassword:e,confirmPassword:o,keyId:f.Id},u)})},i.prototype.changePasswordByRSA=function(t,i,r,u){n.Security.SecurityManager.requestRSAPublicKey(function(f){var e=n.Security.Encrypter.encrypt(t.toString(),f.Value),o=n.Security.Encrypter.encrypt(i.toString(),f.Value),s=n.Security.Encrypter.encrypt(r.toString(),f.Value);n.Common.forguncyPost("Account/ChangePassword",{newPassword:e,oldPassword:o,confirmPassword:s,keyId:f.Id},u)})},i}(n.CommandBase);n.UserManagerCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.UserManagerCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var n=this.CommandParam,t=this.getLoopCategory(n.LoopInfo);switch(t){case 2:this.LoopByCount(n);break;case 0:this.LoopByListview(n);break;case 1:this.LoopByCell(n);break;default:break}return 1},i.prototype.getLoopCategory=function(n){return n.$type.indexOf("CountLoopInfo")!=-1?2:n.$type.indexOf("ListviewKindLoopInfo")!=-1?0:n.$type.indexOf("CellLoopInfo")!=-1?1:3},i.prototype.LoopByCount=function(n){for(var i=this.getLoopCount(n.LoopInfo),t=0;t<i;t++)this.addToCommandList(n.CommandList)},i.prototype.getLoopCount=function(n){var i=this.evaluateFormula(n.LoopCount),r=typeof i,t;return r!=="string"&&r!=="number"?0:(t=Number(i),!isFinite(t)||isNaN(t)||t<=0)?0:Number(t.toFixed(0))},i.prototype.LoopByListview=function(t){var o=t.LoopInfo.ListviewName,s=t.LoopInfo.ListViewLoopMode,e=n.ListviewBase.getListview(o,this.CommandExecutingInfo.runTimePageName),f,i,r,u;(s===1&&n.Common.IsEmpty(t.LoopInfo.LastLoopIndex)&&(t.LoopInfo.SelectedRowsCache=e.getAllSelectedRowsOfData()),f=this._getListViewLoopCount(t),f<=0)||(i=0,n.Common.IsEmpty(t.LoopInfo.LastLoopIndex)||(i=t.LoopInfo.LastLoopIndex+1),i>=f)||(r=n.Common.clone(this.CommandParam),r.$type="Forguncy.Model.LoopCommand, Forguncy",r.LoopInfo.LastLoopIndex=i,this.addToCommandList([r]),u=null,u=this.CommandParam.formulaListRowInfo?n.Common.clone(this.CommandParam.formulaListRowInfo):{},u[e.getCalcSheetName()]=this._getCurrentLoopRowIndex(t,i),this.addToCommandList(t.CommandList,null,null,u))},i.prototype.LoopByCell=function(t){for(var r,u,f=n.Common.IsEmpty(t.rowOffset)?0:t.rowOffset,e=n.Common.IsEmpty(t.columnOffset)?0:t.columnOffset,o=t.LoopInfo.OffsetList.length,i=o-1;i>=0;i--)r=n.Common.IsEmpty(t.LoopInfo.OffsetList[i].Row)?-1:t.LoopInfo.OffsetList[i].Row,u=n.Common.IsEmpty(t.LoopInfo.OffsetList[i].Column)?-1:t.LoopInfo.OffsetList[i].Column,this.addToCommandList(t.CommandList,f+r,e+u)},i.prototype._getListViewLoopCount=function(t){if(t.LoopInfo.ListViewLoopMode===0){var i=n.ForguncyData.pageInfo.dataModel.getListDataByListviewName(t.LoopInfo.ListviewName,this.CommandExecutingInfo.runTimePageName);return i?i.getRowCount():0}else return t.LoopInfo.SelectedRowsCache.length},i.prototype._getCurrentLoopRowIndex=function(n,t){return n.LoopInfo.ListViewLoopMode===0?t:n.LoopInfo.SelectedRowsCache[t]},i}(n.CommandBase);n.LoopCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.LoopCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.execute=function(){var t=this.initProperties(),n;if(!t)return 1;switch(this._param.UpdateType){case 0:return this.edit();case 1:return this.add();case 2:return this.delete();case 3:return n=this,r.updateListview(this._listview,function(t){n.updateListviewCallBack(n._listview,t)});default:return 1}},r.prototype.initProperties=function(){return(this._param=this.CommandParam,!this._param)?!1:(this._listview=n.ListviewBase.getListview(this._param.ListviewName,this.CommandExecutingInfo.runTimePageName),!this._listview)?!1:(this._dataModel=this._listview.getListDataModel(),!this._dataModel)?!1:!0},r.prototype.edit=function(){var s=this._listview.commitCurrentEdit(!0),t,i,e,r,o;if(!s)return 0;if(!this._param.UpdateValues)return 1;var f=this.getUpdateRowIndexList(),h=this.getDefaultFormulaCalcInfo(),u=this._param.UpdateValues;for(t=0;t<u.length;t++)if(i=n.Common.getColumnIndex(u[t].Column,this._listview),i!==-1)for(e=n.ConditionHelper.calcValue(u[t].Value,h,!this._listview.isTextFormat(i)),r=f.length-1;r>=0;r--)o=f[r],this._dataModel.setValue(o,i,e,5);return 1},r.prototype.add=function(){var e=this._listview.commitCurrentEdit(!0),t,i,u;if(!e)return 0;if(!this._param.UpdateValues||!this._param.UpdateValues)return 1;var o=this.getDefaultFormulaCalcInfo(),f=[],r=this._param.UpdateValues;for(t=0;t<r.length;t++)(i=n.Common.getColumnIndex(r[t].Column,this._listview),i!==-1)&&(u=n.ConditionHelper.calcValue(r[t].Value,o,!this._listview.isTextFormat(i)),u!==null)&&(f[i]=u);return this._listview.addNewRow(f),1},r.prototype.delete=function(){var i=this._listview.commitCurrentEdit(!0),t,n;if(!i)return 0;for(t=this.getUpdateRowIndexList(),n=t.length-1;n>=0;n--)this._listview.deleteRowByJavascriptAPI(t[n]);return this._param.UpdateRowType===0&&this._listview.clearSelectionOutOfCurrentRow(),1},r.prototype.getUpdateRowIndexList=function(){switch(this._param.UpdateRowType){case 1:return this.getRowsByCondition();case 0:return this.getSelectedRows();case 2:return this.getAllRows();default:return[]}},r.prototype.getSelectedRows=function(){return this._listview.getAllSelectedRowsOfData()},r.prototype.getRowsByCondition=function(){var t;if(!this._param.SpecifiedRowCondition)return[];var f=this._dataModel.getRowCount(),e=this.getDefaultFormulaCalcInfo(),r=new i(this._listview,this._dataModel,this.CommandExecutingInfo.cacheDataHelper),o=n.ConditionHelper.handlingConditionValue(this._param.SpecifiedRowCondition,e,r),u=[];for(t=0;t<f;t++)r.rowIndex=t,n.ConditionHelper.excuteConditionResult(o,r)&&u.push(t);return u},r.prototype.getAllRows=function(){for(var i=this._dataModel.getRowCount(),t=[],n=0;n<i;n++)t.push(n);return t},r.updateListview=function(t,i){if(!r.isListviewAllowUpdate(t))return 0;var u=r.getEditedValues(t);return u?(t.showLoadingIndicator(),t.GetDataValidationTime()===1&&!t.validateCellValues(u))?(t.hiddenLoadingIndicator(),0):(t.updateMultiRows(u,i,function(){alert(n.RS.Commit_FailMessage);t.hiddenLoadingIndicator();n.ForguncyData.commandExcutor.stopExecuteCommandList(!0)}),1):(i(null),1)},r.isListviewAllowUpdate=function(t){var i=t.commitCurrentEdit(!0);return i?t.isGroupMode()?(alert(n.RS.UpdateListviewCommand_Listview_Group),!1):!t.isMasterTable()&&!t.getMasterQuery()?(alert(n.RS.UpdateListviewCommand_Listview_DetailListview),!1):t.bindingTableCanEdit()?n.ValidationMananger.validateRepeaterCells(t,!0)===1?!1:!0:(alert(n.RS.UpdateListViewFail_BindingTableCantEditError),!1):!1},r.getEditedValues=function(t){var i=t.buildDetailListviewValues(!1),r;return i?(r=n.UpdateDataTableCommand.checkCalcErrorValue(null,null,[i]),!n.Common.IsEmpty(r))?(alert(r),null):i:null},r.prototype.updateListviewCallBack=function(t,i){if(!t.hasDestroyed()&&i){var r=i;if(r.Message){t.hiddenLoadingIndicator();this.stopExecuteCommandList(!0);alert(r.Message);return}n.NormalCellBindingManager.reloadData(t.getDataTableName(),!0);n.ForguncyData.getRelatedTableWithForeignKey(t.getDataTableName()).forEach(function(t){n.NormalCellBindingManager.reloadData(t,!0)})}},r}(n.CommandBase),i;n.UpdateListviewCommand=t;i=function(){function t(i,r,u){this._listview=i;this._dataModel=r;this._columnIndexCache=u.getCachedData(t._cacheDataKey);n.Common.IsEmpty(this._columnIndexCache)&&(this._columnIndexCache={},t._cacheDataKey=u.cacheData(this._columnIndexCache))}return t.prototype.calc=function(n){var t=this.getColumnIndex(n);return t===-1?null:this.getValue(t)},t.prototype.getValue=function(n){return n===-1?null:this._dataModel.getValue(this.rowIndex,n)},t.prototype.getColumnIndex=function(t){if(n.Common.IsEmpty(t)||n.Common.IsEmpty(t.Column))return-1;if(typeof t.columnIndex=="undefined"){var r=this._listview.getFullListviewName()+"@"+t.Column,i=this._columnIndexCache[r];n.Common.IsEmpty(i)&&(i=n.Common.getColumnIndex(t.Column,this._listview));this._columnIndexCache[r]=i;t.columnIndex=i}return t.columnIndex},t.prototype.needUnparseValue2=function(n){var t=this.getColumnIndex(n);return t===-1?!1:!this._listview.isTextFormat(t)},t}();n.CommandFactory.registerCommand("Forguncy.Model.UpdateListviewCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.Export(this.CommandParam)},i.prototype.Export=function(t){var u=this,i,r;if(n.Platform.isWeChatOrQQBrowser())return alert(n.ChineseStaticValues.WeChartBrowser_CantDownloadFileWarning),1;this.CommandExecutingInfo.suspend=!0;try{if(n.Common.IsEmpty(t))return 1;i={fileName:t.FileName,fileGuid:t.FileGuid,fileExtension:t.FileExtension};r=n.ForguncyData.ForguncyRoot+"DownloadFile/Download";n.Common.postInHiddenFormAndDownloadFile(r,i,function(){u.CommandExecutingInfo.suspend=!1})}catch(f){alert(f);this.CommandExecutingInfo.suspend=!1}return 1},i}(n.CommandBase);n.DownloadFileCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.DownloadFileCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.runWorkflowCommand(this.CommandParam)},i.prototype.runWorkflowCommand=function(t){var i=this.evaluateFormula(t.TableName),r=t.ActionGUID,u=this.evaluateFormula(t.AssignTo),f=this.evaluateFormula(t.WorkflowComments),e=this.evaluateFormula(t.NextState),o=this.evaluateFormula(t.ActionName),s=this.CommandExecutingInfo.getBindingValueVersions()[i],h=this.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(i),c="WorkflowApi/ExecuteFlowAction",l=this;return n.Common.forguncyPostSync(c,{actionGuid:r,currentInfo:h,comments:f,assignTo:u,newState:e,actionName:o,rowVersion:s},function(t){if(!t||!t.Success)return t.ErrorMessage?alert(t.ErrorMessage):alert(n.RS.ProcessBarCell_ChangeStateFailed),l.stopExecuteCommandList(!0),0;n.NormalCellBindingManager.reloadData(i,!0);n.ForguncyData.pageInfo.ViewInfoList.filter(function(n){return n.ViewType===2&&n.RelatedWorkflowTableName===i}).map(function(n){return n.ViewName}).forEach(function(t){n.NormalCellBindingManager.reloadData(t,!0)})}),1},i}(n.CommandBase);n.WorkflowCommand=t;n.CommandFactory.registerCommand("WorkflowCommand.WorkflowCommand, WorkflowCommand",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return __extends(u,r),u.prototype.execute=function(){return this.shareCommand(this.CommandParam)},u.prototype.shareCommand=function(r){var s=r.ShareCommandContainerRefer.ShareCommandContainerID,f=n.ForguncyData.GlobalSettings.ShareCommands[s],e,u,o;if(f&&f.Commands){if(e={},f.Params)for(u=0;u<f.Params.length;u++)e[f.Params[u].ID]=null;if(r.Params)for(u=0;u<r.Params.length;u++)o=r.Params[u],e[o.ParamReferObject.ParamID]=t.Update(o.Value);t.ParamStack.push(e);this.addToCommandList([].concat(f.Commands,new i))}return 1},u}(n.CommandBase),t,i,r;n.ShareCommand=u;t=function(){function n(){}return n.Update=function(t){if(n.ParamStack&&n.ParamStack.length>0){var r=n.ParamStack[n.ParamStack.length-1],i=r[t];if(i!==undefined)return i}return t===undefined&&(t=null),t},n.ParamStack=[],n}();n.ShareCommandParamsContext=t;n.CommandFactory.registerCommand("Forguncy.Model.ShareCommand, Forguncy",u);i=function(){function n(){this.$type="Forguncy.Model.ShareCommandTerminate, Forguncy"}return n}();n.ShareCommandTerminateParam=i;r=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return __extends(i,n),i.prototype.execute=function(){return t.ParamStack.pop(),1},i}(n.CommandBase);n.ShareCommandTerminate=r;n.CommandFactory.registerCommand("Forguncy.Model.ShareCommandTerminate, Forguncy",r)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){var i={Left:'<?xml version="1.0" encoding="UTF-8"?><svg viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="arrowleft" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Path-5-Copy-2" fill="#4A90E2" transform="translate(5.000000, 5.000000) scale(-1, 1) rotate(90.000000) translate(-5.000000, -5.000000) " points="0 8 10 8 5 2"><\/polygon><\/g><\/svg>',Right:'<?xml version="1.0" encoding="UTF-8"?><svg viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="arrowright" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Path-5-Copy-2" fill="#4A90E2" transform="translate(5.000000, 5.000000) rotate(90.000000) translate(-5.000000, -5.000000) " points="0 8 10 8 5 2"><\/polygon><\/g><\/svg>',Up:'<?xml version="1.0" encoding="UTF-8"?><svg viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="arrowup" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Path-5-Copy-2" fill="#4A90E2" points="0 8 10 8 5 2"><\/polygon><\/g><\/svg>',Down:'<?xml version="1.0" encoding="UTF-8"?><svg viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="arrowdown" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Path-5-Copy-3" fill="#4A90E2" transform="translate(5.000000, 5.000000) scale(1, -1) translate(-5.000000, -5.000000) " points="0 8 10 8 5 2"><\/polygon><\/g><\/svg>'},u=function(t){function r(){var i=t.call(this)||this;return i.id="fgc-columnoptions-dialog",i.defaultUI=f,i.availableTextBlock=new n.UI.TextBlock(n.RS.ColumnOptionsCommand_AvailableColumns).identify("fgc-columnoptions-availabletext"),i.selectedTextBlock=new n.UI.TextBlock(n.RS.ColumnOptionsCommand_SelectedColumns).identify("fgc-columnoptions-selectedtext"),i.availableListBox=new n.UI.ListBox(!0).identify("fgc-columnoptions-availablebox"),i.selectedListBox=(new n.UI.ListBox).identify("fgc-columnoptions-selectedbox"),i.addOrRemoveButtonGroup=new n.UI.ButtonGroup(1),i.moveDownOrUpButtonGroup=new n.UI.ButtonGroup(1),i.resetButton=new n.UI.Button(n.RS.ColumnOptionsCommand_ResetSetting).identify("fgc-columnoptions-button-reset"),i.outerFlex=new n.UI.FlexLayout(0).identify("fgc-columnoptions-outerflex"),i.innerFlex1=new n.UI.FlexLayout(1).identify("fgc-columnoptions-availableflex"),i.innerFlex2=new n.UI.FlexLayout(1).identify("fgc-columnoptions-selectedflex"),i.initializeListBoxs(),i.initializeButtons(),i.title=n.RS.ColumnOptionsCommand_Title,i.initializeFlexLayout(),i}return __extends(r,t),r.prototype.initializeFlexLayout=function(){this.outerFlex.add(this.innerFlex1);this.outerFlex.add(this.addOrRemoveButtonGroup);this.outerFlex.add(this.innerFlex2);this.outerFlex.add(this.moveDownOrUpButtonGroup);this.innerFlex1.add(this.availableTextBlock);this.innerFlex1.add(this.availableListBox);this.innerFlex2.add(this.selectedTextBlock);this.innerFlex2.add(this.selectedListBox);this.footerButtonGroup.add(this.resetButton)},r.prototype.initializeListBoxs=function(){this.availableListBox.compareFn=function(n,t){return n.value.Order-t.value.Order}},r.prototype.initializeButtons=function(){var t=this;this.addOrRemoveButtonGroup.add(new n.UI.Button("",i.Right,n.RS.ColumnOptionsCommand_AddColumn).on("Clicked",function(){t.moveToRight()}).identify("fgc-columnoptions-button-add"));this.availableListBox.on("ActiveItemsChanged",function(){t.moveToRight()});this.addOrRemoveButtonGroup.add(new n.UI.Button("",i.Left,n.RS.ColumnOptionsCommand_RemoveColumn).on("Clicked",function(){t.moveToLeft()}).identify("fgc-columnoptions-button-remove"));this.selectedListBox.on("ActiveItemsChanged",function(){t.moveToLeft()});this.availableListBox.on("SelectionsChanged",function(){t.addOrRemoveButtonGroup.items[0].enabled=t.availableListBox.selections.length>0});this.selectedListBox.on("SelectionsChanged",function(){var n=t.selectedListBox.selections.length>0;t.addOrRemoveButtonGroup.items[1].enabled=n;t.moveDownOrUpButtonGroup.items.forEach(function(t){return t.enabled=n})});this.moveDownOrUpButtonGroup.add(new n.UI.Button("",i.Up,n.RS.ColumnOptionsCommand_MoveColumnUp).on("Clicked",function(){t.selectedListBox.moveUpSelect();t.selectedListBox.moveSelectionToViewport()}).identify("fgc-columnoptions-button-up"));this.moveDownOrUpButtonGroup.add(new n.UI.Button("",i.Down,n.RS.ColumnOptionsCommand_MoveColumnDown).on("Clicked",function(){t.selectedListBox.moveDownSelect();t.selectedListBox.moveSelectionToViewport()}).identify("fgc-columnoptions-button-down"))},r.prototype.moveToRight=function(){var n,t,i;(n=this.selectedListBox).add.apply(n,this.availableListBox.selections);(t=this.selectedListBox).select.apply(t,this.availableListBox.selections);this.selectedListBox.moveSelectionToViewport();(i=this.availableListBox).remove.apply(i,this.availableListBox.selections);this.selectedListBox.focus()},r.prototype.moveToLeft=function(){var n,t,i;(n=this.availableListBox).add.apply(n,this.selectedListBox.selections);(t=this.availableListBox).select.apply(t,this.selectedListBox.selections);this.availableListBox.moveSelectionToViewport();(i=this.selectedListBox).remove.apply(i,this.selectedListBox.selections);this.availableListBox.focus()},r}(n.UI.Dialog),f=function(t){function i(){var i=t!==null&&t.apply(this,arguments)||this;return i.setTimeout=n.DelayRefresh.setTimeout,i}return __extends(i,t),Object.defineProperty(i.prototype,"content",{get:function(){return new e(this.target)},enumerable:!0,configurable:!0}),i}(n.UI.DialogUI),e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.outerFlex.createUI())},t}(n.UI.DialogContentUI),r=function(i){function r(){var n=i!==null&&i.apply(this,arguments)||this;return n.control=new u,n.externalColumns=[],n}return __extends(r,i),r.prototype.execute=function(){var i=this,r,u;return(this.param=this.CommandParam,this.listview=n.ListviewBase.getListview(this.param.ListviewName,this.CommandExecutingInfo.runTimePageName),!this.listview.tryCommitEdit())?0:(this.createControl(),r=this.listview.listviewData.metadata,u=t.isExist(this.listview.getLocationString()),this.control.resetButton.visibility=u,t.resolve(r),this.externalColumns=this.param.Columns.map(function(n,r){return t.generate(i.listview.listviewData.metadata,n,i.param.ID,r+1e6)}),this.resetListBoxItems(),this.control.footerButtonGroup.items[0].enabled=!1,this.control.show(),0)},r.prototype.createControl=function(){this.bindControlEvents();n.ForguncyData.pageInfo.appendExtralPopup(this.control);n.PageBuilder.pagesContainer.append(this.control.createUI().container)},r.prototype.bindControlEvents=function(){var i=this;this.control.on("Confirm",function(){i.resetListView()});this.control.resetButton.on("Clicked",function(){confirm(n.RS.ColumnOptionsCommand_ConfirmResetSetting)&&(t.clear(i.listview.getLocationString()),location.reload())});this.control.selectedListBox.on("ItemsChanged",function(){i.control.footerButtonGroup.items[0].enabled=!0})},r.prototype.resetListBoxItems=function(){var n,t,i=this.generateListBoxItems();this.control.selectedListBox.clear();(n=this.control.selectedListBox).add.apply(n,i.filter(function(n){return n.value.Width>0}));this.control.availableListBox.clear();(t=this.control.availableListBox).add.apply(t,i.filter(function(n){return n.value.Width<=0&&n.value.OriginalWidth>0}))},r.prototype.generateListBoxItems=function(){var i=this,n=[],r=t.distinct(this.listview.listviewData.metadata,this.externalColumns);return n.push.apply(n,r.map(function(n){return{value:n,displayText:i.getColumnName(n)}})),n},r.prototype.resetListView=function(){var u=this.control.availableListBox.items.map(function(n){return n.value}),r,i,f;u.forEach(function(n){return n.Width=0});r=this.control.selectedListBox.items.map(function(n){return n.value});r.forEach(function(n){n.Width<=0&&(n.Width=n.OriginalWidth)});i=this.listview.listviewData.metadata;t.mix(i,__spreadArrays(u,r));t.save(i,this.listview.getLocationString());f=new n.ListviewData(i,this.CommandExecutingInfo.runTimePageName,this.listview.listviewData.uniqueIndex);this.listview.resetListviewDataForColumnOptionsCommand(f)},r.prototype.getColumnName=function(t){var i=t.TemplateCell&&t.TemplateCell.Element&&t.TemplateCell.Element.Name;return i&&!n.Common.IsEmpty(i[0])?i[0]:n.RS.ColumnOptionsCommand_UnamedColumn},r}(n.CommandBase);n.ColumnOptionsCommand=r;var o=function(){function n(){}return n}(),s=function(){function n(){}return n}(),t=function(){function t(){}return t.save=function(t,i){var r=JSON.parse(localStorage.getItem(this.CollectionName)),u;t.Columns.forEach(function(n){var i,r,u,f,e,t=(u=(r=(i=n)===null||i===void 0?void 0:i.TemplateCell)===null||r===void 0?void 0:r.Element)===null||u===void 0?void 0:u.CellType;((f=t)===null||f===void 0?void 0:f.haveLoadItems)===!0&&(t.haveLoadItems=!1);((e=t)===null||e===void 0?void 0:e.hasInitItemsInfo)===!0&&(t.hasInitItemsInfo=!1)});(n.Common.IsEmpty(r)||r.version!==n.StaticData.MetaDataVersion)&&(r={items:[],version:n.StaticData.MetaDataVersion});u=r.items.filter(function(n){return n.id===i});u.length>0?u[0].metadata=t:r.items.push({metadata:t,id:i});localStorage.setItem(this.CollectionName,JSON.stringify(r))},t.isExist=function(n){var t=this.restoreFromLocalStorage(n);return t&&t.length>0},t.restore=function(n){var t=this.restoreFromLocalStorage(n);return t&&t.length>0?t[0].metadata:null},t.restoreFromLocalStorage=function(t){var i=JSON.parse(localStorage.getItem(this.CollectionName));return!n.Common.IsEmpty(i)&&i.version===n.StaticData.MetaDataVersion?i.items.filter(function(n){return n.id===t}):null},t.clear=function(t){var i=JSON.parse(localStorage.getItem(this.CollectionName)),r,u;n.Common.IsEmpty(i)||i.version!==n.StaticData.MetaDataVersion||(r=i.items.filter(function(n){return n.id===t}),r.length>0&&(u=i.items.indexOf(r[0]),i.items.splice(u,1)));localStorage.setItem(this.CollectionName,JSON.stringify(i))},t.resolve=function(t){t.OriginalColumns||(t.OriginalColumns=__spreadArrays(t.Columns));t.Columns.forEach(function(t,i){n.Common.IsEmpty(t.OriginalWidth)&&(t.OriginalWidth=t.Width,t.Order=i)})},t.distinct=function(t,i){var r=n.Common.clone(t.Columns),f=this.getPreserveColumnCount(t),u;return r=r.slice(f),u=r.map(function(n){var t=n.TemplateCell&&n.TemplateCell.Element&&n.TemplateCell.Element.Name;if(t)return t[0]}),i.forEach(function(n){var t=n.TemplateCell&&n.TemplateCell.Element&&n.TemplateCell.Element.Name;t&&u.indexOf(t[0])<0&&r.push(n)}),r},t.mix=function(n,t){var u,e=this.getPreserveColumnCount(n),i,f,r;n.Columns=__spreadArrays(n.Columns.slice(0,e),n.Columns.filter(function(n){return n.OriginalWidth===0}));(u=n.Columns).push.apply(u,t.filter(function(n){return!(n.Width<=0&&n.IsExternal)}));i=__spreadArrays(n.Columns).sort(function(n,t){return n.Index-t.Index});i.forEach(function(t,r){t.IsExternal?(t.Index=i[r-1].Index+i[r-1].ColumnCount,t.HeaderCell&&t.HeaderCell.forEach(function(i,r){i.Element.Column=t.Index+n.CellRange.Column;i.Element.Row=n.CellRange.Row+r})):t.HeaderCell&&t.HeaderCell.forEach(function(n,t){n.ColumnSpan=1})});f=n.Columns.length;f>0?(r=__spreadArrays(n.Columns).sort(function(n,t){return t.Index-n.Index})[0],n.ColumnCount=r.Index+r.ColumnCount):n.ColumnCount=0},t.generate=function(n,t,i,r){return r===void 0&&(r=0),{AllowSort:t.AllowSort,AllowAutoMerge:!1,BindingColumnDataType:t.BindingColumnDataType,FilterBindingInfo:t.BindingInfo,FilterColumnDataType:t.BindingColumnDataType,ColumnCount:1,DependenceCells:[],DependenceColumnsIndex:null,HaveFormula:!1,Index:1e5,HeaderCell:[{ColumnSpan:1,RowSpan:n.ColumnHeaderHeight.length,Row:0,Element:{Value:t.Name,Row:-1,Column:-1,StyleInfo:t.HeaderCellStyleMetadata||this.DefaultHeaderStyleInfo,IgnoreExport:!0}}],TemplateCell:{Element:{BindingInfo:t.BindingInfo,Name:[t.Name],StyleInfo:t.TemplateCellStyleMetadata||this.DefaultTemplateStyleInfo,CellType:t.CellType,DataValidation:t.DataValidation,ServerPropertiesId:t.ServerPropertiesId}},Width:0,OriginalWidth:t.Width||0,IsExternal:!0,Order:r,ColumnOptionsCommandID:i}},t.getPreserveColumnCount=function(n){var t=0;return n.IsRowHeaderVisible&&(t+=1),n.IsRowHeaderCheckBoxVisible&&(t+=1),t},Object.defineProperty(t,"DefaultHeaderStyleInfo",{get:function(){return{FontFamily:n.LocaleFonts.default,FontSize:n.StaticValues.DefaultFontSizeInPx,FontStyle:"Normal",FontWeight:"Normal",HorizontalAlignment:n.CellHorizontalAlignment.Center,Strikethrough:!1,TextIndent:0,Underline:!1,VerticalAlignment:n.CellVerticalAlignment.Center,WordWrap:!1}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DefaultTemplateStyleInfo",{get:function(){return{FontFamily:n.LocaleFonts.default,FontSize:n.StaticValues.DefaultFontSizeInPx,FontStyle:"Normal",FontWeight:"Normal",HorizontalAlignment:n.CellHorizontalAlignment.Left,Strikethrough:!1,TextIndent:0,Underline:!1,VerticalAlignment:n.CellVerticalAlignment.Center,WordWrap:!1}},enumerable:!0,configurable:!0}),t.CollectionName="FGC_ListviewMetadataCollection",t}();n.ListviewMetadataHelper=t;n.CommandFactory.registerCommand("Forguncy.Model.ColumnOptionsCommand, Forguncy",r)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.runCallStoredProcedureCommand(this.CommandParam)},i.prototype.runCallStoredProcedureCommand=function(t){for(var u,s=t.ID,r=t.Parmeters,e=[],o={},i=0;i<r.length;i++)u={Name:r[i].Name,Value:this.evaluateFormula(r[i].Value),Direction:r[i].Direction,DataType:r[i].DataType},e.push(u),o[u.Name]=r[i].ReturnCell;var h="Home/CallStoredProcedure",f=this,c=t.ReturningValue;return n.Common.forguncyPostSync(h,{ID:s,parListStr:JSON.stringify(e)},function(t){var r,e,u,i;if(n.Common.IsEmpty(t)==!1)if(r=t,r.Success===!0){for(e=r.ReturnValue,u=0;u<e.length;u++)i=e[u],i.Direction==3||i.Direction==2?f.SetValue(i.Value,o[i.Name]):i.Direction==6&&f.SetValue(i.Value,c);n.NormalCellBindingManager.reloadData(null,!0)}else return alert(r.ReturnValue),console.error(n.RS.CallStoredProcedureCommand_ExecuteFailed+"\r\n"+r.ReturnValue),f.stopExecuteCommandList(!0),0}),1},i.prototype.SetValue=function(t,i){var u,r;if(!n.Common.IsEmpty(i))for(u=n.CommandBase.getCellID(i,this.getDefaultFormulaCalcInfo(),!0),r=0;r<u.length;r++)n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(u[r],{newValue:t},5)},i}(n.CommandBase);n.CallStoredProcedureCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.CallStoredProcedureCommand, Forguncy",t)}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.sendRequestToServer(this.CommandParam)},i.prototype.sendRequestToServer=function(t){var r=this,u,s,f,e,i,o;if(t.CheckDataValidation){if(!n.ListviewBase.validateAllListviewsData())return this.stopExecuteCommandList(!0),0;s=n.ValidationMananger.validateAllCells();switch(s){case 2:return 2;case 1:return this.stopExecuteCommandList(!0),0;case 0:break}}try{if(f=null,t.OnlySendChangeParams=(u=t.OnlySendChangeParams,u!==null&&u!==void 0?u:[]),t.Parameters&&t.Parameters.length>0)for(f={},e=0;e<t.Parameters.length;e++)i=t.Parameters[e],f[i.ParamName]=i.$type.indexOf("ObjectParam")>=0?this.evaluateFormula(i.Value):this.getListviewData(i,t.OnlySendChangeParams.indexOf(i.ParamName)>=0);return t.RequestAsync&&(this.CommandExecutingInfo.suspend=!0),o="ServerCommand/"+t.ServerCommandName,n.Common.forguncyPost(o,f,function(i){try{r.setResult(t,i);t.RefreshAfterFinish&&n.Page.reloadBindingData()}finally{t.RequestAsync&&(r.CommandExecutingInfo.suspend=!1)}},o,function(n,i){try{var u={ErrCode:n.status,Message:i};r.setResult(t,u)}finally{t.RequestAsync&&(r.CommandExecutingInfo.suspend=!1)}},!1),1}catch(h){alert(h);t.RequestAsync&&(this.CommandExecutingInfo.suspend=!1)}},i.prototype.setResult=function(t,i){var r,u;t.ResultMessageTo&&(r=n.CommandBase.getCellID(t.ResultMessageTo,this.getDefaultFormulaCalcInfo(),!0),this.setValue(i.Message,r));t.ResultErrorCodeTo&&(u=n.CommandBase.getCellID(t.ResultErrorCodeTo,this.getDefaultFormulaCalcInfo(),!0),this.setValue(i.ErrCode,u));i.Log&&(n.Platform.isChrome()?this.consoleGroupedLog(i.Log):console.log(i.Log));i.ErrCode===0||t.ResultMessageTo||t.ResultErrorCodeTo||!i.Log||alert(i.Log)},i.prototype.consoleGroupedLog=function(n){for(var l,h,f,i,e=n.trim().split("\r\n"),a=e.length,o=0,t=0;t<a;t++){var c=e[t],s=c.trim(),v=e[t+1],r=c.search(/\S/),u=(i=(f=v)===null||f===void 0?void 0:f.search(/\S/),i!==null&&i!==void 0?i:-1);if(t===0||u>r)console.group(s),o++;else if(u===r)console.log(s);else if(u<r)for(console.log(s),l=(r-u)/4,h=0;h<l;h++)console.groupEnd(),o--}while(o-->0)console.groupEnd()},i.prototype.setValue=function(t,i){for(var r in i)n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(i[r],{newValue:t},5)},i.prototype.getListviewData=function(t,i){var p,v,o,k,l,f,h,c,d,g,w,s,e,a,r,u,b,it,y;if(i){if(e={AddRows:[],EditRows:[],DeleteRows:[]},p=n.ListviewBase.getAllListviews().filter(function(n){return n.getListviewName()===t.ListviewName}),p.length===0)throw"Can't find a list view with name:"+t.ListviewName;if(v=p[0],o=v.buildDetailListviewValues(!1,null,!0),!o)return e;for(r=0;r<o.AddValues.length;r++){if(u={},k=o.AddValues[r],t.Columns)for(f=0;f<t.Columns.length;f++)h=t.Columns[f].ArrayItemName,c=k.values[t.Columns[f].Column],u[h]=c;e.AddRows.push(u)}for(r=0;r<o.EditValues.length;r++){if(u={},l=o.EditValues[r],t.Columns)for(f=0;f<t.Columns.length;f++)h=t.Columns[f].ArrayItemName,c=l.values[t.Columns[f].Column],c!==undefined?u[h]=c:(d=v.getColIndexOfNamedColumn(t.Columns[f].Column,!1),g=v.getListDataModel().getValue(l.rowIndex,d),u[h]=g);for(s in l.query)u[s]=l.query[s];e.EditRows.push(u)}for(r=0;r<o.DeletedValues.length;r++){u={};w=o.DeletedValues[r];for(s in w.query)u[s]=w.query[s];e.DeleteRows.push(u)}return e}else{if(e=[],a=n.Page.getListView(t.ListviewName),t.Scope==1){var nt=a.getSelectedRowsData(),rt=a.getMergedColumnInfos(),tt=this.mergedColumnInfos(t,rt);for(r=0;r<nt.length;r++){u={};for(b in tt)it=tt[b],u[b]=nt[r].Values[it];e.push(u)}}else for(y=0;y<a.getRowCount();y++)this.addRowData(e,t,y,a);return e}},i.prototype.mergedColumnInfos=function(n,t){for(var f,e,i,u={},r=0;r<n.Columns.length;r++)for(f=n.Columns[r].ArrayItemName,e=n.Columns[r].Column,i=0;i<t.length;i++)t[i].ColumnName==e&&(u[f]=i);return u},i.prototype.addRowData=function(n,t,i,r){var f={},u,e;if(t.Columns)for(u=0;u<t.Columns.length;u++)e=t.Columns[u].ArrayItemName,f[e]=r.getValue(i,t.Columns[u].Column);n.push(f)},i.prototype.getMessage=function(t){if(n.Common.IsEmpty(t))return"";var i=this.evaluateFormula(t.MessageFormula);return n.Common.IsEmpty(i)?"":i},i}(n.CommandBase);n.RequestServerCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.RequestServerCommand, Forguncy",t)}(Forguncy||(Forguncy={})),function(n){var i=function(){function i(){}return i.showTooltip=function(n,r){var u=i.getToolTipElement($(n)),f=u.attr("title");f!==r&&(i.destroyTooltip(u),u.attr("title",r));i.tooltip(u,t.show)},i.destroyTooltip=function(n){var r=i.getToolTipElement(n);i.tooltip(r,t.destroy)},i.getToolTipElement=function(n){return $(n).closest("[data-trigger]")},i.tooltip=function(t,r){return t.each(function(){var u=$(this),t=u.data(i.DataKey),f=typeof r=="object"&&r;(t||r!=="destroy")&&(t||u.data(i.DataKey,t=new n.Tooltip(this,f)),typeof r=="string"&&t[r]())})},i.setTooltipAttr=function(t,r){t.addClass("red-tooltip");t.attr("data-trigger","manual");n.Common.IsEmpty(r)||i.changeTooltipPlacement(t,r)},i.changeTooltipPlacement=function(n,t){var i=t>60?"top":"bottom";n.attr("data-placement",i)},i.DataKey="bs.tooltip",i}(),t;n.ValidationTooltipHelper=i;t=function(){function n(){}return n.show="show",n.destroy="destroy",n}()}(Forguncy||(Forguncy={})),function(n){var t=GC.Spread.Sheets.ConditionalFormatting,i=function(){function i(){}return i.prototype.ConvertConditionRuleToSpreadJS=function(n,t,i,r,u){return u===void 0&&(u=0),this.ConvertConditionRuleToSpreadJSByRanges(n,t,[new GC.Spread.Sheets.Range(u,i,r,1)])},i.prototype.ConvertConditionRuleToSpreadJSByRanges=function(n,t,r){if(!t)return null;this._colStyleInfo=n;var u=null;switch(t.RuleType){case 1:u=this.GenerateCellValueRule(t);break;case 2:u=this.GenerateSpecificTextRule(t);break;case 3:u=this.GenerateDateOccurringRule(t);break;case 4:u=this.GenerateDuplicateRule(t);break;case 5:u=this.GenerateUniqueRule(t);break;case 6:u=i.GenerateTwoColorScaleRule(t);break;case 7:u=i.GenerateThreeColorScaleRule(t);break;case 8:u=this.GenerateTop10Rule(t);break;case 9:u=this.GenerateAverageRule(t);break;case 10:u=this.GenerateFormulaRule(t);break;case 11:u=i.GenerateIconSetRule(t);break;case 12:u=i.GenerateDataBarRule(t);break}return u.stopIfTrue(!!t.StopIfTrue),u.ranges(r),u},i.prototype.GenerateCellValueRule=function(n){var r=n.Params,u=i.ConvertComparisonOperator(r.Operator),f=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.cellValueRule,[],f,u,r.Value1,r.Value2)},i.prototype.GenerateSpecificTextRule=function(n){var i=n.Params,r=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.specificTextRule,[],r,i.Operator,null,null,i.Value)},i.prototype.GenerateDateOccurringRule=function(n){var i=n.Params,r=i.Operator,u=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.dateOccurringRule,[],u,null,null,null,null,null,r)},i.prototype.GenerateDuplicateRule=function(n){var i=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.duplicateRule,[],i)},i.prototype.GenerateUniqueRule=function(n){var i=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.uniqueRule,[],i)},i.GenerateTwoColorScaleRule=function(r){var u=r.Params,f=i.ConvertScaleValueType(u.MinimumType),e=i.ConvertScaleValueType(u.MaximumType);return new t.ScaleRule(t.RuleType.twoScaleRule,f,u.MinimumValue,n.ColorHelper.Convert(u.MinimumColor),null,null,null,e,u.MaximumValue,n.ColorHelper.Convert(u.MaximumColor),[])},i.GenerateThreeColorScaleRule=function(r){var u=r.Params,f=i.ConvertScaleValueType(u.MinimumType),e=i.ConvertScaleValueType(u.MidpointType),o=i.ConvertScaleValueType(u.MaximumType);return new t.ScaleRule(t.RuleType.threeScaleRule,f,u.MinimumValue,n.ColorHelper.Convert(u.MinimumColor),e,u.MidpointValue,n.ColorHelper.Convert(u.MidpointColor),o,u.MaximumValue,n.ColorHelper.Convert(u.MaximumColor),[])},i.GenerateIconSetRule=function(n){var f=n.Params,h=i.ConvertIconSetType(f.IconSetType),e=new t.IconSetRule(h,[]),s,o,r,u;if(e.showIconOnly(f.ShowIconOnly),e.reverseIconOrder(f.ReverseIconOrder),s=e.iconCriteria(),o=s.length,o>=2&&o<=4)for(r=0;r<o;r++)u=f.IconCriteria.$values,s[r]=new t.IconCriterion(u[r].IsGreaterThanOrEqualTo===undefined?!1:u[r].IsGreaterThanOrEqualTo,i.ConvertIconValueType(u[r].IconValueType),u[r].Value===undefined?0:u[r].Value);return e},i.GenerateDataBarRule=function(r){var u=r.Params,e=i.ConvertScaleValueType(u.MaximumType),o=i.ConvertScaleValueType(u.MinimumType),f=new t.DataBarRule(o,u.MinimumValue,e,u.MaximumValue,n.ColorHelper.Convert(u.Color),[]);return f.gradient(u.Gradient),f.axisColor(n.ColorHelper.Convert(u.AxisColor)),f.axisPosition(i.ConvertDataBarAxisPosition(u.AxisPosition)),f.borderColor(n.ColorHelper.Convert(u.BorderColor)),f.negativeBorderColor(n.ColorHelper.Convert(u.NegativeBorderColor)),f.negativeFillColor(n.ColorHelper.Convert(u.NegativeFillColor)),f.showBarOnly(u.ShowBarOnly),f.showBorder(u.ShowBorder),f.useNegativeBorderColor(u.UseNegativeBorderColor),f.useNegativeFillColor(u.UseNegativeFillColor),f.dataBarDirection(i.ConvertDataBarDirection(u.DataBarDirection)),f},i.prototype.GenerateTop10Rule=function(n){var i=n.Params,r=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.top10Rule,[],r,null,null,null,null,null,i.Operator,i.Rank)},i.prototype.GenerateAverageRule=function(n){var r=n.Params,u=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.averageRule,[],u,null,null,null,null,null,i.ConvertAverageRuleType(r.Operator))},i.ConvertAverageRuleType=function(n){switch(n){case 0:return t.AverageConditionType.above;case 4:return t.AverageConditionType.above1StdDev;case 6:return t.AverageConditionType.above2StdDev;case 8:return t.AverageConditionType.above3StdDev;case 1:return t.AverageConditionType.below;case 5:return t.AverageConditionType.below1StdDev;case 7:return t.AverageConditionType.below2StdDev;case 9:return t.AverageConditionType.below3StdDev;case 2:return t.AverageConditionType.equalOrAbove;case 3:return t.AverageConditionType.equalOrBelow}},i.prototype.GenerateFormulaRule=function(n){var i=n.Params,r=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.formulaRule,[],r,null,null,null,null,i.Formula)},i.ConvertScaleValueType=function(n){switch(n){case 8:return t.ScaleValueType.automax;case 6:return t.ScaleValueType.automin;case 7:return t.ScaleValueType.formula;case 3:return t.ScaleValueType.highestValue;case 2:return t.ScaleValueType.lowestValue;case 1:return t.ScaleValueType.number;case 4:return t.ScaleValueType.percent;case 5:return t.ScaleValueType.percentile}},i.ConvertIconValueType=function(n){switch(n){case 7:return t.IconValueType.formula;case 1:return t.IconValueType.number;case 4:return t.IconValueType.percent;case 5:return t.IconValueType.percentile;default:break}},i.ConvertIconSetType=function(n){switch(n){case 15:return t.IconSetType.fiveArrowsColored;case 16:return t.IconSetType.fiveArrowsGray;case 19:return t.IconSetType.fiveBoxes;case 18:return t.IconSetType.fiveQuarters;case 17:return t.IconSetType.fiveRatings;case 10:return t.IconSetType.fourArrowsColored;case 11:return t.IconSetType.fourArrowsGray;case 13:return t.IconSetType.fourRatings;case 12:return t.IconSetType.fourRedToBlack;case 14:return t.IconSetType.fourTrafficLights;case 0:return t.IconSetType.threeArrowsColored;case 1:return t.IconSetType.threeArrowsGray;case 4:return t.IconSetType.threeFlags;case 7:return t.IconSetType.threeSigns;case 3:return t.IconSetType.threeStars;case 8:return t.IconSetType.threeSymbolsCircled;case 9:return t.IconSetType.threeSymbolsUncircled;case 6:return t.IconSetType.threeTrafficLightsRimmed;case 5:return t.IconSetType.threeTrafficLightsUnrimmed;case 2:return t.IconSetType.threeTriangles;default:break}},i.ConvertDataBarAxisPosition=function(n){switch(n){case 0:return t.DataBarAxisPosition.automatic;case 1:return t.DataBarAxisPosition.cellMidPoint;case 2:return t.DataBarAxisPosition.none;default:break}},i.ConvertDataBarDirection=function(n){switch(n){case 0:return t.BarDirection.leftToRight;case 1:return t.BarDirection.rightToLeft}},i.ConvertComparisonOperator=function(n){switch(n){case 1:return t.ComparisonOperators.between;case 2:return t.ComparisonOperators.notBetween;case 3:return t.ComparisonOperators.equalsTo;case 4:return t.ComparisonOperators.notEqualsTo;case 5:return t.ComparisonOperators.greaterThan;case 6:return t.ComparisonOperators.lessThan;case 7:return t.ComparisonOperators.greaterThanOrEqualsTo;case 8:return t.ComparisonOperators.lessThanOrEqualsTo;default:break}},i.prototype.GenerateStyle=function(t){var i,r,u;return n.Common.IsEmpty(t)?null:(i=n.Common.clone(t),this._colStyleInfo&&(r=this._colStyleInfo,n.Common.IsEmpty(i.FontFamily)&&(i.FontFamily=n.Common.IsEmpty(r.FontFamily)?n.LocaleFonts.default:r.FontFamily),i.FontSize===-1&&(i.FontSize=r.FontSize),i.FontStyle===n.StaticValues.Font_Normal&&(i.FontStyle=r.FontStyle),i.FontWeight===n.StaticValues.Font_Normal&&(i.FontWeight=r.FontWeight),n.Common.IsEmpty(i.Underline)&&(i.Underline=r.Underline),n.Common.IsEmpty(i.Strikethrough)&&(i.Strikethrough=r.Strikethrough)),delete i.WordWrap,delete i.HorizontalAlignment,delete i.VerticalAlignment,u=n.ListViewHelper.SpreadJSStyleHelper.generateStlyeObject(i),n.Common.IsEmpty(t.Underline)&&n.Common.IsEmpty(t.Strikethrough)&&delete u.textDecoration,u)},i}();n.ConditionFormatRuleHelper=i}(Forguncy||(Forguncy={})),function(n){var v=function(){function n(){}return n}(),t,i,r,u,f,e,o,s,h,c,l,a;n.ConditionalFormattingMetadata=v;t=function(){function n(){}return n}();n.ConditionRuleModel=t;i=function(){function n(){}return n}();n.CellValueRuleParam=i;r=function(){function n(){}return n}();n.SpecificTextRuleParam=r;u=function(){function n(){}return n}();n.DateOccurringRuleParam=u;f=function(){function n(){}return n}();n.TwoColorScaleRuleParam=f;e=function(){function n(){}return n}();n.ThreeColorScaleRuleParam=e;o=function(){function n(){}return n}();n.IconSetRuleParam=o;s=function(){function n(){}return n}();n.DataBarRuleParam=s;h=function(){function n(){}return n}();n.IconCriterion=h;c=function(){function n(){}return n}();n.Top10RuleParam=c;l=function(){function n(){}return n}();n.AverageRuleParam=l;a=function(){function n(){}return n}();n.FormulaRuleParam=a}(Forguncy||(Forguncy={})),function(n){var t=function(){function t(n){this._runTimePageName=n;this._dependences=[];this._dependenceListviews=[]}return t.prototype.getDependences=function(){return this._dependences},Object.defineProperty(t.prototype,"dependenceListviews",{get:function(){return this._dependenceListviews},enumerable:!0,configurable:!0}),t.prototype.HandleFormulaInConditionFormat=function(n){var t=n.Params;switch(n.RuleType){case 1:this.HandleCellValueRuleParam(t);break;case 2:this.HandleSpecificTextRuleParam(t);break;case 3:break;case 6:this.HandleTwoColorScaleRuleParam(t);break;case 7:this.HandleThreeColorScaleRuleParam(t);break;case 8:break;case 9:break;case 10:this.HandleFormulaRuleParam(t);break;case 11:this.HandleIconSetRuleParam(t);break;case 12:this.HandleDataBarRuleParam(t);break}},t.prototype.HandleCellValueRuleParam=function(n){this.HandleFormula(n,"Value1");this.HandleFormula(n,"Value2")},t.prototype.HandleSpecificTextRuleParam=function(n){this.HandleFormula(n,"Value")},t.prototype.HandleTwoColorScaleRuleParam=function(n){this.HandleFormula(n,"MaximumValue");this.HandleFormula(n,"MinimumValue")},t.prototype.HandleThreeColorScaleRuleParam=function(n){this.HandleFormula(n,"MaximumValue");this.HandleFormula(n,"MinimumValue");this.HandleFormula(n,"MidpointValue")},t.prototype.HandleIconSetRuleParam=function(n){for(var i=n.IconCriteria.$values,t=0;t<i.length;t++)this.HandleFormula(i[t],"Value")},t.prototype.HandleDataBarRuleParam=function(n){this.HandleFormula(n,"MaximumValue");this.HandleFormula(n,"MinimumValue")},t.prototype.HandleFormulaRuleParam=function(n){this.HandleFormula(n,"Formula")},t.prototype.HandleFormula=function(t,i){var e=t[i],r,u;if(typeof e=="string"&&(r=e,r=r.trim(),r.length>0&&r[0]==="="))try{var o=n.FormulaHelper.parse(r),f=this,s=this.adjustFormula(o,function(n){return f.adjustCellExpression(n)},function(n){return f.adjustRangeExpression(n)},function(n){return f.adjustNameExpression(n)});s!==o&&(u=n.FormulaHelper.unparse(s),u="="+u,t[i]=u)}catch(h){}},t.prototype.getAllListviews=function(){return n.ListviewBase.getAllListviews([this._runTimePageName])},t.prototype.adjustCellExpression=function(t){var i=n.Common.getLocatedListview(this._runTimePageName,t.row,t.column),r,f,u;return i!=null&&i instanceof n.SpreadJSView?(f=i.getConditionFormatCalcSourceName(),r=n.ForguncyData.pageInfo.formulaManager.getCalcSource(f),u=i.getContentRangeInfo(),t.row=t.row-u.Row,t.column=t.column-u.Column,this._dependenceListviews.indexOf(i.getCalcSheetName())===-1&&this._dependenceListviews.push(i.getCalcSheetName())):(r=n.ForguncyData.pageInfo.formulaManager.getCalcSource(this._runTimePageName),this._dependences.push({Row:t.row,Column:t.column,ColumnCount:1,RowCount:1})),n.FormulaHelper.createCellExpression(r,null,t.row,t.column,t.rowRelative,t.columnRelative)},t.prototype.adjustRangeExpression=function(t){var i=n.Common.getLocatedListview(this._runTimePageName,t.row,t.column),u,r;return i!=null?(u=n.ForguncyData.pageInfo.formulaManager.getCalcSource(i.getCalcSheetName()),r=i.getContentRangeInfo(),t.row=t.row-r.Row,t.column=t.column-r.Column,t.endRow=t.endRow-r.Row,t.endColumn=t.endColumn-r.Column,this._dependenceListviews.indexOf(i.getCalcSheetName())===-1&&this._dependenceListviews.push(i.getCalcSheetName())):(u=n.ForguncyData.pageInfo.formulaManager.getCalcSource(this._runTimePageName),this._dependences.push({Row:t.row,Column:t.column,ColumnCount:t.endColumn-t.column+1,RowCount:t.endRow-t.row+1})),n.FormulaHelper.createRangeExpression(u,null,t.row,t.column,t.endRow,t.endColumn,t.rowRelative,t.columnRelative,t.endRowRelative,t.endColumnRelative)},t.prototype.adjustNameExpression=function(n){return this._dependences.push(n.value),n},t.prototype.adjustFormula=function(t,i,r,u){var e,f,o,a;if(!t)return t;if(e=this,f=GC.Spread.CalcEngine.ExpressionType,t.type===f.operator){var s=t,v=s.value,y=s.value2,p=e.adjustFormula(v,i,r,u),w=e.adjustFormula(y,i,r,u);if(v!==p||y!==w)return n.FormulaHelper.createOperatorExpression(s.operatorType,p,w)}else if(t.type===f.function){var h=t,b=[],c=void 0,l=!1;for(o=0;o<h.arguments.length;o++)c=h.arguments[o],a=e.adjustFormula(c,i,r,u),l=l||c!==a,b.push(a);if(l)return n.FormulaHelper.createFunctionExpression(h,b)}else if(t.type===f.reference)return n.FormulaHelper.isCellExpression(t)?i(t):r(t);else if(t.type===f.parentheses){var g=t,k=g.value,d=e.adjustFormula(k,i,r,u);if(k!==d)return n.FormulaHelper.createParenthesesExpression(d)}else if(t.type===f.name)return u(t);return t},t}();n.ConditionFormatFormulaHelper=t}(Forguncy||(Forguncy={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){function wt(t,i,r,u,f,e){n.Common.IsEmpty(e)===!1?n.SendMailCommand.sendMail(t,i,r,u,null,f,e):typeof u=="string"?n.SendMailCommand.sendMail(t,i,r,u,null,f,e):n.SendMailCommand.sendMail("",t,i,r,null,u,f)}function bt(t){try{return n.Convertor.fromOADateToDate(t)}catch(i){n.ErrorHelper.printJavascriptAIPError("OADate","ConvertOADateToDate",i)}}function kt(t){try{return n.Convertor.fromDateToOADate(t)}catch(i){n.ErrorHelper.printJavascriptAIPError("OADate","ConvertDateToOADate",i)}}function dt(t){return n.ColorHelper.Convert(t)}var i="rowIndex",e="fn",ft="getCell",ht="getListView",ct="getCellArray",y="getValue",c="setValue",f="bind",l="unbind",p="selectRow",et="addNewRow",r="Page",u="Cell",o="ListView",t=function(n){return n=String(n),n.toLowerCase()},s=function(t,i,r,u){return typeof t!="function"?(n.ErrorHelper.printJavascriptAIPError(i,r,n.Common.format(n.RS.InvalidFunctionParam,u)),!1):!0},lt=function(){function t(){}return t.Loaded=n.Events.Loaded,t.PageDefaultDataLoaded=n.Events.PageDefaultDataLoaded,t.PopupClosed=n.Events.PopupClosed,t}(),d,a,ot,w,b,k,g,nt,tt,v,it,h,rt,at,vt,yt,pt,ut,st;n.PageEvents=lt;d=function(){function i(){this._supportedForguncyEvents=[n.Events.Loaded,n.Events.PageDefaultDataLoaded,n.Events.PopupClosed];this._elements=new a}return i.prototype._getRunTimePageNames=function(t){return t?null:[n.StaticValues.RunTimeNormalPage,n.StaticValues.RunTimeMasterPage]},i.prototype.getCell=function(n,t){return t===void 0&&(t=!0),this._elements.getCell(n,this._getRunTimePageNames(t))},i.prototype.getCellByLocation=function(n){return this._elements.getCellByLocation(n)},i.prototype.getCellArray=function(n,t){return t===void 0&&(t=!0),this._elements.getCellArray(n,this._getRunTimePageNames(t))},i.prototype.getContainerCells=function(n){return n===void 0&&(n=!0),this._elements.getContainerCells(this._getRunTimePageNames(n))},i.prototype.getSubPageInfoByPageID=function(t){var i,r;return this._getRunTimePageNames(!1).indexOf(t)>=0?null:(i=n.PageManager.getContainerCell(t),!i||!i.cellType)?null:(r=this._elements._getCellByPageCell([i])[0],!r)?null:r.getSubPageByPageID(t)},i.prototype.getListView=function(n,t){return t===void 0&&(t=!0),this._elements.getListView(n,this._getRunTimePageNames(t))},i.prototype.getListViews=function(n){return n===void 0&&(n=!0),this._elements.getListViews(this._getRunTimePageNames(n))},i.prototype.recalc=function(){n.FormulaManager.isReady()&&(n.CustomFunction.ODataFunction.clearCache(null,!1),n.ForguncyData.pageInfo.formulaManager.recalc(!0))},i.prototype.suspendCalc=function(){n.FormulaManager.isReady()&&n.ForguncyData.pageInfo.formulaManager.suspend()},i.prototype.resumeCalc=function(){n.FormulaManager.isReady()&&n.ForguncyData.pageInfo.formulaManager.resume(!0)},i.prototype.reloadBindingData=function(t){n.NormalCellBindingManager.reloadData(t,!0)},i.prototype.getUserName=function(){return n.ForguncyData.userInfo.UserName},i.prototype.getUserInfo=function(){return n.ForguncyData.userInfo},i.prototype.getPageName=function(){return n.ForguncyData.pageInfo.pageName},i.prototype.getMasterPageName=function(){return n.ForguncyData.pageInfo.masterPageName},i.prototype.setCurrentRow=function(t){n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.currentRowInfoCollection&&n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfoByAPI(t)},i.prototype._init=function(){this._elements.destory();this._elements=new a},i.prototype._pushCurrentState=function(){i._stateStack.push(this._elements);this._elements=new a},i.prototype._popupState=function(){i._stateStack.length!==0&&(this._init(),this._elements=i._stateStack.pop())},i.prototype._clearState=function(){i._stateStack.forEach(function(n){return n.destory()});i._stateStack=[]},i.prototype.ready=function(t){this.bind(n.Events.Loaded,null,t)},i.prototype.bind=function(u,o,h,c){var v=t(u),l,a;this._checkEventType(v,u,f)&&(arguments.length===2?(h=o,o=undefined):arguments.length===3&&typeof o=="function"&&(c=h,h=o,o=undefined),s(h,r,f,e))&&(l=n.Common.IsEmpty(c)||typeof c!="string"?n.ForguncyData.pageInfo?n.ForguncyData.pageInfo.pageName:null:c,a={eventType:v,data:o,fn:h},l?(i._userEvents[l]||(i._userEvents[l]=[]),i._userEvents[l].push(a)):(this._tempReadyEvents||(this._tempReadyEvents=[]),this._tempReadyEvents.push(a)))},i.prototype.unbind=function(u,o,h){var w=t(u),v,y,c,a,p;if(this._checkEventType(w,u,l)&&(v=arguments.length===1||n.Common.IsEmpty(o),v!==!1||s(o,r,f,e))&&(y=n.Common.IsEmpty(h)||typeof h!="string"?n.ForguncyData.pageInfo.pageName:h,c=y?i._userEvents[y]:this._tempReadyEvents,c))for(a=c.length-1;a>=0;a--)p=c[a],p.eventType===w&&(v||p.fn===o)&&c.splice(a,1)},i.prototype.unbindAll=function(t){var r=n.Common.IsEmpty(t)||typeof t!="string"?n.ForguncyData.pageInfo.pageName:t;r?i._userEvents[r]=[]:this._tempReadyEvents=[]},i.prototype._setTempReadyEvents=function(){var r=n.ForguncyData.pageInfo.pageName,t;r&&(this._tempReadyEvents&&this._tempReadyEvents.length>0&&(t=i._userEvents[r],t=t&&t.length>0?this._tempReadyEvents.concat(t):this._tempReadyEvents,i._userEvents[r]=t),this._tempReadyEvents=null)},i.prototype._trigger=function(t){var r=this;this._setTempReadyEvents();t=t.toLowerCase();t===n.Events.Loaded&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel.bind(n.Events.ValueChanged,function(n,t){r._onCellValueChanged(t)});this._triggerUserEvents(i._userEvents[n.ForguncyData.pageInfo.pageName],t);this._triggerUserEvents(i._userEvents["*"],t)},i.prototype._triggerUserEvents=function(t,i){var f,e,u,r;if(t)for(f=t.map(function(n){return n}),e=f.length,u=0;u<e;u++)r=f[u],r.eventType===i&&r.fn({data:r.data===undefined?null:r.data},{pageName:n.ForguncyData.pageInfo.pageName})},i.prototype._checkEventType=function(t,i,u){return this._supportedForguncyEvents.indexOf(t)===-1?(n.ErrorHelper.printJavascriptAIPError(r,u,n.Common.format(n.RS.NotSupportEventForPage,i,r)),!1):!0},i.prototype._onCellValueChanged=function(t){var i=this._elements.getExistingCellById(t.id);i!==null&&i.trigger(n.Events.ValueChanged,{oldValue:t.oldValue,newValue:t.newValue})},Object.defineProperty(i.prototype,"AutoDisconnectTimeout",{get:function(){return n.ForguncyData.AutoDisconnectTimeout},set:function(t){n.ForguncyData.AutoDisconnectTimeout=t},enumerable:!0,configurable:!0}),i._userEvents={},i._stateStack=[],i}();n.ForguncyPage=d;a=function(){function i(){this._listViews=null;this._cells=null}return i.prototype.getExistingCellById=function(n){var i,t;if(this._cells){for(i=this._cells.length,t=0;t<i;t++)if(this._cells[t]._getCellId()===n)return this._cells[t]}else this._cells=[];return null},i.prototype._createCell=function(t){var i;return t.runTimePageName&&n.Page.getSubPageInfoByPageID(t.runTimePageName),i=t.cellType instanceof n.ContentContainerCellType?new g(t):t.cellType instanceof n.TabControlCellType?new nt(t):t.cellType instanceof n.RepeaterCellType?new tt(t):new w(t),this._cells===null&&(this._cells=[]),this._cells.push(i),i},i.prototype.getCell=function(i,u){var o=t(i),f=n.ForguncyData.pageInfo.pageElementManager.cells.getCellByName(o,!0,u),e;return f===null?(n.ErrorHelper.printJavascriptAIPError(r,ft,n.Common.format(n.RS.CannotFindCell,i)),null):(e=this.getExistingCellById(f.id),e!==null)?e:this._createCell(f)},i.prototype.getCellByLocation=function(t){var u,i,f,e;return t?(u=this._getRunTimePageName(t),n.Common.IsEmpty(u))?null:(i=n.Common.getIdStr(t.Row,t.Column,u),f=this.getExistingCellById(i),f!==null)?f:(e=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(i),e===null)?(n.ErrorHelper.printJavascriptAIPError(r,ft,n.Common.format(n.RS.CannotFindCellById,i)),null):this._createCell(e):null},i.prototype._getRunTimePageName=function(t){if(t.PageID)return t.PageID;var i="";return t.PageName&&(i=n.PageManager.getRunTimePageName(t.PageName)),n.Common.IsEmpty(i)?n.StaticValues.RunTimeNormalPage:i},i.prototype.getCellArray=function(i,u){var e=t(i),f=n.ForguncyData.pageInfo.pageElementManager.cells.getCellsByName(e,!0,u);return!f||f.length===0?(n.ErrorHelper.printJavascriptAIPError(r,ct,n.Common.format(n.RS.CannotFindCell,i)),null):this._getCellByPageCell(f)},i.prototype._getCellByPageCell=function(n){var t=this,i=this;return n.map(function(n){var r=t.getExistingCellById(n.id);return r!==null?r:i._createCell(n)})},i.prototype.getContainerCells=function(t){var r=this,i=n.ForguncyData.pageInfo.pageElementManager.cells.getAllContainerCells();return t&&(i=i.filter(function(n){return n.runTimePageName&&t.indexOf(n.runTimePageName)>=0})),this._getCellByPageCell(i)},i.prototype.getListView=function(i,u){for(var e,s=t(i),o=this.getListViews(u),f=0;f<o.length;f++)if(e=o[f],e.getName().toLowerCase()===s)return e;return n.ErrorHelper.printJavascriptAIPError(r,ht,n.Common.format(n.RS.CannotFindListview,i)),null},i.prototype.getListViews=function(t){var i=this,r=n.ListviewBase.getAllListviews(t);return r.map(function(n){return i._getListviewAPIObject(n)})},i.prototype._getListviewAPIObject=function(n){var t=this._getExistingListview(n.getCalcSheetName());return t?t:this._createListview(n)},i.prototype._getExistingListview=function(n){var i,t;if(this._listViews)for(i=this._listViews.length,t=0;t<i;t++)if(this._listViews[t]._getUniqueID()===n)return this._listViews[t];return null},i.prototype._createListview=function(n){this._listViews===null&&(this._listViews=[]);var t=new rt(n);return this._listViews.push(t),t},i.prototype.destory=function(n){this._listViews&&(this._listViews.filter(function(t){return!n||n.indexOf(t._getPageID())>=0}).forEach(function(n){return n.unbindAll()}),this._listViews=n?this._listViews.filter(function(t){return n.indexOf(t._getPageID())===-1}):null);this._cells&&(this._cells.filter(function(t){return!n||n.indexOf(t._getPageID())>=0}).forEach(function(n){return n.unbindAll()}),this._cells=n?this._cells.filter(function(t){return n.indexOf(t._getPageID())===-1}):null)},i}();n.APIPageElements=a;ot=function(){function t(){}return t.ValueChanged=n.Events.ValueChanged,t.Click=n.Events.Click,t.MouseEnter=n.Events.MouseEnter,t.MouseLeave=n.Events.MouseLeave,t.SelectionChanged=n.Events.SelectionChanged,t.PivottableClick=n.Events.PivottableClick,t}();n.CellEvents=ot;w=function(i){function r(n){var t=i.call(this)||this;return t._pageCell=n,t}return __extends(r,i),r.prototype._getPageID=function(){return this._pageCell.runTimePageName},r.prototype._getCellId=function(){return this._pageCell.id},r.prototype.getValue=function(){return n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this._pageCell.id)},r.prototype.setValue=function(t){if(!this._pageCell.cellType.allowSetValueByUser){n.ErrorHelper.printJavascriptAIPError(u,c,n.Common.format(n.RS.NotSupportSetValue,this._pageCell.name));return}var i=this.getValue();(t===undefined&&(t=null),n.Common.equals(i,t))||n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this._pageCell.id,{newValue:t},5)},r.prototype.setVisible=function(n){this._pageCell.setVisible(n)},r.prototype.hide=function(){this.setVisible(!1)},r.prototype.show=function(){this.setVisible(!0)},r.prototype.setBackColor=function(n){this._pageCell.setBackColor(n)},r.prototype.setForeColor=function(n){this._pageCell.setForeColor(n)},r.prototype.disable=function(){this._pageCell.disable()},r.prototype.enable=function(){this._pageCell.enable()},r.prototype.setReadOnly=function(n){this._pageCell.setReadOnly(n)},r.prototype.hasFocus=function(){var n=this._pageCell.cellType;return n?n.hasFocus():!1},r.prototype.setFocus=function(){var n=this._pageCell.cellType;n&&n.setFocus()},r.prototype.getControl=function(){return this._pageCell.cellType.getControl()},r.prototype.bind=function(r,o,h){if(arguments.length===2&&(h=o,o=undefined),s(h,u,f,e)){var c=t(r);c===n.Events.ValueChanged||this._pageCell.cellType.supportedEvents.indexOf(c)>=0?(i.prototype.bind.call(this,c,o,h),c!==n.Events.ValueChanged&&this._pageCell.cellType.bind(c,o,h)):n.ErrorHelper.printJavascriptAIPError(u,f,n.Common.format(n.RS.NotSupportEventForCellOrListview,r,u,this._pageCell.name))}},r.prototype.unbind=function(r,f){var h=arguments.length===1,o;(h!==!1||s(f,u,l,e))&&(o=t(r),o===n.Events.ValueChanged||this._pageCell.cellType.supportedEvents.indexOf(o)>=0?(i.prototype.unbind.call(this,o,f),o!==n.Events.ValueChanged&&this._pageCell.cellType.unbind(o,f)):n.ErrorHelper.printJavascriptAIPError(u,l,n.Common.format(n.RS.NotSupportEventForCellOrListview,r,u,this._pageCell.name)))},r.prototype.unbindAll=function(){for(var n,r=this._events.length,t=0;t<r;t++)n=this._events[t],this._pageCell.cellType.supportedEvents.indexOf(n.eventType)>=0&&this._pageCell.cellType.unbind(n.eventType,n.fn);i.prototype.unbindAll.call(this)},r}(n.EventClassBase);n.Cell=w;b=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(w);n.ContainerCellBase=b;k=function(t){function i(i){var u=t.call(this,i)||this,r;return u._subPages=[],r=u,r._cellType=i.cellType,r._cellType.bind(n.Events.PageingInfoChanged,function(n,t){r._updateSubPage(t.tabIndex)}),r._cellType.subPageInfos.forEach(function(n,t){return r._updateSubPage(t)}),u}return __extends(i,t),i.prototype._updateSubPage=function(n){n===void 0&&(n=0);this._subPages[n]||(this._subPages[n]=new v(null,null));var t=this._subPages[n],i=this._cellType.subPageInfos[n],r=i?i.runTimeNormalPageName:null,u=i?i.runTimeMasterPageName:null;(r!==t.runTimeNormalPageName||u!==t.runTimeMasterPageName)&&(t.destory(),t.runTimeNormalPageName=r,t.runTimeMasterPageName=u)},i.prototype._getSubPage=function(n){return n===void 0&&(n=0),this._subPages[n]||(this._subPages[n]=new v(null,null)),this._subPages[n]},i.prototype.getSubPageByPageID=function(n){var t=this._subPages.filter(function(t){return t.runTimeMasterPageName===n||t.runTimeNormalPageName===n});return t.length>0?t[0]:null},i}(b);n.SubPageContainerCellBase=k;g=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getContentPage=function(){return this._getSubPage(0)},t}(k);n.ContentContainerCell=g;nt=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getTabPage=function(n){return this._getSubPage(n)},t.prototype.showTab=function(n){this._cellType&&this._cellType.showTab(n)},t.prototype.getActiveTabIndex=function(){return this._cellType?this._cellType.getActiveTabIndex():-1},t.prototype.getTabCount=function(){return this._cellType?this._cellType.getTabCount():0},t}(k);n.TabControlCell=nt;tt=function(t){function i(i){var u=t.call(this,i)||this,r;return u._subPages=[],r=u,r._cellType=i.cellType,r._cellType.bind(n.Events.SubPageChanged,function(n,t){r.removeSubPage()}),u}return __extends(i,t),i.prototype.removeSubPage=function(){var t=this;this._subPages.filter(function(n){return!t._cellType.containRunTimePage(n.runTimeNormalPageName)}).forEach(function(n){n.destory();n.runTimeNormalPageName=null});this._subPages=this._subPages.filter(function(t){return!n.Common.IsEmpty(t.runTimeNormalPageName)})},i.prototype.getSubPageByPageID=function(n){var t=this._subPages.filter(function(t){return t.runTimeNormalPageName===n}),i;return t&&t.length>0?t[0]:this._cellType.containRunTimePage(n)?(i=new it(n),this._subPages.push(i),i):null},i}(b);n.RepeaterCell=tt;v=function(){function t(t,i){t===void 0&&(t=n.StaticValues.RunTimeNormalPage);i===void 0&&(i=n.StaticValues.RunTimeMasterPage);this.runTimeNormalPageName=t;this.runTimeMasterPageName=i}return t.prototype._getRunTimePageNames=function(){return[this.runTimeNormalPageName,this.runTimeMasterPageName].filter(function(t){return!n.Common.IsEmpty(t)})},t.prototype.getCell=function(t){return n.Page._elements.getCell(t,this._getRunTimePageNames())},t.prototype.getCellArray=function(t){return n.Page._elements.getCellArray(t,this._getRunTimePageNames())},t.prototype.getContainerCells=function(){return n.Page._elements.getContainerCells(this._getRunTimePageNames())},t.prototype.getListView=function(t){return n.Page._elements.getListView(t,this._getRunTimePageNames())},t.prototype.getListViews=function(){return n.Page._elements.getListViews(this._getRunTimePageNames())},t.prototype.getPageName=function(){return n.Common.IsEmpty(this.runTimeNormalPageName)?null:n.PageManager.getDesignerPageName(this.runTimeNormalPageName,!1)},t.prototype.getMasterPageName=function(){return n.Common.IsEmpty(this.runTimeMasterPageName)?null:n.PageManager.getDesignerPageName(this.runTimeMasterPageName,!1)},t.prototype.destory=function(){n.Page._elements.destory(this._getRunTimePageNames())},t}();n.SubPage=v;it=function(n){function t(t){return n.call(this,t,null)||this}return __extends(t,n),t.prototype.getPageName=function(){return null},t}(v);n.TemplatePage=it;h=function(){function t(){}return t.Reloaded=n.Events.Reloaded,t.SelectionChanged=n.Events.SelectionChanged,t.SelectedRowsChanged=n.Events.SelectedRowsChanged,t.ValueChanged=n.Events.ValueChanged,t}();n.ListViewEvents=h;rt=function(a){function v(n){var t=a.call(this)||this,i,r;t._grid=n;i=t;for(r in h)(function(n){i._grid.bind(n,function(t,r){i._triggerListviewEvent(n,r)})})(h[r]);return t}return __extends(v,a),v.prototype._triggerListviewEvent=function(n,t){try{this.trigger(n,t)}catch(i){}},v.prototype._getPageID=function(){return this._grid.runTimePageName},v.prototype._getUniqueID=function(){return this._grid.getCalcSheetName()},v.prototype.getName=function(){return this._grid.getListviewName()},v.prototype.getDataTableName=function(){return this._grid.getDataTableName()},v.prototype.getControl=function(){return this._grid.getControl()},v.prototype.getRowCount=function(){return this._grid.getListDataCount()},v.prototype.getSelectedRowIndex=function(){return this._grid.getSelectedRowIndex()},v.prototype.getSelectedRowIndexs=function(){return this._grid.getAllSelectedRowsOfData()},v.prototype.getSelectedRowsData=function(){return this._grid.getSelectedRowsDataByAPI()},v.prototype.clearSelectedRowByQuery=function(t){return n.DelayRefresh.RunNow(),this._grid.clearSelectedRowByQuery(t)},v.prototype.selectRowsByValue=function(t,i){var r=this._getValidColumnIndexParam(i,"selectRowsByValue");if(r!==-1)return n.DelayRefresh.RunNow(),this._grid.selectRowsByValue(t,r)},v.prototype.getQuery=function(n){return this._grid.getListDataModel().getRowQuery(n)},v.prototype.getMergedColumnInfos=function(){return this._grid.getMergedColumnInfos()},v.prototype.getDesignerRangeInfo=function(){return this._grid.getRangeInfo()},v.prototype.getText=function(t,r){if(t=this._getValidRowIndexParam(t,y,i),t===-1)return"";var u=this._getValidColumnIndexParam(r,y);return u===-1?"":(n.DelayRefresh.RunNow(),this._grid.getText(t,u))},v.prototype.getValue=function(n,t){if(n=this._getValidRowIndexParam(n,y,i),n===-1)return null;var r=this._getValidColumnIndexParam(t,y);return r===-1?null:this._grid.getListDataModel().getValue(n,r)},v.prototype._getValidColumnIndexParam=function(i,r,u){var f,e,s;if(u===void 0&&(u=!1),f=-1,typeof i=="string"?(s=t(i),f=this._grid.getColIndexOfNamedColumn(s,!1),f===-1&&(e=n.Common.format(n.RS.CannotFindColumn,i,this.getName()))):(f=this._grid.getDataColIndexByMergedColIndex(i),f===-1&&(e=n.Common.format(n.RS.CannotFindColumnIndex,i,this.getName()))),e)if(u)throw e;else n.ErrorHelper.printJavascriptAIPError(o,r,e);return f},v.prototype.setValue=function(n,t,r){if(n=this._getValidRowIndexParam(n,c,i),n!==-1){var u=this._getValidColumnIndexParam(t,c);u!==-1&&(r=this._ajustValue(r),this._grid.getListDataModel().setValue(n,u,r,5))}},v.prototype.setText=function(n,t,r){if(n=this._getValidRowIndexParam(n,c,i),n!==-1){var u=this._getValidColumnIndexParam(t,c);u!==-1&&this._grid.setCellText(n,u,r)}},v.prototype.addNewRow=function(n,t){if(t===void 0&&(t=!1),n){var i=n instanceof Array?this._getRowDataFromColumnIndexData(n):this._getRowDataFromColumnNameData(n);!i||i.length<=0||(t?this._grid.addNewRowWithText(i):this._grid.addNewRow(i))}},v.prototype.importData=function(t,i,r,u,f,e){var o=this,s,h;t||(t=[]);var c=t.map(function(n){return n instanceof Array?o._getRowDataFromColumnIndexData(n):o._getRowDataFromColumnNameData(n)}),l=(s=u)===null||s===void 0?void 0:s.map(function(n){return o._getValidColumnIndexParam(n,"importData")}),a=(h=f)===null||h===void 0?void 0:h.map(function(n){return o._getValidColumnIndexParam(n,"importData")}),v=new n.ListviewDataImportHelper(this._grid);i?v.importDataWithText(c,r,l,a,!0,e):v.importData(c,r,l,a,e)},v.prototype._getRowDataFromColumnNameData=function(n){var r=[],t,i;for(t in n){if(i=this._getValidColumnIndexParam(t,et),i<0)return null;r[i]=this._ajustValue(n[t])}return r},v.prototype._getRowDataFromColumnIndexData=function(n){for(var i,r=[],t=0;t<n.length;t++){if(i=this._getValidColumnIndexParam(t,et),i<0)return null;n[t]!==undefined&&(r[i]=this._ajustValue(n[t]))}return r},v.prototype._ajustValue=function(n){return n===undefined?null:n},v.prototype.deleteRow=function(n){(n=this._getValidRowIndexParam(n,"deleteRow",i),n!==-1)&&this._grid.deleteRowByJavascriptAPI(n)},v.prototype.selectRow=function(n){n=this._getValidRowIndexParam(n,p,i);n!==-1&&this._grid.selectRow(n)},v.prototype.addSelectedRow=function(t){n.DelayRefresh.RunNow();t=this._getValidRowIndexParam(t,p,i);t!==-1&&this._grid.addSelectedRow(t)},v.prototype.clearSelectedRow=function(t){n.DelayRefresh.RunNow();t=this._getValidRowIndexParam(t,p,i);t!==-1&&this._grid.clearSelectedRow(t)},v.prototype.selectAllRows=function(){n.DelayRefresh.RunNow();this._grid.selectAllRows()},v.prototype.clearAllSelectedRows=function(){n.DelayRefresh.RunNow();this._grid.clearAllSelectedRows()},v.prototype.isSelectedRow=function(t){return n.DelayRefresh.RunNow(),t=this._getValidRowIndexParam(t,p,i),t!==-1?this._grid.isSelectedRow(t):!1},v.prototype._getValidRowIndexParam=function(t,i,r){var u=null;return(n.Common.IsEmpty(t)&&(u=n.Common.format(n.RS.InvalidNumberParam,r)),t=Number(t),isNaN(t)&&(u=n.Common.format(n.RS.InvalidNumberParam,r)),(t<0||t>=this.getRowCount())&&(u=n.Common.format(n.RS.IndexOutOfRange,r)),u!==null)?(n.ErrorHelper.printJavascriptAIPError(o,i,u),-1):t},v.prototype.reload=function(){this._grid.fillData(null,!0)},v.prototype.bind=function(i,u,h){var c=t(i);if(arguments.length===2&&(h=u,u=undefined),s(h,r,f,e)){if(this._isSupportedEvent(c)){a.prototype.bind.call(this,c,u,h);return}n.ErrorHelper.printJavascriptAIPError(o,f,n.Common.format(n.RS.NotSupportEventForCellOrListview,i,o,this.getName()))}},v.prototype._isSupportedEvent=function(n){for(var t in h)if(h[t]===n)return!0;return!1},v.prototype.unbind=function(i,r){var h=arguments.length===1,f;if(h!==!1||s(r,u,l,e)){if(f=t(i),this._isSupportedEvent(f)){a.prototype.unbind.call(this,f,r);return}n.ErrorHelper.printJavascriptAIPError(o,l,n.Common.format(n.RS.NotSupportEventForCellOrListview,i,o,this.getName()))}},v.prototype.getPaginationInfo=function(){return this._grid.getPagingInfo()},v.prototype.usePaginationDisplay=function(n,t){(t===void 0&&(t=1),n<=0||t<0)||this._paginationDisplayListview(4,t,n)},v.prototype.goToFirstPage=function(){this._paginationDisplayListview(0,1)},v.prototype.goToPreviousPage=function(){var t=n.ForguncyData.pageingInfoList.GetPageIndex(this._grid.getLocationString());this._paginationDisplayListview(1,t)},v.prototype.goToNextPage=function(){var t=n.ForguncyData.pageingInfoList.GetPageIndex(this._grid.getLocationString());this._paginationDisplayListview(2,t)},v.prototype.goToLastPage=function(){this._paginationDisplayListview(3,1)},v.prototype.goToSpecifiedPage=function(n){n<0||this._paginationDisplayListview(4,n)},v.prototype._paginationDisplayListview=function(t,i,r){if(r===void 0&&(r=0),r===0&&(r=n.ForguncyData.pageingInfoList.GetLimit(this._grid.getLocationString())),!(r<=0)){var u=[{$type:"Forguncy.Model.GoToPageCommand, Forguncy",targetPageKind:t,ListviewName:this.getName(),Limit:r,TargetPageIndex:i}];n.ForguncyData.commandExcutor.excuteCommand(u,this._grid.runTimePageName,null,"null",n.Events.Click)}},v.prototype.showLoadingIndicator=function(){this._grid.showLoadingIndicator()},v.prototype.hiddenLoadingIndicator=function(){this._grid.hiddenLoadingIndicator()},v.prototype.commitEditChange=function(){return this._grid.commitEditChange()},v.prototype.getRowValue=function(n){return this._grid.getRowValue(n)},v.prototype.getDataCommitMode=function(){return this._grid.GetDataCommitMode()},v.prototype.getDataValidationTime=function(){return this._grid.GetDataValidationTime()},v.prototype.isRowHeaderVisible=function(){return this._grid instanceof n.SpreadJSView?this._grid.isRowHeaderVisible():!1},v.prototype.isRowHeaderCheckBoxVisible=function(){return this._grid instanceof n.SpreadJSView?this._grid.isRowHeaderCheckBoxVisible():!1},v.prototype.setSelection=function(t,i){this._grid instanceof n.SpreadJSView&&this._grid.setSelectionWithEvent(t,i,1,1)},v.prototype.hideColumns=function(n){return this.showOrHideColumns(n,!0)},v.prototype.showColumns=function(n){return this.showOrHideColumns(n,!1)},v.prototype.showOrHideColumns=function(t,i){var f=this,r,u;if(t&&!(t.length<=0))try{r=i?"hideColumns":"showColumns";u=t.map(function(n){return f._getValidColumnIndexParam(n,r,!0)});new n.ListivewColumnManager(this._grid).showOrHideColumns(u,i)}catch(e){throw e;}},v}(n.EventClassBase);n.ListView=rt,function(n){n[n.Add=0]="Add";n[n.Merge=1]="Merge";n[n.Replace=2]="Replace";n[n.MergeIgnoreEdit=3]="MergeIgnoreEdit";n[n.ReplaceIgnoreEdit=4]="ReplaceIgnoreEdit"}(at=n.ImportMode||(n.ImportMode={})),function(n){n[n.ExistSameKeys=0]="ExistSameKeys";n[n.ValidateError=1]="ValidateError"}(vt=n.ImportError||(n.ImportError={})),function(n){n[n.RowHeader=0]="RowHeader";n[n.SelectedColumn=1]="SelectedColumn";n[n.DataColumn=2]="DataColumn"}(yt=n.ListviewColumnType||(n.ListviewColumnType={})),function(n){n[n.Other=0]="Other";n[n.Number=1]="Number";n[n.Bool=2]="Bool";n[n.Date=3]="Date";n[n.Time=4]="Time";n[n.String=5]="String";n[n.Image=6]="Image";n[n.Attachment=7]="Attachment";n[n.User=8]="User"}(pt=n.ColumnDataType||(n.ColumnDataType={}));n.Page=new d;ut=function(){function t(){}return t.prototype.getBaseUrl=function(){return n.ForguncyData.ForguncyRoot},t.prototype.getBuiltInImageFolderPath=function(){return n.ForguncyData.ForguncyRoot+"Resources/Images/CellTypeBuiltInImage/"},t.prototype.getImageEditorUploadImageFolderPath=function(){return n.ForguncyData.ForguncyRoot+"GeneratedResources/Images/GenerateImages/ImageCellType/"},t.prototype.getUploadFileFolderPathInDesigner=function(){return n.ForguncyData.ForguncyRoot+"GeneratedResources/images/UserCustomCellTypeFiles/"},t.prototype.getUploadImageFolderPathInServer=function(){return n.ForguncyData.ForguncyRoot+"Upload/"},t.prototype.getUserFileFolderPath=function(){return n.ForguncyData.ForguncyRoot+"GeneratedResources/UserFile/"},t}();n.SpecialPath=ut;st=function(){function t(){}return t.post=function(t,i,r,u){u===void 0&&(u=!0);u?n.Common.forguncyPost(t,i,r):n.Common.forguncyPostSync(t,i,r)},t.getCellLocation=function(t,i){var r=n.Common.getRunTimePageNameFromFormulaCalcContext(i);return n.FormulaHelper.getCellLocation(t,r)},t.preSetEchartOption=function(n,t,i){},t.preProcessImageSrc=function(n){return n},t.SpecialPath=new ut,t}();n.Helper=st;n.SendMail=wt;n.ConvertOADateToDate=bt;n.ConvertDateToOADate=kt;n.ConvertToCssColor=dt}(Forguncy||(Forguncy={})),function(n){function b(n,t,u,f){var o={};o[r]=t;i(e,n,o,u,f)}function k(t,i,r,u){u===void 0&&(u=!0);n.Common.operateODataPost(y,t,i,r,u)}function d(i,r,u,f){f===void 0&&(f=!0);var s="Home/GetTableDataForPlugins",h=n.Common.IsEmpty(i.QueryPolicy)?!0:i.QueryPolicy.Distinct,c=n.Common.getRunTimePageNameFromFormulaCalcContext(r),l=n.Common.IsEmpty(i.QueryPolicy)?n.QueryNullPolicy.QueryAllItemsWhenValueIsNull:i.QueryPolicy.QueryNullPolicy,o={tableName:i.TableName,columns:i.Columns,queryCondition:n.ConditionHelper.getComputedSqlConditionFormula(i.QueryCondition,c,l),sortCondition:i.SortCondition,distinct:h},e=JSON.stringify(o),a=n.Common.IsEmpty(i.QueryPolicy)?!1:i.QueryPolicy.IgnoreCache;a||t[e]===undefined?f?n.Common.forguncyPost(s,o,function(n){t[e]=n;u&&u(n)}):n.Common.forguncyPostSync(s,o,function(n){t[e]=n;u&&u(n)}):u&&u(t[e])}function g(n,t,u,f){var e={};e[r]=t;i(a,n,e,u,f)}function nt(n,t,r,u){var f={};f[c]=t;i(v,n,f,r,u)}function tt(n,t,u,f,e){var o={};o[r]=t;o[h]=u;i(l,n,o,f,e)}function it(n,t,r){var f={};f.updateData=n;i(u,null,f,t,r)}function rt(t,i){n.Common.forguncyPost(p,{tableName:t},function(n){i&&i(n)})}function i(t,i,r,h,c){var y,l,a,v;if(t===u){for(y in r.updateData)if(i=String(y),l=s(i,r),l){c&&c(l);return}}else if(i=String(i),l=s(i,r),l){c&&c(l);return}a={};a[f]=i;for(v in r)a[v]=r[v];n.Common.forguncyPost(t,a,function(n){var f=n,s,l;if(f.Success){if(t!==e){if(t===u)for(s in r.updateData)o(s,!0);else o(i,!0);$(window).trigger("ForguncyRowCountChanged")}h&&(f.TableRowData?(l=f.TableRowData,h(l)):h())}else c&&c(f.ErrorMessage)})}function o(t,i){n.NormalCellBindingManager.reloadData(t,i);n.ForguncyData.getRelatedTableWithForeignKey(t).forEach(function(t){n.NormalCellBindingManager.reloadData(t,i)})}function s(t,i){if(t==="")return n.Common.format(n.RS.WebApi_ErrorInfo_NonemptyStringParam,f);for(var r in i)if(typeof i[r]!="object")return n.Common.format(n.RS.WebApi_ErrorInfo_ParamInvalid,r)}function ut(){t={}}var f="tableName",r="primaryKey",h="updateValue",c="newValue",e="Home/GetTableDataApi",l="Home/UpdateTableDataApi",a="Home/DeleteTableDataApi",v="Home/AddTableDataApi",u="Home/ModifyTablesDataApi",y="Home/GetTableDataODataApi",p="Home/ForceSyncExternalBuiltInTableDataApi",w,t;(function(n){n[n.QueryAllItemsWhenValueIsNull=0]="QueryAllItemsWhenValueIsNull";n[n.QueryZeroItemsWhenValueIsNull=1]="QueryZeroItemsWhenValueIsNull"})(w=n.QueryNullPolicy||(n.QueryNullPolicy={}));n.getTableData=b;n.getTableDataByOData=k;n.getTableDataByCondition=d;n.deleteTableData=g;n.addTableData=nt;n.updateTableData=tt;n.modifyTablesData=it;n.forceSyncTableData=rt;t={};n.clearGetTableDataByConditionCache=ut}(Forguncy||(Forguncy={})),function(n){function r(t,i,r,u,f){r===void 0&&(r=!1);var e=new n.UserManagerCommand,o=u!==null&&u!==void 0?u:function(){location.reload()};e.loginByRSA(t,i,r,o,f)}function u(t){var i=new n.UserManagerCommand;i.Logout(t)}function f(r,u,f,e,o,s){if(n.ForguncyData.AuthenticationType===1){if(o=u,s=f,u=undefined,f=undefined,e=undefined,!t(o,"function")||!t(s,"function")||!t(r,"string")){alert(n.RS.AddUserApiParamError);return}i("AddUser",{userName:r},o,s)}else{if(!t(u,"string")||!t(f,"string")||!t(e,"string")||!t(o,"function")||!t(s,"function")||!t(r,"string")){alert(n.RS.AddUserApiParamError);return}n.Security.SecurityManager.requestRSAPublicKey(function(t){var h=n.Security.Encrypter.encrypt(u,t.Value);i("AddUser",{userName:r,password:h,displayName:f,email:e,keyId:t.Id},o,s)})}}function t(n,t){return typeof n===t?!0:!1}function e(n,t,r){i("DeleteUser",{userName:n},t,r)}function o(n,t,r,u){i("AddUserToRole",{userName:n,roleName:t},r,u)}function s(n,t,r,u){i("DeleteUserFromRole",{userName:n,roleName:t},r,u)}function i(t,i,r,u){n.Common.forguncyPost("Account/"+t,i,function(n){n.Result?r&&r():u&&u(n.Message)})}n.logIn=r;n.logOut=u;n.addUser=f;n.deleteUser=e;n.addUserToRole=o;n.deleteUserFromRole=s}(Forguncy||(Forguncy={})),function(n){var t;(function(t){t.CellHorizontalAligment=n.CellHorizontalAlignment;t.CellVerticalAlignment=n.CellVerticalAlignment;t.CellTypeBase=n.CellTypeBase;t.CellTypeHelper=n.CellTypeHelper;t.CommandBase=n.CommandBase;t.CommandFactory=n.CommandFactory})(t=n.Plugin||(n.Plugin={}))}(Forguncy||(Forguncy={})),function(n){var t;(function(t){var i,r;$(document).ready(function(){if(location.hostname==="localhost"){var n=null;$(document).on("keydown",function(t){var f,u;if(!n&&t.key==="m"&&t.ctrlKey===!0){for(f=$("[innerid],[fgcname],[chartname]"),n=$("<div/>"),n.addClass("fgc-cell-tip__cover"),u=0;u<f.length;u++){var i=$(f[u]),e=i.attr("innerid"),r=$("<div/>");r.addClass("fgc-cell-tip__label");r.css("left",i.offset().left);r.css("top",i.offset().top);i.attr("fgcname")?e=i.attr("fgcname"):i.attr("chartname")&&(e=i.attr("chartname"));r.text(e);n.append(r)}return $(document.body).append(n),!1}});$(document).on("keyup",function(t){n&&(n.remove(),n=null)})}});i=function(){function t(){}return t.getListviewControl=function(t){for(var r=n.ListviewBase.getAllListviews(),i=0;i<r.length;i++)if(r[i].getListviewName()===t)return r[i]},t.getSpreadJSNewRowIndex=function(i){var r=t.getListviewControl(i);return r&&r instanceof n.SpreadJSView?r.getNewRowIndex():-1},t.IsListviewAllowEdit=function(n){var i=t.getListviewControl(n);return i?i.allowEdit():!1},t.getBackcolor=function(t,i,r){var u=this.getActualStyle(t,i,r);return u&&!n.Common.IsEmpty(u.backColor)?u.backColor:""},t.getForecolor=function(t,i,r){var u=this.getActualStyle(t,i,r);return u&&!n.Common.IsEmpty(u.foreColor)?u.foreColor:""},t.getActualStyle=function(n,i,r){var u=t.getListviewControl(n);return u?u.getActualStyle(i,r):null},t}();t.Listview=i;r=function(){function t(){}return t.login=function(t,i,r){var u=new n.UserManagerCommand;u.loginByRSA(t,i,r,function(){location.reload()})},t}();t.UserManager=r})(t=n.AutoTest||(n.AutoTest={}))}(Forguncy||(Forguncy={}));+function(n){"use strict";var t=function(n,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null;this.init("tooltip",n,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"><\/div><div class="tooltip-inner"><\/div><\/div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1};t.prototype.init=function(t,i,r){var f,e,u,o,s;for(this.enabled=!0,this.type=t,this.$element=n(i),this.options=this.getOptions(r),f=this.options.trigger.split(" "),e=f.length;e--;)if(u=f[e],u=="click")this.$element.on("click."+this.type,this.options.selector,n.proxy(this.toggle,this));else if(u!="manual"){o=u=="hover"?"mouseenter":"focusin";s=u=="hover"?"mouseleave":"focusout";this.$element.on(o+"."+this.type,this.options.selector,n.proxy(this.enter,this));this.$element.on(s+"."+this.type,this.options.selector,n.proxy(this.leave,this))}this.options.selector?this._options=n.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()};t.prototype.getDefaults=function(){return t.DEFAULTS};t.prototype.getOptions=function(t){return t=n.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t};t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&n.each(this._options,function(n,r){i[n]!=r&&(t[n]=r)}),t};t.prototype.enter=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);if(clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)};t.prototype.leave=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){i.hoverState=="out"&&i.hide()},i.options.delay.hide)};t.prototype.show=function(){var h=n.Event("show.bs."+this.type),u,i,v,s;if(this.hasContent()&&this.enabled){if(this.$element.trigger(h),h.isDefaultPrevented())return;u=this;i=this.tip();this.setContent();this.options.animation&&i.addClass("fade");var t=typeof this.options.placement=="function"?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,c=/\s?auto?\s?/i,l=c.test(t);l&&(t=t.replace(c,"")||"top");i.detach().css({top:0,left:0,display:"block"}).addClass(t);this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element);var r=this.getPosition(),f=i[0].offsetWidth,e=i[0].offsetHeight;if(l){var o=this.$element.parent(),y=t,a=document.documentElement.scrollTop||document.body.scrollTop,p=this.options.container=="body"?window.innerWidth:o.outerWidth(),w=this.options.container=="body"?window.innerHeight:o.outerHeight(),b=this.options.container=="body"?0:o.offset().left;t=t=="bottom"&&r.top+r.height+e-a>w?"top":t=="top"&&r.top-a-e<0?"bottom":t=="right"&&r.right+f>p?"left":t=="left"&&r.left-f<b?"right":t;i.removeClass(y).addClass(t)}v=this.getCalculatedOffset(t,r,f,e);this.applyPlacement(v,t);this.hoverState=null;s=function(){u.$element.trigger("shown.bs."+u.type)};n.support.transition&&this.$tip.hasClass("fade")?i.one(n.support.transition.end,s).emulateTransitionEnd(150):s()}};t.prototype.applyPlacement=function(t,i){var c,r=this.tip(),l=r[0].offsetWidth,e=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),s=parseInt(r.css("margin-left"),10),f,u,h;isNaN(o)&&(o=0);isNaN(s)&&(s=0);t.top=t.top+o;t.left=t.left+s;n.offset.setOffset(r[0],n.extend({using:function(n){r.css({top:Math.round(n.top),left:Math.round(n.left)})}},t),0);r.addClass("in");f=r[0].offsetWidth;u=r[0].offsetHeight;i=="top"&&u!=e&&(c=!0,t.top=t.top+e-u);/bottom|top/.test(i)?(h=0,t.left<0&&(h=t.left*-2,t.left=0,r.offset(t),f=r[0].offsetWidth,u=r[0].offsetHeight),this.replaceArrow(h-l+f,f,"left")):this.replaceArrow(u-e,u,"top");c&&r.offset(t)};t.prototype.replaceArrow=function(n,t,i){this.arrow().css(i,n?50*(1-n/t)+"%":"")};t.prototype.setContent=function(){var n=this.tip(),t=this.getTitle();n.find(".tooltip-inner")[this.options.html?"html":"text"](t);n.removeClass("fade in top bottom left right")};t.prototype.hide=function(){function u(){t.hoverState!="in"&&i.detach();t.$element.trigger("hidden.bs."+t.type)}var t=this,i=this.tip(),r=n.Event("hide.bs."+this.type);if(this.$element.trigger(r),!r.isDefaultPrevented())return i.removeClass("in"),n.support.transition&&this.$tip.hasClass("fade")?i.one(n.support.transition.end,u).emulateTransitionEnd(150):u(),this.hoverState=null,this};t.prototype.fixTitle=function(){var n=this.$element;(n.attr("title")||typeof n.attr("data-original-title")!="string")&&n.attr("data-original-title",n.attr("title")||"").attr("title","")};t.prototype.hasContent=function(){return this.getTitle()};t.prototype.getPosition=function(){var t=this.$element[0];return n.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())};t.prototype.getCalculatedOffset=function(n,t,i,r){return n=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-i/2}:n=="top"?{top:t.top-r,left:t.left+t.width/2-i/2}:n=="left"?{top:t.top+t.height/2-r/2,left:t.left-i}:{top:t.top+t.height/2-r/2,left:t.left+t.width}};t.prototype.getTitle=function(){var t=this.$element,n=this.options;return t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title)};t.prototype.tip=function(){return this.$tip=this.$tip||n(this.options.template)};t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")};t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)};t.prototype.enable=function(){this.enabled=!0};t.prototype.disable=function(){this.enabled=!1};t.prototype.toggleEnabled=function(){this.enabled=!this.enabled};t.prototype.toggle=function(t){var i=t?n(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;i.tip().hasClass("in")?i.leave(i):i.enter(i)};t.prototype.destroy=function(){clearTimeout(this.timeout);this.hide().$element.off("."+this.type).removeData("bs."+this.type)};Forguncy&&(Forguncy.Tooltip=t)}(jQuery,Forguncy);+function(n){"use strict";function r(i){n(f).remove();n(t).each(function(){var t=u(n(this)),r={relatedTarget:this};t.hasClass("open")&&((t.trigger(i=n.Event("hide.bs.dropdown",r)),i.isDefaultPrevented())||t.removeClass("open").trigger("hidden.bs.dropdown",r))})}function u(t){var i=t.attr("data-target"),r;return i||(i=t.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")),r=i&&n(i),r&&r.length?r:t.parent()}var f=".dropdown-backdrop",t="[data-toggle=_dropdown]",i=function(t){n(t).on("click.bs.dropdown",this.toggle)};i.prototype.toggle=function(t){var f=n(this),i,o,e;if(!f.is(".disabled, :disabled")){if(i=u(f),o=i.hasClass("open"),r(),!o){if("ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length)n('<div class="dropdown-backdrop"/>').insertAfter(n(this)).on("click",r);if(e={relatedTarget:this},i.trigger(t=n.Event("show.bs.dropdown",e)),t.isDefaultPrevented())return;i.toggleClass("open").trigger("shown.bs.dropdown",e);f.focus()}return!1}};i.prototype.keydown=function(i){var e,o,s,h,f,r;if(/(38|40|27)/.test(i.keyCode)&&(e=n(this),i.preventDefault(),i.stopPropagation(),!e.is(".disabled, :disabled"))){if(o=u(e),s=o.hasClass("open"),!s||s&&i.keyCode==27)return i.which==27&&o.find(t).focus(),e.click();(h=" li:not(.divider):visible a",f=o.find("[role=menu]"+h+", [role=listbox]"+h),f.length)&&(r=f.index(f.filter(":focus")),i.keyCode==38&&r>0&&r--,i.keyCode==40&&r<f.length-1&&r++,~r||(r=0),f.eq(r).focus())}};n(document).on("click.bs.dropdown.data-api",r).on("click.bs.dropdown.data-api",".dropdown form",function(n){n.stopPropagation()}).on("click.bs.dropdown.data-api",t,i.prototype.toggle).on("keydown.bs.dropdown.data-api",t+", [role=menu], [role=listbox]",i.prototype.keydown)}(jQuery);+function(n){"use strict";var t=function(t){this.element=n(t)};t.prototype.show=function(){var t=this.element,e=t.closest("ul:not(.dropdown-menu)"),i=t.data("target"),r,u,f;(i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),t.parent("li").hasClass("active"))||(r=e.find(".active:last a")[0],u=n.Event("show.bs.tab",{relatedTarget:r}),t.trigger(u),u.isDefaultPrevented())||(f=n(i),this.activate(t.parent("li"),e),this.activate(f,f.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:r})}))};t.prototype.activate=function(t,i,r){function e(){u.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");t.addClass("active");f?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade");t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active");r&&r()}var u=i.find("> .active"),f=r&&n.support.transition&&u.hasClass("fade");f?u.one(n.support.transition.end,e).emulateTransitionEnd(150):e();u.removeClass("in")};Forguncy&&(Forguncy.Tab=t)}(jQuery)